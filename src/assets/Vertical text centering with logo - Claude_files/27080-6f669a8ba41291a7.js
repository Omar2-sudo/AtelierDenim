try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="fc54264e-b77a-4e0c-9ad6-928e78236de1",e._sentryDebugIdIdentifier="sentry-dbid-fc54264e-b77a-4e0c-9ad6-928e78236de1")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27080],{0xede65b:(e,t,a)=>{"use strict";a.d(t,{n:()=>s});let s=e=>{let t,a=[],s=/\[[^\]]*\]\((computer:\/\/\/[^)]+)\)/g;for(;null!==(t=s.exec(e));)a.push(t[1]);let n=RegExp("(?<!\\]\\()computer:\\/\\/\\/[^\\s)\\],;!?`]+(?![^[]*\\])","g");return a.push(...e.match(n)||[]),[...new Set(a.map(e=>e.replace(/[.,;!?)]+$/,"")))]}},0x1020e1ec:(e,t,a)=>{"use strict";a.d(t,{w:()=>o,y:()=>d});var s=a(0x12c9046cd),n=a(0x1a3383306),l=a(0xfc89b4a4);function i(e,t){let a=new Map;return t.forEach(e=>{var t;let s=null!=(t=a.get(e.file_name))?t:[];s.push(e),a.set(e.file_name,s)}),a.get(e)}function r(e,t){let a=i(e,t);if(!a||0===a.length)return null;let s=a.filter(e=>e.file_kind===n.Mr.Blob);return 0===s.length?null:s[s.length-1]}function o(){let e=function(){let e=(0,s.mn)();return(0,l.useCallback)(async(t,a,s,n,l)=>{let i=r(t,a);if(!i&&n){let a=await e("/api/organizations/".concat(s,"/projects/").concat(n,"/docs")),l=(await a.json()).find(e=>e.file_name===t);if(l)return new TextEncoder().encode(l.content);let o=await e("/api/organizations/".concat(s,"/projects/").concat(n,"/files"));i=r(t,await o.json())}if(!i)return null;try{let e=l?"/api/organizations/".concat(s,"/shared_artifact/").concat(l,"/files/").concat(i.file_uuid,"/contents"):"/api/organizations/".concat(s,"/files/").concat(i.file_uuid,"/contents"),t=await fetch(e);if(!t.ok)return null;let a=await t.arrayBuffer();if(a.byteLength>0x80000000-1)return null;return new Uint8Array(a)}catch(e){return null}},[e])}();return(0,l.useCallback)(async(t,a,s,n,l,r)=>{if(!n)return null;let o=function(e,t){let a=i(e,t);if(!a||0===a.length)return null;let s=a[a.length-1];if(s){let e=s.extracted_content;return new TextEncoder().encode(e)}return null}(t,a);return o||await e(t,s,n,l,r)},[e])}function d(e,t,a,s,n){let i=o();return(0,l.useCallback)(async l=>i(l,e,t,a,s,n),[e,t,a,s,i,n])}},0x15fe0c6d:(e,t,a)=>{"use strict";a.d(t,{Y:()=>L});var s=a(0x22102fd88),n=a(0xb289f444),l=a(0xde20e41b),i=a(0x219970d37),r=a(0x38ec88a6),o=a(0xfc89b4a4),d=a(0x1ab0d1ca1),c=a(0x1c29096e8);let u=new Map,m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.15;if("undefined"==typeof document)return"";let t=Math.round(100*e);if(u.has(t))return u.get(t);let a=document.createElement("canvas");a.width=200,a.height=200;let s=a.getContext("2d");if(!s)return"";let n=s.createImageData(200,200);for(let t=0;t<n.data.length;t+=4){let a=255*Math.random();n.data[t]=a,n.data[t+1]=a,n.data[t+2]=a,n.data[t+3]=255*e}s.putImageData(n,0,0);let l=a.toDataURL();return u.set(t,l),l},x=(0,o.memo)(e=>{let{opacity:t=.4,blend:a="overlay"}=e,[n,l]=(0,o.useState)("");return((0,o.useEffect)(()=>{l(m(.15))},[]),n)?(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(n,")"),opacity:t,mixBlendMode:a}}):null});x.displayName="Grain";let f=(0,o.memo)(e=>{let{day:t,mutedColor:a}=e,o=(0,d.A)(),c=t.precipitation_chance;if(void 0!==c&&c>0){let e="snow"===t.precipitation_type?(0,s.jsx)(n.D,{size:12,weight:"fill",style:{color:a}}):(0,s.jsx)(l.e,{size:12,weight:"fill",style:{color:a}});return(0,s.jsxs)("div",{className:"flex items-center gap-0.5",children:[e,(0,s.jsx)("span",{className:"text-[10px]",style:{color:a},children:o.formatMessage({defaultMessage:"{percent}%",id:"9hSgu8oT87"},{percent:Math.round(c)})})]})}return t.condition&&["cloudy","overcast","fog","partly_cloudy"].includes(t.condition)?(0,s.jsx)(i.E,{size:12,weight:"fill",style:{color:a}}):(0,s.jsx)(r.b,{size:12,weight:"fill",style:{color:a}})});f.displayName="PrecipitationDisplay";let p=(0,o.memo)(e=>{let{days:t,bgColor:a="#0a0f19",borderColor:n="rgba(255,255,255,0.1)",textColor:l="rgba(255,255,255,0.8)",mutedColor:i="rgba(255,255,255,0.4)"}=e,r=(0,d.A)(),c=(0,o.useCallback)((e,t)=>{if(0===t)return r.formatMessage({defaultMessage:"Today",id:"zWgbGgjUUg"});if(e.day_of_week)return e.day_of_week;if(e.date)try{return r.formatDate(new Date(e.date),{weekday:"short"})}catch(e){}return""},[r]);return(0,s.jsx)("div",{className:"rounded-b-2xl",style:{background:a,borderTop:"1px solid ".concat(n)},children:(0,s.jsx)("div",{className:"flex",children:t.slice(0,5).map((e,t)=>(0,s.jsxs)("div",{className:"flex-1 py-3 text-center flex flex-col items-center",style:{borderLeft:t>0?"1px solid ".concat(n):void 0},children:[(0,s.jsx)("div",{className:"text-xs",style:{color:i},children:c(e,t)}),(0,s.jsx)("div",{className:"text-sm font-medium mt-1",style:{color:l},children:void 0!==e.high?"".concat(Math.round(e.high),"\xb0"):"—"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(f,{day:e,mutedColor:i})})]},t))})})});p.displayName="ForecastStrip";let g=(0,o.memo)(e=>{let{location:t,temp:a,condition:n,lightText:l=!0,labelColor:i="rgba(255,255,255,0.5)"}=e;return(0,s.jsxs)("div",{className:"absolute inset-0 p-5 flex justify-between items-end",children:[(0,s.jsxs)("div",{children:[t&&(0,s.jsx)("div",{className:"text-xs uppercase tracking-widest mb-1",style:{color:i,letterSpacing:2},children:t}),(0,s.jsx)("div",{className:"text-4xl font-light leading-none tracking-tight",style:{color:l?"hsl(var(--always-white))":"rgba(40,40,40,0.9)",textShadow:l?"0 2px 8px hsl(var(--always-black)/15%)":"none"},children:void 0!==a?"".concat(Math.round(a),"\xb0"):"—"})]}),n&&(0,s.jsx)("div",{className:"text-xs text-right",style:{color:i},children:n})]})});g.displayName="WeatherInfo";let h=(0,o.memo)(()=>{let[e,t]=(0,o.useState)("");return(0,o.useEffect)(()=>{t(m(.05))},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{background:"linear-gradient(180deg, #4a90d0 0%, #70b0e0 50%, #90c8f0 100%)"}}),(0,s.jsx)("style",{children:"@keyframes bandMove { 0%, 100% { transform: translateX(-20%); } 50% { transform: translateX(20%); } }"}),[.15,.35,.55,.75].map((e,t)=>(0,s.jsx)("div",{className:"absolute",style:{top:"".concat(100*e,"%"),left:"-20%",width:"140%",height:35,background:"linear-gradient(90deg, transparent, rgba(255,255,255,".concat(.18-.025*t,"), transparent)"),filter:"blur(18px)",animation:"bandMove ".concat(8+2*t,"s ease-in-out infinite"),animationDelay:"".concat(1.5*t,"s")}},t)),e&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(e,")"),opacity:.3,mixBlendMode:"overlay"}})]})});h.displayName="ClearDayEffect";let b=(0,o.memo)(()=>{let e=(0,o.useRef)(null),[t,a]=(0,o.useState)("");return(0,o.useEffect)(()=>{a(m(.05))},[]),(0,o.useEffect)(()=>{let t,a=e.current;if(!a)return;let s=a.getContext("2d");if(!s)return;let n=[{x:100,y:50},{x:150,y:75},{x:200,y:45},{x:180,y:100},{x:350,y:60},{x:400,y:40},{x:420,y:90},{x:380,y:115},{x:500,y:55},{x:530,y:95},{x:480,y:110}],l=[[0,1],[1,2],[1,3],[4,5],[5,6],[6,7],[4,7],[8,9],[9,10]],i=0,r=()=>{s.fillStyle="rgb(5, 8, 18)",s.fillRect(0,0,800,160),i+=.01,l.forEach(e=>{let[t,a]=e,l=.15*Math.sin(i+t)+.2;s.beginPath(),s.moveTo(n[t].x,n[t].y),s.lineTo(n[a].x,n[a].y),s.strokeStyle="rgba(100, 150, 200, ".concat(l,")"),s.lineWidth=1,s.stroke()}),n.forEach((e,t)=>{let a=.3*Math.sin(2*i+t)+.7;s.beginPath(),s.arc(e.x,e.y,2,0,2*Math.PI),s.fillStyle="rgba(255, 255, 255, ".concat(a,")"),s.fill()});for(let e=0;e<50;e++){let t=37*e%800,a=23*e%160,n=.3*Math.sin(3*i+.5*e)+.4;s.beginPath(),s.arc(t,a,.8,0,2*Math.PI),s.fillStyle="rgba(255, 255, 255, ".concat(n,")"),s.fill()}t=requestAnimationFrame(r)};return r(),()=>cancelAnimationFrame(t)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("canvas",{ref:e,width:800,height:160,className:"absolute inset-0 w-full h-full"}),t&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(t,")"),opacity:.4,mixBlendMode:"overlay"}})]})});b.displayName="ClearNightEffect";let v=(0,o.memo)(e=>{let{isDay:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"@keyframes partlyCloudDrift { 0% { transform: translateX(0); } 100% { transform: translateX(-40%); } }"}),(0,s.jsx)("div",{className:"absolute inset-0",style:{background:t?"linear-gradient(180deg, #4a90d0 0%, #70b0e0 50%, #90c8f0 100%)":"linear-gradient(135deg, #050510 0%, #0a0a20 20%, #101035 40%, #16164a 60%, #1c1c5a 80%, #22226a 100%)"}}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"@keyframes bandMove { 0%, 100% { transform: translateX(-20%); } 50% { transform: translateX(20%); } }"}),[.2,.45,.7].map((e,t)=>(0,s.jsx)("div",{className:"absolute",style:{top:"".concat(100*e,"%"),left:"-20%",width:"140%",height:30,background:"linear-gradient(90deg, transparent, rgba(255,255,255,".concat(.12-.02*t,"), transparent)"),filter:"blur(15px)",animation:"bandMove ".concat(10+2*t,"s ease-in-out infinite"),animationDelay:"".concat(2*t,"s")}},"band-".concat(t)))]}),[0,1].map(e=>(0,s.jsx)("div",{className:"absolute",style:{top:"".concat(15+25*e,"%"),left:0,width:"180%",height:55,background:t?"linear-gradient(90deg, transparent 0%, rgba(255,255,255,".concat(.5-.15*e,") 15%, rgba(255,255,255,").concat(.7-.2*e,") 30%, rgba(255,255,255,").concat(.45-.1*e,") 45%, transparent 55%, transparent 100%)"):"linear-gradient(90deg, transparent 0%, rgba(60,60,90,".concat(.4-.1*e,") 15%, rgba(70,70,100,").concat(.55-.15*e,") 30%, rgba(55,55,85,").concat(.35-.08*e,") 45%, transparent 55%, transparent 100%)"),filter:"blur(22px)",animation:"partlyCloudDrift ".concat(70+15*e,"s linear infinite"),animationDelay:"".concat(-20*e,"s")}},e)),(0,s.jsx)(x,{opacity:t?.1:.25})]})});v.displayName="PartlyCloudyEffect";let y=(0,o.memo)(e=>{let{isDay:t}=e,a=(0,o.useRef)(null),[n,l]=(0,o.useState)("");return(0,o.useEffect)(()=>{l(m(.1))},[]),(0,o.useEffect)(()=>{let e,s=a.current;if(!s)return;let n=s.getContext("2d");if(!n)return;let l=[];for(let e=0;e<4;e++){let t=[];for(let e=0;e<30;e++)t.push({x:800*Math.random()*1.5,y:160*Math.random(),size:70+120*Math.random(),alpha:.025+.045*Math.random()});l.push({blobs:t,speed:.12+.08*e})}let i=t?"rgb(180, 178, 175)":"rgb(30, 32, 38)",r=t?[255,255,255]:[80,85,100],o=()=>{n.fillStyle=i,n.fillRect(0,0,800,160),l.forEach(e=>{e.blobs.forEach(t=>{let a=n.createRadialGradient(t.x,t.y,0,t.x,t.y,t.size);a.addColorStop(0,"rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(t.alpha,")")),a.addColorStop(.6,"rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(.4*t.alpha,")")),a.addColorStop(1,"transparent"),n.fillStyle=a,n.fillRect(t.x-t.size,t.y-t.size,2*t.size,2*t.size),t.x-=e.speed,t.x<-t.size&&(t.x=800+t.size,t.y=160*Math.random())})}),e=requestAnimationFrame(o)};return o(),()=>cancelAnimationFrame(e)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("canvas",{ref:a,width:800,height:160,className:"absolute inset-0 w-full h-full"}),n&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(n,")"),opacity:.45,mixBlendMode:"multiply"}})]})});y.displayName="FogEffect";let j=(0,o.memo)(e=>{let{isDay:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{background:t?"linear-gradient(135deg, #6a7078 0%, #7a8088 25%, #8a9098 50%, #9aa0a8 75%, #aab0b8 100%)":"linear-gradient(135deg, #1a1a22 0%, #22222a 25%, #2a2a32 50%, #32323a 75%, #3a3a42 100%)"}}),(0,s.jsx)("div",{className:"absolute",style:{top:0,left:0,right:0,height:"70%",background:t?"linear-gradient(180deg, rgba(90,95,105,0.4) 0%, transparent 100%)":"linear-gradient(180deg, rgba(10,10,15,0.5) 0%, transparent 100%)"}}),(0,s.jsx)(x,{opacity:.45,blend:"multiply"})]})});j.displayName="OvercastEffect";let w=(0,o.memo)(e=>{let{isDay:t}=e,a=(0,o.useRef)(null),[n,l]=(0,o.useState)("");return(0,o.useEffect)(()=>{l(m(.06))},[]),(0,o.useEffect)(()=>{let e,s=a.current;if(!s)return;let n=s.getContext("2d");if(!n)return;let l=[];for(let e=0;e<60;e++)l.push({x:800*Math.random(),y:160*Math.random(),len:4+8*Math.random(),speed:1.5+1.5*Math.random(),alpha:.08+.12*Math.random()});let i=[],r=[];for(let e=0;e<20;e++)r.push({x:800*Math.random(),y:160*Math.random(),size:40+80*Math.random(),alpha:.02+.03*Math.random(),drift:.1+.2*Math.random()});let o=()=>{let a=n.createLinearGradient(0,0,0,160);t?(a.addColorStop(0,"rgb(95, 105, 120)"),a.addColorStop(.5,"rgb(85, 95, 110)"),a.addColorStop(1,"rgb(75, 85, 100)")):(a.addColorStop(0,"rgb(25, 30, 40)"),a.addColorStop(.5,"rgb(20, 25, 35)"),a.addColorStop(1,"rgb(15, 20, 30)")),n.fillStyle=a,n.fillRect(0,0,800,160),r.forEach(e=>{let a=n.createRadialGradient(e.x,e.y,0,e.x,e.y,e.size),s=t?"180, 190, 200":"100, 110, 130";a.addColorStop(0,"rgba(".concat(s,", ").concat(e.alpha,")")),a.addColorStop(.5,"rgba(".concat(s,", ").concat(.5*e.alpha,")")),a.addColorStop(1,"transparent"),n.fillStyle=a,n.fillRect(e.x-e.size,e.y-e.size,2*e.size,2*e.size),e.x+=e.drift,e.x>800+e.size&&(e.x=-e.size)});let s=t?"140, 160, 180":"120, 140, 170";l.forEach(e=>{n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(e.x-.5,e.y+e.len),n.strokeStyle="rgba(".concat(s,", ").concat(e.alpha,")"),n.lineWidth=.8,n.stroke(),e.y+=e.speed,e.x-=.15,e.y>160&&(Math.random()>.7&&i.push({x:e.x,y:155+10*Math.random(),r:0,maxR:15+20*Math.random(),speed:.3+.2*Math.random()}),e.y=-e.len,e.x=800*Math.random())});let d=t?"160, 175, 190":"100, 120, 150";i.forEach(e=>{e.r+=e.speed;let t=.25*Math.max(0,1-e.r/e.maxR);n.beginPath(),n.arc(e.x,e.y,e.r,0,2*Math.PI),n.strokeStyle="rgba(".concat(d,", ").concat(t,")"),n.lineWidth=1,n.stroke(),e.r>3&&(n.beginPath(),n.arc(e.x,e.y,.6*e.r,0,2*Math.PI),n.strokeStyle="rgba(".concat(d,", ").concat(.5*t,")"),n.stroke())}),i=i.filter(e=>e.r<=e.maxR).slice(-15),e=requestAnimationFrame(o)};return o(),()=>cancelAnimationFrame(e)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{background:t?"linear-gradient(180deg, rgba(120,130,145,0.3) 0%, transparent 50%)":"linear-gradient(180deg, rgba(40,50,70,0.4) 0%, transparent 50%)"}}),(0,s.jsx)("canvas",{ref:a,width:800,height:160,className:"absolute inset-0 w-full h-full"}),n&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(n,")"),opacity:.4,mixBlendMode:"overlay"}})]})});w.displayName="DrizzleEffect";let N=(0,o.memo)(e=>{let{isDay:t}=e,a=(0,o.useRef)(null),[n,l]=(0,o.useState)("");return(0,o.useEffect)(()=>{l(m(.08))},[]),(0,o.useEffect)(()=>{let e,s=a.current;if(!s)return;let n=s.getContext("2d");if(!n)return;let l=[];for(let e=0;e<80;e++)l.push({x:880*Math.random(),y:160*Math.random()-50,len:12+20*Math.random(),speed:6+5*Math.random(),alpha:.08+.18*Math.random()});let i=()=>{n.fillStyle="rgba(".concat(t?"60, 70, 85":"15, 22, 35",", 0.15)"),n.fillRect(0,0,800,160),l.forEach(e=>{n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(e.x-.2*e.len,e.y+e.len),n.strokeStyle="rgba(140, 170, 200, ".concat(e.alpha,")"),n.lineWidth=1.1,n.stroke(),e.y+=e.speed,e.x-=.2*e.speed,e.y>180&&(e.y=-e.len,e.x=880*Math.random())}),e=requestAnimationFrame(i)};return n.fillStyle=t?"rgb(60, 70, 85)":"rgb(15, 22, 35)",n.fillRect(0,0,800,160),i(),()=>cancelAnimationFrame(e)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("canvas",{ref:a,width:800,height:160,className:"absolute inset-0 w-full h-full"}),n&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(n,")"),opacity:.5,mixBlendMode:"overlay"}})]})});N.displayName="RainEffect";let _=(0,o.memo)(e=>{let{isDay:t}=e,a=(0,o.useRef)(null),[n,l]=(0,o.useState)("");return(0,o.useEffect)(()=>{l(m(.08))},[]),(0,o.useEffect)(()=>{let e,t=a.current;if(!t)return;let s=t.getContext("2d");if(!s)return;let n=[];for(let e=0;e<120;e++)n.push({x:900*Math.random(),y:160*Math.random()-50,len:18+28*Math.random(),speed:10+8*Math.random(),alpha:.1+.22*Math.random()});let l=()=>{s.fillStyle="rgba(15, 22, 35, 0.18)",s.fillRect(0,0,800,160),n.forEach(e=>{s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(e.x-.35*e.len,e.y+e.len),s.strokeStyle="rgba(140, 170, 200, ".concat(e.alpha,")"),s.lineWidth=1.3,s.stroke(),e.y+=e.speed,e.x-=.35*e.speed,e.y>185&&(e.y=-e.len,e.x=920*Math.random())}),e=requestAnimationFrame(l)};return s.fillStyle="rgb(15, 22, 35)",s.fillRect(0,0,800,160),l(),()=>cancelAnimationFrame(e)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("canvas",{ref:a,width:800,height:160,className:"absolute inset-0 w-full h-full"}),(0,s.jsx)("div",{className:"absolute",style:{top:-20,left:-30,right:-30,height:80,background:"linear-gradient(180deg, #0a0c10 0%, transparent 100%)",filter:"blur(10px)"}}),n&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(n,")"),opacity:.6,mixBlendMode:"overlay"}})]})});_.displayName="HeavyRainEffect";let k=(0,o.memo)(()=>{let e=(0,o.useRef)(null),[t,a]=(0,o.useState)("");return(0,o.useEffect)(()=>{a(m(.06))},[]),(0,o.useEffect)(()=>{let t,a=e.current;if(!a)return;let s=a.getContext("2d");if(!s)return;let n=[];for(let e=0;e<90;e++)n.push({x:800*Math.random(),y:160*Math.random(),len:14+20*Math.random(),speed:5+6*Math.random(),alpha:.08+.15*Math.random()});let l=[],i=()=>{if(s.fillStyle="rgba(10, 12, 20, 0.12)",s.fillRect(0,0,800,160),n.forEach(e=>{s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(e.x-.8,e.y+e.len),s.strokeStyle="rgba(130, 160, 200, ".concat(e.alpha,")"),s.lineWidth=1,s.stroke(),e.y+=e.speed,e.y>160+e.len&&(e.y=-e.len,e.x=800*Math.random())}),Math.random()>.996){let e=800*Math.random(),t=160*Math.random()*.4,a=2+Math.floor(3*Math.random());for(let s=0;s<a;s++)l.push({x:e+(Math.random()-.5)*200,y:t+(Math.random()-.5)*80,intensity:.04+.04*Math.random(),decay:.97+.015*Math.random(),size:200+280*Math.random()})}l.forEach((e,t)=>{let a=s.createRadialGradient(e.x,e.y,0,e.x,e.y,e.size);a.addColorStop(0,"rgba(160, 175, 200, ".concat(e.intensity,")")),a.addColorStop(.4,"rgba(140, 160, 190, ".concat(.4*e.intensity,")")),a.addColorStop(.7,"rgba(120, 140, 170, ".concat(.15*e.intensity,")")),a.addColorStop(1,"transparent"),s.fillStyle=a,s.fillRect(0,0,800,160),e.intensity*=e.decay,e.intensity<.005&&l.splice(t,1)}),t=requestAnimationFrame(i)};return s.fillStyle="rgb(10, 12, 20)",s.fillRect(0,0,800,160),i(),()=>cancelAnimationFrame(t)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("canvas",{ref:e,width:800,height:160,className:"absolute inset-0 w-full h-full"}),t&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(t,")"),opacity:.5,mixBlendMode:"overlay"}})]})});k.displayName="ThunderstormEffect";let M=(0,o.memo)(()=>{let e=(0,o.useRef)(null),[t,a]=(0,o.useState)("");return(0,o.useEffect)(()=>{a(m(.05))},[]),(0,o.useEffect)(()=>{let t,a=e.current;if(!a)return;let s=a.getContext("2d");if(!s)return;let n=[];for(let e=0;e<80;e++)n.push({x:800*Math.random(),y:160*Math.random(),r:2.5*Math.random()+.8,speed:.65*Math.random()+.22,drift:.35*Math.random()-.18,opacity:.6*Math.random()+.3,phase:Math.random()*Math.PI*2});let l=()=>{s.clearRect(0,0,800,160),n.forEach(e=>{s.beginPath(),s.arc(e.x,e.y,e.r,0,2*Math.PI),s.fillStyle="rgba(255,255,255,".concat(e.opacity,")"),s.fill(),e.y+=e.speed,e.x+=e.drift+.35*Math.sin(.008*e.y+e.phase),e.y>170&&(e.y=-10,e.x=800*Math.random())}),t=requestAnimationFrame(l)};return l(),()=>cancelAnimationFrame(t)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"@keyframes snowGlow { 0%, 100% { opacity: 0.22; } 50% { opacity: 0.42; } }"}),(0,s.jsx)("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, #b8c0d0 0%, #c8ccd8 25%, #d4d8e2 50%, #e0e4ec 75%, #eaecf2 100%)"}}),(0,s.jsx)("div",{className:"absolute",style:{top:"5%",right:"25%",width:180,height:120,borderRadius:"50%",background:"radial-gradient(circle, hsl(var(--always-white)/60%) 0%, transparent 70%)",filter:"blur(35px)",animation:"snowGlow 7s ease-in-out infinite"}}),(0,s.jsx)("canvas",{ref:e,width:800,height:160,className:"absolute inset-0 w-full h-full"}),t&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(t,")"),opacity:.32,mixBlendMode:"multiply"}})]})});M.displayName="SnowDayEffect";let C=(0,o.memo)(()=>{let e=(0,o.useRef)(null),[t,a]=(0,o.useState)(""),[n]=(0,o.useState)(()=>Array.from({length:35}).map(()=>({x:100*Math.random(),y:60*Math.random(),size:1.5*Math.random()+.5,opacity:.5*Math.random()+.2,delay:3*Math.random(),duration:2.5*Math.random()+2})));return(0,o.useEffect)(()=>{a(m(.05))},[]),(0,o.useEffect)(()=>{let t,a=e.current;if(!a)return;let s=a.getContext("2d");if(!s)return;let n=[];for(let e=0;e<80;e++)n.push({x:800*Math.random(),y:160*Math.random(),r:2.5*Math.random()+.8,speed:.65*Math.random()+.22,drift:.35*Math.random()-.18,opacity:.6*Math.random()+.3,phase:Math.random()*Math.PI*2});let l=()=>{s.clearRect(0,0,800,160),n.forEach(e=>{s.beginPath(),s.arc(e.x,e.y,e.r,0,2*Math.PI),s.fillStyle="rgba(255,255,255,".concat(e.opacity,")"),s.fill(),e.y+=e.speed,e.x+=e.drift+.35*Math.sin(.008*e.y+e.phase),e.y>170&&(e.y=-10,e.x=800*Math.random())}),t=requestAnimationFrame(l)};return l(),()=>cancelAnimationFrame(t)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"\n        @keyframes snowGlow { 0%, 100% { opacity: 0.22; } 50% { opacity: 0.42; } }\n        @keyframes starTwinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.9; } }\n      "}),(0,s.jsx)("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, #080a10 0%, #0e1018 25%, #141820 50%, #1a2028 75%, #1e2430 100%)"}}),n.map((e,t)=>(0,s.jsx)("div",{className:"absolute rounded-full",style:{top:"".concat(e.y,"%"),left:"".concat(e.x,"%"),width:e.size,height:e.size,background:"hsl(var(--always-white))",opacity:e.opacity,animation:"starTwinkle ".concat(e.duration,"s ease-in-out infinite"),animationDelay:"".concat(e.delay,"s")}},t)),(0,s.jsx)("div",{className:"absolute",style:{top:"5%",right:"25%",width:180,height:120,borderRadius:"50%",background:"radial-gradient(circle, rgba(200,210,230,0.15) 0%, transparent 70%)",filter:"blur(35px)",animation:"snowGlow 7s ease-in-out infinite"}}),(0,s.jsx)("canvas",{ref:e,width:800,height:160,className:"absolute inset-0 w-full h-full"}),t&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(t,")"),opacity:.4,mixBlendMode:"overlay"}})]})});C.displayName="SnowNightEffect";let S=(0,o.memo)(e=>{let{isDay:t}=e,a=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let e,s=a.current;if(!s)return;let n=s.getContext("2d");if(!n)return;let l=[];for(let e=0;e<100;e++){let e=Math.random()>.5;l.push({x:800*Math.random(),y:160*Math.random(),isSnow:e,r:e?2*Math.random()+.8:0,length:e?0:12*Math.random()+8,speed:3*Math.random()+(e?.5:4),drift:.8*Math.random()-.4,opacity:.45*Math.random()+.2})}let i=()=>{n.clearRect(0,0,800,160),l.forEach(e=>{e.isSnow?(n.beginPath(),n.arc(e.x,e.y,e.r,0,2*Math.PI),n.fillStyle="rgba(255,255,255,".concat(e.opacity,")"),n.fill()):(n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(e.x-1,e.y+e.length),n.strokeStyle=t?"rgba(180,200,220,".concat(e.opacity,")"):"rgba(150,175,210,".concat(e.opacity,")"),n.lineWidth=1.2,n.stroke()),e.y+=e.speed,e.x+=e.drift,e.y>160&&(e.y=-10,e.x=800*Math.random())}),e=requestAnimationFrame(i)};return i(),()=>cancelAnimationFrame(e)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{background:t?"linear-gradient(135deg, #708090 0%, #8090a0 30%, #909aa8 60%, #a0a8b4 100%)":"linear-gradient(135deg, #1a1e24 0%, #252a32 30%, #303840 60%, #3a4048 100%)"}}),(0,s.jsx)("canvas",{ref:a,width:800,height:160,className:"absolute inset-0 w-full h-full"}),(0,s.jsx)(x,{opacity:.4})]})});S.displayName="SleetEffect";let A=(0,o.memo)(e=>{let{isDay:t}=e,a=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let e,s=a.current;if(!s)return;let n=s.getContext("2d");if(!n)return;let l=[];for(let e=0;e<30;e++)l.push({x:800*Math.random(),y:160*Math.random(),r:2.5*Math.random()+1.5,speed:5*Math.random()+5,opacity:.3*Math.random()+.25});let i=()=>{n.clearRect(0,0,800,160),l.forEach(e=>{n.beginPath(),n.arc(e.x,e.y,e.r,0,2*Math.PI);let a=n.createRadialGradient(e.x-.3*e.r,e.y-.3*e.r,0,e.x,e.y,e.r);a.addColorStop(0,"rgba(255,255,255,".concat(e.opacity,")")),a.addColorStop(1,t?"rgba(200,220,240,".concat(.6*e.opacity,")"):"rgba(150,180,220,".concat(.5*e.opacity,")")),n.fillStyle=a,n.fill(),e.y+=e.speed,e.y>170&&(e.y=-10,e.x=800*Math.random())}),e=requestAnimationFrame(i)};return i(),()=>cancelAnimationFrame(e)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{background:t?"linear-gradient(135deg, #3a4550 0%, #4a5560 25%, #5a6570 50%, #6a7580 75%, #7a8590 100%)":"linear-gradient(135deg, #0c1014 0%, #141a20 25%, #1c2228 50%, #242a30 75%, #2c3238 100%)"}}),(0,s.jsx)("div",{className:"absolute",style:{top:-15,left:-20,right:-20,height:70,background:t?"linear-gradient(180deg, #303a45 0%, transparent 100%)":"linear-gradient(180deg, #06080a 0%, transparent 100%)",filter:"blur(8px)"}}),(0,s.jsx)("canvas",{ref:a,width:800,height:160,className:"absolute inset-0 w-full h-full"}),(0,s.jsx)(x,{opacity:.45})]})});A.displayName="HailEffect";let E=(0,o.memo)(e=>{let{isDay:t}=e,[a,n]=(0,o.useState)("");return(0,o.useEffect)(()=>{n(m(.05))},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{background:t?"linear-gradient(180deg, #7090b8 0%, #6080a8 50%, #5070a0 100%)":"linear-gradient(135deg, #0a1018 0%, #141c28 25%, #1e2838 50%, #283448 75%, #324058 100%)"}}),(0,s.jsx)("style",{children:"@keyframes streak { 0% { transform: translateX(-100%); } 100% { transform: translateX(250%); } }"}),[.15,.3,.45,.6,.75,.85].map((e,a)=>(0,s.jsx)("div",{className:"absolute",style:{top:"".concat(100*e,"%"),left:0,width:"".concat(35+5*a,"%"),height:2,background:t?"linear-gradient(90deg, transparent, rgba(255,255,255,".concat(.22-.02*a,"), transparent)"):"linear-gradient(90deg, transparent, rgba(180,200,230,".concat(.18-.02*a,"), transparent)"),animation:"streak ".concat(3.5+.6*a,"s linear infinite"),animationDelay:"".concat(.5*a,"s")}},a)),a&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(a,")"),opacity:t?.25:.35,mixBlendMode:"overlay"}})]})});E.displayName="WindEffect";let I=(0,o.memo)(()=>{let[e,t]=(0,o.useState)("");(0,o.useEffect)(()=>{t(m(.05))},[]);let[a]=(0,o.useState)(()=>Array.from({length:40}).map(()=>({x:100*Math.random(),y:60*Math.random(),size:1.8*Math.random()+.8,opacity:.5*Math.random()+.25,delay:3*Math.random(),duration:3.5*Math.random()+2})));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"\n        @keyframes auroraWash1 { 0%, 100% { opacity: 0.5; transform: translateX(-5%); } 50% { opacity: 0.75; transform: translateX(5%); } }\n        @keyframes auroraWash2 { 0%, 100% { opacity: 0.4; transform: translateX(5%); } 50% { opacity: 0.6; transform: translateX(-5%); } }\n        @keyframes auroraWash3 { 0%, 100% { opacity: 0.35; transform: translateY(0); } 50% { opacity: 0.55; transform: translateY(-5%); } }\n        @keyframes starTwinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.85; } }\n      "}),(0,s.jsx)("div",{className:"absolute inset-0",style:{background:"linear-gradient(180deg, #080c1a 0%, #0a1020 50%, #05080f 100%)"}}),a.map((e,t)=>(0,s.jsx)("div",{className:"absolute rounded-full bg-always-white",style:{top:"".concat(e.y,"%"),left:"".concat(e.x,"%"),width:e.size,height:e.size,opacity:e.opacity,animation:"starTwinkle ".concat(e.duration,"s ease-in-out infinite"),animationDelay:"".concat(e.delay,"s")}},t)),(0,s.jsx)("div",{className:"absolute",style:{top:"-10%",left:"-10%",width:"70%",height:"90%",background:"radial-gradient(ellipse at center, rgba(0,255,150,0.4) 0%, rgba(0,220,120,0.15) 40%, transparent 70%)",filter:"blur(40px)",animation:"auroraWash1 12s ease-in-out infinite"}}),(0,s.jsx)("div",{className:"absolute",style:{top:"5%",right:"-15%",width:"60%",height:"80%",background:"radial-gradient(ellipse at center, rgba(80,140,255,0.35) 0%, rgba(140,80,220,0.12) 40%, transparent 70%)",filter:"blur(45px)",animation:"auroraWash2 15s ease-in-out infinite"}}),(0,s.jsx)("div",{className:"absolute",style:{top:"20%",left:"20%",width:"50%",height:"60%",background:"radial-gradient(ellipse at center, rgba(0,200,180,0.25) 0%, rgba(50,255,200,0.08) 50%, transparent 70%)",filter:"blur(50px)",animation:"auroraWash3 18s ease-in-out infinite"}}),e&&(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"url(".concat(e,")"),opacity:.4,mixBlendMode:"overlay"}})]})});I.displayName="AuroraEffect";let T=(0,o.memo)(()=>(0,s.jsxs)("div",{className:"w-full rounded-2xl bg-gradient-to-br from-bg-300 to-bg-200 animate-pulse",children:[(0,s.jsxs)("div",{className:"h-[160px] p-5 flex justify-between items-end rounded-t-2xl",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"h-3 w-20 bg-bg-400 rounded mb-2"}),(0,s.jsx)("div",{className:"h-10 w-16 bg-bg-400 rounded"})]}),(0,s.jsx)("div",{className:"h-3 w-12 bg-bg-400 rounded"})]}),(0,s.jsx)("div",{className:"flex border-t border-bg-400 rounded-b-2xl",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)("div",{className:"flex-1 py-3 flex flex-col items-center gap-2 border-l border-bg-400 first:border-l-0",children:[(0,s.jsx)("div",{className:"h-3 w-8 bg-bg-400 rounded"}),(0,s.jsx)("div",{className:"h-4 w-6 bg-bg-400 rounded"})]},t))})]}));T.displayName="ShimmerWeather";let L=(0,o.memo)(e=>{var t,a,n,l,i;let{input:r,isStreaming:d}=e,u=(0,o.useMemo)(()=>(function(e){var t;return e&&"object"==typeof e&&(e.location||e.current||(null==(t=e.daily)?void 0:t.length))?e:null})(r),[r]),m=(null==u||null==(t=u.current)?void 0:t.condition)||"clear",x=null==(i=null==u||null==(a=u.current)?void 0:a.is_day)||i,f=((e,t)=>{var a;let s={clear:{day:{lightText:!0,labelColor:"rgba(255,255,255,0.6)",forecastBg:"#5090c0",forecastBorder:"rgba(255,255,255,0.15)",forecastText:"rgba(255,255,255,0.95)",forecastMuted:"rgba(255,255,255,0.6)"},night:{lightText:!0,labelColor:"rgba(150,160,200,0.55)",forecastBg:"#05080f",forecastBorder:"rgba(100,150,200,0.15)",forecastText:"rgba(180,200,230,0.9)",forecastMuted:"rgba(100,130,170,0.5)"}},partly_cloudy:{day:{lightText:!0,labelColor:"rgba(255,255,255,0.65)",forecastBg:"#5090c0",forecastBorder:"rgba(255,255,255,0.15)",forecastText:"rgba(255,255,255,0.95)",forecastMuted:"rgba(255,255,255,0.6)"},night:{lightText:!0,labelColor:"rgba(150,160,200,0.5)",forecastBg:"#0a0a1a",forecastBorder:"rgba(100,100,150,0.15)",forecastText:"rgba(180,190,220,0.9)",forecastMuted:"rgba(100,110,150,0.5)"}},cloudy:{day:{lightText:!1,labelColor:"rgba(90,88,85,0.55)",forecastBg:"#c8c6c3",forecastBorder:"rgba(100,98,95,0.2)",forecastText:"rgba(60,58,55,0.9)",forecastMuted:"rgba(100,98,95,0.55)"},night:{lightText:!0,labelColor:"rgba(145,150,175,0.5)",forecastBg:"#1a1c22",forecastBorder:"rgba(80,85,100,0.2)",forecastText:"rgba(180,185,200,0.9)",forecastMuted:"rgba(100,105,130,0.5)"}},overcast:{day:{lightText:!0,labelColor:"rgba(220,220,230,0.6)",forecastBg:"#5a6068",forecastBorder:"rgba(255,255,255,0.1)",forecastText:"rgba(240,240,245,0.9)",forecastMuted:"rgba(200,200,210,0.6)"},night:{lightText:!0,labelColor:"rgba(120,125,145,0.5)",forecastBg:"#18181e",forecastBorder:"rgba(80,80,90,0.2)",forecastText:"rgba(180,185,200,0.9)",forecastMuted:"rgba(100,105,125,0.5)"}},fog:{day:{lightText:!1,labelColor:"rgba(90,88,85,0.55)",forecastBg:"#c8c6c3",forecastBorder:"rgba(100,98,95,0.2)",forecastText:"rgba(60,58,55,0.9)",forecastMuted:"rgba(100,98,95,0.55)"},night:{lightText:!0,labelColor:"rgba(120,120,135,0.5)",forecastBg:"#1a1c22",forecastBorder:"rgba(80,80,90,0.2)",forecastText:"rgba(170,170,185,0.9)",forecastMuted:"rgba(100,100,120,0.5)"}},drizzle:{day:{lightText:!0,labelColor:"rgba(180,200,220,0.6)",forecastBg:"#192332",forecastBorder:"rgba(100,140,180,0.12)",forecastText:"rgba(180,200,220,0.9)",forecastMuted:"rgba(120,150,180,0.5)"},night:{lightText:!0,labelColor:"rgba(140,160,190,0.55)",forecastBg:"#0f141e",forecastBorder:"rgba(80,110,150,0.12)",forecastText:"rgba(160,180,210,0.9)",forecastMuted:"rgba(100,130,170,0.5)"}},rain:{day:{lightText:!0,labelColor:"rgba(180,200,220,0.6)",forecastBg:"#3a4550",forecastBorder:"rgba(100,140,180,0.12)",forecastText:"rgba(180,200,220,0.9)",forecastMuted:"rgba(120,150,180,0.5)"},night:{lightText:!0,labelColor:"rgba(130,150,180,0.5)",forecastBg:"#0f1620",forecastBorder:"rgba(80,110,150,0.12)",forecastText:"rgba(160,180,210,0.9)",forecastMuted:"rgba(100,130,170,0.5)"}},heavy_rain:{day:{lightText:!0,labelColor:"rgba(160,180,200,0.6)",forecastBg:"#0f1623",forecastBorder:"rgba(100,140,180,0.12)",forecastText:"rgba(180,200,220,0.9)",forecastMuted:"rgba(120,150,180,0.5)"},night:{lightText:!0,labelColor:"rgba(130,150,180,0.5)",forecastBg:"#0a0e14",forecastBorder:"rgba(80,110,150,0.1)",forecastText:"rgba(160,180,210,0.9)",forecastMuted:"rgba(100,130,170,0.5)"}},thunderstorm:{day:{lightText:!0,labelColor:"rgba(140,160,190,0.55)",forecastBg:"#0a0c14",forecastBorder:"rgba(100,120,160,0.1)",forecastText:"rgba(170,185,210,0.9)",forecastMuted:"rgba(100,120,160,0.5)"},night:{lightText:!0,labelColor:"rgba(140,160,190,0.55)",forecastBg:"#0a0c14",forecastBorder:"rgba(100,120,160,0.1)",forecastText:"rgba(170,185,210,0.9)",forecastMuted:"rgba(100,120,160,0.5)"}},snow:{day:{lightText:!1,labelColor:"rgba(60,65,80,0.5)",forecastBg:"#c0c5cf",forecastBorder:"rgba(80,90,110,0.15)",forecastText:"rgba(50,55,70,0.9)",forecastMuted:"rgba(90,95,110,0.6)"},night:{lightText:!0,labelColor:"rgba(140,150,180,0.5)",forecastBg:"#0a0f1c",forecastBorder:"rgba(150,180,220,0.1)",forecastText:"rgba(200,220,255,0.9)",forecastMuted:"rgba(120,150,200,0.5)"}},sleet:{day:{lightText:!0,labelColor:"rgba(255,255,255,0.6)",forecastBg:"#606878",forecastBorder:"rgba(255,255,255,0.1)",forecastText:"rgba(255,255,255,0.9)",forecastMuted:"rgba(200,210,220,0.6)"},night:{lightText:!0,labelColor:"rgba(150,165,190,0.5)",forecastBg:"#1a1e28",forecastBorder:"rgba(100,120,150,0.1)",forecastText:"rgba(200,210,230,0.9)",forecastMuted:"rgba(120,140,170,0.5)"}},hail:{day:{lightText:!0,labelColor:"rgba(220,230,240,0.65)",forecastBg:"#303a45",forecastBorder:"rgba(255,255,255,0.1)",forecastText:"rgba(255,255,255,0.9)",forecastMuted:"rgba(180,195,210,0.6)"},night:{lightText:!0,labelColor:"rgba(140,160,190,0.5)",forecastBg:"#0c1018",forecastBorder:"rgba(100,130,170,0.1)",forecastText:"rgba(200,215,235,0.9)",forecastMuted:"rgba(110,135,170,0.5)"}},wind:{day:{lightText:!0,labelColor:"rgba(255,255,255,0.7)",forecastBg:"#5878a0",forecastBorder:"rgba(255,255,255,0.12)",forecastText:"rgba(255,255,255,0.95)",forecastMuted:"rgba(205,220,242,0.6)"},night:{lightText:!0,labelColor:"rgba(120,140,180,0.5)",forecastBg:"#0a1420",forecastBorder:"rgba(80,120,180,0.12)",forecastText:"rgba(180,200,230,0.9)",forecastMuted:"rgba(100,130,180,0.5)"}},aurora:{day:{lightText:!0,labelColor:"rgba(100,200,180,0.55)",forecastBg:"#050810",forecastBorder:"rgba(0,255,150,0.1)",forecastText:"rgba(150,255,200,0.9)",forecastMuted:"rgba(80,180,150,0.5)"},night:{lightText:!0,labelColor:"rgba(100,200,180,0.55)",forecastBg:"#050810",forecastBorder:"rgba(0,255,150,0.1)",forecastText:"rgba(150,255,200,0.9)",forecastMuted:"rgba(80,180,150,0.5)"}}};return(null==(a=s[e])?void 0:a[t?"day":"night"])||s.clear[t?"day":"night"]})(m,x),L=(null==u?void 0:u.country)?"".concat(u.location,", ").concat(u.country):null==u?void 0:u.location;return d&&!u?(0,s.jsx)(c.n2,{children:(0,s.jsx)(T,{})}):u?(0,s.jsx)(c.uM,{className:"!p-0 !space-y-0 overflow-hidden",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"relative h-[160px] rounded-t-2xl overflow-hidden",children:[(()=>{switch(m){case"clear":default:return x?(0,s.jsx)(h,{}):(0,s.jsx)(b,{});case"partly_cloudy":return(0,s.jsx)(v,{isDay:x});case"cloudy":case"fog":return(0,s.jsx)(y,{isDay:x});case"overcast":return(0,s.jsx)(j,{isDay:x});case"drizzle":return(0,s.jsx)(w,{isDay:x});case"rain":return(0,s.jsx)(N,{isDay:x});case"heavy_rain":return(0,s.jsx)(_,{isDay:x});case"thunderstorm":return(0,s.jsx)(k,{});case"snow":return x?(0,s.jsx)(M,{}):(0,s.jsx)(C,{});case"sleet":return(0,s.jsx)(S,{isDay:x});case"hail":return(0,s.jsx)(A,{isDay:x});case"wind":return(0,s.jsx)(E,{isDay:x});case"aurora":return(0,s.jsx)(I,{})}})(),(0,s.jsx)(g,{location:L,temp:null==(n=u.current)?void 0:n.temperature,condition:null==(l=u.current)?void 0:l.condition_text,lightText:f.lightText,labelColor:f.labelColor})]}),u.daily&&u.daily.length>0&&(0,s.jsx)(p,{days:u.daily,bgColor:f.forecastBg,borderColor:f.forecastBorder,textColor:f.forecastText,mutedColor:f.forecastMuted})]})}):(0,s.jsx)(c.MO,{})});L.displayName="WeatherToolUseCell"},0x18b9bd76:(e,t,a)=>{"use strict";a.d(t,{_:()=>L});var s=a(0x22102fd88),n=a(0x8aef00d0),l=a(0x8daa74e8),i=a(0x14de19ae8),r=a(0x139b5e710),o=a(0x19c88845),d=a(0x225bae024),c=a(0x1b370f49d),u=a(0x9f369389),m=a(0xac309a83),x=a(0x1bd175d8c),f=a(0x14d913eae),p=a(0x213f5659b),g=a(0x233515654),h=a(0xf0b8fe63),b=a(0x24635187b),v=a(0x1666ff835),y=a(0xf897c741),j=a(0x1a1f6dda6),w=a(0xfc89b4a4),N=a(0x1ab0d1ca1),_=a(0x38e6572),k=a(0x18175ce17),M=a(0x20d6272f9),C=a(0x21010ec24),S=a(0x1334f6ecc),A=a(0x1611828d),E=a(0x1f507121),I=a(0x1a65cb992),T=a(0xebf0737a);function L(e){let{file:t,conversationUuid:a,onOpen:L,isInSidebar:R=!1,isShared:F}=e,{activeOrganization:z}=(0,i.YL)(),O=(0,N.A)(),[U,D]=(0,w.useState)(null),[P,B]=(0,w.useState)(!1),G=(0,E.P)(),W=(0,x.V)(),q=(0,m.fS)("wiggle_desktop_integration"),H=(0,S.Gk)(),Y=(0,k.kO)(),V=(0,A.PF)(),J=(0,A.lI)();(0,w.useEffect)(()=>{let e=!0;if(W&&(null===u.Q2||void 0===u.Q2?void 0:u.Q2.whichApplication)&&(q||V)){let a=t.path.replace(/^computer:\/\//,"");return u.Q2.whichApplication(a).then(t=>{e&&D(t)}),()=>{e=!1}}},[q,t.path,W,V]);let{addError:K}=(0,r.Yf)(),X=(0,M.Ud)(t.name),$={code:{IconComponent:p.l,label:(0,s.jsx)(_.A,{defaultMessage:"Code",id:"G8PgU8iXdR",description:"A label for a category of filetypes"}),isPreviewable:!0},table:{IconComponent:g.K,label:(0,s.jsx)(_.A,{defaultMessage:"Table",id:"o1Bm9Seua1",description:"A label for a category of filetypes"}),isPreviewable:!0},spreadsheet:{IconComponent:g.K,label:(0,s.jsx)(_.A,{defaultMessage:"Spreadsheet",id:"WeEn8OTS2e",description:"A label for a category of filetypes"}),isPreviewable:!0},doc:{IconComponent:h.d,label:(0,s.jsx)(_.A,{defaultMessage:"Document",id:"86Gv/DR1uA",description:"A label for a category of filetypes"}),isPreviewable:!0},image:{IconComponent:b.x,label:(0,s.jsx)(_.A,{defaultMessage:"Image",id:"8mG9Cg7ges",description:"A label for a category of filetypes"}),isPreviewable:!0},diagram:{IconComponent:y.n,label:(0,s.jsx)(_.A,{defaultMessage:"Diagram",id:"HDIA+OJNvT",description:"A label for a category of filetypes"}),isPreviewable:!0},preso:{IconComponent:v.Z,label:(0,s.jsx)(_.A,{defaultMessage:"Presentation",id:"KUNdHQwOKr",description:"A label for a category of filetypes"}),isPreviewable:!1},skill:{IconComponent:o.BookText,label:(0,s.jsx)(_.A,{defaultMessage:"Skill",id:"T6zqYFD/5k",description:"A label for a skill filetype"}),isPreviewable:!1}},{IconComponent:Q,label:Z}=X?$[X]:{IconComponent:f.o,label:null},ee="skill"===X,{displayName:et,displayExt:ea}=ee?{displayName:t.name.replace(/\.skill$/i,""),displayExt:null}:(0,M.FT)(t.name),es=(0,s.jsxs)(s.Fragment,{children:[Z,Z&&ea&&(0,s.jsx)("span",{className:"opacity-50",children:" \xb7 "}),ea]}),en=!R&&!F&&!V&&H&&(0,C.z)(t.path,Y);return(0,s.jsx)(n.d,{icon:(0,s.jsx)(Q,{size:20,weight:"light",className:"text-text-500"}),properties:{id:t.path,title:et||t.name},isStreaming:!1,className:(0,j.A)(R&&"!m-0"),displayType:es,actions:(0,s.jsxs)("div",{className:"flex min-w-0 items-center justify-center gap-2 shrink-0",children:[ee&&!V&&(0,s.jsx)(d.$,{"aria-label":O.formatMessage({id:"5q3qC0sC3r",defaultMessage:"Download"}),variant:R?"ghost":"secondary",onClick:e=>{e.preventDefault(),e.stopPropagation(),(null==z?void 0:z.uuid)&&G(F?{filepath:t.path,orgUuid:z.uuid,snapshotUuid:a,isShared:!0,source:"wiggle_card_download_button"}:{filepath:t.path,orgUuid:z.uuid,conversationUuid:a,isShared:!1,source:"wiggle_card_download_button"})},size:"icon",className:"!rounded-lg",children:(0,s.jsx)(o.Download,{size:16,className:"text-text-400"})}),en&&(0,s.jsx)(I.M,{file:t,conversationUuid:a,source:"wiggle_card",variant:"secondary",size:"icon",className:"!rounded-lg"}),!R&&!F&&!V&&ee&&(0,s.jsx)(T.a,{file:t,conversationUuid:a,source:"wiggle_artifact_card",variant:"secondary",size:"default",className:"!rounded-lg"}),V&&W&&(null===u.Q2||void 0===u.Q2?void 0:u.Q2.openLocalFile)&&J&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.m,{tooltipContent:O.formatMessage({defaultMessage:"Show in Folder",id:"qJzHPN7NHs"}),delayDuration:50,children:(0,s.jsx)(d.$,{"aria-label":O.formatMessage({defaultMessage:"Show in Folder",id:"qJzHPN7NHs"}),variant:R?"ghost":"secondary",size:"icon",onClick:e=>{e.preventDefault(),e.stopPropagation(),u.Q2.openLocalFile(J,t.path.replace(/^computer:\/\//,""),!0).catch(()=>{K(O.formatMessage({defaultMessage:"Failed to show file in folder.",id:"FQYzrsgaNq"}),{messageForLogging:"Failed to show file in folder"})})},children:(0,s.jsx)(o.Folder,{size:16,className:"text-text-400"})})}),(0,s.jsx)(d.$,{"aria-label":O.formatMessage({id:"JfG49wNHKP",defaultMessage:"Open"}),variant:R?"ghost":"secondary",onClick:e=>{e.preventDefault(),e.stopPropagation(),u.Q2.openLocalFile(J,t.path.replace(/^computer:\/\//,"")).catch(()=>{K(O.formatMessage({defaultMessage:"Failed to open file.",id:"/xJLpYnG2S"}),{messageForLogging:"Failed to open file"})})},size:R?"icon":"default",prepend:!R&&U&&U.appIconBase64&&(0,s.jsx)("img",{src:U.appIconBase64,height:20,width:20,alt:O.formatMessage({defaultMessage:"Open file on desktop",id:"7tjfei6CPJ"})}),children:R?(0,s.jsx)(o.Folder,{size:16,className:"text-text-400"}):U?(0,s.jsx)(_.A,{id:"AsiqC3lr7Z",defaultMessage:"Open in {appName}",values:{appName:U.appName}}):(0,s.jsx)(_.A,{id:"JfG49wNHKP",defaultMessage:"Open"})})]}),!ee&&!V&&(W&&(null===u.Q2||void 0===u.Q2?void 0:u.Q2.writeFileDownloadAndOpen)&&q?(0,s.jsx)(d.$,{"aria-label":O.formatMessage({id:"JfG49wNHKP",defaultMessage:"Open"}),variant:R?"ghost":"secondary",loading:P,onClick:e=>{if(e.preventDefault(),e.stopPropagation(),!(null==z?void 0:z.uuid))return;let s=t.path.split("/");B(!0);let n=(0,l.T)(F?{organizationUuid:z.uuid,snapshotUuid:a,filePath:t.path.replace(/^computer:\/\//,""),isShared:!0}:{organizationUuid:z.uuid,conversationUuid:a,filePath:t.path.replace(/^computer:\/\//,""),isShared:!1});u.Q2.writeFileDownloadAndOpen(s[s.length-1],new URL(n,window.location.href).href).catch(()=>{K(O.formatMessage({defaultMessage:"Failed to download and open file",id:"cxAbUvhHjJ"}),{messageForLogging:"Failed to download and open file"})}).then(()=>{B(!1)})},size:R?"icon":"default",prepend:!R&&U&&U.appIconBase64&&(0,s.jsx)("img",{src:U.appIconBase64,height:20,width:20,alt:O.formatMessage({defaultMessage:"Open file on desktop",id:"7tjfei6CPJ"})}),children:R?(0,s.jsx)(o.Folder,{size:16,className:"text-text-400"}):U?(0,s.jsx)(_.A,{id:"AsiqC3lr7Z",defaultMessage:"Open in {appName}",values:{appName:U.appName}}):(0,s.jsx)(_.A,{id:"JfG49wNHKP",defaultMessage:"Open"})}):(0,s.jsx)(d.$,{"aria-label":O.formatMessage({id:"5q3qC0sC3r",defaultMessage:"Download"}),variant:R?"ghost":"secondary",onClick:e=>{e.preventDefault(),e.stopPropagation(),(null==z?void 0:z.uuid)&&G(F?{filepath:t.path,orgUuid:z.uuid,snapshotUuid:a,isShared:!0,source:"wiggle_card_download_button"}:{filepath:t.path,orgUuid:z.uuid,conversationUuid:a,isShared:!1,source:"wiggle_card_download_button"})},size:R?"icon":"default",children:R?(0,s.jsx)(o.Download,{size:16,className:"text-text-400"}):(0,s.jsx)(_.A,{id:"5q3qC0sC3r",defaultMessage:"Download"})}))]}),onOpenArtifact:L},t.path)}},0x1f163163:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});var s=a(0x1065e6d73),n=a(0x14de19ae8),l=a(0xfc89b4a4);async function i(e,t,a){try{let s=new URL("/api/organizations/".concat(e,"/conversations/").concat(t,"/wiggle/list-files"),window.location.origin);void 0!==a&&s.searchParams.append("prefix",a);let n=await fetch(s.toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)return[];let l=await n.json();if(l.files_metadata)return l.files_metadata;if(l.files)return l.files.map(e=>({path:e,size:0,content_type:"application/octet-stream"}));return[]}catch(e){return[]}}function r(e,t,a){let[r,o]=(0,l.useState)([]),[d,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null),{activeOrganization:x}=(0,n.YL)(),f=(0,s.u9)(),p=(0,l.useCallback)(async()=>{if(f&&t&&(null==x?void 0:x.uuid)){c(!0),m(null);try{let a=(await i(x.uuid,t,e)).map(e=>{let t=e.path.split("/").pop()||e.path;return{path:e.path,name:t,content_type:e.content_type||"application/octet-stream"}});o(a)}catch(e){m("Failed to load files")}finally{c(!1)}}},[f,t,null==x?void 0:x.uuid,e]);return(0,l.useEffect)(()=>{f&&a&&p()},[f,a,p]),{files:r,isLoading:d,error:u,refetch:p}}},0x1f507121:(e,t,a)=>{"use strict";a.d(t,{P:()=>d,_:()=>c});var s=a(0xf32c56dd),n=a(0xd3117c3a),l=a(0x139b5e710),i=a(0xfc89b4a4),r=a(0x1ab0d1ca1);function o(){let e=(0,r.A)(),{addError:t}=(0,l.Yf)();return(0,i.useCallback)(a=>{let s=document.createElement("iframe");s.style.display="none",s.src=a,s.onload=()=>{t(e.formatMessage({defaultMessage:"Failed to download files",id:"ZqhXQGNmd6"})),s.parentElement&&s.remove()},s.onerror=()=>{t(e.formatMessage({defaultMessage:"Failed to download files",id:"ZqhXQGNmd6"})),s.parentElement&&s.remove()},document.body.appendChild(s),setTimeout(()=>{s.parentElement&&s.remove()},2e4)},[e,t])}function d(){let{track:e}=(0,s.st)(),t=o();return(0,i.useCallback)(a=>{let{filepath:s,orgUuid:l,source:i}=a,r=s.replace("computer://","");e({event_key:"wiggle.file.downloaded",...(0,n.k)({filePath:s,isShared:a.isShared,conversationUuid:a.isShared?void 0:a.conversationUuid,snapshotUuid:a.isShared?a.snapshotUuid:void 0,source:i})});let o=a.isShared?"/api/organizations/".concat(l,"/snapshots/").concat(a.snapshotUuid,"/wiggle/download-file"):"/api/organizations/".concat(l,"/conversations/").concat(a.conversationUuid,"/wiggle/download-file"),d=new URLSearchParams;d.append("path",r),t("".concat(o,"?").concat(d.toString()))},[e,t])}function c(){let{track:e}=(0,s.st)(),t=o();return(0,i.useCallback)(a=>{let{filepaths:s,orgUuid:n,source:l}=a,i=s.map(e=>e.replace("computer://","")).filter(e=>!a.isShared||e.startsWith("/mnt/user-data/"));e({event_key:"wiggle.file.downloaded_all",file_count:i.length,is_snapshot:a.isShared,source:l,conversation_uuid:a.isShared?null:a.conversationUuid,snapshot_uuid:a.isShared?a.snapshotUuid:null});let r=a.isShared?"/api/organizations/".concat(n,"/snapshots/").concat(a.snapshotUuid,"/wiggle/download-files"):"/api/organizations/".concat(n,"/conversations/").concat(a.conversationUuid,"/wiggle/download-files"),o=new URLSearchParams;for(let e of i)o.append("paths",e);t("".concat(r,"?").concat(o.toString()))},[e,t])}},0x1f7748bd:(e,t,a)=>{"use strict";a.d(t,{a:()=>l});var s=a(0xfc89b4a4),n=a(0x214374164);let l=(e,t,a)=>{let l=(0,s.useRef)(!1),i=(0,s.useRef)(null),r=(0,s.useRef)(null),[o,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!e),{expandedItemKey:m,setExpandedItemKey:x}=(0,n.D8)(),f=t&&x&&!a,p=(0,s.useCallback)(e=>{f&&x(e?t:void 0),d(e)},[f,x,d,t]),g=!!a||(f?m===t:o);return(0,s.useEffect)(()=>(i.current&&(clearTimeout(i.current),i.current=null),r.current&&(clearTimeout(r.current),r.current=null),e?(l.current=!0,p(!0),u(!1)):l.current&&!a&&(i.current=setTimeout(()=>{p(!1),r.current=setTimeout(()=>{u(!0),l.current=!1},600)},2e3)),()=>{i.current&&(clearTimeout(i.current),i.current=null),r.current&&(clearTimeout(r.current),r.current=null)}),[e,p,a]),{isExpanded:g,setIsExpanded:p,snappyTransition:c}}},0x1fa9af01:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s.Z});var s=a(0x112f760bb)},0x1fc7d761:(e,t,a)=>{"use strict";a.d(t,{Bk:()=>l,Kc:()=>r,LR:()=>i});var s=a(0x394ef833),n=a(0x16784b660);let l=(0,s.v)()((0,n.eh)((e,t)=>({features:{},setMessageFeatures:(t,a)=>e(e=>({features:{...e.features,[t]:{...e.features[t],...a}}})),clearAllFeatures:()=>e({features:{}}),getMessageFeatures:e=>t().features[e],hasLink:e=>{var a,s;return null!=(s=null==(a=t().features[e])?void 0:a.hasLink)&&s},hasCode:e=>{var a,s;return null!=(s=null==(a=t().features[e])?void 0:a.hasCode)&&s}}))),i=e=>l(t=>{var a,s;return null!=(s=null==(a=t.features[e])?void 0:a.hasLink)&&s}),r=e=>l(t=>{var a,s;return null!=(s=null==(a=t.features[e])?void 0:a.hasCode)&&s})},0x249008d3:(e,t,a)=>{"use strict";a.d(t,{l:()=>s});var s=function(e){return e.Standard="Standard",e.TimelineGroup="TimelineGroup",e}({})},0x2fb9ea43:e=>{e.exports={toastAnimation:"ToastComponent_toastAnimation__C_5gv",translateX:"ToastComponent_translateX__VOS8B",fade:"ToastComponent_fade__yi0F_"}},0x31bda27d:(e,t,a)=>{"use strict";a.d(t,{b:()=>S});var s=a(0x22102fd88),n=a(0x185cf2deb),l=a(0x18d835460),i=a(0x1afb3afe7),r=a(0x1a1f6dda6),o=a(0xfc89b4a4),d=a(0x21ad7bd5e),c=a(0x1b6a4a195),u=a(0x628a9a0b),m=a(0x1065e6d73),x=a(0x19c88845),f=a(0x21d170f9),p=a(0x225bae024),g=a(0xb844abc8),h=a(0x23977865),b=a(0x1bd175d8c),v=a(0xef41e510),y=a.n(v),j=a(0x38e6572),w=a(0x6808359f),N=a(0x1dad12e86),_=a(0x1babd1d4e);let k=(0,o.memo)(function(e){let{conversationUuid:t,name:a,isInteractive:n=!0,sharedBy:l,project:i,controlsSidebarIsOpen:d,openControlsSidebar:c,closeControlsSidebar:v,isStreaming:k,isLoading:M,messagesLength:C=0}=e,S=!!l,{data:A}=(0,u.Bq)(t,{enabled:!S}),E=(0,m.u9)(),I=!!i&&!i.is_harmony_project,T=(0,b.V)(h.E_),[L,R]=(0,o.useState)(!1),[F,z]=(0,o.useState)(""),[O,U]=(0,o.useState)(null),D=(0,o.useRef)(null),{mutate:P}=(0,u.HI)(t),[B,G]=(0,o.useState)(!1),W=e=>{A&&!A.is_temporary&&((0,g.fJ)()||(e.preventDefault(),e.stopPropagation(),R(!0),z(a||""),U(null)))},q=()=>{if(F.trim()&&A){let e=F.trim();e!==a&&(U(e),P({name:e},{onSettled:()=>{U(null)}}))}R(!1)},H=e=>{e.nativeEvent.isComposing||("Enter"===e.key?(e.preventDefault(),q()):"Escape"===e.key&&(e.preventDefault(),R(!1),z(a||"")))};return((0,o.useEffect)(()=>{L&&D.current&&(D.current.focus(),D.current.select())},[L]),n&&A&&A.is_temporary)?null:(0,s.jsxs)(N.z,{className:(0,r.A)("h-12",!T&&"-mb-3"),contentClassName:(0,r.A)("gap-6",T?"pl-0":"p-3 lg:pl-4 lg:pr-3"),"data-testid":"chat-header",sticky:!0,children:[(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 shrink md:items-center font-base-bold pr-[100px]",children:[I&&(0,s.jsxs)("div",{className:"text-text-300 hover:text-text-100 inline-flex min-w-0 shrink-[4] items-center max-md:pl-1 gap-1",children:[(0,s.jsx)(y(),{href:"/project/".concat(i.uuid),className:"truncate",children:i.name}),(0,s.jsx)("span",{className:"opacity-50 px-0.5",children:"/"})]}),(0,s.jsx)("div",{className:"flex min-w-0 shrink-1 items-center group",children:M?(0,s.jsx)("div",{className:"animate-pulse h-5 w-32 rounded-lg bg-bg-300"}):n&&A?A.is_temporary?(0,s.jsxs)("div",{className:"flex flex-row items-center text-text-300 gap-2 cursor-default",children:[(0,s.jsx)(f.X3,{}),(0,s.jsx)(j.A,{defaultMessage:"Incognito chat",id:"MZWV60Fq3N"})]}):(0,s.jsx)(s.Fragment,{children:L?(0,s.jsx)("div",{className:"flex items-center bg-bg-000 border border-accent-secondary-100 rounded-md h-7 w-48 px-1.5",onClick:e=>e.stopPropagation(),children:(0,s.jsx)("input",{ref:D,type:"text",value:F,onChange:e=>z(e.target.value),onKeyDown:H,onBlur:q,className:"bg-transparent border-none outline-none focus:outline-none focus:ring-0 focus:border-transparent font-base-bold text-text-000 w-full overflow-x-auto",style:{outline:"none",boxShadow:"none"},"data-testid":"name-chat",autoFocus:!0})}):(0,s.jsxs)("div",{className:"flex items-center group [&:hover>button]:!bg-bg-300 [&>button:hover]:!bg-bg-500",children:[(0,s.jsx)(p.$,{variant:"ghost",size:"default",className:(0,r.A)(0===a.length?"!text-text-500":"!text-text-300 hover:!text-text-100","!shrink !min-w-0 !px-2 !py-0 !scale-100 !h-7 !rounded-r-none","active:!bg-bg-500",B&&"!bg-bg-300"),onClick:W,"data-testid":"chat-title-button",children:(0,s.jsx)("div",{className:"min-w-0 flex-1",children:(0,s.jsx)("div",{className:"truncate font-base-bold",children:O||(a.length>0?a:(0,s.jsx)(j.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"}))})})}),(0,s.jsx)("div",{className:"w-[1.5px] h-7"}),(0,s.jsx)(w.p,{conversation:A,initialName:a,open:B,onOpenChange:G,trigger:(0,s.jsx)(p.$,{variant:"ghost",size:"icon_sm",className:(0,r.A)("!h-7 !w-7 !rounded-l-none !text-text-300 hover:!text-text-100","active:!bg-bg-500",B&&"!bg-bg-500"),"data-testid":"chat-menu-trigger",children:(0,s.jsx)(x.CaretDownSmall,{size:16})})})]})}):(0,s.jsx)("div",{className:"truncate text-text-300 cursor-pointer hover:text-text-100",onClick:W,children:L?(0,s.jsx)("input",{ref:D,type:"text",value:F,onChange:e=>z(e.target.value),onKeyDown:H,onBlur:q,className:"bg-transparent border-0 outline-none focus:outline-none focus:ring-0 font-base-bold text-text-300 w-full","data-testid":"name-chat",onClick:e=>e.stopPropagation()}):(0,s.jsx)(s.Fragment,{children:O||(a.length>0?a:(0,s.jsx)(j.A,{defaultMessage:"Untitled",id:"3kbIhS7KZS"}))})})})]}),(0,s.jsxs)("div",{className:"right-3 flex gap-2",children:[S&&(0,s.jsx)("div",{className:"bg-bg-300 text-text-300 rounded-full px-3 py-1.5 font-base-bold",children:(0,s.jsx)(j.A,{defaultMessage:"Shared by {sharedBy}",id:"UMLOHo6H9c",values:{sharedBy:l}})}),t&&!S&&!E&&(0,s.jsx)(_.O,{conversationUuid:t,controlsSidebarIsOpen:d,openControlsSidebar:c,closeControlsSidebar:v,isStreaming:k,isTemporary:null==A?void 0:A.is_temporary,hasConversationLoaded:C>0})]})]})});var M=a(0x18bfd014),C=a(0xec9172c1);function S(e){let{headerProps:t,mainElement:a,drawerElement:u,auxilaryElement:m,isDrawerOpen:x,autoscrollRef:f,rightSidebarElement:p,autoScrollInnerClassName:g}=e,[h,b]=(0,o.useState)(!1),v=(0,o.useRef)(null),y=(0,o.useRef)(null),j=(0,o.useRef)(null),w=(0,o.useRef)({interacted:!1}),{setIsDrawerExpanded:N}=(0,C.x)(),{incognitoModeEnabled:_}=(0,M.S)(),S=(0,l.F)("md");(0,o.useEffect)(function(){let e=!0;if(!y.current||!v.current||!A.current||!j.current)return;let t=v.current,a=y.current,s=j.current;if(S){let e=x?window.innerWidth/2-d.rL:a.getBoundingClientRect().width;s.style.width="".concat(e,"px")}let n=S&&!!p,l=A.current.getBoundingClientRect().width,i=n?384/l*100:0,r=Date.now(),o=x?i:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=parseFloat(e);return isNaN(a)?t:a}(a.style.flexGrow,50);return x&&(requestAnimationFrame(function n(){if(!e)return;let l=(Date.now()-r)/220,o=i+l*(50-i);if(l>=1||!S){t.style.flex=String(50),a.style.flex=String(50),s.style.width="auto";return}t.style.flex=String(100-o),a.style.flex=String(o),requestAnimationFrame(n)}),w.current.interacted=!0),!x&&w.current.interacted&&requestAnimationFrame(function n(){if(!e)return;let l=(Date.now()-r)/220,i=o-l*o;if(l>=1||!S){t.style.flex=String(100),a.style.flex=String(0),s.style.width="auto";return}t.style.flex=String(100-i),a.style.flex=String(i),requestAnimationFrame(n)}),()=>{e=!1}},[x]);let[A,E]=(0,i.w)();return(0,o.useEffect)(()=>{if(!y.current||!v.current||!A.current)return;let e=A.current.getBoundingClientRect(),t=v.current.getBoundingClientRect();if(window.innerWidth<c.gU||t.width>c.Db)return;let a=c.Db/e.width*100;v.current.style.flex=String(a),y.current.style.flex=String(100-a)},[E.width,E.height,A]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,r.A)("flex flex-1 h-full w-full overflow-hidden relative",h&&"select-none"),ref:A,onMouseUp:function(){b(!1),document.body.style.removeProperty("cursor")},onMouseMove:e=>{var t,a;if(!h||!y.current||!v.current||!A.current)return;let s=A.current.getBoundingClientRect(),n=v.current.getBoundingClientRect(),l=(t=e.clientX-n.left,a=c.Db,Math.min(Math.max(t,a),s.width-240)/s.width*100);v.current.style.flex=String(l),y.current.style.flex=String(100-l)},children:[(0,s.jsxs)("div",{ref:v,className:"h-full flex flex-col overflow-hidden",style:{flex:"".concat(100," 0")},children:[(0,s.jsx)(k,{...t}),(0,s.jsx)(n.Z,{ref:f,parentClassName:"pt-6 flex-1",innerClassName:g,children:a})]}),(0,s.jsxs)("div",{className:(0,r.A)("max-md:hidden group w-2 relative h-full cursor-col-resize -mr-1 z-30 grid place-items-center",!x&&"hidden"),onMouseDown:function(){b(!0),document.body.style.setProperty("cursor","col-resize")},children:[(0,s.jsx)("div",{className:(0,r.A)("absolute top-0 bottom-0 right-1 w-[0.5px] bg-border-300","transition-all group-hover:delay-75 group-hover:bg-accent-secondary-100 group-hover:w-px group-hover:translate-x-[0.5px]",h&&"!bg-accent-secondary-000")}),(0,s.jsx)("div",{className:(0,r.A)("h-6 w-2 relative","rounded-full border-0.5 bg-bg-100 shadow border-border-300","transition duration-200 group-hover:delay-75 group-hover:border-accent-secondary-900 group-hover:bg-accent-secondary-900","cursor-col-resize",h&&"!bg-accent-secondary-000 !border-accent-secondary-000")})]}),(0,s.jsx)("div",{ref:y,className:(0,r.A)("max-md:absolute top-0 right-0 bottom-0 left-0 z-20","md:flex-grow-0 md:flex-shrink-0 md:basis-0","overflow-hidden h-full",x?"max-md:flex-1":"max-md:hidden",h&&"pointer-events-none"),style:{flex:"0 0"},children:(0,s.jsxs)("div",{ref:j,className:"flex flex-col h-full overflow-hidden",children:[!_&&(0,s.jsx)("div",{className:"h-12 md:hidden bg-bg-000/30 backdrop-blur border-b-0.5 border-border-300",onClick:()=>{N(!1)}}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden h-full bg-bg-100",children:u})]})}),p]}),null!=m?m:null]})}},0x37979d5f:(e,t,a)=>{"use strict";a.d(t,{g:()=>h});var s=a(0x22102fd88),n=a(0x865afcc2),l=a(0xb323e954),i=a(0x19c88845),r=a(0x1a1f6dda6),o=a(0x8774d407),d=a(0x18c2bb2d),c=a(0x160045b25),u=a(0xfc89b4a4),m=a(0x481204e3),x=a(0x23fde417d),f=a(0x23b243043),p=a(0x1669db9c6);let g=e=>{let{title:t,subtitles:a,url:o,disabled:d,isError:c,icon:m,isInSelectionMode:x=!1,isSelected:f=!1,onSelect:p,onSelectForBulk:g}=e,h=(0,u.useCallback)(()=>{p&&x&&p(!f,!1)},[x,p,f]),b=(0,u.useCallback)(()=>{p&&(!x&&g?g():p(!f,!1))},[x,p,f,g]);return(0,s.jsxs)("div",{className:"group/row relative flex items-center pl-1",onClick:h,style:{cursor:x?"pointer":void 0},children:[p&&(0,s.jsxs)("div",{className:"shrink-0 w-5 h-5 flex items-center justify-center",onClick:e=>{e.stopPropagation(),b()},children:[(0,s.jsx)("div",{className:(0,r.A)("absolute transition-all duration-200",x||f?"opacity-100 scale-100":"opacity-0 scale-75 group-hover/row:opacity-100 group-hover/row:scale-100"),children:(0,s.jsx)(l.S,{disabled:d,checked:f,onChange:e=>{p(e,!1)},label:"Select ".concat(t),hideLabel:!0,onClick:e=>e.stopPropagation()})}),(0,s.jsx)(i.Chat,{vectorSizeOverride:18,className:(0,r.A)("transition-all duration-200 text-text-400 pointer-events-none",x||f?"opacity-0 scale-75":"opacity-100 scale-100 group-hover/row:opacity-0 group-hover/row:scale-75")})]}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsx)(n.$,{icon:m,title:t,subtitles:a,url:o,disabled:d,isError:c})})]})},h=e=>{let{results:t,disabled:a}=e,[n,l]=(0,u.useState)(!1),[i,r]=(0,u.useState)(!1),h=(0,u.useMemo)(()=>t.map(e=>({uuid:e.conversationUuid,type:"conversation"})),[t]),{selectedItems:b,handleSelect:v,selectAllItems:y,isInSelectionMode:j,toggleSelectMode:w}=(0,f.m)(h,a),N=(0,u.useCallback)(e=>{w(!0),v({uuid:e,type:"conversation"},!0,!1)},[w,v]),_=(0,u.useCallback)(()=>{r(!1),w(!1)},[w]),k=(0,u.useCallback)(()=>{l(!1),w(!1)},[w]),M=(0,u.useMemo)(()=>b.map(e=>{let{uuid:t}=e;return t}),[b]),C=t.length>0;return(0,s.jsxs)(o.o,{children:[(0,s.jsxs)("div",{className:"relative flex flex-col h-full",children:[(0,s.jsx)(d.P.div,{variants:{initial:{opacity:0},animate:{opacity:1}},initial:"initial",animate:"animate",className:"flex flex-col flex-nowrap p-2 pt-0 overflow-y-auto flex-1",children:t.map(e=>{let t=b.some(t=>t.uuid===e.conversationUuid);return(0,s.jsx)(g,{title:e.title,subtitles:e.subtitles,url:e.url,disabled:a,icon:e.icon,isInSelectionMode:j,isSelected:t,onSelect:(t,a)=>{v({uuid:e.conversationUuid,type:"conversation"},t,a)},onSelectForBulk:()=>N(e.conversationUuid)},e.conversationUuid)})}),(0,s.jsx)(c.N,{children:j&&C&&(0,s.jsx)(d.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"sticky bottom-0 bg-bg-000/[98%] border-t-0.5 border-border-300 rounded-b-lg",children:(0,s.jsx)("div",{className:"ml-[0.875rem] mr-2 pt-1 pb-1.5",children:(0,s.jsx)(p.g,{numSelected:b.length,totalNumItems:t.length,handleSelectAll:y,handleCancel:()=>w(!1),handleDeleteSelected:()=>l(!0),handleMoveToProject:()=>r(!0)})})})})]}),b.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{isOpen:n,onClose:k,conversationUuids:M}),(0,s.jsx)(x.h,{conversationUuids:M,isOpen:i,onClose:_})]})]})}},0x3cebcb0f:(e,t,a)=>{"use strict";a.d(t,{M9:()=>i,NX:()=>r});var s=a(0x24fcf6beb);async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,a=e.querySelectorAll('link[rel="stylesheet"]');if(0===a.length)return;let s=Array.from(a).map(e=>new Promise(t=>{if(e.sheet)return void t();e.addEventListener("load",()=>t()),e.addEventListener("error",()=>t())}));await Promise.race([Promise.all(s),new Promise(e=>setTimeout(e,t))])}async function l(e){let{title:t,element:a}=e;return new Promise((e,s)=>{try{var l;let i=document.head.innerHTML,r=document.createElement("iframe");r.style.position="fixed",r.style.right="0",r.style.bottom="0",r.style.width="0",r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-same-origin allow-modals"),r.setAttribute("csp","");let o=!1;r.onload=()=>{o=!0},document.body.appendChild(r);let d=r.contentDocument||(null==(l=r.contentWindow)?void 0:l.document);if(!d){document.body.removeChild(r),s(Error("Could not access iframe document"));return}d.write("\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>".concat(t,"</title>\n            ").concat(i,"\n            <style>\n              /* Remove browser-added headers and footers */\n              @page {\n                size: auto;\n                margin: 0; /* Keep at 0 to remove datetime, page count, website, etc */\n                padding: 25px 0; /* top and bottom page padding */\n              }\n              @media print {\n                html, body, pre, code {\n                  -webkit-print-color-adjust: exact !important;\n                  color-adjust: exact !important;\n                  print-color-adjust: exact !important;\n                }\n              \n                /* Smart page breaks */\n                h1, h2, h3 {\n                  page-break-after: avoid !important;\n                }\n                img, pre, table {\n                  page-break-inside: avoid !important;\n                }\n              }\n            </style>\n          </head>\n          <body>\n            ").concat(a.outerHTML,"\n          </body>\n        </html>\n      ")),d.close();let c=document.title,u=()=>{try{document.title=c,document.body.removeChild(r)}catch(e){}};(async()=>{try{o||await new Promise((e,t)=>{r.onload=()=>e(),r.onerror=e=>t(e)}),await n(d);try{var a,l;document.title=t;try{null==(a=r.contentWindow)||a.print()}catch(e){null==(l=r.contentDocument)||l.execCommand("print")}setTimeout(()=>{u(),e()},100)}catch(e){u(),s(e)}}catch(e){u(),s(e)}})()}catch(e){s(e)}})}async function i(e){if(e.type!==s.vU.Markdown)throw Error("Only markdown artifacts can be saved as PDF");let t=document.getElementById("markdown-artifact");if(!t)throw Error("Markdown artifact element not found");return l({title:(null==e?void 0:e.title)||"Artifact",element:t})}async function r(e){let t=document.getElementById("wiggle-file-content");if(!t)throw Error("File content element not found");return l({title:e.path.split("/").pop()||e.path,element:t})}},0x3d2215b3:(e,t,a)=>{"use strict";a.d(t,{n:()=>M,M:()=>k});var s=a(0x628a9a0b),n=a(0x209960a1a),l=a(0x1e3604791),i=a(0x10a2d47e3),r=a(0x253a5c787),o=a(0xfc89b4a4),d=a(0x14c0dfde7),c=a(0x25062734b),u=a(0x213592df7),m=a(0x597e433e),x=a(0xf32c56dd),f=a(0x139b5e710),p=a(0xac309a83),g=a(0xe670e093),h=a(0x10e01d04d),b=a(0xe824fb1c);function v(e){let{mimeType:t,base64Data:a}=e;if(!m._F[t])throw(0,r.Cp)(Error("Unsupported image type"),{extra:{mimeType:t}}),Error("The tool returned an image in an unsupported format.");let s=m._F[t];return{type:"image",file_name:"".concat((0,g.b)(),".").concat(s),source:{media_type:t,type:"base64",data:a}}}var y=a(0x922ef01f);async function j(e,t){try{let a=await (0,y.lx)(e,t||{});return{content:[{type:"text",text:"string"==typeof a?a:JSON.stringify(a,null,2)}]}}catch(t){let e=t instanceof Error?t.message:String(t);throw Error("Error calling parent tool: ".concat(e))}}var w=a(0x1137a9c1a);async function N(e,t){let a=w.zN.safeParse(e);if(a.success)try{let e=await t(a.data.code);return{content:[{type:"text",text:JSON.stringify(e)}]}}catch(t){let e=t instanceof Error?t.message:String(t);throw Error("Error executing code: ".concat(e))}throw Error("Error parsing input: ".concat(a.error.message))}var _=a(0x9f889a90);function k(){let{mutateAsync:e}=(0,s.Pt)(),t=function(){let{executeReplCode:e}=(0,n.q)(),t=function(){let{track:e}=(0,x.st)(),{addError:t}=(0,f.Yf)(),a=(0,p.fS)("mcp_structured_content_support");return(0,o.useCallback)(async(s,n,l)=>{let i;try{let t=await (0,b.KU)(l).callTool({name:n.name,arguments:s},h.zo,{timeout:24e4});e({event_key:"mcp.tools.called",result:"success",argument_count:Object.keys(s).length}),"structuredContent"in t&&void 0!==t.structuredContent&&null!==t.structuredContent&&a?i={content:[{type:"text",text:JSON.stringify(t.structuredContent)}],isError:"isError"in t&&"boolean"==typeof t.isError&&t.isError,structuredContent:t.structuredContent}:"content"in t?(i=t,"structuredContent"in t&&void 0!==t.structuredContent&&null!==t.structuredContent&&(i={...i,structuredContent:t.structuredContent})):i={content:[{type:"text",text:JSON.stringify(t.toolResult,null,2)}],isError:!1}}catch(a){throw(0,r.Cp)(a,{tags:{serverUuid:l}}),t('Failed to call tool "'.concat(n.name,'".'),{error:a}),e({event_key:"mcp.tools.called",result:"failure",argument_count:Object.keys(s||{}).length}),Error("Tool execution failed")}return{is_error:i.isError,content:i.content.map(e=>{switch(e.type){case"text":return{type:"text",text:e.text};case"image":return v({mimeType:e.mimeType,base64Data:e.data});case"resource":{let t=e.resource;if("text"in t)return{type:"text",text:t.text};if("blob"in t){if(!t.mimeType)throw(0,r.Cp)(Error("Missing MIME type for resource"),{tags:{serverUuid:l}}),Error("The tool returned a resource without a valid format.");return v({mimeType:t.mimeType,base64Data:t.blob})}}}throw(0,r.Cp)(Error("Unsupported content type"),{tags:{serverUuid:l},extra:{mimeType:e.type}}),Error("The tool returned content in an unsupported format.")}),structured_content:i.structuredContent}},[e,t,a])}(),a=(0,y.Xi)(e=>e.IframeParentTools);return(0,o.useCallback)(async(s,n)=>{let l=(0,_.p)(n);if("repl"===s)return await N(l,e);{if(a.some(e=>e.name===s))return await j(s,l);let e=(0,b.pK)(s);if((null==e?void 0:e.tool)&&(null==e?void 0:e.server))return await t(l,e.tool,e.server.uuid)}},[e,t,a])}();return(0,o.useCallback)(async function(a,s,n,l){let{overriddenResult:i}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{let o=null!=i?i:await t(s,l);if(void 0===o){(0,b.qT)(s)&&(0,r.Cp)(Error("Tool not found"),{tags:{conversationUuid:a,toolId:n},level:"warning"});return}await e({conversation_uuid:a,type:"tool_result",tool_use_id:n,...o})}catch(s){(0,r.Cp)(s,{tags:{conversationUuid:a,toolId:n}});let t=s instanceof Error?s.message:String(s);await e({conversation_uuid:a,type:"tool_result",tool_use_id:n,is_error:!0,content:[{type:"text",text:t}]})}},[t,e])}let M=(e,t,a)=>{let s=(0,i.wc)(),{value:n}=(0,l.N)(null!=e?e:{}),r=(0,d.p9)(),m=(0,u.Pb)(t),x=(0,c.yr)(),f=(0,y.Xi)(e=>e.IframeParentTools),p=(0,y.Xi)(e=>e.integrationName);return(0,o.useCallback)(()=>{let t=(0,b._b)(r,null==e?void 0:e.enabled_mcp_tools,x,a);f.forEach(e=>{let a=p?"[".concat(p,"] ").concat(e.description):e.description;t.push({name:e.name,description:a,input_schema:e.input_schema})});let l=null==s?void 0:s[i.U3];return l&&(null==e?void 0:e.enabled_web_search)&&t.push({type:(null==s?void 0:s[i.$6])||"",name:l}),t.push({type:"artifacts_v0",name:"artifacts"}),n&&t.push({type:"repl_v0",name:"repl"}),m&&t.push({type:"project_knowledge_search",name:"project_knowledge_search"}),t},[null==e?void 0:e.enabled_mcp_tools,null==e?void 0:e.enabled_web_search,n,s,m,r,x,a,f,p])}},0x4fd5f678:(e,t,a)=>{"use strict";a.d(t,{w:()=>j});var s=a(0x22102fd88),n=a(0x225bae024),l=a(0x18c2bb2d),i=a(0x160045b25),r=a(0xfc89b4a4),o=a(0x38e6572),d=a(0x19c88845),c=a(0x1ab0d1ca1),u=a(0x1a1f6dda6);let m={base:"flex w-full items-center justify-between p-3 text-left transition-colors",selected:"bg-accent-secondary-900/40",highlighted:"bg-bg-200",border:"border-t border-border-300",hover:"hover:bg-bg-200"},x={base:"ml-4 flex h-6 w-6 shrink-0 items-center justify-center rounded font-small",selected:"bg-accent-secondary-900 text-text-100",unselected:"bg-bg-200 text-text-300"},f={base:"mr-3 flex h-4 w-4 shrink-0 items-center justify-center rounded border transition-colors",selected:"border-accent-secondary-000 bg-accent-secondary-000 text-text-000",unselected:"border-border-400 bg-bg-000"},p=(e,t,a)=>(0,u.A)(m.base,a&&m.border,e?m.selected:t?m.highlighted:m.hover),g=e=>(0,u.A)(x.base,e?x.selected:x.unselected),h=e=>(0,u.A)(f.base,e?f.selected:f.unselected),b=(0,r.memo)(e=>{let{isSelected:t,isHighlighted:a,isMultiSelect:n,value:l,onChange:i,onClick:r,inputRef:u,optionNumber:m}=e,x=(0,c.A)();return(0,s.jsxs)("button",{onClick:r,className:p(t,a,!0),children:[(0,s.jsxs)("div",{className:"flex flex-grow items-center",children:[n&&(0,s.jsx)("div",{className:h(t),children:t&&(0,s.jsx)(d.Check,{className:"h-3 w-3"})}),(0,s.jsx)("div",{className:"flex flex-grow flex-col",children:t?(0,s.jsx)("textarea",{ref:u,value:l,onChange:e=>i(e.target.value),onClick:e=>e.stopPropagation(),rows:1,placeholder:x.formatMessage({defaultMessage:"Type something else...",id:"CEcRD5wtUW"}),className:"hide-focus-ring w-full resize-none border-none bg-transparent font-base text-text-100 outline-none placeholder:text-text-300",style:{fieldSizing:"content"}}):(0,s.jsx)("span",{className:"font-base text-text-300",children:(0,s.jsx)(o.A,{defaultMessage:"Type something else...",id:"CEcRD5wtUW"})})})]}),!t&&(0,s.jsx)("span",{className:g(t),children:m})]})});b.displayName="OtherOption";let v=(0,r.memo)(e=>{let{option:t,index:a,isSelected:n,isHighlighted:l,isMultiSelect:i,showTopBorder:r,onClick:o}=e;return(0,s.jsxs)("button",{onClick:o,className:p(n,l,r),children:[(0,s.jsxs)("div",{className:"flex items-center",children:[i&&(0,s.jsx)("div",{className:h(n),children:n&&(0,s.jsx)(d.Check,{className:"h-3 w-3"})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-base text-text-100",children:t.label}),t.description&&(0,s.jsx)("span",{className:"mt-0.5 font-small text-text-500",children:t.description})]})]}),(0,s.jsx)("span",{className:g(n),children:a+1})]})});v.displayName="QuestionOption";let y=(0,r.memo)(e=>{let{responses:t}=e;return(0,s.jsx)(l.P.div,{layout:"position",className:"flex flex-col gap-3",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-col gap-1 font-base",children:[(0,s.jsx)("span",{className:"text-text-100",children:e.question}),(0,s.jsx)("span",{className:"text-text-500",children:Array.isArray(e.response)?e.response.join(", "):e.response})]},t))})});y.displayName="SubmittedResponses";let j=(0,r.memo)(e=>{var t,a;let{input:d,onAnswersSubmit:c}=e,u=null!=(t=null==d?void 0:d.questions)?t:[],{containerRef:m,otherInputRef:x,currentQuestionIndex:f,selectedIndices:p,highlightedIndex:g,otherText:h,showSubmitted:j,displayResponses:w,timeRemaining:N,isTimerPaused:_,pauseTimer:k,resumeTimer:M,setOtherText:C,handleSubmit:S,handleOptionClick:A,handleKeyDown:E,handleSkip:I}=function(e){var t;let{parsedInput:a,onAnswersSubmit:s}=e,[n,l]=(0,r.useState)(0),[i,o]=(0,r.useState)(new Set),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(""),[x,f]=(0,r.useState)([]),[p,g]=(0,r.useState)(!1),h=(0,r.useRef)(null),b=(0,r.useRef)(null),[v,y]=(0,r.useState)(3e4),[j,w]=(0,r.useState)(!1),N=(0,r.useRef)(null),_=a.questions,k=a.answers,M=_[n],C=n===_.length-1,S=k&&Object.keys(k).length>0,A=p||S||!s,E=S?_.map(e=>{var t;return{question:e.question,response:null!=(t=k[e.question])?t:""}}):x,I=null!=(t=null==M?void 0:M.multiSelect)&&t,T=(0,r.useCallback)(e=>{o(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[]),L=(0,r.useCallback)(e=>{let t=[...x,e];if(f(t),C){g(!0);let e={};for(let a of t)e[a.question]=a.response;null==s||s(e,a)}else l(e=>e+1),o(new Set),c(null),m(""),y(3e4),w(!1)},[x,C,s,a]),R=(0,r.useCallback)(()=>{if(!M)return"";let e=[];for(let t of Array.from(i).sort((e,t)=>e-t))-1===t?e.push(u.trim()||"Something else"):e.push(M.options[t].label);return I?e:e[0]},[M,i,u,I]),F=(0,r.useCallback)(()=>{w(!0)},[]),z=(0,r.useCallback)(()=>{w(!1)},[]),O=(0,r.useCallback)(e=>{F(),m(e)},[F]),U=(0,r.useCallback)(()=>{if(M)if(i.size>0){let e=R();L({question:M.question,response:e})}else L({question:M.question,response:"[No preference]"})},[M,i.size,R,L]),D=(0,r.useCallback)(()=>{if(!M||0===i.size)return;let e=R();L({question:M.question,response:e})},[M,i.size,R,L]),P=(0,r.useCallback)(e=>{if(M)if(F(),I)T(e),c(e);else if(-1!==e){let t=M.options[e].label;L({question:M.question,response:t})}else o(new Set([-1])),c(-1)},[I,T,M,L,F]),B=(0,r.useCallback)(e=>{if(!M||p)return;let t=e.target===b.current,a=M.options.length,s=parseInt(e.key,10);if(!t&&s>=1&&s<=a){e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),F(),I?T(s-1):o(new Set([s-1])),c(s-1);return}if(!t&&s===a+1){e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),F(),I?T(-1):o(new Set([-1])),c(-1);return}if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();let t=null;if(c(t="ArrowDown"===e.key?null===d||-1===d?0:d===a-1?-1:d+1:null===d?-1:-1===d?a-1:0===d?-1:d-1),I||null===t||o(new Set([t])),-1!==t){var n;null==(n=h.current)||n.focus()}return}"Enter"===e.key&&(I?e.metaKey||e.ctrlKey?i.size>0&&(e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),D()):null!==d&&(e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),T(d)):i.size>0&&(e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),D()))},[M,p,I,i,d,T,D,F]);return(0,r.useEffect)(()=>{if(!A&&!j&&s)return N.current=setInterval(()=>{y(e=>e<=1e3?(N.current&&(clearInterval(N.current),N.current=null),setTimeout(()=>{U()},0),0):e-1e3)},1e3),()=>{N.current&&(clearInterval(N.current),N.current=null)}},[A,j,s,U]),(0,r.useEffect)(()=>{if(!A){var e;null==(e=h.current)||e.focus()}},[A,n]),(0,r.useEffect)(()=>{if(i.has(-1)){var e;null==(e=b.current)||e.focus()}},[i]),{containerRef:h,otherInputRef:b,currentQuestionIndex:n,selectedIndices:i,highlightedIndex:d,otherText:u,showSubmitted:A,displayResponses:E,timeRemaining:v,isTimerPaused:j,pauseTimer:F,resumeTimer:z,setOtherText:O,handleSubmit:D,handleOptionClick:P,handleKeyDown:B,handleSkip:U}}({parsedInput:d,onAnswersSubmit:c}),T=u[f],L=f===u.length-1,R=null!=(a=null==T?void 0:T.multiSelect)&&a,F=p.size>0,z=Math.ceil(N/1e3),O=!_&&N<=9e3,U=(0,r.useCallback)(()=>{A(-1)},[A]),D=(0,r.useCallback)(()=>{O&&k()},[O,k]),P=(0,r.useCallback)(()=>{0===p.size&&M()},[p.size,M]);if(!T)return(0,s.jsx)("div",{className:"text-text-300",children:(0,s.jsx)(o.A,{defaultMessage:"Invalid question format",id:"BMz5hTNoCd"})});let B=T.options.length+1,G=p.has(-1);return(0,s.jsxs)(l.P.div,{ref:m,tabIndex:j?void 0:0,onKeyDown:j?void 0:E,onMouseEnter:j?void 0:D,onMouseLeave:j?void 0:P,layout:!0,transition:{duration:.3,ease:"easeInOut"},className:"rounded-xl outline-none border border-border-300 p-4 ".concat(j?"bg-bg-200":"bg-bg-000"),children:[j&&(0,s.jsx)(y,{responses:w}),(0,s.jsx)(i.N,{mode:"wait",children:!j&&(0,s.jsxs)(l.P.div,{initial:f>0?{opacity:0,x:20}:{opacity:1},animate:{opacity:1,x:0},exit:L?{opacity:0,height:0}:{opacity:0,x:-20},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-base text-text-100",children:T.question}),u.length>1&&(0,s.jsx)("span",{className:"font-small text-text-300",children:(0,s.jsx)(o.A,{defaultMessage:"{current}/{total}",id:"KQd37jzhqv",values:{current:f+1,total:u.length}})})]}),(0,s.jsxs)("div",{className:"overflow-hidden rounded-lg border border-border-300",children:[T.options.map((e,t)=>(0,s.jsx)(v,{option:e,index:t,isSelected:p.has(t),isHighlighted:g===t,isMultiSelect:R,showTopBorder:0!==t,onClick:()=>A(t)},t)),(0,s.jsx)(b,{isSelected:G,isHighlighted:-1===g,isMultiSelect:R,value:h,onChange:C,onClick:U,inputRef:x,optionNumber:B})]}),c&&(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,s.jsxs)(l.P.button,{layout:!0,type:"button",onClick:I,className:"relative overflow-hidden rounded-lg border border-border-300 bg-bg-100 px-4 py-2 text-sm text-text-200 hover:bg-bg-200",children:[O&&(0,s.jsx)("div",{className:"absolute inset-0 bg-accent-main-100/20 origin-left transition-transform duration-1000 ease-linear",style:{transform:"scaleX(".concat(1-N/3e4,")")}}),(0,s.jsx)("span",{className:"relative z-10 tabular-nums",children:O?(0,s.jsx)(o.A,{defaultMessage:"Skipping in {seconds}s...",id:"hqEeUhB+XW",values:{seconds:z}}):(0,s.jsx)(o.A,{defaultMessage:"Skip",id:"/4tOwTiCH6"})})]}),(0,s.jsx)(i.N,{children:_&&F&&(0,s.jsx)(l.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:(0,s.jsx)(n.$,{variant:"primary",onClick:S,children:L?(0,s.jsx)(o.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"}):(0,s.jsx)(o.A,{defaultMessage:"Next",id:"9+DdtuCqLw"})})})})]})]},f)})]})});j.displayName="AskUserQuestionToolUseCell"},0x5497a152:(e,t,a)=>{"use strict";a.d(t,{F:()=>l});var s=a(0xdc12822f);let n={sm:"(min-width: 640px)",md:"(min-width: 768px)",lg:"(min-width: 1024px)",xl:"(min-width: 1280px)","2xl":"(min-width: 1536px)"};function l(e){return(0,s.U)(n[e])}},0x695f5df2:(e,t,a)=>{"use strict";a.d(t,{t:()=>d});var s=a(0x22102fd88),n=a(0x19c88845),l=a(0x1b370f49d),i=a(0x1a1f6dda6),r=a(0xfc89b4a4),o=a(0x1ab0d1ca1);let d=(0,r.memo)(e=>{let{fileTree:t,selectedPath:a,expandedFolders:d,onFileSelect:c,onToggleFolder:u,className:m,variant:x="fileDetail"}=e,f=(0,o.A)(),p="settings"===x?"hover:bg-bg-300":"hover:bg-bg-100",g="settings"===x?"bg-bg-400":"bg-bg-200",h=(0,r.useCallback)((e,t)=>{if(!e.name){var r;return(0,s.jsx)(s.Fragment,{children:null==(r=e.children)?void 0:r.map(e=>(0,s.jsx)("div",{children:h(e,t)},e.path))})}let o="directory"===e.type,m=d.has(e.path),x=a===e.path,b=16*t+8;return o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>u(e.path),"aria-label":f.formatMessage({defaultMessage:"{action} folder {name}",id:"hyfwl4pfKG"},{action:m?"Collapse":"Expand",name:e.name}),"aria-expanded":m,className:(0,i.A)("w-full px-2 py-2 rounded-lg flex items-center justify-between transition-colors text-text-300 hover:text-text-100",p),children:[(0,s.jsx)(l.m,{tooltipContent:e.name,side:"top",sideOffset:4,children:(0,s.jsx)("div",{className:"text-left text-sm font-normal truncate",children:e.name})}),(0,s.jsx)("div",{className:"w-3.5 h-3.5 flex-shrink-0 ml-1.5",children:m?(0,s.jsx)(n.CaretDown,{size:14}):(0,s.jsx)(n.CaretRight,{size:14})})]}),m&&e.children&&(0,s.jsx)("div",{className:"flex flex-col gap-px",children:e.children.map(e=>(0,s.jsx)("div",{children:h(e,t+1)},e.path))})]}):(0,s.jsx)(l.m,{tooltipContent:e.name,side:"top",sideOffset:4,children:(0,s.jsx)("button",{onClick:()=>c(e.path,e),className:(0,i.A)("w-full py-2 rounded-lg inline-flex justify-start items-center gap-2 transition-colors",0===t?"px-2":"",x?"".concat(g," text-text-100 font-semibold"):"".concat(p," text-text-300 hover:text-text-100 font-normal")),style:t>0?{paddingLeft:"".concat(b,"px")}:void 0,children:(0,s.jsx)("div",{className:"flex-1 min-w-0 text-left text-sm truncate",children:e.name})})})},[d,a,c,u,p,g,f]);return(0,s.jsx)("div",{className:(0,i.A)("w-60 flex-shrink-0 overflow-y-auto",m),children:(0,s.jsx)("div",{className:"flex flex-col gap-px",children:h(t,0)})})});d.displayName="FileTreeSidebar"},0x6f2a2354:(e,t,a)=>{"use strict";a.d(t,{CV:()=>ee,ke:()=>en});var s=a(0x22102fd88),n=a(0x17aa9d8d7),l=a(0x1dd44336e),i=a(0x202fabf16),r=a(0x20805e624),o=a(0xf32c56dd),d=a(0x14de19ae8),c=a(0x139b5e710),u=a(0x246846ae8),m=a(0x1b6318607),x=a(0x19c88845),f=a(0x225bae024),p=a(0x1b03847fb),g=a(0x14023fbb8),h=a(0x183548b63),b=a(0x1b370f49d),v=a(0x1e1f2a153),y=a(0x24fcf6beb),j=a(0x23977865),w=a(0x9845e38c),N=a(0x1bd175d8c),_=a(0x3dfb3b63),k=a(0x1a1f6dda6),M=a(0x160045b25),C=a(0x18c2bb2d),S=a(0x733b8fe2),A=a.n(S),E=a(0xef41e510),I=a.n(E),T=a(0xfc89b4a4),L=a(0x38e6572),R=a(0x1ab0d1ca1),F=a(0xf071fd84),z=a(0x1dbad8fd1),O=a(0xbebfc702),U=a(0x16801a2b9),D=a(0xd4b9b976),P=a(0x22fc8d729),B=a(0xbe814870),G=a(0x17e4caf4c),W=a(0x216fdf08f);function q(e){let t,{onClose:a,onSubmitRating:n,onSubmitNotes:l}=e,i=(0,R.A)(),[r,o]=(0,T.useState)(!1),[d,c]=(0,T.useState)(""),m=e=>{n(e),o(!0)},x=()=>{a()};return t=r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("div",{className:"ml-1",children:(0,s.jsx)(L.A,{defaultMessage:"What were you trying to accomplish when this artifact was created?",id:"CrrumB/FnI"})}),(0,s.jsx)("div",{className:"pt-1",children:(0,s.jsx)("button",{onClick:x,children:(0,s.jsx)(B.X,{size:20})})})]}),(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),l(d),x()},children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(u.ks,{className:"w-full",placeholder:i.formatMessage({defaultMessage:"e.g. make a graph",id:"g1RrFC72N+"}),value:d,onChange:e=>c(e.target.value)})}),(0,s.jsx)("div",{children:(0,s.jsx)(f.$,{variant:"primary",type:"submit",children:(0,s.jsx)(L.A,{defaultMessage:"Send",id:"9WRlF4R2gm"})})})]})})]}):(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(L.A,{defaultMessage:"Is this artifact useful?",id:"RxVIwIW9vn"})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:()=>m(!0),"aria-label":i.formatMessage({defaultMessage:"Thumbs up",id:"0HnZ1ci6be"}),children:(0,s.jsx)(G.t,{size:20})}),(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:()=>m(!1),"aria-label":i.formatMessage({defaultMessage:"Thumbs down",id:"go4L4rFJNq"}),children:(0,s.jsx)(W.S,{size:20})}),(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:x,"aria-label":i.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}),children:(0,s.jsx)(B.X,{size:20})})]})]}),(0,s.jsxs)(H,{children:[(0,s.jsx)("div",{className:"p-3",children:t}),(0,s.jsx)("div",{className:"p-3 border-t border-border-400 w-full font-normal text-xs text-text-500",children:(0,s.jsx)(P.Y,{href:"https://support.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback",target:"_blank",children:(0,s.jsx)(L.A,{defaultMessage:"Learn more about how Anthropic uses feedback",id:"NBSES31K7c"})})})]})}function H(e){return(0,s.jsx)("div",{...e,className:"border border-border-400 bg-bg-100 w-96 rounded-xl font-medium text-text-300 text-sm"})}var Y=a(0x2f6cd846),V=a(0x1fb5bdc42),J=a(0x17e7bc007);let K=e=>{let{currentArtifact:t,hasMenuOpen:a,setHasMenuOpen:n}=e,l=(0,T.useCallback)(()=>{n(!1)},[n]),i=(0,J.dd)(),{dispatchChatResource:r}=(0,U.i)(),o=Object.values(i).reverse().sort((e,t)=>{let a=e.versions[e.versions.length-1];return new Date(t.versions[t.versions.length-1].created_at).getTime()-new Date(a.created_at).getTime()}),d=(0,T.useRef)(t),c=(0,T.useRef)(!1),u=(0,T.useCallback)(e=>{queueMicrotask(()=>{r({type:"SELECT_ARTIFACT",id:e.id,versionUuid:e.versions[e.versions.length-1].uuid})})},[r]);(0,T.useEffect)(()=>{let e=d.current;return()=>{e&&!c.current&&(null==t?void 0:t.id)!==e.id&&u(e),c.current=!1}},[]);let m=(0,Y.w)(),p=(0,R.A)();return o.length<2?null:(0,s.jsxs)(V.bL,{open:a,onOpenChange:e=>n(e),children:[(0,s.jsx)(V.l9,{asChild:!0,children:(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",className:"-mx-1",children:(0,s.jsx)(b.m,{side:"right",className:"ml-2",tooltipContent:a?"":p.formatMessage({defaultMessage:"Switch between artifacts",id:"mYiLqlDMdl"}),delayDuration:800,children:(0,s.jsx)(x.ListBullet,{size:20})})})}),(0,s.jsx)(V.UC,{align:"start",asChild:!0,children:(0,s.jsx)("ul",{className:"\n            relative\n            z-dropdown\n            overflow-y-auto\n            max-h-[min(var(--radix-dropdown-menu-content-available-height),var(--dropdown-max-height))]\n            flex flex-col gap-1\n            py-2 pr-3\n          ",onMouseLeave:()=>d.current&&u(d.current),children:o.map((e,t)=>{var a;let n=e.type?m[e.type]:null,i=(null==(a=d.current)?void 0:a.id)===e.id,r=p.formatMessage({defaultMessage:"versions",id:"bhuRmwJBaN"}),x=e.versions.length>1?"".concat(e.versions.length):"",f=e.versions.length>1&&n?" \xb7 ":"";return(0,s.jsx)(C.P.li,{initial:{y:-12,opacity:0},animate:{y:0,opacity:1},exit:{opacity:0,transition:{ease:"easeOut",duration:.1,delay:0}},transition:{delay:.035*t,type:"spring",stiffness:285,damping:25,mass:1},role:"none",children:(0,s.jsxs)(V.q7,{className:(0,k.A)("bg-bg-000 border-0.5 cursor-pointer can-focus","flex flex-col py-2 pl-3 pr-4 w-full max-w-72 mb-px rounded-lg overflow-hidden","text-sm text-left transition duration-300 drop-shadow-[0_2px_8px_hsl(var(--always-black)/8%)] dark:drop-shadow-[0_2px_8px_hsl(var(--always-black)/16%)]",i?"border-accent-secondary-100 shadow-[0_0_0_1px_hsl(var(--accent-secondary-100))]":"text-text-300 hover:text-text-100 border-border-200 hover:border-accent-secondary-100 focus-within:border-accent-secondary-100 focus-within:text-text-100"),onClick:()=>(e=>{c.current=!0,l();let t=o[e];d.current=t,u(t)})(t),onMouseEnter:()=>{u(e)},"aria-label":"".concat(e.title).concat(n?", ".concat(n):"").concat(x?", ".concat(x," ").concat(r):""),children:[(0,s.jsx)("div",{className:"line-clamp-2",children:e.title}),(0,s.jsxs)("span",{className:"text-text-300",children:[e.versions.length>1?(0,s.jsxs)(s.Fragment,{children:[x," ",r]}):null,f?(0,s.jsx)(s.Fragment,{children:f}):null,n]})]},e.id)},e.id)})})})]})};var X=a(0x1bf083d8d),$=a(0x16f861148),Q=a(0x1b35c88fb),Z=a(0x3cebcb0f);let ee=e=>{var t,a,c,u,m,x,f,p,g,h;let{onClose:b,artifact:v,isStreaming:j,selectedArtifactMessageUuid:N,selectedArtifactVersionUuid:S,setSelectedArtifactVersionUuid:A,projectUuid:E,selectDoc:I,disablePublishing:L,sendMessage:R,richSandboxCapabilities:z,isOpen:D,isTemporary:P=!1}=e,{account:B}=(0,d.YL)(),G=(0,o.st)(),[W,H]=(0,T.useState)("normal"),Y=(0,T.useRef)(null),[V,J]=(0,T.useState)(!1),K=(0,d.mV)(),[Z,ee]=(0,T.useState)(!0),{data:ea}=(0,O.fo)(E),{data:en}=(0,F.mt)({entityId:S,artifactEntityType:"artifact_version"}),el=(0,T.useMemo)(()=>(null==en?void 0:en.mcp_servers)||[],[en]),ei=!L&&!K,[er,{open:eo,close:ed}]=(0,_.j)(!1),ec=(0,T.useCallback)(()=>{ee(!1)},[]),{data:eu}=(0,l.rC)({includeDeletedArtifacts:!0}),em=null==v?void 0:v.versions[v.versions.length-1],ex=j&&!(null==em?void 0:em.isClosed),ef=(0,T.useMemo)(()=>{if(!v)return 0;if(!ex&&S&&!(null==N?void 0:N.startsWith(r.B6))){let e=v.versions.findIndex(e=>e.uuid===S);if(-1!==e)return e}return ex||!N||N.startsWith(r.B6)?v.versions.length-1:v.versions.findIndex(e=>e.message===N)},[N,S,ex,v]),ep=null==v||null==(t=v.versions[ef])?void 0:t.uuid;(0,T.useEffect)(()=>{ep&&ep!==S&&A(ep),H("normal")},[null==v?void 0:v.id,ep,A,S]);let eg=K&&!P,[eh,{open:eb,close:ev}]=(0,_.j)(!1),ey=v&&(null==eu||null==(a=eu.find(e=>{let{artifact_identifier:t,message_uuid:a}=e;return t===v.id&&a===v.versions[ef].message}))?void 0:a.published_artifact_uuid),ej=null!=(f=null==eu?void 0:eu.some(e=>{let{published_artifact_uuid:t,deleted:a}=e;return t===ey&&a}))&&f,ew=null==v||null==(c=v.versions[ef])?void 0:c.message,[eN,e_]=(0,T.useState)(!1);(0,T.useEffect)(()=>e_(eN||j),[eN,j]);let[ek,eM]=(0,T.useState)(!1);(0,T.useEffect)(()=>eM(!1),[N,ew]);let[eC,eS]=(0,T.useState)(!1),{data:eA}=(0,l.SN)(),{mutate:eE}=(0,n.yJ)(),{track:eI}=(0,o.st)(),eT=null!=(p=(0,U.i)().chatResourceState.conversationUuid)?p:"",{data:eL}=(0,F.Ns)({entityId:S,artifactEntityType:"artifact_version",conversationUuid:eT},{enabled:!j}),[eR,{open:eF,close:ez}]=(0,_.j)(!1),{mutateAsync:eO}=(0,l.cH)(eT),eU=(0,T.useCallback)(async()=>{if(!S)try{var e;let{artifactVersionUUID:t}=await eO({version_index:ef,artifact_identifier:null!=(e=null==v?void 0:v.id)?e:""});A(t)}catch(e){w.v.error(w.u.ARTIFACTS,"Error getting artifact UUID",e);return}eI({event_key:"artifact.share_button_clicked",message_uuid:ew,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eb()},[S,eb,eO,ef,null==v?void 0:v.id,A,eI,ew,null==v?void 0:v.type,null==v?void 0:v.language]),eD=(0,T.useCallback)(()=>{eI({event_key:"artifact.publish_button_clicked",message_uuid:ew,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eo()},[eo,eI,ew,null==v?void 0:v.type,null==v?void 0:v.language]),eP=(null==v?void 0:v.type)===y.vU.Text,eB=(null==v?void 0:v.type)===y.vU.Markdown||(null==v?void 0:v.type)===y.vU.Code,eG=(null==v?void 0:v.type)===y.vU.Html||(null==v?void 0:v.type)===y.vU.React,eW=(null==v?void 0:v.type)!==y.vU.Text&&!(ex&&((null==v?void 0:v.type)===y.vU.Svg||(null==v?void 0:v.type)===y.vU.Mermaid||(null==v?void 0:v.type)===y.vU.React||(null==v?void 0:v.type)===y.vU.Html)),eq=!eW||"raw"===W,eH=ek||eN&&!j&&!eC&&!(null==B?void 0:B.settings.dismissed_artifact_feedback_form)&&eA,eY=null!=(g=null==v?void 0:v.versions.length)?g:0,[eV,eJ]=(0,T.useState)(!1),eK=E&&v?{show:!ex&&!(null==ea?void 0:ea.is_starter_project),artifact:v,projectUuid:E,selectedVersion:ef,selectDoc:I}:void 0;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,k.A)(v?"bg-bg-000 flex h-full flex-col relative":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none"),onClick:()=>eV&&eJ(!1),children:[(0,s.jsx)(et,{versionCount:eY,selectedVersion:ef,artifact:v,canRenderNormal:eW,canOnlyRenderRaw:eP,canOnlyRenderNormal:eB,viewing:W,setViewing:H,showRaw:eq,canRefresh:eG,isSandboxLoading:Z,handleRefresh:()=>{ee(!0),Y.current&&Y.current.refresh()},canShare:eg,handleOpenShareModal:eU,isStreaming:j,onClose:b,hasMenuOpen:eV,setHasMenuOpen:eJ,canPublish:ei,wasUnpublished:ej,publishedArtifactUuid:ey,openPublishModal:eD,projectParams:eK,richSandboxRef:Y,hasArtifactToolConfig:!!(null==en||null==(u=en.mcp_servers)?void 0:u.length),setShowArtifactMcpModal:J,storageInfo:eL,openResetStorageModal:eF,handleVersionSelect:e=>{let t=null==v?void 0:v.versions[e].uuid;t&&A(t)}}),(0,s.jsx)(i.k,{isOpen:D,content:null!=(h=null==v||null==(m=v.versions[ef])?void 0:m.resultState)?h:"",type:null==v?void 0:v.type,citations:null==v||null==(x=v.versions[ef])?void 0:x.citations,language:void 0===v?void 0:v.language||y.K5[v.type].syntaxName,showRaw:eq,richSandboxRef:Y,isCurrentStreaming:ex,isChatStreaming:j,onSandboxConfirmation:ec,sendMessage:R,richSandboxCapabilities:z,isLatestVersion:!!v&&ef===v.versions.length-1,artifactId:null==v?void 0:v.id,artifactContext:S?{uuid:S,type:"artifact_version",id:null==v?void 0:v.id}:void 0,artifactVersion:ef,onArtifactRuntimeError:e=>{G.track({event_key:"claudeai.artifacts.execution.error",artifact_version_uuid:null==S?void 0:S.toString(),error_type:e.type,source:null==v?void 0:v.versions[ef].source})},artifact:v,hasMenuOpen:eV,ArtifactMcpModal:X.I}),(0,s.jsx)(M.N,{children:eH&&(0,s.jsx)(C.P.div,{initial:{opacity:0,y:20,x:"-50%"},animate:{opacity:1,y:0,x:"-50%"},transition:{duration:.3,delay:.8,ease:"easeOut"},exit:{opacity:0,y:20,x:"-50%",transition:{duration:.3,ease:"easeOut"}},className:"absolute bottom-20 left-1/2",children:(0,s.jsx)("div",{children:(0,s.jsx)(q,{onSubmitNotes:e=>{eI({event_key:"artifact.feedback.note",note:e,message_uuid:ew,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eM(!1)},onSubmitRating:e=>{eI({event_key:"artifact.feedback.sentiment",type:e?"thumbs_up":"thumbs_down",message_uuid:ew,artifact_type:null==v?void 0:v.type,artifact_language:null==v?void 0:v.language}),eE({dismissed_artifact_feedback_form:!0}),eM(!0)},onClose:()=>{eS(!0),eE({dismissed_artifact_feedback_form:!0}),eM(!1)}})})})})]}),(null==v?void 0:v.versions[ef])&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($.Dr,{messageUuid:v.versions[ef].message,isOpen:er&&!ej,onClose:ed,artifact:v,selectedVersion:ef,publishedArtifactUuid:ey,richSandboxRef:Y}),eg&&S&&(0,s.jsx)(es,{isOpen:eh,onClose:ev,artifactVersionUuid:S,artifact:v,messageUuid:v.versions[ef].message,isProjectArtifact:!!(null==ea?void 0:ea.is_private)})]}),V&&S&&(0,s.jsx)(X.I,{isOpen:V,requestedServers:el,onClose:()=>J(!1),artifactContext:{uuid:S,type:"artifact_version",id:null==v?void 0:v.id}}),eR&&S&&(0,s.jsx)(Q.c,{isOpen:eR,onClose:ez,entityId:S,artifactEntityType:"artifact_version",conversationUuid:eT})]})};function et(e){var t;let{versionCount:a,selectedVersion:n,artifact:l,canRenderNormal:i,canOnlyRenderRaw:r,canOnlyRenderNormal:o,viewing:d,setViewing:h,showRaw:w,canRefresh:_,isSandboxLoading:M,handleRefresh:C,canShare:S,handleOpenShareModal:E,isStreaming:I,canPublish:F,wasUnpublished:O,publishedArtifactUuid:U,projectParams:P,onClose:B,openPublishModal:G,handleVersionSelect:W,hasMenuOpen:q,setHasMenuOpen:H,richSandboxRef:Y,hasArtifactToolConfig:V,setShowArtifactMcpModal:J,storageInfo:X,openResetStorageModal:$}=e,Q=(0,R.A)(),ee=(0,N.V)(j.E_),{copyToClipboard:et,didCopy:es}=(0,v.C)(),{copyToProject:en,isCopiedToProject:el}=function(e){let{projectUuid:t,artifact:a,selectedVersion:n}=e,[l,i]=(0,T.useState)(!1),{mutateAsync:r,data:o}=(0,z.fh)(null!=t?t:""),{addError:d}=(0,c.Yf)();return(0,T.useEffect)(()=>{if(null==o?void 0:o.uuid){i(!0);let e=setTimeout(()=>{i(!1)},12e3);return()=>clearTimeout(e)}},[o]),{copyToProject:async()=>{if(a)try{var e;await r({file_name:"".concat(a.title,".").concat(y.K5[a.type].extension()),content:null!=(e=a.versions[n].resultState)?e:""})}catch(e){d((0,s.jsx)(L.A,{defaultMessage:"Error adding artifact to project: {error}",id:"sSg3OiDDja",values:{error:e}}),{error:e})}},isCopiedToProject:l}}({artifact:l,projectUuid:null!=(t=null==P?void 0:P.projectUuid)?t:"",selectedVersion:n});async function ei(){var e,t;if(!l)return;let a=l.type===y.vU.Markdown,s=l.type===y.vU.React,i=null!=(e=l.versions[n].resultState)?e:"";if(s&&Y.current){let e=await (null==(t=Y.current)?void 0:t.copyHtmlContent());e?await et({text:e,html:e}):await et(i)}else if(a)try{let e=(0,D.u)(i);await et({text:i,html:e})}catch(e){await et(i)}else await et(i)}let{ref:er,width:eo}=function(){let e=(0,T.useRef)(null),[t,a]=(0,T.useState)(()=>{var t,a;return null!=(a=null==(t=e.current)?void 0:t.offsetWidth)?a:null});return(0,T.useEffect)(()=>{let t=A()(()=>{e.current&&a(e.current.offsetWidth)},20,{leading:!0,trailing:!0}),s=new ResizeObserver(t);if(e.current){let a=e.current;return t(),s.observe(a),()=>s.disconnect()}},[]),{ref:e,width:t}}(),ed=eo&&eo<480,ec=!w&&_,{addError:eu}=(0,c.Yf)(),em=(null==l?void 0:l.type)===y.vU.Markdown&&"raw"!==d?(0,s.jsx)(p.tJ,{onSelect:async()=>{try{await (0,Z.M9)(l)}catch(e){eu((0,s.jsx)(L.A,{defaultMessage:"Error downloading PDF",id:"fes7nfwp3b"}),{error:e})}},children:(0,s.jsx)(L.A,{defaultMessage:"Download as PDF",id:"camH0DLf91"})},"saveAsPdf"):null,ex=l?(0,s.jsx)(p.tJ,{asChild:!0,"data-testid":"export-download",children:(0,s.jsx)(ea,{artifact:l,selectedVersion:n})},"download"):null;return(0,s.jsxs)("div",{ref:er,className:(0,k.A)("pr-2 pl-3 flex items-center justify-between gap-2 select-none",ee?[j.X_,j.zo,"draggable"]:"py-2"),children:[l&&(0,s.jsx)(K,{currentArtifact:l,hasMenuOpen:q,setHasMenuOpen:H}),q?(0,s.jsxs)("div",{className:"flex justify-between items-center flex-1 text-sm text-text-300 pl-1",children:[(0,s.jsx)(L.A,{defaultMessage:"Switch between artifacts",id:"mYiLqlDMdl"}),!w&&ec&&M?(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,s.jsx)(g.R,{size:"sm"})}):null]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,k.A)("flex items-center flex-1 gap-2"),children:[!(!i||r||o)&&(0,s.jsx)(u.Iz,{options:[{key:"normal",label:(0,s.jsx)(x.Eye,{size:16}),ariaLabel:Q.formatMessage({defaultMessage:"Preview",id:"TJo5E6JuIN"})},{key:"code",label:(0,s.jsx)(x.Code,{size:16}),ariaLabel:Q.formatMessage({defaultMessage:"Code",id:"h2vipunVVd"})}],initialKey:"normal"===d?"normal":"code",onSelect:e=>{h("normal"===e?"normal":"raw")},itemClassName:"!px-1"},"normal"===d?"normal":"code"),a>1?(0,s.jsx)(p.ms,{align:"start",trigger:(0,s.jsxs)(f.$,{variant:"ghost",size:"sm",className:"group !text-text-000 gap-1 justify-between !pl-1.5 !pr-1 !text-sm","data-testid":"artifact-version-trigger",children:["v",n+1,ed||n!==a-1?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"∙"}),(0,s.jsx)(L.A,{defaultMessage:"Latest",id:"adThp5MDl0"})]}),(0,s.jsx)(x.CaretDownSmall,{size:16,className:"opacity-0 group-hover:opacity-100 group-[&[data-state=open]]:opacity-100"})]}),children:Array.from({length:a}).map((e,t)=>a-t).map(e=>(0,s.jsxs)(p.tJ,{"data-testid":"version-dropdown",className:"flex justify-between",onSelect:()=>W(e-1),children:[(0,s.jsx)(L.A,{defaultMessage:"Version {versionNum}",id:"iMMX+ZCJ/I",values:{versionNum:e}}),e===a?(0,s.jsxs)(s.Fragment,{children:[" - ",(0,s.jsx)(L.A,{defaultMessage:"Latest",id:"adThp5MDl0"})]}):null,e-1===n?(0,s.jsx)(x.Check,{className:"text-accent-secondary-100",size:16}):null]},e))}):null]}),(0,s.jsxs)("div",{className:(0,k.A)("flex gap-2 items-center text-sm"),children:[ed?(0,s.jsxs)(p.ms,{align:"end",trigger:(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm","data-testid":"artifact-menu-trigger","aria-label":Q.formatMessage({defaultMessage:"More options for artifact",id:"O91Ji7GVP2"}),children:(0,s.jsx)(x.DotsVertical,{size:16})}),children:[ec&&(0,s.jsx)(p.tJ,{disabled:M,onSelect:C,children:(0,s.jsx)(L.A,{defaultMessage:"Refresh",id:"rELDbByu8U"})},"refresh"),X&&X.total_size_bytes>0&&!w&&(0,s.jsx)(p.tJ,{onSelect:$,children:(0,s.jsx)(m.YX,{id:"silver_apple_jungle"})},"reset-storage"),V&&!w&&(0,s.jsx)(p.tJ,{onSelect:()=>J(!0),children:(0,s.jsx)(L.A,{defaultMessage:"Manage connectors",id:"cqx+RdJnHp"})},"manage-connectors"),(0,s.jsx)(p.tJ,{onSelect:ei,children:(0,s.jsx)(L.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})},"copy"),S?(0,s.jsx)(p.tJ,{onSelect:E,children:(0,s.jsx)(L.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})},"share"):null,O?(0,s.jsx)(p.tJ,{disabled:!0,onSelect:G,children:(0,s.jsx)(L.A,{defaultMessage:"Unpublished",id:"wbU4tD+0G+"})},"unpublished"):F?(0,s.jsx)(p.tJ,{onSelect:G,children:(0,s.jsx)(L.A,{defaultMessage:"Publish",id:"syEQFEKfku"})},"publish"):null,ex,em]}):(()=>{let e=!w&&ec&&(M?(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,s.jsx)(g.R,{size:"sm"})}):(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:C,children:(0,s.jsx)(x.Reload,{size:16})})),t=S&&(0,s.jsx)(f.$,{onClick:E,variant:"primary",size:"sm",disabled:I,prepend:(0,s.jsx)(x.Share,{size:16,className:"mr-0.5"}),children:(0,s.jsx)("span",{className:"text-sm",children:(0,s.jsx)(L.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})}),a=F&&(0,s.jsx)(b.m,{open:!!O&&void 0,tooltipContent:(0,s.jsx)(L.A,{defaultMessage:"This artifact was previously unpublished. Create a new artifact to publish again.",id:"173M62fqu+"}),children:(0,s.jsx)(f.$,{onClick:G,variant:"primary",size:"sm",disabled:O||I,className:(0,k.A)(O&&"!pointer-events-auto"),children:(0,s.jsx)("span",{className:"text-sm",children:void 0===U||O?(0,s.jsx)(L.A,{defaultMessage:"Publish",id:"syEQFEKfku"}):(0,s.jsx)(L.A,{defaultMessage:"Published",id:"w7tf2zwi6+"})})})}),n=(0,s.jsxs)(p.AM,{mainButtonText:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:(0,k.A)(es?"invisible":""),children:(0,s.jsx)(L.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})}),es?(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(x.Check,{size:16})}):null]}),onClickMainButton:ei,children:[(null==P?void 0:P.show)?el?(0,s.jsx)(p.tJ,{disabled:!0,children:(0,s.jsx)(L.A,{defaultMessage:"Copied to project",id:"KYVs6Ta+VU"})},"added-to-project"):(0,s.jsx)(p.tJ,{onSelect:en,children:(0,s.jsx)(L.A,{defaultMessage:"Copy to project",id:"Xmf/Sp7n9T"})},"add-to-project"):null,ex,em]}),l=X&&X.total_size_bytes>0&&!w&&(0,s.jsx)(b.m,{tooltipContent:(0,s.jsx)(m.YX,{id:"silver_apple_jungle"}),children:(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:$,children:(0,s.jsx)(x.Trash,{size:16})})}),i=V&&!w&&(0,s.jsx)(b.m,{tooltipContent:(0,s.jsx)(L.A,{defaultMessage:"Manage connectors",id:"cqx+RdJnHp"}),children:(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:()=>J(!0),children:(0,s.jsx)(x.Settings,{size:16})})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex gap-1 items-center",children:[e,l,i]}),n,t,a]})})(),(0,s.jsx)(f.$,{variant:"ghost",size:"icon_sm",onClick:B,children:(0,s.jsx)(x.X,{size:16})})]})]})]})}function ea(e){let{artifact:t,selectedVersion:a}=e,{downloadUrl:n,filename:l}=((e,t)=>{let[a,s]=(0,T.useState)(""),[n,l]=(0,T.useState)("");return(0,T.useEffect)(()=>{var a;let n=null!=(a=e.versions[t].resultState)?a:"",i=(0,y.eg)(e),r=new Blob([n],{type:"text/plain"}),o=URL.createObjectURL(r);return s(o),l("".concat(e.id,".").concat(i)),()=>{URL.revokeObjectURL(o)}},[e,t]),{downloadUrl:a,filename:n}})(t,a),i=function(e){switch(e.type){case y.vU.Markdown:return"Markdown";case y.vU.Html:return"HTML";case y.vU.React:return"TSX";case y.vU.Svg:return"SVG";case y.vU.Text:return"TXT";case y.vU.Mermaid:return"Mermaid";case y.vU.Code:var t;return null!=(t=y.K5[e.type].extension(e))?t:null;default:return null}}(t);return(0,s.jsx)("a",{href:n,download:l,className:"py-1 px-2 rounded-md cursor-pointer whitespace-nowrap overflow-hidden grid grid-cols-[minmax(0,_1fr)_auto] gap-2 hover:bg-bg-200 hover:text-text-000 text-sm",children:i?(0,s.jsx)(L.A,{defaultMessage:"Download as {fileType}",values:{fileType:i},id:"PJh4v0uaV6"}):(0,s.jsx)(L.A,{defaultMessage:"Download file",id:"k9qHCCLPA5"})})}let es=e=>{let{onClose:t,isOpen:a,artifactVersionUuid:n,artifact:i,messageUuid:r,isProjectArtifact:d}=e,c=(0,R.A)(),{track:u}=(0,o.st)(),{mutateAsync:m,isPending:x}=(0,l.yE)(n),{data:f,isLoading:p}=(0,l.EC)(n),g=(null==f?void 0:f.visibility)==="shared",h=x||p,[b,y]=(0,T.useState)("");(0,T.useEffect)(()=>{if(""===b)return;let e=setTimeout(()=>y(""),5e3);return()=>clearTimeout(e)},[b]);let j="".concat(window.location.origin,"/artifacts/").concat(n),{copyToClipboard:w}=(0,v.C)(),N=h?"loading":g?"shared":"private",_=(0,T.useRef)(N);_.current!==N&&("loading"!==_.current&&"private"===N&&y(c.formatMessage({defaultMessage:"Artifact no longer shared",id:"5AFOwOoFPe"})),_.current=N);let k=e=>{"private"===e&&g&&m({visibility:"private"}).then(()=>t()),"shared"!==e||g||m({visibility:"shared"}).then(()=>w(j))};return(0,s.jsx)(en,{isOpen:a,onClose:t,isLoading:h,isShared:g,isProjectArtifact:d,sharedLink:j,updateSharedState:k,handleClickShareButton:()=>{k("shared"),u({event_key:"artifact.share.modal.share_button_clicked",message_uuid:r,artifact_type:i.type,artifact_language:i.language})}})};function en(e){let{isOpen:t,onClose:a,isShared:n,isProjectArtifact:l,sharedLink:i,isLoading:r,updateSharedState:o,handleClickShareButton:d}=e,{copyToClipboard:c,didCopy:u}=(0,v.C)();return(0,s.jsx)(h.aF,{title:(0,s.jsx)("span",{className:"text-text-200 font-claude-response text-xl font-medium",children:n?(0,s.jsx)(L.A,{defaultMessage:"Artifact shared",id:"0TqmonlxQo"}):(0,s.jsx)(L.A,{defaultMessage:"Share artifact",id:"FeSSOL+/49"})}),isOpen:t,onClose:a,modalSize:"lg",hasCloseButton:!0,children:(0,s.jsx)("div",{className:"mt-1 flex flex-col gap-2.5",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col rounded-xl",children:[(0,s.jsxs)("div",{className:"border-b-0.5 border-border-300 flex gap-3 py-3 pl-3 pr-5",children:[(0,s.jsx)("div",{children:(0,s.jsx)(x.Globe,{className:"mt-1",size:16})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h6",{className:"font-medium",children:(0,s.jsx)(L.A,{defaultMessage:"Shared",id:"kWI6zXRaHY"})}),(0,s.jsx)("p",{className:"text-text-300",children:l?(0,s.jsx)(L.A,{defaultMessage:"Anyone who has access to this project can view this artifact and its associated attachments and files.",id:"fxjJJNetIb"}):(0,s.jsx)(L.A,{defaultMessage:"Anyone in your organization can view this artifact and its associated attachments and files.",id:"P+skcC6AMa"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 py-3 pl-3 pr-5",children:[(0,s.jsx)(I(),{className:"text-text-300 truncate text-sm",href:i,children:i}),(0,s.jsx)(f.$,{variant:"ghost",className:"!text-accent-secondary-000 hover:bg-accent-secondary-900 font-medium",onClick:()=>{c(i)},prepend:u?(0,s.jsx)(x.CheckCircle,{size:16}):(0,s.jsx)(x.LinkSimple,{size:16}),children:u?(0,s.jsx)(L.A,{defaultMessage:"Link copied",id:"zU/q1NoIdN"}):(0,s.jsx)(L.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsx)(f.$,{size:"lg",variant:"secondary",loading:r,onClick:()=>o("private"),children:(0,s.jsx)(L.A,{defaultMessage:"Unshare",id:"bEq+NWNIXF"})})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-text-400 flex flex-col gap-3 py-3",children:l?(0,s.jsxs)("p",{className:"bg-bg-300 text-text-300 flex gap-2 rounded-xl p-3 text-sm",children:[(0,s.jsx)(x.Info,{size:16,className:"mt-0.5 shrink-0"}),(0,s.jsx)(L.A,{defaultMessage:"This artifact was created in a private project. Anyone in your organization who has access to this project will be able to view this artifact.",id:"g6r4HATHuW"})]}):(0,s.jsx)("p",{children:(0,s.jsx)(L.A,{defaultMessage:"Anyone in your organization can view this artifact. It also has access to attachments and files in the conversation.",id:"AnqiBApCMX"})})}),(0,s.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex gap-3 rounded-xl py-3 pl-3 pr-5",children:[(0,s.jsx)(x.Lock,{className:"mt-0.5",size:16}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h6",{className:"font-medium",children:(0,s.jsx)(L.A,{defaultMessage:"Unshared",id:"0r/9ANkloS"})}),(0,s.jsx)("p",{className:"text-text-300",children:(0,s.jsx)(L.A,{defaultMessage:"Only you have access",id:"U+7IIlpC6m"})})]})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full items-center justify-end gap-2",children:(0,s.jsx)(f.$,{size:"lg",loading:r,onClick:d,children:(0,s.jsx)(L.A,{defaultMessage:"Share & copy link",id:"E7GQdF/HSA"})})})]})})})}},0x6ff86c72:(e,t,a)=>{"use strict";a.d(t,{A:()=>e5});var s=a(0x22102fd88),n=a(0xac309a83),l=a(0x1b813d90),i=a(0xfc89b4a4),r=a(0x1334f6ecc),o=a(0x25062734b),d=a(0x17509cc64),c=a(0x3769f4df),u=a(0x1b8f3b064),m=a(0x38e6572);let x=()=>(0,s.jsxs)("div",{className:"items-top flex w-full bg-bg-200 mt-5 p-3 rounded-xl items-center text-text-300",children:[(0,s.jsx)(u.R,{size:24}),(0,s.jsx)("p",{className:"font-base ml-3",children:(0,s.jsx)(m.A,{defaultMessage:"Claude has ended this chat.",id:"xJ+abA4nue"})})]});var f=a(0x24573a476),p=a(0xb844abc8),g=a(0x17f3a2521),h=a(0x19078106),b=a(0x156c4e43b),v=a(0x1037073d3),y=a(0x1e140f433);let j=b.Ik({url:b.Yj()}),w=e=>{let t,{input:a,toolResult:n,isStreaming:l}=e,r=null==n?void 0:n.is_error,[o,d]=(0,i.useState)(!1),c=(0,i.useMemo)(()=>{if(r)return;let e=function(e){if(!e||!e.content)return null;if(e.content.some(e=>"knowledge"===e.type)){let t=[];for(let a of e.content)"knowledge"===a.type&&t.push(a);return t}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let a=JSON.parse(t.text);return Array.isArray(a)?a.map(e=>{let t=g.ey.safeParse(e);return t.success?t.data:null}).filter(e=>null!==e):[]}catch(e){return[]}}(n);return null==e?void 0:e[0]},[r,n]),u=(0,i.useMemo)(()=>{if(!r)return;let e=function(e){if(!e||!e.content)return null;if(e.content.some(e=>"text"===e.type)){let t=[];for(let a of e.content)if("text"===a.type){let e=function(e){try{return JSON.parse(e)}catch(e){return null}}(a.text);if(null===e)t.push({error_type:"UNKNOWN_ERROR",error_message:a.text});else{let a=g.kS.safeParse(e);a.success&&t.push(a.data)}}return t}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let a=JSON.parse(t.text);return Array.isArray(a)?a.map(e=>{let t=g.tD.safeParse(e);if(!t.success)return null;{let e=g.kS.safeParse(JSON.parse(t.data.text));return e.success?e.data:null}}).filter(e=>null!==e):[]}catch(e){return[]}}(n);return null==e?void 0:e[0]},[r,n]),x=function(e){switch(e){case"INVALID_URL":return(0,s.jsx)(m.A,{defaultMessage:"The URL provided is invalid",id:"EXjAXf5Pbi"});case"URL_NOT_FOUND":return(0,s.jsx)(m.A,{defaultMessage:"Could not find this URL",id:"stDgCXJO7F"});case"RATE_LIMIT_EXCEEDED":return(0,s.jsx)(m.A,{defaultMessage:"Access to this website has been restricted due to rate limits",id:"VhUxwIo+O2"});case"ROBOTS_DISALLOWED":return(0,s.jsx)(m.A,{defaultMessage:"This website has blocked Claude via robots.txt rules",id:"dHtmXRJ647"});case"URL_TOO_LONG":return(0,s.jsx)(m.A,{defaultMessage:"The URL provided is too long",id:"K2DBYJqbtF"});case"SITE_BLOCKED":return(0,s.jsx)(m.A,{defaultMessage:"Access to this website is blocked",id:"WI6DZStAoi"});case"PERMISSIONS_ERROR":return(0,s.jsx)(m.A,{defaultMessage:"The URL was not provided by the user nor was it contained in any web search/fetch results",id:"aXYLYDjU6L"});case"UNKNOWN_ERROR":case"SERVER_ERROR":case"CLIENT_ERROR":return(0,s.jsx)(m.A,{defaultMessage:"An unknown error occurred",id:"3VG8rbxa4v"});case void 0:return null}}(null==u?void 0:u.error_type),{data:b}=j.safeParse(a);if(!b)return;let w=b.url,N=(null==c?void 0:c.title)||w,_=(0,p.Nj)(w);return t=l?_?(0,s.jsx)(m.A,{defaultMessage:"Fetching from {hostname}",id:"5qKeNV67+8",values:{hostname:_}}):(0,s.jsx)(m.A,{defaultMessage:"Fetching from site",id:"TSZq9sKvY7"}):r?(0,s.jsx)(m.A,{defaultMessage:"Failed to fetch <b>{title}</b>",id:"8JHipUo6K+",values:{title:N,b:e=>(0,s.jsx)("span",{className:"text-text-400",children:e})}}):(0,s.jsx)(m.A,{defaultMessage:"Fetched <b>{title}</b>",id:"BWNvvK6PhH",values:{title:N,b:e=>(0,s.jsx)("span",{className:"text-text-400",children:e})}}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.aX,{isError:r,errorMessage:x,text:t,secondaryText:l?void 0:_,handleClick:()=>d(!0),icon:(0,s.jsx)(v.z,{size:16,type:"favicon",src:w,name:_||"Fetch",fallbackToGlobe:!0}),secondaryIcon:(0,s.jsx)(h.B,{size:16,className:"text-text-300"}),...e}),(0,s.jsx)(f.v,{isOpen:o,url:w,onClose:()=>d(!1),onConfirm:()=>{window.open(w,"_blank"),d(!1)}})]})};var N=a(0xf32c56dd),_=a(0x14de19ae8),k=a(0x139b5e710),M=a(0xee2e6e74),C=a(0x10e01d04d),S=a(0x2149252e7),A=a(0x1cee1d89);let E=e=>{let{client:t,sandboxProxyUrl:a,toolName:n,toolResourceUri:l,toolInput:r,isToolInputPartial:o,toolResult:d,hostContext:c,onmessage:u,onopenlink:m,onloggingmessage:x,onDisplayModeChange:f,onerror:p,oninitialized:g,onresourcemeta:h,onBridgeEvent:b}=e,[v,y]=(0,i.useState)(null),[j,w]=(0,i.useState)(null),[N,_]=(0,i.useState)(null),[k,M]=(0,i.useState)(!1),[E,I]=(0,i.useState)(null),T=(0,i.useRef)(null),L=(0,i.useRef)(null),R=(0,i.useRef)(u),F=(0,i.useRef)(m),z=(0,i.useRef)(x),O=(0,i.useRef)(f),U=(0,i.useRef)(p),D=(0,i.useRef)(g),P=(0,i.useRef)(b),B=(0,i.useRef)(h),G=(0,i.useRef)(c),W=(0,i.useRef)(void 0),q=(0,i.useRef)(!1),H=(0,i.useRef)(!1);(0,i.useEffect)(()=>{R.current=u,F.current=m,z.current=x,O.current=f,U.current=p,D.current=g,P.current=b,B.current=h,G.current=c});let Y=e=>{var t;null==(t=P.current)||t.call(P,{type:e,sandboxUrl:a.href,toolName:n})};return(0,i.useEffect)(()=>{let e=!1;return(async()=>{var s,i,r,o,d,c;try{let c;if(l)c=l;else{let e=await (0,A.Bv)(t,n);if(!e)throw Error("Tool ".concat(n," has no UI resource (no ui/resourceUri in tool._meta)"));c=e.uri}if(e)return;let{html:u,meta:m}=await (0,A.t_)(t,{uri:c});if(e)return;let x=new URL(a.href);(null==m||null==(i=m.csp)||null==(s=i.connectDomains)?void 0:s.length)&&x.searchParams.set("connect-src",m.csp.connectDomains.join(" "));let f=[...null!=(d=null==m||null==(r=m.csp)?void 0:r.resourceDomains)?d:[],"https://assets.claude.ai"];x.searchParams.set("resource-src",f.join(" ")),y(x.href),w(u),null==(o=B.current)||o.call(B,m)}catch(a){if(e)return;let t=a instanceof Error?a:Error(String(a));I(t),null==(c=U.current)||c.call(U,t)}})(),()=>{e=!0}},[t,n,l,a.href]),(0,i.useEffect)(()=>{if(!v)return;let e=!0;return(async()=>{try{let{iframe:a,onReady:s}=await (0,A.PK)(new URL(v));if(!e||(L.current=a,T.current&&T.current.appendChild(a),q.current=!1,H.current=!1,await s,!e))return;let n=t.getServerCapabilities(),l=new S.T1(t,{name:"Example MCP UI Host",version:"1.0.0"},{openLinks:{},serverTools:null==n?void 0:n.tools,serverResources:null==n?void 0:n.resources},{hostContext:G.current});if(l.oninitialized=()=>{var t;e&&(Y("initialized"),M(!0),null==(t=D.current)||t.call(D))},l.onmessage=(e,t)=>{if(Y("message"),!R.current)throw new C.Nh(C.O4.MethodNotFound,"Method not found");return R.current(e,t)},l.onopenlink=(e,t)=>{if(Y("openlink"),!F.current)throw new C.Nh(C.O4.MethodNotFound,"Method not found");return F.current(e,t)},l.onloggingmessage=e=>{if(Y("loggingmessage"),!z.current)throw new C.Nh(C.O4.MethodNotFound,"Method not found");return z.current(e)},l.onrequestdisplaymode=e=>{var t,a,s;let{mode:n}=e,l=G.current,i=null!=(t=null==l?void 0:l.availableDisplayModes)?t:["inline"],r=null!=(a=null==l?void 0:l.displayMode)?a:"inline";return i.includes(n)?(null==(s=O.current)||s.call(O,n),Promise.resolve({mode:n})):Promise.resolve({mode:r})},l.onsizechange=async e=>{let{height:t}=e;if(L.current&&void 0!==t){var a,s;Y("sizechange");let e=null==(s=G.current)||null==(a=s.viewport)?void 0:a.maxHeight,n=void 0!==e?Math.min(t,e):t;L.current.style.height="".concat(n,"px")}},l.onerror=e=>{var t;Y("error"),null==(t=U.current)||t.call(U,e)},await l.connect(new S.hJ(a.contentWindow,a.contentWindow)),!e)return;_(l)}catch(s){var a;if(!e)return;let t=s instanceof Error?s:Error(String(s));I(t),null==(a=U.current)||a.call(U,t)}})(),()=>{var t;e=!1,L.current&&(null==(t=T.current)?void 0:t.contains(L.current))&&T.current.removeChild(L.current)}},[v,t]),(0,i.useEffect)(()=>{N&&j&&(Y("sandbox_resource_ready"),N.sendSandboxResourceReady({html:j}))},[N,j]),(0,i.useEffect)(()=>{N&&k&&r&&(o?(Y("tool_input_partial"),N.sendToolInputPartial({arguments:r})):q.current||(q.current=!0,Y("tool_input"),N.sendToolInput({arguments:r})))},[N,k,r,o]),(0,i.useEffect)(()=>{N&&k&&d&&!H.current&&(H.current=!0,Y("tool_result"),N.sendToolResult(d))},[N,k,d]),(0,i.useEffect)(()=>{if(!N||!k||!c)return;let e=W.current;if(!e){W.current=c;return}let t={};for(let a of Object.keys(c)){let s=c[a],n=e[a];("object"==typeof s&&null!==s?JSON.stringify(s)!==JSON.stringify(n):s!==n)&&(t[a]=s)}Object.keys(t).length>0&&(N.sendHostContextChange(t),W.current=c)},[N,k,c]),(0,s.jsx)("div",{ref:T,className:"h-full w-full"})};var I=a(0x225bae024),T=a(0x22fc8d729),L=a(0x1b370f49d),R=a(0x1888e36ef),F=a(0x8f56a24b),z=a(0x213f5659b),O=a(0x1a1f6dda6),U=a(0x1ab0d1ca1),D=a(0xdf5c3676),P=a(0x1bd175d8c);let B={"--color-background-primary":"light-dark(rgba(255, 255, 255, 1), rgba(48, 48, 46, 1))","--color-background-secondary":"light-dark(rgba(245, 244, 237, 1), rgba(38, 38, 36, 1))","--color-background-tertiary":"light-dark(rgba(250, 249, 245, 1), rgba(20, 20, 19, 1))","--color-background-inverse":"light-dark(rgba(20, 20, 19, 1), rgba(250, 249, 245, 1))","--color-background-ghost":"light-dark(rgba(255, 255, 255, 0), rgba(48, 48, 46, 0))","--color-background-info":"light-dark(rgba(214, 228, 246, 1), rgba(37, 62, 95, 1))","--color-background-danger":"light-dark(rgba(247, 236, 236, 1), rgba(96, 42, 40, 1))","--color-background-success":"light-dark(rgba(233, 241, 220, 1), rgba(27, 70, 20, 1))","--color-background-warning":"light-dark(rgba(246, 238, 223, 1), rgba(72, 58, 15, 1))","--color-background-disabled":"light-dark(rgba(255, 255, 255, 0.5), rgba(48, 48, 46, 0.5))","--color-text-primary":"light-dark(rgba(20, 20, 19, 1), rgba(250, 249, 245, 1))","--color-text-secondary":"light-dark(rgba(61, 61, 58, 1), rgba(194, 192, 182, 1))","--color-text-tertiary":"light-dark(rgba(115, 114, 108, 1), rgba(156, 154, 146, 1))","--color-text-inverse":"light-dark(rgba(255, 255, 255, 1), rgba(20, 20, 19, 1))","--color-text-info":"light-dark(rgba(50, 102, 173, 1), rgba(128, 170, 221, 1))","--color-text-danger":"light-dark(rgba(127, 44, 40, 1), rgba(238, 136, 132, 1))","--color-text-success":"light-dark(rgba(38, 91, 25, 1), rgba(122, 185, 72, 1))","--color-text-warning":"light-dark(rgba(90, 72, 21, 1), rgba(209, 160, 65, 1))","--color-text-disabled":"light-dark(rgba(20, 20, 19, 0.5), rgba(250, 249, 245, 0.5))","--color-text-ghost":"light-dark(rgba(115, 114, 108, 0.5), rgba(156, 154, 146, 0.5))","--color-border-primary":"light-dark(rgba(31, 30, 29, 0.4), rgba(222, 220, 209, 0.4))","--color-border-secondary":"light-dark(rgba(31, 30, 29, 0.3), rgba(222, 220, 209, 0.3))","--color-border-tertiary":"light-dark(rgba(31, 30, 29, 0.15), rgba(222, 220, 209, 0.15))","--color-border-inverse":"light-dark(rgba(255, 255, 255, 0.3), rgba(20, 20, 19, 0.15))","--color-border-ghost":"light-dark(rgba(31, 30, 29, 0), rgba(222, 220, 209, 0))","--color-border-info":"light-dark(rgba(70, 130, 213, 1), rgba(70, 130, 213, 1))","--color-border-danger":"light-dark(rgba(167, 61, 57, 1), rgba(205, 92, 88, 1))","--color-border-success":"light-dark(rgba(67, 116, 38, 1), rgba(89, 145, 48, 1))","--color-border-warning":"light-dark(rgba(128, 92, 31, 1), rgba(168, 120, 41, 1))","--color-border-disabled":"light-dark(rgba(31, 30, 29, 0.1), rgba(222, 220, 209, 0.1))","--color-ring-primary":"light-dark(rgba(20, 20, 19, 0.7), rgba(250, 249, 245, 0.7))","--color-ring-secondary":"light-dark(rgba(61, 61, 58, 0.7), rgba(194, 192, 182, 0.7))","--color-ring-inverse":"light-dark(rgba(255, 255, 255, 0.7), rgba(20, 20, 19, 0.7))","--color-ring-info":"light-dark(rgba(50, 102, 173, 0.5), rgba(128, 170, 221, 0.5))","--color-ring-danger":"light-dark(rgba(167, 61, 57, 0.5), rgba(205, 92, 88, 0.5))","--color-ring-success":"light-dark(rgba(67, 116, 38, 0.5), rgba(89, 145, 48, 0.5))","--color-ring-warning":"light-dark(rgba(128, 92, 31, 0.5), rgba(168, 120, 41, 0.5))","--font-sans":"Anthropic Sans, sans-serif","--font-mono":"ui-monospace, monospace","--font-weight-normal":"400","--font-weight-medium":"500","--font-weight-semibold":"600","--font-weight-bold":"700","--font-text-xs-size":"12px","--font-text-sm-size":"14px","--font-text-md-size":"16px","--font-text-lg-size":"20px","--font-heading-xs-size":"12px","--font-heading-sm-size":"14px","--font-heading-md-size":"16px","--font-heading-lg-size":"20px","--font-heading-xl-size":"24px","--font-heading-2xl-size":"28px","--font-heading-3xl-size":"36px","--font-text-xs-line-height":"1.4","--font-text-sm-line-height":"1.4","--font-text-md-line-height":"1.4","--font-text-lg-line-height":"1.25","--font-heading-xs-line-height":"1.4","--font-heading-sm-line-height":"1.4","--font-heading-md-line-height":"1.4","--font-heading-lg-line-height":"1.25","--font-heading-xl-line-height":"1.25","--font-heading-2xl-line-height":"1.1","--font-heading-3xl-line-height":"1","--border-radius-xs":"4px","--border-radius-sm":"6px","--border-radius-md":"8px","--border-radius-lg":"10px","--border-radius-xl":"12px","--border-radius-full":"9999px","--border-width-regular":"0.5px","--shadow-hairline":"0 1px 2px 0 rgba(0, 0, 0, 0.05)","--shadow-sm":"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)","--shadow-md":"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)","--shadow-lg":"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1)"};var G=a(0x1c12b3087),W=a(0xe824fb1c),q=a(0x18393fe29),H=a(0x1050bd590),Y=a(0x152f2a28d),V=a(0x1f7748bd);let J="https://sandbox.claudemcpcontent.com/mcp_apps";async function K(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await globalThis.crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("").slice(0,32)}async function X(e,t,a){let s=new URL(e);if((0,q.yz)())return s;let n=await K(t+a),l=s.hostname.split(".");return l.length>=2&&(l[0]=n,s.hostname=l.join(".")),s}async function $(e,t){return Promise.all(e.map(async e=>{if("file_uuid"in e&&e.file_uuid)try{let a="/api/".concat(t,"/files/").concat(e.file_uuid,"/preview"),s=await fetch(a,{credentials:"include"});if(!s.ok)throw Error("Failed to fetch file: ".concat(s.status," ").concat(s.statusText));let n=await s.blob(),l=await new Promise((e,t)=>{let a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=t,a.readAsDataURL(n)});return{type:e.type,mimeType:n.type||"image/png",data:l.split(",")[1]}}catch(e){}return e}))}async function Q(e,t){if(!(!e||e.content.some(e=>"file_uuid"in e&&e.file_uuid)&&!t))return{content:t?await $(e.content,t):e.content,structuredContent:e.structuredContent,isError:e.is_error}}function Z(e){let{isFirstBlockOfMessage:t,isLastBlockOfMessage:a}=e;return(0,s.jsx)(y.aX,{isDisabled:!0,isStreaming:!1,isFirstBlockOfMessage:t,isLastBlockOfMessage:a,icon:(0,s.jsx)(F.z,{size:16,className:"text-text-500"}),text:(0,s.jsx)("span",{className:"text-text-500",children:(0,s.jsx)(m.A,{defaultMessage:"Connector hidden in shared chats",id:"05tUYKrPy6"})})})}function ee(e){var t;let{toolName:a,serverUuid:n,conversationUuid:l,toolUseId:r,message:o,input:d,toolResult:c,isStreaming:u,approvalData:x,isFirstBlockOfMessage:p,isLastBlockOfMessage:g,groupItemKey:h,autoscrollRef:b}=e,j=(0,U.A)(),{activeOrganization:w}=(0,_.YL)(),C=null==w?void 0:w.uuid,{trackClientNotFound:S,trackError:A,trackBridgeEvent:F}=function(e){let{serverUuid:t,toolName:a,toolUseId:s,chatMessageUuid:n}=e,{track:l}=(0,N.st)(),r=(0,i.useRef)(!1),o=(0,i.useRef)(!1),d=(0,i.useCallback)(()=>{r.current||(r.current=!0,l({event_key:"claudeai.mcp_app.client_not_found",server_uuid:t,tool_name:a,tool_use_id:s,chat_message_uuid:n}))},[t,a,s,n,l]);return{trackClientNotFound:d,trackError:(0,i.useCallback)(e=>{o.current||(o.current=!0,l({event_key:"claudeai.mcp_app.error",server_uuid:t,tool_name:a,tool_use_id:s,chat_message_uuid:n,error_message:e}))},[t,a,s,n,l]),trackBridgeEvent:(0,i.useCallback)(e=>{l({event_key:"claudeai.mcp_app.bridge_event",server_uuid:t,tool_name:a,tool_use_id:s,chat_message_uuid:n,event_type:e.type,sandbox_url:e.sandboxUrl})},[t,a,s,n,l])}}({serverUuid:n,toolName:a,toolUseId:r,chatMessageUuid:o.uuid}),[q,K]=(0,i.useState)(null),[$,Z]=(0,i.useState)(!1),[ee,et]=(0,i.useState)(void 0),[ea,es]=(0,i.useState)(void 0),[en,el]=(0,i.useState)("inline"),ei=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=ei.current;if(!e)return;let t=new ResizeObserver(e=>{for(let t of e)es(t.contentRect.width)});return t.observe(e),es(e.getBoundingClientRect().width),()=>{t.disconnect()}},[]);let[er,eo]=(0,i.useState)(!1),{server:ed}=(0,i.useMemo)(()=>{let e=(0,W.pK)(a);return{server:null==e?void 0:e.server,tool:null==e?void 0:e.tool}},[a]),{handleOpenLink:ec,ExternalLinkModal:eu}=function(){let[e,t]=(0,i.useState)(null),a=(0,i.useRef)(null),n=(0,i.useCallback)(e=>{let{url:s}=e;return new Promise(e=>{t(s),a.current=e})},[]),l=(0,i.useCallback)(()=>{var s;e&&window.open(e,"_blank"),null==(s=a.current)||s.call(a,{isError:!1}),a.current=null,t(null)},[e]),r=(0,i.useCallback)(()=>{var e;null==(e=a.current)||e.call(a,{isError:!0}),a.current=null,t(null)},[]);return{handleOpenLink:n,ExternalLinkModal:(0,s.jsx)(f.v,{isOpen:null!==e,url:null!=e?e:"",onClose:r,onConfirm:l})}}(),{handleMessage:em}=function(e){let t=(0,U.A)(),{addSuccess:a,clearToast:n}=(0,k.Yf)(),{getPrompt:l,setPrompt:r,focusInput:o}=(0,G.aJ)();return{handleMessage:(0,i.useCallback)(i=>{let d=i.content.filter(e=>"text"===e.type).map(e=>e.text).join("\n");return d.trim()?l().trim()?new Promise(l=>{let i,c;i=a((0,s.jsxs)(s.Fragment,{children:[t.formatMessage({defaultMessage:"{serverName} wants to add a prompt.",id:"HIx8Wdvs1D"},{serverName:null!=e?e:"Integration"})," ",(0,s.jsx)(T.Y,{onClick:()=>{c&&clearTimeout(c),r(d,{forceUpdateTiptap:!0,unsafe:!0}),null==o||o(),void 0!==i&&n(i),l({})},children:t.formatMessage({defaultMessage:"Replace current text?",id:"BM1mp2wej1"})})]})),c=setTimeout(()=>{l({isError:!0})},M.ME)}):(r(d,{forceUpdateTiptap:!0,unsafe:!0}),null==o||o(),Promise.resolve({})):Promise.resolve({isError:!0})},[t,a,n,l,r,o,e])}}(null==ed?void 0:ed.name),ex="fullscreen"===en?800:1e7,ef=function(e){let{resolvedMode:t}=(0,D.D)(),a=(0,U.A)(),s=(0,P.V)(),n=(0,i.useMemo)(()=>{let e=window.matchMedia;return{touch:e?window.matchMedia("(pointer: coarse)").matches:void 0,hover:e?window.matchMedia("(hover: hover)").matches:void 0}},[]);return(0,i.useMemo)(()=>({theme:t,locale:a.locale,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,userAgent:"undefined"!=typeof navigator?navigator.userAgent:void 0,platform:s?"desktop":"web",deviceCapabilities:n,availableDisplayModes:["inline"],styles:{variables:B,css:{fonts:'\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-Regular-Static.otf") format("opentype");\n  font-weight: 400;\n  font-style: normal;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-RegularItalic-Static.otf") format("opentype");\n  font-weight: 400;\n  font-style: italic;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-Medium-Static.otf") format("opentype");\n  font-weight: 500;\n  font-style: normal;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-MediumItalic-Static.otf") format("opentype");\n  font-weight: 500;\n  font-style: italic;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-Semibold-Static.otf") format("opentype");\n  font-weight: 600;\n  font-style: normal;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-SemiboldItalic-Static.otf") format("opentype");\n  font-weight: 600;\n  font-style: italic;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-Bold-Static.otf") format("opentype");\n  font-weight: 700;\n  font-style: normal;\n  font-display: swap;\n}\n@font-face {\n  font-family: "Anthropic Sans";\n  src: url("https://assets.claude.ai/Fonts/AnthropicSans-Text-BoldItalic-Static.otf") format("opentype");\n  font-weight: 700;\n  font-style: italic;\n  font-display: swap;\n}\n'}},displayMode:e.displayMode,safeAreaInsets:e.safeAreaInsets,viewport:e.viewport}),[t,a.locale,s,n,e.displayMode,e.safeAreaInsets,e.viewport])}({displayMode:en,safeAreaInsets:"fullscreen"===en?{top:32,right:32,bottom:64,left:32}:ee?{top:12,right:12,bottom:12,left:12}:{top:0,right:0,bottom:0,left:0},viewport:(0,i.useMemo)(()=>{if(void 0!==ea)return{width:ea,height:ex,maxWidth:ea,maxHeight:ex}},[ea,ex])}),[ep,eg]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=!1;return X(J,l,n).then(t=>{e||eg(t)}),()=>{e=!0}},[l,n]);let eh=(0,i.useMemo)(()=>{let e=W.eZ.getState();return(0,W.lU)(n,e)},[n]),eb=!!(null==x?void 0:x.approvalRequired),ev=(0,R.q)(),ey=(0,i.useRef)(!1),{isExpanded:ej,setIsExpanded:ew,snappyTransition:eN}=(0,V.a)(!1,h,eb),e_="".concat(n,"-wrapped"),ek=(0,W.eZ)(e=>e.remoteClients[n]),eM=(0,W.eZ)(e=>e.remoteClients[e_]),[eC,eS]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=null!=ek?ek:eM;e instanceof Promise?e.then(e=>{eS(e)}).catch(()=>{}):e&&eS(e)},[n,ek,eM]);let eA=(0,i.useMemo)(()=>{try{return(0,W.KU)(n)}catch(e){if(eC)return eC;return S(),null}},[n,S,eC]),eE=(0,i.useMemo)(()=>{var e;return{name:null==ed?void 0:ed.name,iconType:null!=(e=null==ed?void 0:ed.iconType)?e:"external",iconSrc:null==ed?void 0:ed.iconSrc}},[null==ed?void 0:ed.name,null==ed?void 0:ed.iconType,null==ed?void 0:ed.iconSrc]),eI=(0,i.useMemo)(()=>(function(e){let t=e.indexOf(":");return -1!==t?e.slice(t+1):e})(a),[a]),eT=(0,i.useMemo)(()=>"object"!=typeof d||null===d||Array.isArray(d)?void 0:d,[d]),[eL,eR]=(0,i.useState)();(0,i.useEffect)(()=>{let e=!1;return Q(c,C).then(t=>{e||eR(t)}),()=>{e=!0}},[c,C,a]);let eF=(0,i.useCallback)(e=>{A(e.message),K(e)},[A]),ez=(0,i.useCallback)(()=>{Z(!0)},[]),eO=(0,i.useCallback)(e=>{et(null==e?void 0:e.prefersBorder)},[]),eU=(0,i.useCallback)(e=>{e.stopPropagation(),eo(e=>!e)},[]),eD=(0,s.jsx)(v.z,{size:16,type:eE.iconType,src:eE.iconSrc,name:eE.name});if(!eA||q)return(0,s.jsx)(y.aX,{isDisabled:!0,icon:eD,isStreaming:u,isFirstBlockOfMessage:p,isLastBlockOfMessage:g,isError:!0,errorMessage:null==q?void 0:q.message,text:eE.name?j.formatMessage({defaultMessage:"Unable to reach {server}",id:"0TerLPGBdw"},{server:eE.name}):j.formatMessage({defaultMessage:"Unable to reach Connector",id:"w8qyhsO3ot"})});if(eb){let e=(0,s.jsx)(m.A,{defaultMessage:"Claude wants to use {toolName} from {serverName}",id:"nMg1IMBNMk",values:{toolName:eI,serverName:eE.name}});return(0,s.jsx)(y.sH,{isExpanded:ev&&ej,setIsExpanded:ew,isExpandingDisabled:!0,text:e,icon:eD,isStreaming:u,isFirstBlockOfMessage:p,isLastBlockOfMessage:g,children:(0,s.jsx)(y.NG,{isExpanded:ev&&ej,snappyTransition:eN,onAnimationComplete:()=>{if(eb&&!ey.current){var e;null==b||null==(e=b.current)||e.scrollToBottom("smooth",{onlyIfPinned:!0}),ey.current=!0}},isScrollable:!0,footer:x?(0,s.jsx)(Y.E,{...x,setIsExpanded:ew}):null,children:(0,s.jsx)(H.L,{input:d,toolResult:c})})})}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(y.aX,{isBorderless:!ee,className:"!h-[3.25rem]",isDisabled:!0,isExpanded:$||er,icon:eD,isStreaming:u||!$,isFirstBlockOfMessage:p,isLastBlockOfMessage:g,text:(0,s.jsxs)(s.Fragment,{children:[null!=(t=eE.name)?t:j.formatMessage({defaultMessage:"Unknown",id:"5jeq8PJZg7"}),eh&&(0,s.jsxs)("span",{className:"text-text-500",children:[" ",eI]})]}),secondaryIcon:eh?(0,s.jsx)(L.m,{tooltipContent:j.formatMessage({defaultMessage:"View request/response",id:"zOLGySrDp2"}),align:"center",children:(0,s.jsx)(I.$,{variant:"ghost",size:"icon_sm",onClick:eU,className:ee?"-m-1":"",children:(0,s.jsx)(z.C,{size:16,className:"text-text-300"})})}):void 0,children:[eh&&(0,s.jsx)(y.NG,{isExpanded:er,isScrollable:!0,snappyTransition:!0,children:(0,s.jsx)(H.L,{input:d,toolResult:c})}),(0,s.jsx)("div",{ref:ei,className:"w-full",children:(0,s.jsx)("div",{className:(0,O.A)(!$&&"hidden",ee&&"border-t-0.5 border-border-300"),children:ep&&(0,s.jsx)(E,{sandboxProxyUrl:ep,client:eA,toolName:eI,toolInput:eT,isToolInputPartial:u,toolResult:eL,hostContext:ef,onerror:eF,oninitialized:ez,onresourcemeta:eO,onDisplayModeChange:el,onBridgeEvent:F,onopenlink:ec,onmessage:em})})})]}),eu]})}let et=(0,i.memo)(function(e){let{toolName:t,serverUuid:a,conversationUuid:n,toolUseId:l,message:i,input:r,toolResult:o,isStreaming:d,approvalData:c,isFirstBlockOfMessage:u,isLastBlockOfMessage:m,groupItemKey:x,autoscrollRef:f,shareType:p}=e;return p?(0,s.jsx)(Z,{isFirstBlockOfMessage:u,isLastBlockOfMessage:m}):a?(0,s.jsx)(ee,{toolName:t,serverUuid:a,conversationUuid:n,toolUseId:l,message:i,input:r,toolResult:o,isStreaming:d,approvalData:c,isFirstBlockOfMessage:u,isLastBlockOfMessage:m,groupItemKey:x,autoscrollRef:f}):null});et.displayName="McpAppToolUseCell";var ea=a(0x1fec22234),es=a(0x865afcc2),en=a(0x1d0c32e96),el=a(0x1d65023c3),ei=a(0x18c2bb2d),er=a(0x54824aed),eo=a.n(er),ed=a(0x18175ce17),ec=a(0x1f92f9b94);function eu(e){return"webpage_metadata"===e.metadata.type?e.url||"":e.metadata.doc_uuid}let em=e=>{let{isExpanded:t,toolName:a,results:n}=e;return(null==n?void 0:n.length)?(0,s.jsx)("div",{className:"flex flex-nowrap p-2 pt-0 flex-col",tabIndex:-1,children:"web_search"===a?(0,s.jsx)(ef,{results:n,isExpanded:t}):(0,s.jsx)(ep,{results:n,isExpanded:t})}):null},ex={initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1,transition:{type:"spring",stiffness:400,damping:30,mass:1}}},ef=e=>{let{isExpanded:t,results:a}=e;return(0,s.jsx)(s.Fragment,{children:a.map(e=>{var a;return e.knowledge&&"webpage_metadata"===e.knowledge.metadata.type?(0,s.jsx)(ei.P.div,{variants:ex,children:(0,s.jsx)(es.$,{disabled:!t,icon:(0,s.jsx)(ea.d,{url:e.knowledge.metadata.favicon_url,size:16}),title:e.knowledge.title,subtitles:[e.knowledge.metadata.site_domain],url:null!=(a=e.knowledge.url)?a:void 0})},e.knowledge.url):null})})},ep=e=>{let{isExpanded:t,results:a}=e;return(0,s.jsx)(s.Fragment,{children:a.map(e=>(0,s.jsx)(ei.P.div,{variants:ex,children:(0,s.jsx)(eg,{disabled:!t,knowledge:e.knowledge})},e.uuid))})},eg=e=>{let{disabled:t,knowledge:a}=e,i=(0,n.fS)("mcp_gdrive"),d=(e=>{let{isError:t}=e,a=(0,ed.Cg)(l.v8.GDRIVE),s=a.isAuthenticated;return(0,o.v_)(a.server_uuid)?s?t?l.I5.ACCESS_DENIED:l.I5.READY:l.I5.UNAUTHENTICATED:l.I5.DISABLED})({isError:!a}),c=(e=>{let{isError:t}=e,{isDriveAuthenticated:a}=(0,r.cI)();return(0,r.yy)()?a?t?l.I5.ACCESS_DENIED:l.I5.READY:l.I5.UNAUTHENTICATED:l.I5.DISABLED})({isError:!a});return(0,s.jsx)(ec.Tc,{syncSourceType:l.v8.GDRIVE,syncStatus:i?d:c,disabled:t,title:(null==a?void 0:a.title)||"Untitled document",subtitles:(null==a?void 0:a.metadata.type)==="google_doc_metadata"&&a.metadata.owner?[a.metadata.owner]:void 0,url:(null==a?void 0:a.url)||void 0})},eh=b.Ik({query:b.Yj(),n:b.ai().int().optional()}),eb=e=>{var t;let{toolName:a,syncSourceType:n,...l}=e,{input:i,toolResult:r,isStreaming:o,groupItemKey:d}=l,{isExpanded:c,setIsExpanded:u,snappyTransition:m}=(0,V.a)(!1,d),x=(0,U.A)(),f=null==r?void 0:r.is_error,p=f?null:function(e){if(!e)return null;if(e.content.some(e=>"knowledge"===e.type||"rag_reference"===e.type)){let t=[];for(let a of e.content)if("knowledge"===a.type)t.push({uuid:eu(a),knowledge:a});else if("rag_reference"===a.type){let e=a.doc_uuid;t.push({uuid:e})}return eo()(t,e=>e.uuid)}try{let t=e.content[0];if((null==t?void 0:t.type)!=="text")return[];let a=JSON.parse(t.text),s=(Array.isArray(a)?a.map(e=>{let t=g.ey.safeParse(e);return t.success?t.data:null}).filter(e=>null!==e):[]).map(e=>({uuid:eu(e),knowledge:e}));return eo()(s,e=>e.uuid)}catch(e){return[]}}(r),{data:h}=eh.safeParse(i),b="web_search"===a?x.formatMessage({defaultMessage:"Searching the web",id:"5KajyzHSXj"}):x.formatMessage({defaultMessage:"Searching Google Drive",id:"V/QOi0yNF0"});if(!h)return;let v=x.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:null!=(t=null==p?void 0:p.length)?t:0}),j=!p&&o?b:h.query;return(0,s.jsx)(y.sH,{isExpandingDisabled:!!o,isExpanded:c,setIsExpanded:u,isError:f,text:j,secondaryText:o?void 0:v,icon:"web_search"===a?(0,s.jsx)(el.q,{size:16}):!!n&&(0,s.jsx)(en.A9,{type:n,size:14}),...l,children:(0,s.jsx)(y.NG,{isExpanded:c,snappyTransition:m,isScrollable:!0,children:!f&&!!(null==p?void 0:p.length)&&(0,s.jsx)(em,{isExpanded:c,toolName:a,results:p})})})};a(0x18f6e74fb),a(0x1b4b4fb37),a(0x15fe0c6d);var ev=a(0x5ae340a6);b.Ik({prompt:b.Yj()});var ey=a(0x249008d3),ej=a(0x8aef00d0),ew=a(0x24fcf6beb),eN=a(0x17e7bc007);function e_(e){var t,a,n,l;let{input:r,toolResult:o,isStreaming:d,isLastMessage:c,onOpenArtifact:u,message:m,artifactCellType:x,selectedArtifactId:f,selectedArtifactVersion:p,isFirstBlockOfMessage:g,isLastBlockOfMessage:h}=e,b=(0,i.useMemo)(()=>ew.oE.parse(r),[r]),{versions:v,...y}=null!=(n=(0,eN.ST)(null!=(a=b.id)?a:""))?n:{},j=(0,i.useMemo)(()=>{let e=null==v?void 0:v.findIndex(e=>e.uuid===b.version_uuid);if(-1!==e)return e},[v,b.version_uuid]),w=null==(t=null!=(l=b.content)?l:b.new_str)?void 0:t.slice(0,250),N=(0,i.useCallback)(e=>{u&&u(e,m.uuid,b.version_uuid)},[u,m.uuid,b.version_uuid]),_=(0,i.useMemo)(()=>({isClosed:void 0!==o,...y,...b}),[o,y,b]),k=f===_.id&&p===b.version_uuid,M="individual_cell_create"===x||"multi_edit_not_last"!==x;return(0,s.jsx)("div",{className:(0,O.A)(M&&(g?"pt-2":"pt-3"),M&&(h?"pb-2":"pb-3"),"multi_edit_not_last"===x&&"h-0"),children:(0,s.jsx)(ej.d,{versionNum:j?j+1:void 0,preview:w,versionCount:null==v?void 0:v.length,properties:_,isStreaming:d,isEdit:"individual_cell_create"!==x,isNotLastEdit:"multi_edit_not_last"===x,isLastMessage:c,onOpenArtifact:N,isExpanded:k})})}var ek=a(0x4fd5f678),eM=a(0xb2489667),eC=a(0x39be5342),eS=a(0x253a5c787),eA=a(0xde8f44d0);let eE=b.Ik({code:b.Yj().nullish().transform(e=>(null==e?void 0:e.charAt(0))==="\n"?e.slice(1):null!=e?e:void 0)}),eI=e=>{var t;let{input:a,toolResult:n,isStreaming:l,groupItemKey:r}=e,o=(0,U.A)(),{isExpanded:d,setIsExpanded:c,snappyTransition:u}=(0,V.a)(l,r),m=null!=(t=eE.parse(a).code)?t:"",{toolResultLogs:x,toolResultErrors:f}=(0,i.useMemo)(()=>n?(e=>{let t;if(!e.content||0===e.content.length||!e.content[0])return{toolResultLogs:"",toolResultErrors:"Error: Missing content data"};if("text"!==e.content[0].type)return{toolResultLogs:"",toolResultErrors:""};try{t=JSON.parse(e.content[0].text)}catch(e){return(0,eS.Cp)(e,{tags:{source:"repl-tool-result"}}),{toolResultLogs:"",toolResultErrors:"Error: failed to parse Analysis tool result"}}let a=t.logs?"Result\n\n"+t.logs.join("\n"):"";return"error"===t.status?{toolResultLogs:a,toolResultErrors:"Error\n\n"+t.error}:{toolResultLogs:a,toolResultErrors:""}})(n):{toolResultLogs:"",toolResultErrors:""},[n]);return(0,s.jsx)(y.sH,{isExpanded:d,setIsExpanded:c,icon:(0,s.jsx)(eC.N,{size:16,className:"text-text-500"}),text:l?o.formatMessage({defaultMessage:"Analyzing data",id:"UkajfL/9Yh"}):o.formatMessage({defaultMessage:"Analyzed data",id:"NbwDtG2acW"}),secondaryText:l?void 0:o.formatMessage({defaultMessage:"View analysis",id:"fL+Q/8QHAy"}),...e,children:(0,s.jsx)(y.NG,{isExpanded:d,snappyTransition:u,isScrollable:!0,children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:[(0,s.jsx)(eA.z,{language:"javascript",code:m}),(0,s.jsx)(eA.z,{title:o.formatMessage({defaultMessage:"Output",id:"fio5opLcOZ"}),language:"javascript",code:x}),!!f&&(0,s.jsx)(eA.z,{title:o.formatMessage({defaultMessage:"Error",id:"KN7zKn8z4F"}),code:f,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"})]})})})};var eT=a(0x1381f2bb),eL=a(0x18c40ed68);let eR=e=>{let{input:t,message:a,toolUseId:n,...l}=e,{isStreaming:r}=l,o=null==t?void 0:t.description,d=(0,i.useMemo)(()=>(function(e,t){if(!e.content||!t)return 0;let a=0;for(let s of e.content)"tool_use"===s.type&&"_isSubagentBlock"in s&&s._isSubagentBlock&&"_parentToolUseId"in s&&s._parentToolUseId===t&&a++;return a})(a,n),[a,n]),c=o||(0,s.jsx)(m.A,{defaultMessage:"Running task",id:"lLRd2TOJK+"}),u=(0,i.useMemo)(()=>{if(!r&&0!==d)return(0,s.jsx)(m.A,{defaultMessage:"{count, plural, one {# tool use} other {# tool uses}}",id:"EZ05jQyBmI",values:{count:d}})},[r,d]);return(0,s.jsx)(y.aX,{text:c,secondaryText:u,icon:(0,s.jsx)(eT.O,{size:16,children:(0,s.jsx)(eL.d,{size:12,className:"text-text-300"})}),...l})};var eF=a(0x16d07c314),ez=a(0x8f813b9c);let eO=e=>{let{streamingAction:t,errorAction:a,successAction:n,target:l,isStreaming:i=!1,isError:r=!1,description:o}=e;return o&&!r?i?(0,s.jsx)(ez.N,{children:o}):(0,s.jsx)("span",{className:"text-text-200",children:o}):(0,s.jsxs)("span",{className:"flex items-center min-w-0 text-text-200",children:[(0,s.jsx)("span",{className:"whitespace-nowrap mr-1 text-text-200",children:i?t:r?a:n}),(0,s.jsx)("span",{className:"bg-gradient-to-b from-bg-300 via-bg-300/80 to-bg-300 shadow-xs rounded px-1 py-0.5 font-mono truncate overflow-hidden text-ellipsis min-w-0 text-text-200",title:l,children:l})]})},eU=b.Ik({returncode:b.ai().int(),stdout:b.Yj(),stderr:b.Yj()});function eD(e){if(!e.content||0===e.content.length)return null;let t=e.content[0];return(null==t?void 0:t.type)==="text"?t.text:null}let eP=e=>{let{input:t,toolResult:a,isStreaming:n,isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,groupItemKey:d,isFirstItemInGroup:c,isLastItemInGroup:u}=e,m=(0,U.A)(),{isExpanded:x,setIsExpanded:f,snappyTransition:p}=(0,V.a)(!1,d),g=(null==t?void 0:t.command)||"",h=(null==a?void 0:a.is_error)||!1,b=(0,i.useMemo)(()=>(function(e,t,a){if(!e)return;if(t)return{type:"error",rawContent:eD(e)||JSON.stringify(e,null,2)};let s=eD(e);if(!s)return{type:"empty"};try{let e=eU.parse(JSON.parse(s));return{type:"success",data:e}}catch(e){try{let e=JSON.parse(s);if(Array.isArray(e)&&e.length>0&&"text"===e[0].type&&e[0].text){let t=eU.parse(JSON.parse(e[0].text));return{type:"success",data:t}}}catch(e){}return a?void 0:{type:"parse-error",rawContent:s}}})(a,h,n),[a,h,n]),v=null==t?void 0:t.description;return(0,s.jsx)(y.sH,{isExpanded:x,setIsExpanded:f,isStreaming:!!n,icon:(0,s.jsx)(eF.b,{size:16}),text:(0,s.jsx)(eO,{streamingAction:m.formatMessage({defaultMessage:"Running",description:"Status header for a bash command",id:"ScRq37Oq7S"}),errorAction:m.formatMessage({defaultMessage:"Failed to run",description:"Status header for a bash command",id:"O15lx6IwMb"}),successAction:m.formatMessage({defaultMessage:"Ran",description:"Status header for a bash command",id:"JUMXBud/d6"}),target:g,isStreaming:n,isError:h,description:v}),isFirstBlockOfMessage:l,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:c,isLastItemInGroup:u,children:(0,s.jsx)(y.NG,{isExpanded:x,snappyTransition:p,isScrollable:!0,children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:[(0,s.jsx)(eA.z,{language:"bash",code:g}),(()=>{if(!b)return null;switch(b.type){case"success":{let{data:e}=b;return(0,s.jsxs)(s.Fragment,{children:[e.stdout&&(0,s.jsx)(eA.z,{title:m.formatMessage({defaultMessage:"Output",description:"Title for the result of a bash command",id:"98/B4gW/HL"}),language:"bash",code:e.stdout}),e.stderr&&(0,s.jsx)(eA.z,{title:m.formatMessage({defaultMessage:"Error",description:"Title for the result of a bash command",id:"96iMiC11cz"}),code:e.stderr,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"}),!e.stdout&&!e.stderr&&(0,s.jsx)(eA.z,{title:m.formatMessage({defaultMessage:"Output",description:"Title for the result of a bash command",id:"98/B4gW/HL"}),code:m.formatMessage({defaultMessage:"exit code {returncode}",description:"The result of a bash command",id:"Uoe/PEvNYN"},{returncode:e.returncode})})]})}case"error":return(0,s.jsx)(eA.z,{title:m.formatMessage({defaultMessage:"Command failed",description:"Title for the result of a bash command",id:"REMG+p+ZiU"}),code:b.rawContent,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"});case"parse-error":return(0,s.jsx)(eA.z,{title:m.formatMessage({defaultMessage:"Output",description:"Title for the result of a bash command",id:"98/B4gW/HL"}),code:b.rawContent,codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"});case"empty":return(0,s.jsx)(eA.z,{title:m.formatMessage({defaultMessage:"No output",description:"Title for the result of a bash command",id:"DyoXiEr2fN"}),code:m.formatMessage({defaultMessage:"Command completed with no output",description:"The result of a bash command",id:"TRBc7KuuG+"})});default:return null}})()]})})})};var eB=a(0x2202d81f6),eG=a(0xbca8e388),eW=a(0x1fa9af01),eq=a(0xec9172c1),eH=a(0x16801a2b9),eY=a(0x14a7c225d),eV=a(0x16a96a9a2);let eJ=e=>{var t,a;let{input:n,toolResult:l,isStreaming:i,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:d,groupItemKey:c,isFirstItemInGroup:u,isLastItemInGroup:m,message:x,shareType:f}=e,{chatResourceState:p,dispatchChatResource:g}=(0,eH.i)(),{setIsDrawerExpanded:h}=(0,eq.x)(),b=null==l?void 0:l.is_error,v=null!=(t=null==n?void 0:n.path)?t:"",j=p.streamingFiles.get(v),w=(null==j?void 0:j.showingInRightPane)&&(null==j?void 0:j.renderAs)===ew.vU.Markdown,{isExpanded:N,setIsExpanded:_,snappyTransition:k}=(0,V.a)(!w&&i,c),M=null!=(a=null==n?void 0:n.file_text)?a:"",C=(0,eY.S)(v),S="markdown"===C,A=(0,eV.W)(v),E=v.split("/").pop()||v,I=null==n?void 0:n.description,T=!b&&v&&(null==x?void 0:x.uuid)&&(0,eV.m)(v,f),L=T&&!f;return!(w&&i)&&(i||N||!k)?(0,s.jsx)(y.sH,{isExpanded:N,setIsExpanded:_,isExpandingDisabled:i,isStreaming:!!i,icon:(0,s.jsx)(eY.o,{path:(null==n?void 0:n.path)||"",size:16}),text:(0,s.jsx)(eO,{streamingAction:"Creating",errorAction:"Failed to create",successAction:"Created",target:A,isStreaming:i,isError:b,description:I}),secondaryIcon:L?(0,s.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:E}):void 0,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:d,isFirstItemInGroup:u,isLastItemInGroup:m,children:(0,s.jsx)(y.NG,{isExpanded:N,snappyTransition:k,children:(0,s.jsx)(eW.Z,{noDefaultScroll:!i,className:"flex flex-col gap-3 p-3 pt-1 max-h-[238px] overflow-y-scroll",disabled:!1,children:(0,s.jsx)("div",{"data-testid":"repl-output",children:M&&(S&&!w?(0,s.jsx)("div",{className:"markdown-wrapper",children:i?(0,s.jsx)(eB.qO,{text:M,className:"font-claude-response prose prose-sm max-w-none",isStreaming:!0}):(0,s.jsx)(eG.fP,{text:M,className:"font-claude-response prose prose-sm max-w-none"})}):(0,s.jsx)(eA.z,{title:v,language:C,code:M}))})})})}):(0,s.jsx)(y.aX,{isStreaming:!!i,handleClick:T?()=>{v&&(null==x?void 0:x.uuid)&&(g({type:"SELECT_FILE",path:v,toolType:"create_file",messageId:x.uuid}),h(!0))}:void 0,icon:(0,s.jsx)(eY.o,{path:(null==n?void 0:n.path)||"",size:16}),text:(0,s.jsx)(eO,{streamingAction:"Creating",errorAction:"Failed to create",successAction:"Created",target:A,isStreaming:i,isError:b,description:I}),secondaryIcon:L?(0,s.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:E}):void 0,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:d,isFirstItemInGroup:u,isLastItemInGroup:m})};var eK=a(0xf0b8fe63);let eX=e=>{var t,a;let{toolResult:n,isStreaming:l,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:d,isLastItemInGroup:c,message:u}=e,{dispatchChatResource:m}=(0,eH.i)(),{setIsDrawerExpanded:x}=(0,eq.x)(),f=(null==n?void 0:n.message)||(l?"Presenting file(s)...":"Presented file(s)"),p=null==n||null==(a=n.content)||null==(t=a.find(e=>"local_resource"===e.type))?void 0:t.file_path;return(0,s.jsx)(y.aX,{text:f,icon:(0,s.jsx)(eK.i,{size:20}),isStreaming:null!=l&&l,isFirstBlockOfMessage:null!=i&&i,isLastBlockOfMessage:null!=r&&r,renderMode:o,isFirstItemInGroup:d,isLastItemInGroup:c,handleClick:p?()=>{p&&(null==u?void 0:u.uuid)&&(m({type:"SELECT_FILE",path:p,toolType:"present_files",messageId:u.uuid}),x(!0))}:void 0})};var e$=a(0x206efe2ad);let eQ=i.memo(e=>{let{oldStr:t="",newStr:a="",isStreaming:n=!1}=e,{linesAdded:l,linesRemoved:r}=(0,i.useMemo)(()=>{let e=t?t.split("\n").length:0;return{linesAdded:a?a.split("\n").length:0,linesRemoved:e}},[t,a]),o=(0,i.useMemo)(()=>{let e=[];return l>0&&e.push("".concat(l," ").concat(1===l?"line":"lines"," added")),r>0&&e.push("".concat(r," ").concat(1===r?"line":"lines"," removed")),e.join(", ")},[l,r]);if(0===l&&0===r)return null;let d=(0,s.jsxs)("span",{className:"flex items-center gap-1.5 text-xs font-mono mr-2 border-0.5 border-border-300 rounded px-1 py-0.5",children:[l>0&&(0,s.jsx)("span",{className:"text-forest-green",children:"+".concat(l)}),r>0&&(0,s.jsx)("span",{className:"text-danger-000",children:"-".concat(r)})]}),c=n?(0,s.jsx)(ez.N,{children:d}):d;return(0,s.jsx)(L.m,{tooltipContent:o,align:"center",children:(0,s.jsx)("span",{className:"inline-flex",children:c})})});eQ.displayName="LineDiffCounter";let eZ=e=>{var t;let{input:a,toolResult:n,isStreaming:l,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:d,isLastItemInGroup:c,message:u,shareType:m}=e,{dispatchChatResource:x}=(0,eH.i)(),{setIsDrawerExpanded:f}=(0,eq.x)(),p=null==n?void 0:n.is_error,g=null!=(t=null==a?void 0:a.path)?t:"",h=(0,eV.W)(g),b=null==a?void 0:a.description,v=g.split("/").pop()||g,j=!p&&g&&(null==u?void 0:u.uuid)&&(0,eV.m)(g,m);return(0,s.jsx)(y.aX,{isStreaming:!!l,handleClick:j?()=>{g&&(null==u?void 0:u.uuid)&&(x({type:"SELECT_FILE",path:g,toolType:"str_replace",messageId:u.uuid}),f(!0))}:void 0,icon:(0,s.jsx)(e$.I,{size:16,className:"text-text-500"}),text:(0,s.jsx)(eO,{streamingAction:"Editing",errorAction:"Failed to edit",successAction:"Edited",target:h,isStreaming:l,isError:p,description:b}),secondaryIcon:(0,s.jsxs)(s.Fragment,{children:[!p&&(0,s.jsx)(eQ,{oldStr:null==a?void 0:a.old_str,newStr:null==a?void 0:a.new_str,isStreaming:l}),j&&!m&&(0,s.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:v})]}),isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:d,isLastItemInGroup:c})};function e0(e){let{toolResult:t,fileSyntax:a}=e,{activeOrganization:n}=(0,_.YL)(),l=null==n?void 0:n.uuid;try{var i;if(t.content&&t.content.length>0&&(null==(i=t.content[0])?void 0:i.type)==="text"){let e=t.content[0].text;try{let a=JSON.parse(e);Array.isArray(a)&&(t.content=a)}catch(e){}}if(!t.content||0===t.content.length||!t.content[0])return(0,s.jsx)(s.Fragment,{});return(0,s.jsx)(s.Fragment,{children:t.content.map((e,t)=>"text"===e.type?(0,s.jsx)(eA.z,{language:a,code:e.text},t):"image"===e.type?(0,s.jsx)("img",{alt:"",src:"/api/".concat(l,"/files/").concat(e.file_uuid,"/preview"),className:"max-w-md max-h-md h-auto rounded-md"},t):null)})}catch(e){return(0,s.jsx)(eA.z,{title:"Error displaying content - Raw result:",code:JSON.stringify(t,null,2),codeTagProps:{className:"text-danger-000"},className:"!bg-danger-900"})}}let e1=e=>{let{path:t}=e,a=t.split("/"),n=a.indexOf("skills"),l=a[n+1]||"";return(0,s.jsx)("span",{className:"flex items-center min-w-0 text-text-200 overflow-hidden",children:(0,s.jsx)("span",{className:"whitespace-nowrap text-text-200",children:(0,s.jsx)(m.A,{defaultMessage:"Loading {skill} skill",id:"b2eRiWSxS0",values:{skill:l}})})})},e2=e=>{var t;let{input:a,toolResult:n,isStreaming:l,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,groupItemKey:d,isFirstItemInGroup:c,isLastItemInGroup:u,message:x,shareType:f}=e,{isExpanded:p,setIsExpanded:g,snappyTransition:h}=(0,V.a)(!1,d),{dispatchChatResource:b}=(0,eH.i)(),{setIsDrawerExpanded:v}=(0,eq.x)(),j=null==n?void 0:n.is_error,w=null!=(t=null==a?void 0:a.path)?t:"",N=(0,eY.S)(w),_=/\.[^/]+$/.test(w),k=w.includes("/mnt/skills/"),M=(0,eV.W)(w),C=null==a?void 0:a.description,S=w.split("/").pop()||w,A=!j&&w&&(null==x?void 0:x.uuid)&&(0,eV.m)(w,f),E=A&&!f&&!k;return _?(0,s.jsx)(y.aX,{isStreaming:!!l,handleClick:A&&!k?()=>{w&&(null==x?void 0:x.uuid)&&(b({type:"SELECT_FILE",path:w,toolType:"view",messageId:x.uuid}),v(!0))}:void 0,isDisabled:k,icon:(0,s.jsx)(eY.o,{path:(null==a?void 0:a.path)||"",size:16}),text:k&&!C?(0,s.jsx)(e1,{path:w}):(0,s.jsx)(eO,{streamingAction:"Viewing",errorAction:"Failed to view",successAction:"Viewed",target:M,isStreaming:l,isError:j,description:C}),secondaryIcon:E?(0,s.jsx)("span",{className:"text-xs text-text-300 max-w-64 truncate shrink-0 min-w-0",children:l?S:(0,s.jsx)(m.A,{defaultMessage:"Show working file",id:"qucjoSGi3N"})}):void 0,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:c,isLastItemInGroup:u}):(0,s.jsx)(y.sH,{isExpanded:p,setIsExpanded:g,isStreaming:!!l,icon:(0,s.jsx)(eY.o,{path:(null==a?void 0:a.path)||"",size:16}),text:k&&!C?(0,s.jsx)(e1,{path:w}):(0,s.jsx)(eO,{streamingAction:"Viewing",errorAction:"Failed to view",successAction:"Viewed",target:M,isStreaming:l,isError:j,description:C}),isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:o,isFirstItemInGroup:c,isLastItemInGroup:u,isExpandingDisabled:!n,children:(0,s.jsx)(y.NG,{isExpanded:p,snappyTransition:h,isScrollable:!0,children:(0,s.jsx)("div",{className:"flex flex-col gap-3 p-3 pt-1","data-testid":"repl-output",children:n&&(0,s.jsx)(e0,{toolResult:n,fileSyntax:N,isStreaming:l})})})})},e5=i.memo(e=>{let{toolUseId:t,isLastMessage:a,isStreaming:u,toolName:m,input:f,message:p,onOpenArtifact:g,toolResult:h,artifactCellType:b,isFirstBlockOfMessage:v,isLastBlockOfMessage:y,conversationUuid:j,selectedDrawerItem:N,shareType:_,displayData:k,approvalData:M,mcpAuthRequired:C,context:S,renderMode:A=ey.l.Standard,groupItemKey:E,isFirstItemInGroup:I,isLastItemInGroup:T,autoscrollRef:L,isSessionChat:R,toolPermissionRequests:F,onToolDecision:z}=e,O=(0,r.fb)(),U=(0,c.be)();(0,n.fS)("prism_enabled");let D=(0,d.Ho)(),P={input:f,toolResult:h,isStreaming:u,isFirstBlockOfMessage:v,isLastBlockOfMessage:y,renderMode:A,groupItemKey:E,isFirstItemInGroup:I,isLastItemInGroup:T,message:p,shareType:_,autoscrollRef:L,isSessionChat:R,mcpAuthRequired:C},B=(0,i.useMemo)(()=>null==F?void 0:F.find(e=>"AskUserQuestion"===e.toolName),[F]),G=(0,i.useCallback)((e,a)=>{if(!B||!z)return;let s={questions:a.questions,answers:e};z(B.toolUseId,t,s,"once")},[B,z,t]),W={bash_tool:eP,create_file:eJ,present_files:eX,view:e2,str_replace:eZ}[m];if(W)return(0,s.jsx)(W,{...P});switch(m){case"Task":return(0,s.jsx)(eR,{...P,toolUseId:t,input:f});case"AskUserQuestion":return(0,s.jsx)(ek.w,{input:f,onAnswersSubmit:B&&z?G:void 0})}if("end_conversation"===m)return(0,s.jsx)(x,{});let q=(null==N?void 0:N.type)==="artifact"?N:void 0,Y=!!h&&!!N&&"compass"===N.type&&N.data.toolUseId===h.tool_use_id;switch(m){case"artifacts":return(0,s.jsx)(e_,{input:f,toolResult:h,isLastMessage:a,isStreaming:u,onOpenArtifact:g,message:p,artifactCellType:b,selectedArtifactId:null==q?void 0:q.id,selectedArtifactVersion:null==q?void 0:q.versionUuid,isFirstBlockOfMessage:v,isLastBlockOfMessage:y});case"repl":return(0,s.jsx)(eI,{...P});case"drive_search":if(!O)break;return(0,s.jsx)(eb,{syncSourceType:l.v8.GDRIVE,toolName:m,...P});case"web_search":if(!U)break;return(0,s.jsx)(eb,{toolName:m,...P});case"web_fetch":return(0,s.jsx)(w,{...P});case"launch_extended_search_task":return(0,s.jsx)(ev.wD,{toolUseId:t,isFirstBlockOfMessage:v,isLastBlockOfMessage:y,conversationUuid:j,toolResult:h,isShared:!!_,isExpanded:Y,isStreaming:u,context:S})}let V=(0,o.tg)(m);if(D){let e=(0,d.Gt)(m);if(e)return(0,s.jsx)(et,{toolName:e.toolName,serverUuid:e.serverUuid,conversationUuid:j,toolUseId:t,approvalData:M,...P})}return!V&&(null==k?void 0:k.integrationName)?(0,s.jsx)(eM.K,{...k,toolName:m,isError:null==h?void 0:h.is_error,isStreaming:u,isFirstBlockOfMessage:v,isLastBlockOfMessage:y,renderMode:A,groupItemKey:E,isFirstItemInGroup:I,isLastItemInGroup:T}):(0,s.jsx)(H.d,{toolName:m,toolMessage:null==k?void 0:k.toolMessage,integrationName:null==k?void 0:k.integrationName,integrationIcon:null==k?void 0:k.integrationIcon,approvalData:M,...P})});e5.displayName="ToolUseCell"},0x965113a9:(e,t,a)=>{"use strict";a.d(t,{d:()=>n});var s=a(0x46988392);function n(e){let t=s.c9.now(),a=s.c9.fromISO(e),n=a.diff(t,"minutes").toObject().minutes;return n&&1>=Math.abs(n)?"just now":a.toRelative()}},0x9f889a90:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(0x30e48ce2);function n(e){let t;try{t=JSON.parse(e)}catch(a){try{let a=(0,s.m)(e);t=JSON.parse(a)}catch(e){}}return t}},0xb2489667:(e,t,a)=>{"use strict";a.d(t,{K:()=>g,r:()=>b});var s=a(0x22102fd88),n=a(0x865afcc2),l=a(0x19c88845),i=a(0x1b813d90),r=a(0x1a1f6dda6),o=a(0x18c2bb2d),d=a(0xfc89b4a4),c=a(0x1ab0d1ca1),u=a(0x1037073d3),m=a(0x37979d5f),x=a(0xde8f44d0),f=a(0x1e140f433),p=a(0x1f7748bd);function g(e){var t,a,n;let l,{integrationName:i,icon:r,integrationIcon:o,message:d,result:u,isStreaming:m,isError:x,isExpandingDisabled:g,isFirstBlockOfMessage:h,isLastBlockOfMessage:w,wrapperClassName:N,contentClassName:_,defaultExpanded:k=!1,toolName:M,renderMode:C,groupItemKey:S,isFirstItemInGroup:A,isLastItemInGroup:E}=e,I=(0,c.A)(),{isExpanded:T,setIsExpanded:L}=(0,p.a)(k,S),R=!!u&&!g&&!m&&("rich_content"!==u.type||(null==(t=u.content)?void 0:t.length)>0);return l=u?"rich_content"===u.type?I.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:null!=(n=null==(a=u.content)?void 0:a.length)?n:0}):"JSON":void 0,(0,s.jsx)(f.sH,{isError:x,isExpandingDisabled:!R,isExpanded:T,setIsExpanded:L,isStreaming:!!m,text:null!=d?d:m?I.formatMessage({defaultMessage:"Searching",id:"IfE0if3ytt"}):I.formatMessage({defaultMessage:"Searched",id:"0ZuuhwjU4n"}),secondaryText:m?void 0:l,icon:r||(0,s.jsx)(b,{integrationName:i,iconUrl:o,canShowLetterIcon:!0}),isFirstBlockOfMessage:h,isLastBlockOfMessage:w,wrapperClassName:N,renderMode:C,isFirstItemInGroup:A,isLastItemInGroup:E,children:(0,s.jsxs)(f.NG,{isExpanded:T,snappyTransition:!0,isScrollable:!0,className:_,children:[R&&(null==u?void 0:u.type)==="rich_content"&&(0,s.jsx)(v,{disabled:!T||m,result:u,integrationName:i,toolName:M}),R&&(null==u?void 0:u.type)==="table"&&(0,s.jsx)(y,{result:u}),R&&(null==u?void 0:u.type)==="json_block"&&(0,s.jsx)(j,{result:u})]})})}let h=["Google Calendar","Gmail","Google Drive","Search Project Knowledge","Search Past Conversations"],b=e=>{let t,{canShowLetterIcon:a,integrationName:n,toolName:r,iconUrl:o,size:d=16}=e;switch(n){case"Search Project Knowledge":return(0,s.jsx)(l.Projects,{vectorSizeOverride:d});case"Memory":case"Search Past Conversations":return(0,s.jsx)(l.Memory,{vectorSizeOverride:d});case"Google Drive":t=i.v8.GDRIVE;break;case"Google Calendar":t=i.v8.GCAL;break;case"Gmail":t=i.v8.GMAIL}let c=n||r;return(0,s.jsx)(u.z,{size:d,name:c,...t?{type:"syncSource",src:t}:{type:"favicon",src:o,fallbackToGlobe:!(c&&a)}})},v=e=>{let{disabled:t,integrationName:a,result:l,toolName:i}=e,r=i?i.split("").reduce((e,t)=>e+t.charCodeAt(0),0):0,d=!!a&&h.includes(a)&&2039!==r&&2010!==r;if("Search Past Conversations"===a){let e=l.content.map(e=>{let{title:t,subtitles:n,url:l,icon_url:i}=e;if(l){let e=l.match(/\/chat\/([a-f0-9-]+)/);if(e)return{conversationUuid:e[1],title:t,subtitles:n,url:l,icon:d?void 0:(0,s.jsx)(b,{integrationName:a,iconUrl:i})}}return null}).filter(e=>null!==e);return(0,s.jsx)(m.g,{results:e,disabled:t,integrationName:a,hideIcons:d})}return(0,s.jsx)(o.P.div,{variants:{initial:{opacity:0},animate:{opacity:1,transition:{staggerChildren:.05}}},initial:"initial",animate:"animate",className:"flex flex-col flex-nowrap p-2 pt-0",children:l.content.map((e,l)=>{let{title:i,subtitles:r,url:o,resource_type:c,icon_url:u}=e;return(0,s.jsx)(n.$,{disabled:t,icon:d?void 0:(0,s.jsx)(b,{integrationName:a,iconUrl:u}),title:i,subtitles:r,url:o,tag:c},l)})})},y=e=>{let{result:t}=e;return(0,s.jsx)(w,{table:t.table})},j=e=>{let{result:t}=e,a=(0,c.A)();return(0,s.jsx)("div",{className:"flex flex-col gap-3 p-3 pt-1",children:(0,s.jsx)(x.z,{title:a.formatMessage({defaultMessage:"Response",id:"MgdnPiJHcj"}),code:t.json_block})})},w=e=>{let{table:t}=e;return(0,s.jsx)("div",{className:"grid p-2 pt-0",style:{gridTemplateColumns:"1fr 2fr"},children:t.map((e,a)=>{let[n,l]=e;return(0,s.jsxs)(d.Fragment,{children:[(0,s.jsx)("div",{className:(0,r.A)("flex items-center p-2",a<t.length-1&&"border-b-0.5 border-border-300"),children:(0,s.jsx)("p",{className:"font-medium text-text-300 text-xs",children:n})}),(0,s.jsx)("div",{className:(0,r.A)("flex items-center p-2",a<t.length-1&&"border-b-0.5 border-border-300"),children:(0,s.jsx)("p",{className:"text-text-500 text-xs",children:l})})]},a)})})}},0xbac8f8ca:(e,t,a)=>{"use strict";a.d(t,{as:()=>z});var s=a(0x22102fd88),n=a(0x253ff6d66),l=a(0x1ce8093a4),i=a(0x209ff4fac),r=a(0x11307af4f),o=a(0xbca8e388),d=a(0x236236dc),c=a(0x1f725a926),u=a(0x21870d616),m=a(0x225bae024),x=a(0x14023fbb8),f=a(0x1fa9af01),p=a(0x24fcf6beb),g=a(0x1a1f6dda6),h=a(0xcaa21d58),b=a(0xfc89b4a4),v=a(0x38e6572),y=a(0x239a63c1c),j=a(0x20d6272f9),w=a(0x18ca729ac),N=a(0xb3796c53),_=a(0x19c88845),k=a(0x23b9f35d7),M=a.n(k),C=a(0x1ab0d1ca1);function S(e){let{children:t}=e;return(0,s.jsx)("h3",{className:"font-small text-text-500 mb-3",children:t})}let A=(0,b.memo)(e=>{let{parsedContent:t}=e,{description:a,otherFields:n,content:l}=t,i=(0,C.A)();return(0,s.jsxs)("div",{className:"mx-auto w-full max-w-3xl leading-[1.65rem] px-6 py-4 md:py-6 md:px-11",children:[a&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-0.5 mb-3",children:[(0,s.jsx)("h3",{className:"font-small text-text-500",children:(0,s.jsx)(v.A,{defaultMessage:"Description",id:"Q8Qw5BZ1VA"})}),(0,s.jsx)(N.Tooltip,{tooltipContent:i.formatMessage({defaultMessage:"Claude uses these descriptions when deciding which skills to use in chat.",id:"g08yMBD/54"}),children:(0,s.jsx)("span",{className:"inline-flex cursor-default",children:(0,s.jsx)(_.Info,{className:"w-4 h-4 text-text-500"})})})]}),(0,s.jsx)(o.fP,{text:a,className:"font-claude-response",chatUiCore:!0})]}),n.length>0&&(0,s.jsx)("div",{className:"flex flex-col md:flex-row md:flex-wrap gap-x-12 gap-y-6 mt-6",children:n.map((e,t)=>{let{key:a,value:l}=e;return(0,s.jsxs)("div",{className:n.length>=3?"md:min-w-40 flex-auto":"",children:[(0,s.jsx)(S,{children:M()(a.replaceAll("-"," "))}),(0,s.jsx)("p",{className:"text-text-100",children:l})]},"".concat(a,"-").concat(t))})}),(a||n.length>0)&&(0,s.jsx)("hr",{className:"border-border-300 my-8"}),(0,s.jsx)(S,{children:(0,s.jsx)(v.A,{defaultMessage:"Contents",id:"MyIJbrHxpk"})}),(0,s.jsx)(o.fP,{text:l,className:"font-claude-response",normalizationMode:"markdown-document",chatUiCore:!0})]})});A.displayName="SkillMdContent";let E=()=>(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(x.R,{size:"md"})}),I=e=>{let{error:t,onRetry:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-text-300 gap-4",children:[(0,s.jsx)("div",{children:t}),a&&(0,s.jsx)(m.$,{variant:"secondary",size:"sm",onClick:a,children:(0,s.jsx)(v.A,{defaultMessage:"Try again",id:"FazwRldA7z"})})]})},T=e=>{let{fileName:t}=e,{displayName:a,displayExt:n}=(0,j.FT)(t);return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(u.ObjectDocument,{})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-text-100 font-medium text-lg",children:a}),n&&(0,s.jsx)("div",{className:"text-text-300 text-sm",children:n})]}),(0,s.jsx)("div",{className:"text-text-300",children:(0,s.jsx)(v.A,{defaultMessage:"No preview available",id:"vYALkaFo+6"})})]})},L=e=>{let{content:t,language:a,displayFileType:i,showRaw:r,richSandboxRef:d,onSandboxConfirmation:c,richSandboxCapabilities:u,fileName:m,onRefresh:g,mimeType:y,artifactContext:j,ArtifactMcpModal:N}=e;if("image"===i){if(!(t instanceof Blob))throw Error('displayFileType is "image" but content is not Blob')}else if("rich"===i){if("string"!=typeof t&&!(t instanceof ArrayBuffer))throw Error('displayFileType is "rich" but content is not string or ArrayBuffer')}else if("string"!=typeof t)throw Error('displayFileType is "'.concat(i,'" but content is not a string'));let[_,k]=(0,b.useState)(null),[M,C]=(0,b.useState)(!0),[S,E]=(0,b.useState)(!1),[I,T]=(0,b.useState)(null),L=(0,b.useMemo)(()=>"SKILL.md"===m&&"string"==typeof t?(0,w._H)(t):null,[m,t]);b.useEffect(()=>{t&&"rich"===i&&!S&&C(!0)},[t,i,S]);let R=(0,b.useCallback)((e,t)=>{if("json"===t&&e)try{let t=JSON.parse(e);return JSON.stringify(t,null,2)}catch(e){}return e},[]),z=(0,b.useCallback)(e=>{k({error:e,artifactId:m,artifactVersion:0})},[m]),O=(0,b.useCallback)(()=>{k(null)},[]),U=(0,b.useCallback)(()=>{k(null),null==g||g()},[g]),D=(0,b.useRef)(null),P=y||("rich"===i?p.vU.Html:void 0),B="rich"===i&&!r&&void 0!==P;return(0,b.useEffect)(()=>{if("image"===i){let e=URL.createObjectURL(t);return T(e),()=>{URL.revokeObjectURL(e)}}T(null)},[t,i]),(0,s.jsxs)(s.Fragment,{children:[B&&(0,s.jsxs)("div",{className:"h-full w-full relative border-none",children:[M&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-20",children:(0,s.jsx)(x.R,{size:"md"})}),(0,s.jsx)(l.A,{ref:d,className:"h-full w-full border-none bg-bg-000",content:t,type:P,onSandboxConfirmation:()=>{C(!1),E(!0),null==c||c()},capabilities:u,onReportError:z,onSetContent:O,onRefresh:U,externalLinkBehavior:"ask",artifactContext:j,ArtifactMcpModal:N}),_&&(0,s.jsx)(n.i,{error:_,handleClose:()=>k(null),isStreaming:!1})]}),("code"===i||r)&&(0,s.jsx)("div",{className:"relative h-full",children:(0,s.jsx)(f.Z,{ref:D,className:"absolute inset-0 overflow-auto",children:"markdown"!==a||r||null===L?(0,s.jsx)("div",{tabIndex:0,id:"wiggle-file-content",className:"markdown"!==a&&"plaintext"!==a||r?"":"mx-auto w-full max-w-3xl leading-[1.65rem] px-6 py-4 md:py-6 md:px-11",children:"markdown"!==a||r?(0,s.jsx)(F,{content:R(t,a),language:a,showLineNumbers:"plaintext"!==a&&!r,wrapLongLines:"plaintext"===a||r}):(0,s.jsx)(o.fP,{text:t,className:"font-claude-response",normalizationMode:"markdown-document",chatUiCore:!0})}):(0,s.jsx)(A,{parsedContent:L})})}),"image"===i&&I&&(0,s.jsx)("div",{className:"h-full p-5",children:(0,s.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,s.jsx)(h.default,{src:I,alt:m,width:0,height:0,sizes:"100vw",className:"w-auto h-auto max-w-full max-h-full object-contain"})})}),"nonrenderable"===i&&(0,s.jsx)("div",{className:"flex items-start justify-center h-full pt-12 text-text-300",children:(0,s.jsx)(v.A,{defaultMessage:"File type cannot be displayed",id:"AZLJvXC/bK"})})]})},R="code-block__code !my-0 flex-1 w-fit min-w-full !rounded-none !text-sm !leading-relaxed [&_.linenumber]:!not-italic",F=e=>{let{content:t,language:a,showLineNumbers:n,wrapLongLines:l}=e,{codeStyle:o}=(0,d.V)(),{exceedsSizeLimit:u}=(0,c.y)(t);return u?(0,s.jsx)(i.R,{code:t,codeClassName:(0,g.A)(R,"p-4")}):(0,s.jsx)(y.A,{className:R,language:a,PreTag:"div",style:o,renderer:r.G,showLineNumbers:n,wrapLongLines:l,lineNumberStyle:{opacity:.667,minWidth:"2.5rem"},children:t})},z=e=>{let{isLoading:t,error:a,onRetry:n,content:l,displayFileType:i,fileName:r,...o}=e;return t&&!l?(0,s.jsx)(E,{}):a?(0,s.jsx)(I,{error:a,onRetry:n}):"nonrenderable"===i?(0,s.jsx)(T,{fileName:r}):void 0===l?null:(0,s.jsx)("div",{className:"h-full",children:(0,s.jsx)(L,{content:l,displayFileType:i,fileName:r,...o})})}},0xbe2d73b0:(e,t,a)=>{"use strict";a.d(t,{W:()=>n});var s=a(0xfc89b4a4);function n(e,t,a){let n=(0,s.useRef)(void 0),l=(0,s.useCallback)(e,t),i=(0,s.useCallback)(()=>{n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(l,a)},[l,a]);return(0,s.useEffect)(()=>(i(),()=>{n.current&&window.clearTimeout(n.current)}),[...t,l,a]),i}},0xce58ec20:(e,t,a)=>{"use strict";function s(e,t,a){return"share"===e?"".concat(window.location.origin,"/artifacts/").concat(t.artifact_version_uuid):"publish"===e&&t.published_artifact_uuid?"".concat(a,"/public/artifacts/").concat(t.published_artifact_uuid):void 0}a.d(t,{x:()=>s})},0xd3117c3a:(e,t,a)=>{"use strict";a.d(t,{k:()=>n});var s=a(0x24fcf6beb);function n(e){let{filePath:t,isShared:a,conversationUuid:n,snapshotUuid:l,source:i}=e,r=t.replace("computer://",""),o=t.split(".").pop()||"";return{file_id:function(e){let t=e.replace("computer://",""),a=5381;for(let e=0;e<t.length;e++)a=(a<<5)+a+t.charCodeAt(e);return Math.abs(a).toString(16)}(t),file_extension:o,is_snapshot:a,is_viewable_file:(0,s.IO)(t),is_output_file:r.startsWith("/mnt/user-data/outputs/"),conversation_uuid:a?null:n||null,snapshot_uuid:a&&l||null,source:i}}},0xd4b9b976:(e,t,a)=>{"use strict";a.d(t,{u:()=>i});var s=a(0x1da5efa06),n=a(0xe0e96db4),l=a(0x26a67dfc);function i(e){let t=e.trim();return(0,s.yt)(t,{extensions:[(0,n.x)()],htmlExtensions:[(0,l.k)()]})}},0xde8f44d0:(e,t,a)=>{"use strict";a.d(t,{z:()=>c});var s=a(0x22102fd88),n=a(0x209ff4fac),l=a(0x11307af4f),i=a(0x236236dc),r=a(0x1f725a926),o=a(0x1a1f6dda6),d=a(0x239a63c1c);let c=e=>{let{className:t,code:a,codeTagProps:c,language:m,title:x}=e,{codeStyle:f}=(0,i.V)(),{exceedsSizeLimit:p}=(0,r.y)(a),g="code-block__code !my-0 !p-0 !rounded-none !text-sm !leading-relaxed";return(0,s.jsxs)("div",{className:(0,o.A)("flex flex-col gap-3 p-3 bg-bg-100 rounded-md",t),children:[(0,s.jsx)(u,{language:m,title:x}),p?(0,s.jsx)(n.R,{code:a,codeClassName:(0,o.A)(g,"-px-3")}):(0,s.jsx)(d.A,{className:g,codeTagProps:c,language:m,PreTag:"div",style:f,renderer:l.G,wrapLongLines:!0,children:a})]})},u=e=>{let{language:t,title:a}=e;return(0,s.jsx)("div",{className:"flex justify-between items-center h-3",children:(0,s.jsx)("p",{className:(0,o.A)("text-text-300 text-[0.6875rem]",a?"font-ui font-medium":"font-mono font-[450]"),children:a||t})})}},0xeac7cde8:(e,t,a)=>{"use strict";a.d(t,{g:()=>av,v:()=>ab});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x209960a1a),i=a(0x1139502dd),r=a(0x164c6313f),o=a(0x209ab1f87),d=a(0x20805e624),c=a(0x226530adf),u=a(0x145d45a),m=a(0x14a6d5f1),x=a(0x1809b01ca),f=a(0x1065e6d73),p=a(0x14de19ae8),g=a(0x371cc700),h=a(0xc288ff4d),b=a(0x1b370f49d),v=a(0xac309a83),y=a(0x17f3a2521),j=a(0x1bd175d8c),w=a(0x1457b343f),N=a(0x1a1f6dda6),_=a(0x160045b25),k=a(0xc6536c20),M=a(0x17b9b473e),C=a(0xef41e510),S=a.n(C),A=a(0x4d348f95),E=a(0xfc89b4a4),I=a(0x38e6572),T=a(0x1ab0d1ca1),L=a(0x156c4e43b),R=a(0xb6b8b1fb),F=a(0x11af11324),z=a(0x22be9474c),O=a(0xbebfc702),U=a(0x62563c7),D=a(0x213592df7),P=a(0xd5e0c33c),B=a(0x7050c941),G=a(0x20b1f5782);let W=()=>{let e=(0,v.fS)("chat-ui-core");return(0,s.jsxs)("div",{className:"animate-pulse flex flex-col gap-8 fade-out-bottom h-[calc(100vh-12.5rem)]",children:[e?(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("div",{className:"bg-bg-300 rounded-xl px-4 py-2.5 w-48 h-[46px]"})}):(0,s.jsx)("div",{className:"group relative inline-flex gap-2 bg-bg-300 rounded-xl pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-col",children:(0,s.jsx)("div",{className:(0,N.A)("rounded-full h-7 w-7 bg-text-200 opacity-40")})}),e?(0,s.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-11/12 opacity-100"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-10/12 opacity-90"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-11/12 opacity-80"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-9/12 opacity-70"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-10/12 opacity-60"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-11/12 opacity-50"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-8/12 opacity-40"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-10/12 opacity-30"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-9/12 opacity-20"}),(0,s.jsx)("div",{className:"h-4 rounded-md bg-bg-300 w-4/12 opacity-10"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-10/12"}),(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-4/12"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-10/12"}),(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-9/12"}),(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-11/12"}),(0,s.jsx)("div",{className:"h-4 rounded-sm bg-bg-300 w-4/12"})]})]})]})},q=e=>{let{notificationPermission:t,enableNotifications:a,isFeatureEnabled:n=!0,visible:l=!0}=e,[i,r]=(0,E.useState)(!1);return(0,E.useEffect)(()=>{l?requestAnimationFrame(()=>{r(!0)}):r(!1)},[l]),(0,s.jsx)("div",{className:(0,N.A)("inline-block select-none text-text-300 transition-opacity relative -top-4",i?"opacity-100 delay-300 duration-700":"opacity-0 duration-0"),children:"granted"===t&&n?(0,s.jsx)(I.A,{defaultMessage:"Claude is working on your request. Check back later or start a new conversation.",id:"oiMwdVTmaV"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:(0,s.jsx)(I.A,{defaultMessage:"Get notified when Claude finishes longer tasks like this one.",id:"mBieR/vcEO"})}),(0,s.jsx)("button",{onClick:a,className:"text-text-300 hover:text-text-200 underline",children:(0,s.jsx)(I.A,{defaultMessage:"Turn on notifications",id:"IXF/1bytWQ"})})]})})};q.displayName="ChatNotification";let H=(0,E.memo)(q);var Y=a(0x22bf04094),V=a(0x19a5dec78),J=a(0x1156b3bea),K=a(0x1b6a4a195),X=a(0x204e49c37),$=a(0x17e7bc007),Q=a(0xe13d4dc9);function Z(e,t){let a=e.map(e=>t[e]).filter(e=>void 0!==e),s=[];for(let e of a)e.content&&s.push(...e.content);return{displayUuid:e[0],messageUuids:e,firstMessageUuid:e[0],lastMessageUuid:e[e.length-1],mergedContent:s,isChain:e.length>1,messages:a}}var ee=a(0x1f22b8dda),et=a(0x25062734b),ea=a(0x1050bd590),es=a(0xe824fb1c);(0,E.memo)(function(e){let{toolPermissionRequests:t,onToolDecision:a}=e,n=(0,et.L$)(),l=(0,E.useRef)(new Set),{autoApprove:i,autoDeny:r,needsApproval:o}=(0,E.useMemo)(()=>{let e=[],a=[],s=[];if(!t)return{autoApprove:e,autoDeny:a,needsApproval:s};for(let l of t){if(l.toolName.includes("AskUserQuestion"))continue;let{permission:t}=n(l.toolName);"allow"===t?e.push(l):"blocked"===t?a.push(l):s.push(l)}return{autoApprove:e,autoDeny:a,needsApproval:s}},[t,n]);(0,E.useEffect)(()=>{if(a)for(let e of i)l.current.has(e.toolUseId)||(l.current.add(e.toolUseId),a(e.toolUseId,e.toolUseId,e.input,"once"))},[i,a]),(0,E.useEffect)(()=>{if(a)for(let e of r)l.current.has(e.toolUseId)||(l.current.add(e.toolUseId),a(e.toolUseId,e.toolUseId,e.input,"deny"))},[r,a]),(0,E.useEffect)(()=>{let e=new Set(null==t?void 0:t.map(e=>e.toolUseId));for(let t of l.current)e.has(t)||l.current.delete(t)},[t]);let d=(0,E.useCallback)((e,t,s)=>{null==a||a(e,e,t,s)},[a]);return 0!==o.length&&a?(0,s.jsx)(s.Fragment,{children:o.map(e=>(0,s.jsx)(en,{id:e.toolUseId,toolId:e.toolName,input:e.input,onDecide:d,getToolApprovalState:n},e.toolUseId))}):null}).displayName="LocalAgentModeToolApproval";let en=(0,E.memo)(e=>{let{id:t,toolId:a,input:n,onDecide:l,getToolApprovalState:i}=e,{approvalState:r}=i(a),{toggleMcpToolAlwaysApproved:o}=(0,et.es)(),d=(0,E.useCallback)(e=>{if("perChat"===e)throw Error("`perChat` option not supported");if("always"===e){let e=(0,es.pK)(a);(null==e?void 0:e.tool.alwaysApprovedKey)&&o(e.tool.alwaysApprovedKey,!0)}l(t,n,e)},[l,t,n,a,o]),c=(0,E.useMemo)(()=>{var e;return{showAlwaysAllowed:null==(e=r.showAlwaysAllowed)||e,approvalRequired:r.approvalRequired,disabled:!1,submitToolApproval:d}},[r,d]);return(0,s.jsx)(ea.d,{isSessionChat:!0,message:{},toolResult:void 0,isFirstBlockOfMessage:!1,isFirstItemInGroup:!1,isLastBlockOfMessage:!1,isStreaming:!1,input:n,toolName:a,approvalData:c})});en.displayName="ToolApproval";var el=a(0x1611828d),ei=a(0x4e764078),er=a(0x1020e1ec),eo=a(0x1575c7741),ed=a(0x1bb0f43cc),ec=a(0x17e725145),eu=a(0xf071fd84),em=a(0x1398bcf3b),ex=a(0x6f2a2354),ef=a(0x16801a2b9),ep=a(0x1fec22234),eg=a(0x225bae024),eh=a(0x8f813b9c),eb=a(0x1e1f2a153),ev=a(0x31075f4f),ey=a(0x15a45ede),ej=a(0x680d90a2),ew=a(0x1ab362a20),eN=a(0x1e711c04c),e_=a(0x18f9bc151),ek=a(0x19078106),eM=a(0x18c2bb2d),eC=a(0x286b4261),eS=a.n(eC),eA=a(0x1e140f433),eE=a(0xb2489667);let eI=e=>{let{onClose:t,onBack:a,onDebug:n,title:l,isHidden:i,className:r}=e;return(0,s.jsxs)("div",{className:"shrink-0 flex items-center justify-between gap-4 w-full min-w-0 px-5 h-[3.25rem]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[!!a&&(0,s.jsx)(eg.$,{variant:"ghost",size:"icon_sm",onClick:a,className:"-ml-1",disabled:i,children:(0,s.jsx)(ey.Z,{size:16})}),(0,s.jsx)("h2",{className:(0,N.A)("text-text-200 truncate text-sm min-w-0 text-ellipsis break-words text-nowrap",r),children:l}),!!n&&(0,s.jsx)(eg.$,{variant:"ghost",size:"icon_sm",onClick:n,disabled:i,children:(0,s.jsx)(ej.z,{size:16})})]}),(0,s.jsx)(eg.$,{variant:"ghost",size:"icon_sm",onClick:t,className:"-mr-1",disabled:i,children:(0,s.jsx)(ew.X,{size:16})})]})};function eT(e){let{compassStatus:t,onOpenSources:a}=e;if(!t.total_sources)return null;let n=(e=>{let t=new Map,a=new Map;for(let n of e)for(let e of n.annotated_snippets)for(let n of e.tool_calls)if("web_search"===n.tool_name||"web_fetch"===n.tool_name){let e=[];if("web_search"===n.tool_name){if(!n.output||"rich_content"!==n.output.type||!n.output.content)continue;e=n.output.content.map(e=>{let{url:t}=e;return t}).filter(Boolean)}if("web_fetch"===n.tool_name){if(!n.output||"rich_link"!==n.output.type||!n.output.link.url)continue;e=[n.output.link.url]}for(let t of e)if("string"==typeof t)try{let e=new URL(t),n="https://".concat(e.hostname),l=e.hostname.replace(/^www\./,""),i=a.get(l);a.set(l,{count:((null==i?void 0:i.count)||0)+1,icon:(null==i?void 0:i.icon)||(0,s.jsx)(ep.d,{url:n,size:14})})}catch(e){}}else if(n.output){let e=n.integration_name||n.tool_name,a="rich_content"===n.output.type?n.output.content.length:1,l=t.get(e);t.set(e,{count:((null==l?void 0:l.count)||0)+a,icon:(null==l?void 0:l.icon)||(0,s.jsx)(eE.r,{canShowLetterIcon:!0,size:14,iconUrl:n.server_icon_url||void 0,integrationName:n.integration_name||void 0,toolName:n.tool_name})})}let n=Array.from(t.entries()).sort((e,t)=>t[1].count-e[1].count).slice(0,4),l=Array.from(a.entries()).sort((e,t)=>t[1].count-e[1].count).slice(0,4);return n.concat(l).slice(0,4-n.length)})(t.agents),l=n.length>0?n[0][1].count:0,i=t.total_sources-n.reduce((e,t)=>t[1].count+e,0);return 0===n.length?null:(0,s.jsx)("button",{className:"transition-all w-full flex flex-col gap-3 px-4 py-3.5 border-0.5 border-border-300 rounded-xl hover:border-border-100  max-w-[456px]",onClick:a,children:(0,s.jsxs)("div",{className:"flex flex-col gap-2.5 my-1 w-full",children:[n.map((e,t)=>{let[a,{count:n,icon:i}]=e;return(0,s.jsxs)("div",{className:"flex items-center text-xs",children:[(0,s.jsx)("div",{className:"h-4 w-4 flex items-center justify-center mr-2",children:i}),(0,s.jsx)("p",{className:"text-left font-medium w-32 truncate text-text-100 pr-2",title:a,children:a}),(0,s.jsx)("p",{className:"w-24 text-right text-xs text-text-300 pr-2",children:(0,s.jsx)(I.A,{id:"WrpI57Uej/",defaultMessage:"{count, plural, one {# source} other {# sources}}",values:{count:n}})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(eM.P.div,{className:"h-2 rounded-full bg-bg-400",initial:{width:0},animate:{width:"".concat(n/l*100,"%")},transition:{delay:.1*t,duration:.5}})})]},a)}),i>0&&(0,s.jsxs)("div",{className:"flex items-center text-xs text-text-300",children:[(0,s.jsx)(eN.H,{size:16,className:"text-text-300 mr-2"}),(0,s.jsx)("p",{children:(0,s.jsx)(I.A,{id:"QX3cxMJ9Tc",defaultMessage:"{totalSources, plural, one {# other source} other {# other sources}}",values:{totalSources:i}})})]})]})})}let eL=e=>{let{title:t,complete:a,className:n}=e;return(0,s.jsx)(eM.P.h3,{className:(0,N.A)("text-base text-text-100 font-claude-response",n),initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:a?t:(0,s.jsx)(eh.N,{children:t})},t)};function eR(e){let{title:t,description:a,numSources:n,onClick:l,complete:i}=e;return(0,s.jsxs)(eM.P.button,{variants:{initial:{opacity:0},animate:{opacity:1}},className:"text-left flex flex-col gap-1.5 transition-all duration-500 group/snippet cursor-pointer",onClick:l,children:[(0,s.jsx)(eL,{title:null!=a?a:t,complete:i}),(0,s.jsx)("div",{className:"transition-all flex flex-row items-center gap-1 text-xs text-text-500 group-hover/snippet:text-text-200",children:0===n?(0,s.jsx)(I.A,{id:"NmCRHK7Fm4",defaultMessage:"No sources yet"}):(0,s.jsx)(I.A,{id:"8NMeuJNj8z",defaultMessage:"{totalSources, plural, one {# source} other {# sources}}",values:{totalSources:n}})})]})}function eF(e){let{status:t,allSnippets:a,onOpenSources:n}=e,[l,i]=(0,E.useState)([]);return(0,E.useEffect)(()=>{!(t.agents.length<1)&&(l.length>=3||i((0,V.mk)({agents:t.agents,n:3})))},[null==t?void 0:t.agents,l.length,i]),(0,s.jsxs)("div",{className:"flex flex-col pt-4 pb-6 gap-4 w-full h-full text-sm text-text-200",children:[(0,s.jsx)(eT,{compassStatus:t,onOpenSources:()=>n(!0)}),a&&a.length>0&&(0,s.jsx)("div",{className:"flex flex-col gap-3",children:(0,s.jsx)(eM.P.div,{variants:{initial:{},animate:{transition:{staggerChildren:.08,delayChildren:.05}}},initial:"initial",animate:"animate",className:"flex flex-col gap-4 w-full",children:a.map((e,t)=>(0,s.jsx)(eR,{...e,onClick:()=>n(!0,e.globalAgentIndex)},t))})})]})}function ez(e){let{data:t,onClose:a}=e,[n,l]=(0,E.useState)(!1),[i,r]=(0,E.useState)({sourcesOpen:!1}),{conversationUuid:o,organizationUuid:d,isShared:c,taskId:u}=t,{compassStatus:m}=(0,V.CH)({organizationUuid:d,conversationUuid:o,taskId:u,isShared:c});if(!m)return null;let x=(e,t)=>{r({sourcesOpen:e,index:t})},f=void 0,p=i.sourcesOpen||n;return(0,s.jsxs)("div",{className:"relative h-full w-full bg-bg-000",children:[(0,s.jsx)(eM.P.div,{className:"w-full h-full",animate:p?"minimized":"full",variants:{minimized:{scale:.95},full:{scale:1}},children:(0,s.jsx)(eO,{compassStatus:m,onClose:a,onDebug:f,handleOpenSources:x})}),(0,s.jsx)("div",{className:(0,N.A)("absolute top-0 left-0 right-0 bottom-0 h-full w-full pointer-events-none bg-always-black/[5%]",p?"opacity-100":"opacity-0")}),(0,s.jsx)(eM.P.div,{animate:p?"visible":"hidden",variants:{visible:{opacity:1,translateX:0},hidden:{opacity:0,translateX:"100%"}},transition:{ease:ev.A.snappyOut},className:(0,N.A)("absolute top-0 left-0 right-0 bottom-0"),children:(0,s.jsx)(eP,{isHidden:!p,compassStatus:m,onBack:n?()=>l(!1):()=>x(!1),onClose:a,onDebug:f,isDebug:n,agentIndex:i.index})})]})}function eO(e){let{compassStatus:t,onClose:a,onDebug:n,handleOpenSources:l}=e,i=(0,T.A)(),r=(0,V.OQ)(t),o=t.status,d=(0,V.Nw)(t),c=t.total_sources||0,u=t.agents.slice(1).flatMap((e,t)=>e.annotated_snippets.flat().filter(e=>e.tool_calls.length>0).map(a=>({...a,total_sources:e.total_sources,description:e.description||e.name,complete:!!(a.complete||e.completed_at),globalAgentIndex:t+1,numSources:e.total_sources}))),m=y.gr.indexOf(o),x=[{title:o===y.zu.Starting||o===y.zu.Planning?i.formatMessage({defaultMessage:"Creating my research plan...",id:"4eRg5buC9J"}):i.formatMessage({defaultMessage:"Research plan created",id:"MIzjwRDSc0"}),children:d?(0,s.jsx)(V.GT,{thought:d,className:"pt-4 pb-6"}):void 0,shown:!0,expandable:!!d},{title:o===y.zu.InitiatingAgents||o===y.zu.Searching?0===c?i.formatMessage({defaultMessage:"Searching for sources...",id:"+4r/aaeR9v"}):i.formatMessage({defaultMessage:"Gathering {count, plural, one {# source} other {# sources}} and counting...",id:"kQHn/iXQmy"},{count:c}):i.formatMessage({defaultMessage:"Gathered {count, plural, one {# source} other {# sources}}",id:"DU/dbPu5mV"},{count:c}),titleIcons:(0,s.jsx)(V.mq,{hrefs:(0,V.mk)({agents:t.agents,n:3})}),children:(0,s.jsx)(eF,{allSnippets:u,status:t,onOpenSources:l}),shown:m>=2||t.agents.length>1,expandable:u.length>0},{title:o===y.zu.Completed?i.formatMessage({defaultMessage:"Boom! Research report is ready",id:"8CCPGtuLnt"}):i.formatMessage({defaultMessage:"Writing and citing report...",id:"2b/CKxnAiJ"}),shown:m>=4,expandable:!1}],f=x.filter(e=>e.expandable).length,p=x.findLastIndex(e=>!!e.expandable),g=(0,E.useRef)(p),[h,b]=(0,E.useState)(p),[v,j]=(0,E.useState)(!0),w=(0,E.useCallback)((e,t,a)=>{j(a),t?b(e):b(+(0===e))},[j,b]);(0,E.useEffect)(()=>{p!==g.current&&w(p,!0,!1)},[w,p]);let N=[y.zu.Cancelled,y.zu.Failed,y.zu.TimedOut].includes(t.status),_=x.filter(e=>e.shown).length;return(0,s.jsxs)("div",{className:"flex flex-col h-full bg-bg-000 overflow-hidden",children:[(0,s.jsx)(eI,{onClose:a,onDebug:n,title:r,className:"font-medium"}),(0,s.jsxs)("div",{className:"flex flex-col overflow-y-auto px-5 pb-5 pt-1 -mt-1",children:[x.map((e,a)=>{let{expandable:n,shown:l,title:i,titleIcons:r,children:o}=e,d=N||a<_-1||t.status===y.zu.Completed;return(0,s.jsx)(eU,{title:i,titleIcons:r,noShimmer:d||N,complete:d,isExpanded:n&&h===a,snappyTransition:v,showLine:a<_-1||N||h===a,handleExpand:e=>w(a,e,!0),expandable:n,collapsible:f>1,shown:l,children:o},a)}),N&&(0,s.jsx)(eU,{title:t.status===y.zu.Cancelled?i.formatMessage({defaultMessage:"Interrupted",id:"rJQDmlVOoX"}):i.formatMessage({defaultMessage:"Something went wrong",id:"JqiqNj0Ooi"}),snappyTransition:!0,noShimmer:!0,isError:!0,handleExpand:eS(),shown:N})]})]})}function eU(e){let{title:t,titleIcons:a,complete:n,expandable:l,collapsible:i,shown:r,isExpanded:o,handleExpand:d,snappyTransition:c,noShimmer:u,isError:m,showLine:x,children:f}=e;return!!r&&(0,s.jsxs)("div",{className:"flex flex-row gap-3 min-h-[2.125rem] shrink-0",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center mt-[5px]",children:[(0,s.jsx)("div",{className:(0,N.A)("transition-all w-2.5 h-2.5 rounded-full shrink-0",m?"bg-danger-200":n?"bg-text-500":"bg-accent-main-200")}),x&&(0,s.jsx)("div",{className:(0,N.A)("transition-all h-full -mb-1 w-[1px]",n?"bg-border-300":"bg-gradient-to-b from-accent-main-200/50 to-accent-main-200/0")})]}),(0,s.jsxs)("div",{className:"w-full flex flex-col",children:[(0,s.jsx)("button",{className:"inline-flex items-center gap-1",onClick:()=>d(!o),disabled:!l||o&&!i,children:(0,s.jsxs)("h4",{className:(0,N.A)("flex flex-row items-center gap-2 transition-colors text-start text-text-100 hover:text-text-000 text-sm h-5 user-select-none",m&&"!text-danger-200"),children:[u?t:(0,s.jsx)(eh.N,{children:t}),(0,s.jsx)(_.N,{children:!!a&&!o&&(0,s.jsx)(eM.P.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},children:a})}),!!l&&i&&(0,s.jsx)(e_.a,{className:(0,N.A)("bottom-[0.5px] transform transition-transform duration-400 ease-snappy-out text-text-300",o?"rotate-0":"-rotate-90"),size:12})]})}),(0,s.jsx)(eA.NG,{isExpanded:!!l&&!!o,isScrollable:!1,snappyTransition:c,className:"!max-h-none w-full",setIsExpanded:d,children:f})]})]})}function eD(e){var t,a;let{toolCall:n,isHidden:l}=e;if("web_fetch"===n.tool_name&&(null==(t=n.output)?void 0:t.type)==="rich_link"&&n.output.link.url){let{url:e,icon_url:t,title:a,subtitles:i}=n.output.link;return(0,s.jsx)(eA.aX,{isDisabled:l,isStreaming:!1,icon:(0,s.jsx)(ep.d,{fadeInOnLoad:!0,url:t,size:16}),text:(0,s.jsx)(I.A,{defaultMessage:"Fetched <b>{title}</b>",id:"BWNvvK6PhH",values:{title:a,b:e=>(0,s.jsx)("span",{className:"text-text-400",children:e})}}),handleClick:()=>{window.open(e,"_blank")},secondaryText:null==i?void 0:i[0],secondaryIcon:(0,s.jsx)(ek.B,{size:16,className:"text-text-300"}),isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,wrapperClassName:"!my-0"})}return n.output?(0,s.jsx)(eE.K,{integrationName:n.integration_name||void 0,integrationIcon:n.server_icon_url||void 0,message:n.message,isExpandingDisabled:l,result:n.output,isStreaming:!1,isError:n.is_error,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,wrapperClassName:"!my-0",contentClassName:(null==(a=n.output)?void 0:a.type)==="json_block"?"":"!max-h-none",defaultExpanded:!0}):null}function eP(e){var t;let{isHidden:a,compassStatus:n,onClose:l,onDebug:i,onBack:r,isDebug:o,agentIndex:d}=e,c=(0,E.useRef)(null),u=(0,T.A)(),m=d?!!(null==(t=n.agents[d])?void 0:t.completed_at):n.status===y.zu.Completed,x=void 0===d?null:n.agents[d].description||n.agents[d].name,f=function(e,t){let a=[];for(let s of t?[e.agents[t]]:e.agents)for(let e of s.annotated_snippets)for(let t of e.tool_calls)t.output&&a.push({toolCall:t,timestamp:e.complete&&s.completed_at||s.started_at});return a.sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()),a.map(e=>{let{toolCall:t}=e;return t})}(n,d),p=void 0===d?n.total_sources:n.agents[d].total_sources;return(0,s.jsxs)("div",{className:(0,N.A)("text-sm bg-bg-000 h-full overflow-hidden flex flex-col",a&&"pointer-events-none user-select-none"),children:[(0,s.jsx)(eI,{onDebug:o?void 0:i,isHidden:a,title:o?"Ant only debug panel":u.formatMessage({defaultMessage:"{totalSources, plural, one {# source} other {# sources}} {status}",id:"8cAP0ZJRie"},{totalSources:p,status:m?"":(0,s.jsx)(I.A,{id:"um9oac7M9y",defaultMessage:"and counting..."})}),onClose:l,onBack:()=>{setTimeout(()=>{c.current&&(c.current.scrollTop=0)},500),r()}}),(0,s.jsxs)("div",{ref:c,className:"relative flex-1 overflow-auto px-5 pt-1 pb-5",children:[!!x&&(0,s.jsx)(eL,{title:x,complete:m,className:"pt-1 pb-5"}),f.length>0?(0,s.jsx)("div",{className:"flex flex-col gap-4",children:f.map((e,t)=>(0,s.jsx)(eD,{toolCall:e,isHidden:a},t))}):(0,s.jsx)("div",{className:"text-text-500 text-center px-8 py-16",children:(0,s.jsx)(I.A,{id:"yWSiuEkfbY",defaultMessage:"No sources found"})})]})]})}var eB=a(0x1c6cf1a02),eG=a(0x1a3383306),eW=a(0x1dbad8fd1);let eq=e=>{let{docUuid:t,projectUuid:a,goBack:n,onClose:l}=e,{data:i}=(0,eW.Rn)({projectUuid:a,docUuid:t});if(!i)return null;let r={file_name:i.file_name,file_size:i.content.length,file_type:"text/plain",extracted_content:i.content,origin:eG.R9.UserUpload,kind:eG.XA.File};return(0,s.jsx)(eB.f,{attachment:r,goBack:n,onClose:l})};var eH=a(0x1cdcf3e5a),eY=a(0x1037073d3);let eV=(0,E.memo)(e=>{let{toolCall:t,serverIconType:a,serverIconSrc:n,serverName:l}=e,[i,r]=(0,E.useState)(!0),o=(0,E.useCallback)(()=>{r(e=>!e)},[]);return(0,s.jsx)(eA.sH,{isExpanded:i,setIsExpanded:o,text:t.displayName,icon:(0,s.jsx)(eY.z,{size:16,type:a,src:n,name:l}),isStreaming:!1,isFirstBlockOfMessage:!0,isLastBlockOfMessage:!0,children:(0,s.jsx)(eA.NG,{isExpanded:i,isScrollable:!0,snappyTransition:!1,children:(0,s.jsx)(ea.L,{input:t.input,toolResult:t.toolResult})})})});eV.displayName="ToolCallRow";let eJ=(0,E.memo)(function(e){let{serverUuid:t,serverName:a,iconType:n,iconSrc:l,onClose:i,toolCalls:r}=e,o=(0,T.A)(),d=(0,E.useMemo)(()=>[...r].sort((e,t)=>e.timestamp||t.timestamp?e.timestamp?t.timestamp?t.timestamp-e.timestamp:-1:1:0),[r]);return(0,s.jsxs)("div",{className:"flex h-full flex-col pb-1 pl-5 pt-3",children:[(0,s.jsxs)("div",{className:"sticky flex items-center gap-1 pr-5",children:[(0,s.jsx)(eY.z,{size:24,imageSize:20,name:a,type:n,src:l,className:"shrink-0"}),(0,s.jsx)("h2",{className:"font-ui flex-1 truncate text-lg font-medium",children:a}),(0,s.jsx)(eg.$,{variant:"ghost",size:"icon",className:"-mr-2",onClick:i,"aria-label":o.formatMessage({defaultMessage:"Close panel",description:"Button to close the MCP server detail panel",id:"1RWu+uzjFS"}),children:(0,s.jsx)(ew.X,{size:20})})]}),(0,s.jsxs)("div",{className:"mb-1 flex flex-col pb-3 pr-5 min-h-0 flex-1",children:[(0,s.jsx)("div",{className:"text-xs text-text-400 uppercase tracking-wide py-2",children:o.formatMessage({defaultMessage:"{count, plural, one {# tool call} other {# tool calls}}",description:"Header showing count of tool calls",id:"6b4EFZCPvR"},{count:d.length})}),(0,s.jsx)("div",{className:"min-h-0 flex-1 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[d.map(e=>(0,s.jsx)(eV,{toolCall:e,serverIconType:n,serverIconSrc:l,serverName:a},e.id)),0===d.length&&(0,s.jsx)("div",{className:"text-sm text-text-400 py-4 text-center",children:o.formatMessage({defaultMessage:"No tool calls yet",description:"Empty state for MCP server activity",id:"YkHKEmiZL+"})})]})})]})]})});var eK=a(0x865afcc2),eX=a(0x1d65023c3);let e$=(0,E.memo)(e=>{let{search:t}=e,[a,n]=(0,E.useState)(!0),l=(0,T.A)(),i=(0,E.useCallback)(()=>{n(e=>!e)},[]),r=t.results.length,o=l.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",description:"Count of web search results",id:"J2v/1b5Cbz"},{count:r});return(0,s.jsx)(eA.sH,{isExpanded:a,setIsExpanded:i,text:t.query||"Web search",secondaryText:o,icon:(0,s.jsx)(eX.q,{size:16}),isStreaming:!1,isFirstBlockOfMessage:!0,isLastBlockOfMessage:!0,isError:t.isError,children:(0,s.jsx)(eA.NG,{isExpanded:a,isScrollable:!0,snappyTransition:!1,children:t.results.length>0&&(0,s.jsx)("div",{className:"flex flex-nowrap p-2 pt-0 flex-col",children:t.results.map(e=>(0,s.jsx)(eK.$,{disabled:!a,icon:(0,s.jsx)(ep.d,{url:e.faviconUrl||e.url,size:16}),title:e.title||e.url,subtitles:e.siteDomain?[e.siteDomain]:void 0,url:e.url},e.url))})})})});e$.displayName="WebSearchRow";let eQ=(0,E.memo)(function(e){let{onClose:t,webSearches:a}=e,n=(0,T.A)(),l=(0,E.useMemo)(()=>[...a].sort((e,t)=>e.timestamp||t.timestamp?e.timestamp?t.timestamp?t.timestamp-e.timestamp:-1:1:0),[a]);return(0,s.jsxs)("div",{className:"flex h-full flex-col pb-1 pl-5 pt-3",children:[(0,s.jsxs)("div",{className:"sticky flex items-center gap-1 pr-5",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center bg-bg-000 rounded-md border border-border-300 text-text-400",children:(0,s.jsx)(eX.q,{size:16})}),(0,s.jsx)("h2",{className:"font-ui flex-1 truncate text-lg font-medium",children:n.formatMessage({defaultMessage:"Web Search",description:"Title for web search activity detail panel",id:"erkgiz04xh"})}),(0,s.jsx)(eg.$,{variant:"ghost",size:"icon",className:"-mr-2",onClick:t,"aria-label":n.formatMessage({defaultMessage:"Close panel",description:"Button to close the web search detail panel",id:"9Up6TiAtz+"}),children:(0,s.jsx)(ew.X,{size:20})})]}),(0,s.jsxs)("div",{className:"mb-1 flex flex-col pb-3 pr-5 min-h-0 flex-1",children:[(0,s.jsx)("div",{className:"text-xs text-text-400 uppercase tracking-wide py-2",children:n.formatMessage({defaultMessage:"{count, plural, one {# search} other {# searches}}",description:"Header showing count of web searches",id:"U61wp+86Xp"},{count:l.length})}),(0,s.jsx)("div",{className:"min-h-0 flex-1 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[l.map(e=>(0,s.jsx)(e$,{search:e},e.id)),0===l.length&&(0,s.jsx)("div",{className:"text-sm text-text-400 py-4 text-center",children:n.formatMessage({defaultMessage:"No web searches yet",description:"Empty state for web search activity",id:"xGOUVSbQU8"})})]})})]})]})}),eZ=(0,E.memo)(e=>{let{selectedItem:t,resourceActivity:a,onClose:n}=e,l=(0,E.useMemo)(()=>a.filter(e=>"mcp_tool"===e.operation&&e.mcpServerUuid===t.serverUuid).map(e=>{var t;return{id:e.id,toolName:e.mcpToolName,displayName:e.mcpToolDisplayName,input:e.mcpToolInput,toolResult:e.mcpToolResult?{type:"tool_result",tool_use_id:e.id,name:e.mcpToolName,is_error:null!=(t=e.mcpToolResult.isError)&&t,content:e.mcpToolResult.content}:void 0,timestamp:e.timestamp}}),[a,t.serverUuid]);return(0,s.jsx)(eJ,{serverUuid:t.serverUuid,serverName:t.serverName,iconType:t.iconType,iconSrc:t.iconSrc,onClose:n,toolCalls:l},t.serverUuid)});eZ.displayName="McpServerActivityDetailWrapper";let e0=(0,E.memo)(e=>{let{resourceActivity:t,onClose:a}=e,n=(0,E.useMemo)(()=>t.filter(e=>"web_search"===e.operation).map(e=>({id:e.id,query:e.searchQuery,results:e.searchResults,timestamp:e.timestamp,isError:e.isError})),[t]);return(0,s.jsx)(eQ,{onClose:a,webSearches:n})});e0.displayName="WebSearchActivityDetailWrapper";let e1=(0,E.memo)(function(e){var t;let{conversationUuid:a,onClose:n,isStreaming:l,projectUuid:i,sendMessage:r,isOpen:o,isTemporary:d=!1,resourceActivity:c=[]}=e,u=(0,$.fy)(a),{activeOrganization:m}=(0,p.YL)(),{chatResourceState:{selectedItem:x,activeMessageUuid:f,attachments:g,files:h,streamingFiles:b},dispatchChatResource:v}=(0,ef.i)(),y=null==m?void 0:m.uuid,j=(0,$.HF)(),w=(0,em.f)({conversationUuid:a,source:"w"}),N=null==(t=w.data)?void 0:t.artifact_versions,_=(0,E.useMemo)(()=>{if(!x||"artifact"!==x.type||!N)return;let e=N.find(e=>e.uuid===(null==x?void 0:x.versionUuid));if(e)return{id:e.artifact_uuid,title:e.title,language:e.code_language,type:e.artifact_type,version_uuid:e.uuid,versions:[{command:"create",uuid:e.uuid,resultState:e.result_state,content:e.result_state,message:e.message_uuid,created_at:e.created_at,source:e.source,isClosed:!0}]}},[N,x]),k=(null==x?void 0:x.type)==="artifact"&&x.versionUuid?{uuid:x.versionUuid,type:"artifact_version"}:void 0,M=(0,eo.f)({artifactContext:k}),C=(0,ec.useQueryClient)(),S=(0,ed.j)({artifactContext:k,chatConversationUuid:a,onStorageChange:()=>{C.invalidateQueries({queryKey:[eu.r$]})}}),A=(0,er.y)(g,h,y,i),I=(0,E.useMemo)(()=>({claudeComplete:M,getFile:A,storage:S}),[M,A,S]),T=w.refetch,L=(0,E.useCallback)(async()=>{await T()},[T]),R=(0,E.useCallback)(e=>{(null==x?void 0:x.type)==="artifact"&&v({type:"SELECT_ARTIFACT",id:x.id,versionUuid:e})},[x,v]),F=(0,E.useCallback)(e=>v({type:"SELECT_DOC",id:e}),[v]),z=(0,E.useCallback)(()=>v({type:"CLEAR_SELECTED"}),[v]),O=(null==x?void 0:x.type)==="artifact"&&j[x.id]?j[x.id]:_;return(0,s.jsx)(s.Fragment,{children:(null==x?void 0:x.type)==="artifact"&&O?(0,s.jsx)("div",{className:"relative h-full",children:(0,s.jsx)(ex.CV,{isStreaming:l,artifact:O,selectedArtifactMessageUuid:f,selectedArtifactVersionUuid:x.versionUuid,setSelectedArtifactVersionUuid:R,onClose:n,projectUuid:i,selectDoc:F,sendMessage:r,richSandboxCapabilities:I,isOpen:o,isTemporary:d})}):(null==x?void 0:x.type)!=="artifact"||j[x.id]?(null==x?void 0:x.type)==="attachment"?(0,s.jsx)(eB.f,{goBack:()=>v({type:"CLEAR_SELECTED"}),attachment:x.attachment,onClose:n}):(null==x?void 0:x.type)==="compass"?(0,s.jsx)(ez,{data:x.data,onClose:n,goBack:z}):i&&(null==x?void 0:x.type)==="doc"?(0,s.jsx)(eq,{docUuid:x.id,projectUuid:i,onClose:n,goBack:()=>v({type:"CLEAR_SELECTED"})}):(null==x?void 0:x.type)==="file"?(0,s.jsx)(eH.yL,{file:{path:x.path,name:x.path.split("/").pop()||x.path},showBackButton:x.path.startsWith("/mnt/user-data/outputs/"),goBack:()=>v({type:"CLEAR_SELECTED"}),onClose:n,conversationUuid:a,projectUuid:i,isTemporary:d,isShared:!1,isStreaming:l,streamingFile:b.get(x.path),artifactVersions:null!=N?N:[],cacheBuster:u,onUpdate:L},x.path):(null==x?void 0:x.type)==="mcp_server"?(0,s.jsx)(eZ,{selectedItem:x,resourceActivity:c,onClose:n}):(null==x?void 0:x.type)==="web_search"?(0,s.jsx)(e0,{resourceActivity:c,onClose:n}):null:(0,s.jsx)(ex.CV,{isStreaming:l,artifact:void 0,selectedArtifactMessageUuid:f,selectedArtifactVersionUuid:(null==x?void 0:x.type)==="artifact"?x.versionUuid:void 0,setSelectedArtifactVersionUuid:R,onClose:n,projectUuid:i,selectDoc:F,sendMessage:r,richSandboxCapabilities:I,isOpen:o,isTemporary:d})})});var e2=a(0x108536636),e5=a(0xa5acf583),e3=a(0x19c88845),e4=a(0x1b03847fb),e8=a(0x965113a9),e6=a(0xf583d59a),e9=a(0x1e6127894),e7=a(0x10b8a0309),te=a(0x16cf30ff5),tt=a(0x23506e4da),ta=a(0x1babd1d4e),ts=a(0x1f507121),tn=a(0xec9172c1),tl=a(0x14a7c225d),ti=a(0x18b9bd76),tr=a(0x1f92f9b94);a(0x2120f5fe0);var to=a(0x18a1d1a5a),td=a(0xce297377),tc=a(0x163bd16bb);let tu=e=>{let{projectUuid:t}=e,{data:a}=(0,O.fo)(t);return a?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"text-text-300 mb-2 mt-4 text-sm font-medium",children:(0,s.jsx)(I.A,{defaultMessage:"Project content",id:"/IJPT7JRFn"})}),(0,s.jsxs)("div",{className:"border-border-400 rounded-lg border px-3 py-4",children:[(0,s.jsxs)(S(),{href:"/project/".concat(t),className:"hover:text-text-000 flex items-center gap-1.5 hover:underline",children:[(0,s.jsx)(to.D,{size:16,className:"text-text-300 shrink-0"}),(0,s.jsx)("div",{className:"font-claude-response text-text-200 leading-tight",children:a.name})]}),(0,s.jsx)("div",{children:(0,s.jsx)(tc.t,{project:a,className:"text-text-400 text-xs"})}),(0,s.jsx)("ul",{className:"mt-2 flex flex-col",children:(0,s.jsx)(td.b,{isEditable:!1,project:a,maxItems:3,onViewAll:()=>{window.location.href="/project/".concat(t)}})})]})]})}):null};var tm=a(0xce58ec20),tx=a(0x113daa220),tf=a(0x1f163163),tp=a(0x12c26b561);let tg=(0,tt.default)(()=>Promise.all([a.e(87983),a.e(84052)]).then(a.bind(a,0xa933a7a4)).then(e=>e.ShareModal),{loadableGenerated:{webpack:()=>[0xa933a7a4]},ssr:!1}),th=(0,tt.default)(()=>a.e(55457).then(a.bind(a,0x210f95561)).then(e=>e.WiggleSharingModals),{loadableGenerated:{webpack:()=>[0x210f95561]},ssr:!1});function tb(e){let{conversationUuid:t,projectUuid:a,sessionId:n,isStreaming:l,debugInfo:i,isTemporary:r=!1,messagesLength:o=0}=e,d=(0,f.u9)(),{refetchAll:c,selectWiggleFile:u,wiggleFiles:m,wiggleSharedArtifacts:x}=function(e){let{conversationUuid:t,messagesLength:a=0,isStreaming:s}=e,n=(0,f.Yl)(),l=(0,$.fy)(t),{isDrawerExpanded:i}=(0,tn.x)(),{chatResourceState:{selectedItem:r},dispatchChatResource:o}=(0,ef.i)(),d=(0,em.f)({conversationUuid:t,source:"w"}),c=(0,E.useMemo)(()=>{var e,t;return null!=(t=null==(e=d.data)?void 0:e.artifact_versions)?t:[]},[d.data]),u=n&&i&&!r,m=(0,tf.a)("",t,u),x=(0,E.useMemo)(()=>{var e;let t=[],a=[];return null==(e=m.files)||e.forEach(e=>{"/mnt/user-data/README.md"!==e.path&&(e.path.startsWith("/mnt/user-data/uploads/")||(e.path.startsWith("/mnt/user-data/outputs/")?t.push(e):a.push(e)))}),{output:t,scratchpad:a}},[m.files]),p=x.output.length+x.scratchpad.length,g=(0,E.useCallback)((e,t)=>{o({type:"SELECT_FILE",path:e.replace("computer://",""),toolType:"create_file",messageId:t})},[o]),h=(0,E.useCallback)(async()=>{n&&await Promise.all([m.refetch(),d.refetch()])},[n,m,d]),b=(0,E.useCallback)(async()=>{n&&await m.refetch()},[n,m]);(0,tp.c)({conversationUuid:t,refetch:b,isWorking:s,messagesLength:a,enabled:!r,expansionTrigger:i});let v=(0,tx.Y)(()=>{n&&!r&&d.refetch()},{leading:!1,delay:tp.X});return(0,E.useEffect)(()=>{v()},[i,l]),{wiggleGate:n,showWiggleControls:u,refetchAll:h,refetchWiggleRoot:b,selectWiggleFile:g,wiggleFiles:x,wiggleFilesCount:p,wiggleSharedArtifacts:c}}({conversationUuid:t,messagesLength:o,isStreaming:l}),{isDrawerExpanded:g}=(0,tn.x)(),{chatResourceState:{selectedItem:h,activeMessageUuid:v,files:y,syncSources:w},dispatchChatResource:_}=(0,ef.i)(),{activeOrganization:k}=(0,p.YL)(),[M,C]=(0,E.useState)(null),S=(0,T.A)(),A=(0,ta._)({conversationUuid:t,isStreaming:l}),[L,R]=(0,E.useState)(!1),F=0===m.output.length&&0===x.length&&0===m.scratchpad.length&&0===y.length&&0===w.length&&!a,z=(0,j.V)(),O=(0,el.mL)(),U=(0,ts._)();return d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,N.A)("flex flex-col relative","max-md:absolute max-md:inset-x-0 max-md:top-0",h&&"max-md:hidden",!h&&g&&"max-md:z-header",h&&g&&"md:z-0",!g&&"max-md:pointer-events-none max-md:absolute max-md:inset-0"),inert:!!h&&!!g||void 0,children:[(0,s.jsx)(tv,{sessionId:n,wiggleFiles:m,isTemporary:r,isStreaming:l,messagesLength:o,shareState:A,debugInfo:i,isAgentRoute:O}),!F&&!O&&(0,s.jsx)("div",{className:(0,N.A)("overflow-x-hidden overflow-y-auto md:h-[calc(100%-56px)]","max-md:h-full max-md:border-t max-md:border-border-300 max-md:bg-bg-100","md:transition-[width] md:duration-300 md:ease-in-out",g?"w-full md:mt-12 md:m-2 md:w-[384px] p-5 border-0.5 border-border-300 md:rounded-2xl max-md:border-0":"w-0 p-0 m-0 border-0 overflow-hidden",h&&"md:absolute",z&&g&&"md:mt-[62px]",r&&g&&"md:mt-14"),children:(0,s.jsx)("div",{className:(0,N.A)(g?"md:w-[342px]":"w-0"),children:(0,s.jsxs)("div",{className:(0,N.A)("flex flex-col gap-5 md:transition-opacity md:duration-300",g?"md:animate-[fade_0.3s_ease-in-out_0.1s_forwards]":"opacity-0 pointer-events-none"),children:[m.output.length?(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium text-sm",children:(0,s.jsx)(I.A,{defaultMessage:"Artifacts",id:"eW5eoWkxy3"})}),(0,s.jsx)(eg.$,{variant:"ghost",prepend:(0,s.jsx)(e6.e,{size:14}),className:(0,N.A)("text-sm font-medium opacity-0",m.output.length>1&&"opacity-100"),size:"sm",onClick:()=>{(null==k?void 0:k.uuid)&&U({filepaths:m.output.map(e=>e.path),orgUuid:k.uuid,conversationUuid:t,isShared:!1,source:"chat_controls_download_all_button"})},children:(0,s.jsx)(I.A,{defaultMessage:"Download all",id:"V1UrPNM96z"})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:m.output.map(e=>(0,s.jsx)(b.m,{align:"end",tooltipContent:e.name,side:"bottom",children:(0,s.jsx)("div",{children:(0,s.jsx)(ti._,{file:e,conversationUuid:t,onOpen:()=>u(e.path,v||""),isInSidebar:!0,isShared:!1},e.path)})},e.path))})]}):null,x.length?(0,s.jsx)(ty,{artifactVersions:x,onSelectArtifactVersion:e=>{_({type:"SELECT_ARTIFACT",id:"",versionUuid:e})},onComplete:e=>C(e)}):null,m.scratchpad.length?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("button",{className:"flex font-medium items-center justify-between p-1 hover:bg-bg-300 rounded-md",onClick:()=>R(e=>!e),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I.A,{defaultMessage:"Scratchpad",id:"Qb4YubxAW2"}),(0,s.jsx)(b.m,{tooltipContent:S.formatMessage({defaultMessage:"Files used to create artifacts",id:"T2w69cOLhV"}),side:"right",children:(0,s.jsx)(e9.m,{})})]}),(0,s.jsx)(e7.J,{className:(0,N.A)("transition",L?"rotate-90":"")})]}),(0,s.jsx)(tj,{isExpanded:L,children:(0,s.jsx)("div",{className:"flex flex-col gap-2",children:m.scratchpad.map(e=>(0,s.jsx)(eg.$,{variant:"ghost",prepend:(0,s.jsx)(tl.o,{path:e.path}),className:"!justify-start",onClick:()=>{u(e.path,v||"")},children:e.name},e.path))})})]}):null,a&&(0,s.jsx)(tu,{projectUuid:a}),(0,s.jsx)(tw,{})]})})})]}),M&&(0,s.jsx)(th,{artifactVersion:M,onClose:()=>C(null),onUpdate:async()=>{await c(),C(null)},projectUuid:a}),A.showShareModal&&(0,s.jsx)(tg,{...A})]}):null}function tv(e){let{sessionId:t,wiggleFiles:a,isTemporary:n,isStreaming:l,messagesLength:i,shareState:r,debugInfo:o,isAgentRoute:d}=e,c=(0,T.A)(),u=(0,j.V)(),{isDrawerExpanded:m,setIsDrawerExpanded:x}=(0,tn.x)(),{chatResourceState:{selectedItem:f,files:p,syncSources:g},dispatchChatResource:h}=(0,ef.i)(),b=p.length+g.length,y=a.output.length+a.scratchpad.length+b,w=(0,E.useMemo)(()=>m?c.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}):c.formatMessage({defaultMessage:"Open sidebar",id:"+G35mRWa75"}),[c,m]);(0,v.fS)("yukon_gold_debug_menu_enabled");let[_,k]=(0,E.useState)(!1);return(0,s.jsxs)("div",{className:(0,N.A)("md:absolute md:right-0 md:top-0 z-20","max-md:w-fit max-md:self-end max-md:pointer-events-auto","flex justify-end shrink-0 min-w-0 pr-3 items-center gap-1",u?"!h-[52px] draggable":"!h-12","transition-opacity duration-150 ease-in-out",f&&m?"md:opacity-0 md:pointer-events-none":"md:opacity-100 delay-300",u&&m&&!f&&["md:shadow-[0px_1px_0px_0px_theme(colors.border-300)]","w-full"],n&&"pt-3"),"data-testid":"wiggle-controls-actions",children:["",y>0&&!d&&(0,s.jsx)(eg.$,{"aria-label":w,tooltip:w,variant:"ghost",size:"icon_sm",onClick:()=>{h({type:"CLEAR_SELECTED"}),x(!m)},"data-testid":"wiggle-controls-actions-toggle",className:m?"!bg-bg-400":void 0,children:(0,s.jsx)(e3.File,{})}),!n&&!l&&!t&&i>0&&(0,s.jsx)(eg.$,{tooltip:u&&(0,s.jsx)(I.A,{defaultMessage:"Share chat",id:"bXa+lJhlYV"}),variant:u?"ghost":"secondary",size:u?"icon_sm":"sm",onClick:r.handleShareClick,disabled:r.isCheckingShareability,prepend:u&&(0,s.jsx)(e3.Share,{}),"data-testid":"wiggle-controls-actions-share",children:!u&&(0,s.jsx)(I.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})]})}function ty(e){let{artifactVersions:t,onSelectArtifactVersion:a,onComplete:n}=e,{publishedArtifactsBaseUrl:l}=(0,e5._r)(),{copyToClipboard:i}=(0,eb.C)();return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("h3",{className:"text-text-500 text-xs",children:(0,s.jsx)(I.A,{defaultMessage:"Shared",id:"kWI6zXRaHY"})})}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:t.map(e=>{let t=e.published_artifact_uuid?"publish":"share",r=e.published_artifact_uuid?e.published_artifact_deleted_at?(0,s.jsx)(I.A,{defaultMessage:"Unpublished",id:"wbU4tD+0G+"}):(0,e8.d)(e.created_at):"shared"===e.visibility?(0,e8.d)(e.created_at):"private"===e.visibility?(0,s.jsx)(I.A,{defaultMessage:"Unshared",id:"0r/9ANkloS"}):null;return(0,s.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,s.jsxs)(eg.$,{variant:"ghost",className:"flex-1 !justify-start !px-2 text-sm gap-1.5",onClick:()=>{a(e.uuid)},children:[(0,s.jsx)(e3.LinkSimple,{size:20,className:"shrink-0"}),(0,s.jsxs)("span",{className:"flex items-center min-w-0 overflow-hidden",children:[(0,s.jsx)("span",{className:"truncate",children:e.title}),(0,s.jsx)(te.c,{size:16,className:"shrink-0"}),(0,s.jsx)("span",{className:"text-xs text-text-500",children:r})]})]}),(0,s.jsxs)(e4.ms,{align:"end",trigger:(0,s.jsx)(eg.$,{variant:"ghost",size:"icon_sm",children:(0,s.jsx)(e3.DotsHorizontalSmall,{size:20})}),children:[(0,s.jsx)(e4.tJ,{onClick:()=>{i((0,tm.x)(t,{artifact_uuid:e.artifact_uuid,artifact_version_uuid:e.uuid,message_uuid:e.message_uuid,published_artifact_uuid:e.published_artifact_uuid},l))},children:(0,s.jsx)(I.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})}),e.published_artifact_deleted_at?null:(0,s.jsx)(e4.tJ,{onClick:()=>n(e),children:"publish"===t?(0,s.jsx)(I.A,{defaultMessage:"Unpublish",id:"VjZ6FKc+ZZ"}):"shared"===e.visibility?(0,s.jsx)(I.A,{defaultMessage:"Unshare",id:"bEq+NWNIXF"}):(0,s.jsx)(I.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})})]})]},e.uuid)})})]})}function tj(e){let{children:t,isExpanded:a}=e;return(0,s.jsx)(eM.P.div,{className:"overflow-hidden shrink-0",tabIndex:-1,initial:{opacity:0,height:a?"auto":0},animate:a?"expanded":"collapsed",transition:{ease:"easeInOut",duration:.4},variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:t})}function tw(){let{chatResourceState:{files:e,attachments:t,syncSources:a},dispatchChatResource:n}=(0,ef.i)();return e.length+a.length>0?(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("h3",{className:"font-medium text-sm",children:(0,s.jsx)(I.A,{defaultMessage:"Content",id:"Jq3FDzj0/T"})})}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-3",children:[e.map((e,t)=>(0,s.jsx)(e2.NM,{size:"stretch",file:e},"".concat(e.file_kind,"-").concat(t))),t.map((e,t)=>(0,s.jsx)(e2.NM,{size:"stretch",file:e,handleClick:()=>n({type:"SELECT_ATTACHMENT",attachment:e})},"attachment-".concat(t))),a.map(e=>(0,s.jsx)(tr.br,{size:"stretch",syncSource:e,isEditable:!1,location:"chat"},e.uuid))]})})]}):null}var tN=a(0x139b5e710),t_=a(0x8ca4d894);function tk(e){let{conversationUuid:t}=e,a=(0,A.useRouter)(),n=(0,tN.Yf)(),[l,i]=(0,E.useState)(!1),r=(0,$.xJ)(t);return(0,s.jsxs)("div",{className:" flex flex-col gap-1.5 border-0.5 border-border-300 bg-bg-100 rounded-t-xl text-text-300 font-ui z-10 p-6 ",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row items-center sm:justify-between font-medium",children:[(0,s.jsx)("div",{className:"text-lg",children:(0,s.jsx)(I.A,{defaultMessage:"Chat ended by Claude",id:"dHdfbAOK+j"})}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(eg.$,{onClick:()=>a.push("/new"),children:(0,s.jsx)(I.A,{defaultMessage:"Start new chat",id:"KcA+xo4hhh"})}),(0,s.jsx)(eg.$,{variant:"secondary",onClick:()=>i(!0),children:(0,s.jsx)(I.A,{defaultMessage:"Give feedback",id:"bCmvTYWKoj"})})]})]}),(0,s.jsx)(t_.B,{conversationUuid:t,requestedFeedbackType:y.kj.CHAT_ENDED,setRequestedFeedbackType:()=>{},message:r,isOpen:l,onClose:()=>{i(!1)},onSuccess:()=>n.addSuccess("Feedback submitted"),showOptions:!1})]})}var tM=a(0x9cb4c2a2),tC=a(0x109513363),tS=a(0x31bda27d),tA=a(0x2524bdea9),tE=a(0xf32c56dd),tI=a(0x20e7b44d0),tT=a(0x22fc8d729),tL=a(0x20e00cddd);let tR=["consumer_restricted_mode","consumer_second_warning","consumer_first_warning","recent_election_discussion"],tF=e=>{let{long:t}=e;return(0,s.jsx)(tT.Y,{href:tL.Z1,target:"_blank",rel:"noreferrer",children:t?(0,s.jsx)(I.A,{defaultMessage:"Learn more about the types of prompts to avoid {arrow}",id:"6DZ92vAY0j",values:{arrow:"\xbb"}}):(0,s.jsx)(I.A,{defaultMessage:"Learn more {arrow}",id:"ZeACTbo6DM",values:{arrow:"\xbb"}})})},tz={consumer_restricted_mode:[{isDismissible:!1,content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I.A,{defaultMessage:"Because a large number of your prompts have violated our Acceptable Use Policy, we have temporarily applied enhanced safety filters to your chats.",id:"PzePYdPNe4"})," ",(0,s.jsx)(tF,{})]})}],consumer_second_warning:[{isDismissible:!0,content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I.A,{defaultMessage:"It appears your recent prompts continue to violate our Acceptable Use Policy. If we continue seeing this pattern, we’ll apply enhanced safety filters to your chats.",id:"BjivfV2YY6"})," ",(0,s.jsx)(tF,{})]})}],consumer_first_warning:[{isDismissible:!0,content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I.A,{defaultMessage:"It looks like a few of your recent prompts don’t meet our Usage Policy.",id:"Aup/Kzn3Eq"})," ",(0,s.jsx)(tF,{long:!0})]})}],recent_election_discussion:[{isDismissible:!0,content:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(I.A,{defaultMessage:"Claude may not be able to provide accurate, real time information on elections. Please visit <link>TurboVote</link> or check the Secretary of State site for your state to get reliable, up-to-date, non partisan guidance on how and where to vote in elections across the US.",id:"X4J/f3yO08",values:{link:e=>(0,s.jsx)(tT.Y,{href:"http://claude.turbovote.org",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"US"},{isDismissible:!0,content:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(I.A,{defaultMessage:"The United Kingdom’s general elections will be held on 4 July, 2024. Please visit the <link>UK Election Commission’s website</link> to get reliable, up-to-date, impartial guidance on how and where to vote in the United Kingdom’s general elections.",id:"VUvO/yD1Iw",values:{link:e=>(0,s.jsx)(tT.Y,{href:"https://www.electoralcommission.org.uk/",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"GB"},{isDismissible:!0,content:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(I.A,{defaultMessage:"The French legislative elections will be held in two rounds of voting on June 30 and July 7, 2024. Please consult <link>the French Public Administration website</link> for reliable and up-to-date guidance on where and how to vote in the legislative elections in France.",id:"ZzEMOJWfNz",values:{link:e=>(0,s.jsx)(tT.Y,{href:"https://www.service-public.fr/particuliers/vosdroits/N47",target:"_blank",rel:"noopener noreferrer",children:e})}})}),applicable_country:"FR"}]};function tO(e){let{isClaudeDot:t,content:a,isDismissible:n,handleDismiss:l}=e;return(0,s.jsx)("div",{className:t?"fixed top-8 z-10 p-4":"",children:(0,s.jsx)(tD,{isFloating:t,children:(0,s.jsxs)("div",{className:"items-top flex justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:a}),n&&l&&(0,s.jsx)("button",{className:"h-5 cursor-pointer",onClick:()=>void l(),children:(0,s.jsx)(ew.X,{size:24})})]})})})}function tU(e){let{conversationUuid:t}=e,a=(0,tE.st)(),n=(0,e5.fZ)(),{account:l,activeOrganization:i}=(0,p.YL)(),r=null==l?void 0:l.uuid,o=null==i?void 0:i.uuid,{mutateAsync:d}=(0,z.iD)(),{data:c}=(0,z.Nj)(null==i?void 0:i.uuid),u=(0,tI.H)(),m=(null==c?void 0:c.active_flags)&&(null==c?void 0:c.active_flags.map(e=>e.type)),{shownFlagType:x,shownFlagDetails:f}=function(e,t){let a=tR.findIndex(e=>null==t?void 0:t.includes(e)),s=tR[a];if(!s)return{shownFlagType:null,shownFlagDetails:null};let n=tz[s].filter(t=>!t.applicable_country||t.applicable_country===e);return 0===n.length?{shownFlagType:null,shownFlagDetails:null}:{shownFlagType:s,shownFlagDetails:n[0]}}(u,m);if((0,E.useEffect)(()=>{r&&o&&x&&a.track({event_key:"ts.banner.shown",flag_type:x,conversation_uuid:t,account_uuid:r,organization_uuid:o,ipCountry:null!=u?u:"unknown"})},[a,x,t,r,o,u]),!x||!f)return;let{isDismissible:g,content:h}=f,b=async()=>{if(!g)return;let e=[x];"consumer_second_warning"===x&&(null==m?void 0:m.includes("consumer_first_warning"))&&e.push("consumer_first_warning"),await Promise.all(e.map(e=>d({flagType:e})))};return(0,s.jsx)(tO,{isClaudeDot:n,content:h,isDismissible:g,handleDismiss:b})}function tD(e){let{isFloating:t,className:a,...n}=e;return(0,s.jsx)("div",{...n,className:(0,N.A)("w-full flex gap-2 bg-warning-900 px-3 py-2",t&&"max-w-3xl mx-auto rounded-md shadow-element z-toast",a)})}var tP=a(0x794ab501),tB=a(0xf0b8fe63),tG=a(0x17f06afaa),tW=a(0x1250d018a),tq=a(0x871efbbd),tH=a(0x10b92d793),tY=a(0x20ccd63b4);let tV=["apps_and_websites","documents_and_templates","games","productivity_tools","creative_projects","quiz_or_survey","start_from_scratch"],tJ=e=>{var t;let{selectedLabel:a,disabled:l}=e,i=(0,T.A)(),{track:r}=(0,tE.st)(),o=new Map([["apps_and_websites",i.formatMessage({defaultMessage:"Apps and websites",id:"HC16Tj5QBT"})],["documents_and_templates",i.formatMessage({defaultMessage:"Documents and templates",id:"mLy6zrc3XL"})],["games",i.formatMessage({defaultMessage:"Games",id:"DUyJmj7sj9"})],["productivity_tools",i.formatMessage({defaultMessage:"Productivity tools",id:"t/RMra2cqp"})],["creative_projects",i.formatMessage({defaultMessage:"Creative projects",id:"gZSnjM59XP"})],["quiz_or_survey",i.formatMessage({defaultMessage:"Quiz or survey",id:"yyPDfhkUT7"})],["start_from_scratch",i.formatMessage({defaultMessage:"Start from scratch",id:"fGhwMpK3XG"})]]),d=new Map(Array.from(o,e=>e.reverse())),c=new Map([["apps_and_websites",tP.E],["documents_and_templates",tB.i],["games",tG.H],["productivity_tools",tW.l],["creative_projects",tq.e],["quiz_or_survey",tH.S],["start_from_scratch",tY.f]]),{sendTransparentMessage:u,conversation:m}=(0,tM.oM)(),{mutate:x}=(0,n.HF)(null==m?void 0:m.id),f=null!=(t=d.get(null!=a?a:""))?t:"default",p=async e=>{o.has(e)&&(r({event_key:"artifact.studio.create_mode_selected",create_mode:e}),(null==m?void 0:m.id)&&x({settings:{enabled_monkeys_in_a_barrel:!1}}),await u(o.get(e)))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"font-claude-response-body pl-2 mt-1",children:(0,s.jsx)(I.A,{defaultMessage:"Let’s get cooking! Pick an artifact category or start building your idea from scratch.",id:"HKJSK13xqN"})}),(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 max-w-xl justify-center items-stretch w-full",children:tV.map(e=>{let t=c.get(e);return(0,s.jsx)("div",{className:(0,N.A)("relative w-full h-full min-h-[3.5rem] sm:h-28 p-3 sm:p-3.5 font-base bg-bg-000 rounded-lg transition-colors group",f===e&&"border-0.5 text-text-100 bg-bg-000 shadow-sm",("default"!==f&&f!==e||"default"===f&&l)&&"text-text-500 bg-bg-000/50 border-0.5 border-border-300","default"===f&&!l&&"border-0.5 border-border-300 text-text-300 hover:border-text-200 hover:bg-bg-000 hover:text-text-100 cursor-pointer shadow-sm"),onClick:async()=>{"default"!==f||l||await p(e)},children:(0,s.jsxs)("div",{className:"flex flex-row sm:flex-col items-center sm:items-start justify-center sm:justify-start h-full w-full gap-3 sm:gap-0",children:[t&&(0,s.jsx)(t,{size:20,weight:"light",className:(0,N.A)("transition-transform duration-300 ease-out shrink-0 sm:absolute sm:bottom-4 sm:right-4","default"===f&&!l&&"group-hover:-rotate-2 sm:group-hover:rotate-2 group-hover:scale-105")}),(0,s.jsx)("span",{className:"flex-1 text-left",children:o.get(e)})]})},e)})})]})};var tK=a(0xd1db3b6);let tX=e=>{let{scrollRefs:t,autoScrollRef:a,messageCount:n,additionalBuffer:l=0,parentContainerRef:i,disablePinToTop:r=!1,disableInitialScrollToBottom:o=!1}=e,d=(0,E.useRef)(n),c=(0,tK.Q)(),u=(0,E.useCallback)(()=>{var e,a,s,n,r,o;let d=(null==(e=t.lastAssistantMessage.current)?void 0:e.clientHeight)||0,u=(null==(a=t.lastHumanMessage.current)?void 0:a.clientHeight)||0,m=(null==(n=t.chatInput)||null==(s=n.current)?void 0:s.clientHeight)||0,x=(null==(r=t.extras.current)?void 0:r.clientHeight)||0,f=c?parseFloat(K.Ih)*parseFloat(getComputedStyle(document.documentElement).fontSize):0,p=Math.max(((null==i||null==(o=i.current)?void 0:o.clientHeight)||window.innerHeight)-u-d-x-m-f-(l||98),0);t.extraSpace.current&&(t.extraSpace.current.style.height="".concat(p,"px"))},[t.lastAssistantMessage,t.lastHumanMessage,t.chatInput,t.extras,t.extraSpace,c,i,l]);return(0,E.useLayoutEffect)(()=>{if(d.current!==n&&(u(),!r)){var e;null==(e=a.current)||e.scrollToBottom("smooth")}d.current=n},[n,u,a,r]),(0,E.useLayoutEffect)(()=>{let e=new ResizeObserver(()=>{u()});return[t.lastAssistantMessage,t.lastHumanMessage,t.chatInput,t.extras].forEach(t=>{(null==t?void 0:t.current)&&e.observe(t.current)}),window.addEventListener("resize",u),()=>{e.disconnect(),window.removeEventListener("resize",u)}},[t,u,n]),(0,E.useLayoutEffect)(()=>{var e;o||null==(e=a.current)||e.scrollToBottom("instant")},[a,o]),(0,s.jsx)("div",{ref:t.extraSpace,"aria-hidden":"true"})};function t$(){return(0,s.jsx)(eM.P.figure,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-text-100 flex flex-col gap-8 text-center","data-testid":"empty-chat-screen",children:(0,s.jsxs)("h2",{className:"font-title flex flex-col items-center justify-center gap-2 sm:flex-row",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(h.a,{state:"waiting"})}),(0,s.jsx)(I.A,{defaultMessage:"What can I help you with today?",id:"1PnN/uP0zv"})]})})}var tQ=a(0x1c8eb913f);let tZ="/Spark/",t0=[19,17,16,15,14,13,12,11,1,11,12,13,14,15,16,17,19],t1="".concat(tZ,"/Check.svg"),t2=L.Ik({changeTitle:L.zM().optional(),titleDelayMs:L.ai().optional(),changeFavicon:L.zM().optional(),faviconDelayMs:L.ai().optional(),playSound:L.zM().optional()}),t5={};var t3=a(0x193cc7eb2);let t4=(0,E.forwardRef)((e,t)=>(0,s.jsx)("div",{ref:t,"aria-hidden":"true",className:"h-px w-full pointer-events-none"}));t4.displayName="LastMessageSentinel";var t8=a(0x1a6b4f7ae);function t6(e){let{autoscrollRef:t,sentinelElement:a,isStreaming:n=!1,avatarState:l="static"}=e,i=(0,T.A)(),[r,o]=(0,E.useState)(!1),d=(0,E.useCallback)(()=>{let e=t.current;e&&(e.scrollToBottom("instant"),n&&e.setPinToBottom(!0))},[t,n]);return(0,E.useEffect)(()=>{if(!n){var e;null==(e=t.current)||e.setPinToBottom(!1)}},[n,t]),(0,E.useEffect)(()=>{var e;if(!a)return;let s=null==(e=t.current)?void 0:e.getScrollContainer();if(!s)return;let n=new IntersectionObserver(e=>{let[t]=e;o(!t.isIntersecting)},{root:s,threshold:.01,rootMargin:"0px 0px ".concat(150,"px 0px")});return n.observe(a),()=>{n.disconnect()}},[a,t]),(0,s.jsxs)("button",{onClick:d,"aria-label":i.formatMessage({defaultMessage:"Scroll to bottom",id:"p4l9m92DsT"}),className:(0,N.A)("z-[1] size-9 inline-flex items-center justify-center","absolute -top-8 left-1/2 -translate-x-1/2","border-0.5 overflow-hidden !rounded-full p-1","shadow-md hover:shadow-lg","bg-bg-000/80 hover:bg-bg-000","backdrop-blur transition-opacity duration-200",n?"border-accent-brand/30":"border-border-300",r?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),children:[(0,s.jsx)(h.a,{state:l,className:(0,N.A)("absolute blur-md transition duration-300 pointer-events-none",n?"opacity-50":"opacity-0")}),(0,s.jsx)(t8.y,{className:"mix-blend-luminosity"})]})}var t9=a(0x14b8da165);let t7=(0,E.memo)(function(e){let{toolPermissionRequests:t,onToolDecision:a}=e;if(!t||0===t.length||!a)return null;let n=t.filter(e=>!e.toolName.includes("AskUserQuestion"));return 0===n.length?null:(0,s.jsx)(s.Fragment,{children:n.map(e=>(0,s.jsx)(ae,{id:e.toolUseId,toolId:e.toolName,input:e.input,onDecide:(t,s)=>a(t,e.toolUseId,e.input,s)},e.toolUseId))})});function ae(e){var t;let{id:a,toolId:n,input:l,onDecide:i}=e,[r,o="",d=""]=(null!=n?n:"").split("__"),c=(0,et.iy)()(o,d),u={showAlwaysAllowed:null==(t=c.showAlwaysAllowed)||t,approvalRequired:c.approvalRequired,disabled:!1,submitToolApproval(e){if("perChat"===e)throw Error("`perChat` option not supported");null==i||i(a,e)}};return(0,s.jsx)(ea.d,{isSessionChat:!0,message:{},toolResult:void 0,isFirstBlockOfMessage:!1,isFirstItemInGroup:!1,isLastBlockOfMessage:!1,isStreaming:!1,input:l,toolName:n,approvalData:u})}t7.displayName="SessionToolApprovals";var at=a(0x24fcf6beb);a(0x1b643ff5e);let aa=new Set(["md","markdown","mdown","mkdn","mkd","mdwn","mdtxt","mdtext"]),as=new Set(["py","pyx","pxd","pxi","pyi","js","jsx","ts","tsx","mjs","cjs","java","scala","kt","kts","groovy","gradle","c","h","cpp","cc","cxx","hpp","hxx","cs","csx","go","rs","rb","rbw","rake","gemspec","php","phtml","php4","php5","php7","phps","swift","kt","kts","ktm","dart","lua","pl","pm","t","pod","r","R","Rmd","Rnw","sh","bash","zsh","fish","bat","cmd","ps1","sql","graphql","gql","json","xml","yaml","yml","toml","ini","cfg","conf"]),an=[{pattern:/^#{1,6}\s+/gm,weight:.15,name:"headers"},{pattern:/\[([^\]]+)\]\(([^)]+)\)/g,weight:.1,name:"links"},{pattern:/!\[([^\]]*)\]\(([^)]+)\)/g,weight:.1,name:"images"},{pattern:/^```[\s\S]*?```$/gm,weight:.1,name:"fenced-code"},{pattern:/^(?: {4}|\t)[^\n]+$/gm,weight:.05,name:"indented-code"},{pattern:/`[^`]+`/g,weight:.05,name:"inline-code"},{pattern:/^[\s]*[-*+]\s+/gm,weight:.08,name:"unordered-list"},{pattern:/^[\s]*\d+\.\s+/gm,weight:.08,name:"ordered-list"},{pattern:/\*\*[^*]+\*\*/g,weight:.04,name:"bold"},{pattern:/\*[^*\n]+\*/g,weight:.03,name:"italic"},{pattern:/__[^_]+__/g,weight:.04,name:"bold-underscore"},{pattern:/_[^_\n]+_/g,weight:.03,name:"italic-underscore"},{pattern:/^>\s+/gm,weight:.07,name:"blockquote"},{pattern:/^---+$|^===+$/gm,weight:.05,name:"horizontal-rule"},{pattern:/^\|[^\n]+\|$/gm,weight:.08,name:"table"}];function al(e,t){var a;let s=e?null==(a=e.split(".").pop())?void 0:a.toLowerCase():void 0;if(s&&aa.has(s))return{isMarkdown:!0,confidence:1,method:"extension"};if(s&&as.has(s))return{isMarkdown:!1,confidence:0,method:"extension"};if(t){let e=function(e){if(!e||e.length<10)return 0;let t=0,a=[],s={};for(let{pattern:n,weight:l,name:i}of an){let r=e.match(n);if(r&&r.length>0){let e=r.length,n=l*(.7+.3*(["headers","fenced-code","links","images"].includes(i)?Math.min(e,1):Math.min(e/5,1)));t+=n,a.push(i),s[i]=n}}return Math.min(t+.1*(a.length/an.length),1)}(t),a=e>=.15;return{isMarkdown:a,confidence:e,method:a?"content":"none"}}return{isMarkdown:!1,confidence:0,method:"none"}}class ai{update(e){if(this.hasLatched)return this.lastResult;let t=al(this.filename,e);return t.isMarkdown&&(this.hasLatched=!0),this.lastResult=t,t}reset(){this.hasLatched=!1,this.lastResult=al(this.filename),this.hasLatched=this.lastResult.isMarkdown}isLatched(){return this.hasLatched}constructor(e){this.hasLatched=!1,this.filename=e,this.lastResult=al(e),this.hasLatched=this.lastResult.isMarkdown}}var ar=a(0x1ea21c42d),ao=a.n(ar),ad=a(0xede65b),ac=a(0x2129aebe2),au=a(0xd3117c3a);function am(e){var t;let a=new Set;return null==(t=e.content)||t.filter(e=>"text"===e.type).forEach(e=>{(0,ad.n)(e.text).forEach(e=>a.add(e))}),a}let ax=(0,E.memo)(e=>{let{isStreaming:t,conversationUuid:a,dispatchChatResource:s,openControlsSidebar:n,isDrawerExpanded:l,maxTrackedFiles:i,selectComputerFile:r,lastMessageUuid:o}=e,c=(0,$.xJ)(a),u=(0,$.ot)(a),m=(0,w.l)(),x=(0,tE.st)(),{setIsDrawerExpanded:f}=(0,tn.x)(),p=(0,el.PF)(),g=(0,E.useRef)({lastOpenedId:null});!function(e){let{isStreaming:t,lastMessage:a,conversationUuid:s,dispatchChatResource:n,openControlsSidebar:l,isDrawerExpanded:i,maxTrackedFiles:r}=e,o=(0,E.useRef)(new Map),d=(0,E.useRef)(void 0),c=(0,E.useMemo)(()=>{if(!t||!a||!a.content)return d.current;let e=a.content[a.content.length-1];return d.current=e,e},[t,a]),u=(0,E.useMemo)(()=>null,[c,r]),{detectMarkdown:m,clearDetectors:x}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=(0,E.useRef)(new Map),a=(0,E.useCallback)(a=>{if(t.current.has(a))return t.current.get(a);if(t.current.size>=e){let e=t.current.keys().next().value;e&&t.current.delete(e)}let s=new ai(a);return t.current.set(a,s),s},[e]),s=(0,E.useCallback)(e=>{if(!e||!e.path)return null;if(e.path.includes(".")){let a=e.path,s=[];t.current.forEach((e,t)=>{a.startsWith(t)&&t!==a&&!t.includes(".")&&s.push(t)}),s.forEach(e=>{t.current.delete(e)})}let s=a(e.path);return{isMarkdown:s.update(e.content).isMarkdown,isLatched:s.isLatched(),detector:s}},[a]),n=(0,E.useCallback)(()=>{t.current.clear()},[]);return{detectMarkdown:s,clearDetectors:n,removeDetector:(0,E.useCallback)(e=>{t.current.delete(e)},[]),getDetectorsMap:(0,E.useCallback)(()=>t.current,[]),getOrCreateDetector:a}}(r),{handleMarkdownFileDetected:f,updateStreamingContent:p,clearOpenedFiles:g}=function(e){let{dispatchChatResource:t,openControlsSidebar:a,isDrawerExpanded:s,maxTrackedFiles:n=100,throttleMs:l=100}=e,i=(0,E.useRef)(new Set),r=(0,E.useCallback)(e=>{let t=i.current,a=!t.has(e);if(t.has(e))t.delete(e);else if(t.size>=n){let e=t.values().next().value;e&&t.delete(e)}return t.add(e),a},[n]),o=(0,E.useCallback)(e=>i.current.has(e),[]),d=(0,E.useCallback)(function(e,n){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"create_file";r(e)&&(s||a(),t({type:"SELECT_FILE",path:e,toolType:l,messageId:n}))},[t,a,s,r]),c=(0,E.useCallback)(e=>{},[]),u=(0,E.useCallback)(e=>{let{path:a,content:s,renderAs:n,showingInRightPane:l}=e;t({type:"UPDATE_STREAMING_FILE",path:a,content:s,renderAs:n,showingInRightPane:l})},[t]),m=(0,E.useMemo)(()=>ao()(e=>{u(e)},l,{leading:!0,trailing:!0}),[u,l]);(0,E.useEffect)(()=>()=>{m.cancel()},[m]);let x=(0,E.useCallback)(e=>{m(e)},[m]),f=(0,E.useCallback)(e=>{m.cancel(),u(e)},[u,m]),p=(0,E.useCallback)((e,t,a)=>{d(e,a),x({path:e,content:t,renderAs:at.vU.Markdown,showingInRightPane:!0})},[d,x]);return{trackOpenedFile:r,hasBeenOpened:o,openFileInRightPane:d,registerMarkdownFile:c,updateStreamingContent:x,updateStreamingContentImmediate:f,handleMarkdownFileDetected:p,clearOpenedFiles:(0,E.useCallback)(()=>{i.current.clear()},[]),getOpenedFilesSet:(0,E.useCallback)(()=>i.current,[])}}({dispatchChatResource:n,openControlsSidebar:l,isDrawerExpanded:i,maxTrackedFiles:r});(0,E.useEffect)(()=>{if(!u)return;let{path:e,content:t}=u,s=m(u);if(!s)return;let{isMarkdown:n,isLatched:l}=s,i=(null==a?void 0:a.uuid)||"";n?f(e,t,i):l&&p({path:e,content:t,renderAs:at.vU.Markdown})},[u,m,f,p,null==a?void 0:a.uuid]);let h=(0,E.useCallback)(()=>{o.current.clear()},[]);(0,E.useEffect)(()=>()=>{s&&(x(),g(),h(),d.current=void 0)},[s,x,g,h])}({isStreaming:t,lastMessage:c,conversationUuid:a,dispatchChatResource:s,openControlsSidebar:n,isDrawerExpanded:l,maxTrackedFiles:i});let h=(0,E.useRef)(!1),b=(0,E.useRef)(!1);(0,E.useEffect)(()=>{if(!c)return;if(t){h.current=!1,b.current=!0;return}if(h.current||!b.current||!o||!(0,d.GN)(o))return;let e=u.slice(0,-1),s=new Set;e.forEach(e=>{am(e).forEach(e=>s.add(e))}),Array.from(am(c)).filter(e=>!s.has(e)).forEach(e=>{x.track({event_key:"wiggle.file.created",chat_message_uuid:o,...(0,au.k)({filePath:e,isShared:!1,conversationUuid:a,source:"completion"})})}),h.current=!0},[t,c,o,x,a,u]),(0,E.useEffect)(()=>{if(!p&&!(m.width<K.gU)&&c&&!t){let e=function(e){var t;for(let a of null!=(t=e.content)?t:[])if("text"===a.type){for(let e of(0,ad.n)(a.text))if((0,at.IO)(e))return e}return null}(c),t=g.current.lastOpenedId===e;e&&!t&&o&&(g.current.lastOpenedId=e,r(e,o))}},[p,t,c,r,o,m.width]);let v=(0,ac.a)(null!=c?c:{}),y=(0,E.useRef)(null);return null===y.current&&(y.current=new Set(c?(0,ac.G)(c):[])),(0,E.useEffect)(()=>{if(!t||m.width<K.gU||!c||!o)return;let e=(0,ac.G)(c);if(0===e.length)return;let a=e.filter(e=>{var t;return!(null==(t=y.current)?void 0:t.has(e))});if(a.length>0){var n;let e=a[a.length-1];null==(n=y.current)||n.add(e),s({type:"SELECT_FILE",path:e,toolType:"present_files",messageId:o}),f(!0)}},[v,t,c,o,s,f,m.width]),null});ax.displayName="StreamingFileManager";var af=a(0x6ff86c72);let ap=e=>{var t;let{conversationUuid:a,retryCount:n,agentModeCompactionStatus:l}=e,[i,r]=(0,E.useState)(""),o=(0,T.A)(),d=(0,$.uO)(a),{context:c}=(0,u.j)(a),m=null!=(t=null==c?void 0:c.compactionStatus)?t:"compacting"===l?"compacting":void 0,[x,f]=(0,E.useState)(null),p=null!==x,g=(0,E.useRef)(null),h=(0,E.useRef)(0);(0,E.useEffect)(()=>{if("compacting"===m){g.current=Date.now(),h.current=0,f(0);let e=0,t=setInterval(()=>{if(g.current){let t=Math.min(95,(1-Math.exp(-((Date.now()-g.current)/1e3)/25))*100);h.current=e=Math.max(e,Math.round(t)),f(e)}},100);return()=>clearInterval(t)}if("complete"===m){g.current=null;let e=h.current,t=Date.now(),a=setInterval(()=>{let s=Math.min(1,(Date.now()-t)/300),n=Math.round(e+(100-e)*(1-Math.pow(1-s,2)));h.current=n,f(n),s>=1&&clearInterval(a)},16),s=setTimeout(()=>{f(null),h.current=0},1e3);return()=>{clearInterval(a),clearTimeout(s)}}"failed"===m?(f(null),h.current=0):m||(f(null),h.current=0)},[m]);let b=(0,E.useMemo)(()=>[o.formatMessage({defaultMessage:"Gathering my thoughts, be right there...",id:"C6UYRcZHCt"}),o.formatMessage({defaultMessage:"Contemplating, stand by...",id:"r6P7kLapjf"}),o.formatMessage({defaultMessage:"Pondering, stand by...",id:"l0/dX2gLlN"}),o.formatMessage({defaultMessage:"Ruminating on it, stand by...",id:"wt2OTGsj0k"}),o.formatMessage({defaultMessage:"Pondering, stand by...",id:"l0/dX2gLlN"})],[o]),v=(0,E.useMemo)(()=>o.formatMessage({defaultMessage:"Still working on it, stand by...",id:"R9hnARYgER"}),[o]),y=(0,E.useMemo)(()=>o.formatMessage({defaultMessage:"A bit longer, thanks for your patience...",id:"MCt5e8xpx8"}),[o]);(0,E.useEffect)(()=>{if(d||n&&n>0)return;let e=[];return e.push(setTimeout(()=>{r(b[Math.floor(Math.random()*b.length)])},5e3)),e.push(setTimeout(()=>{r(v)},15e3)),e.push(setTimeout(()=>{r(y)},3e4)),()=>{e.forEach(e=>clearTimeout(e))}},[b,v,y,d,n]);let j=(0,E.useMemo)(()=>"compacting"===m||p?o.formatMessage({defaultMessage:"Compacting our conversation so we can keep chatting...",id:"TtfNhgtojm"}):n&&n>0?o.formatMessage({defaultMessage:"Taking longer than usual. Trying again shortly (attempt {attemptNumber} of 10)",id:"1OhR91Iznh"},{attemptNumber:n+1}):i,[m,p,n,i,o]);return p?(0,s.jsxs)(eM.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"ml-2 pb-1.5",children:[(0,s.jsx)("div",{className:"font-claude-response text-text-300 text-sm italic",children:j}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"bg-bg-500 relative h-1 w-48 overflow-hidden rounded-full after:absolute after:inset-0 after:translate-x-[-100%] after:bg-gradient-to-r after:from-always-white/0 after:from-0% after:via-always-white/20 after:via-50% after:to-always-white/0 after:to-100% after:animate-[shimmer_1.5s_infinite]",children:(0,s.jsx)(eM.P.div,{className:"bg-text-300 h-full rounded-full",initial:{width:0},animate:{width:"".concat(x,"%")},transition:{duration:.3,ease:"easeOut"}})}),(0,s.jsx)("div",{className:"text-text-400 text-xs tabular-nums",children:o.formatMessage({defaultMessage:"{progress}%",id:"LI4B/nslxi"},{progress:x})})]})]}):(!d||n&&0!==n)&&j?(0,s.jsx)(eM.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:"font-claude-response text-text-300 ml-2 pb-1.5 text-sm italic",children:j}):null};function ag(e){let{isStreaming:t,hasWebSearchResponse:a,retryCount:n,conversationUuid:l,shouldShowWaitingText:i,currentAvatarState:r,isTemporary:o,scrollRef:d,incognitoString:c,isResearchPending:u,enableCompassNotificationsUI:m,tooltipContent:x,notificationPermission:f,enableCompassNotifications:p,enableCompletionNotifications:g,isCompassNotificationEnabled:y,isCompletionNotificationEnabled:j,isSession:w,enableCompletionNotificationsUI:_,isRunningToolOrThinking:k,sessionStatusMessage:M,debugInfo:C,agentModeCompactionStatus:A}=e,T=(0,v.fS)("chat-ui-core"),L=(0,X.uD)(),[R,F]=(0,E.useState)(!1),[z,O]=(0,E.useState)(!1),U=(0,E.useRef)(null),D=(0,E.useRef)(null);return(0,E.useEffect)(()=>{if(_)return k?(D.current&&(clearTimeout(D.current),D.current=null),U.current||(U.current=setTimeout(()=>{F(!0),O(!0)},2e3))):(U.current&&(clearTimeout(U.current),U.current=null),R&&!D.current&&(O(!1),D.current=setTimeout(()=>{F(!1),D.current=null},500))),!t&&(O(!1),D.current&&(clearTimeout(D.current),D.current=null),setTimeout(()=>{F(!1)},500),U.current&&(clearTimeout(U.current),U.current=null)),()=>{U.current&&clearTimeout(U.current),D.current&&clearTimeout(D.current)}},[k,t,_,R]),(0,s.jsx)("div",{ref:d,children:(0,s.jsxs)("div",{className:(0,N.A)("ml-1 flex items-center transition-transform duration-300 ease-out",T?"mt-6":"mt-0.5",t&&"-translate-y-2.5"),children:[(0,s.jsx)("div",{className:(0,N.A)("p-1 -translate-x-px",L&&"invisible"),children:(0,s.jsx)(h.a,{state:r})}),M?(0,s.jsx)("div",{className:"font-claude-response text-text-300 ml-2 pb-1.5 text-sm italic",children:M}):null,i?(0,s.jsx)(ap,{conversationUuid:l,retryCount:n,agentModeCompactionStatus:A}):null,(0,s.jsx)("div",{className:(0,N.A)("text-text-500 px-2 mt-6 flex-1 text-right text-[0.65rem] leading-[0.85rem] sm:text-[0.75rem]",t&&!R&&"pointer-events-none",(w||T)&&"hidden"),children:o?(0,s.jsx)("div",{className:(0,N.A)("inline-block select-none transition-opacity mt-1",!t&&"opacity-90 delay-300 duration-700",t&&"opacity-0 duration-0"),children:c}):u&&m?(0,s.jsx)(H,{notificationPermission:f,enableNotifications:p,isFeatureEnabled:y,visible:u}):_&&R&&("granted"!==f||!j)?(0,s.jsx)(H,{notificationPermission:f,enableNotifications:g,isFeatureEnabled:j,visible:z}):(0,s.jsx)(b.m,{tooltipContent:x,side:"bottom",disableHoverableContent:!0,className:"max-w-full",delayDuration:50,children:(0,s.jsx)(S(),{href:"https://support.anthropic.com/en/articles/8525154-claude-is-providing-incorrect-or-misleading-responses-what-s-going-on",target:"_blank",className:(0,N.A)("inline-block select-none",!t&&"opacity-90 delay-300 duration-700",t&&"opacity-0 duration-0"),children:(0,s.jsx)("span",{className:"hover:text-text-300 transition",children:a?(0,s.jsx)(I.A,{defaultMessage:"Claude is AI and can make mistakes. {lineBreak}Please double-check cited sources.",id:"DXEHSZ98B8",values:{lineBreak:(0,s.jsx)("br",{className:"block sm:hidden"})}}):(0,s.jsx)(I.A,{defaultMessage:"Claude is AI and can make mistakes. {lineBreak}Please double-check responses.",id:"xMeF6o3ada",values:{lineBreak:(0,s.jsx)("br",{className:"block sm:hidden"})}})})})})})]})})}let ah=i.XA.maxFilesPerConversation;function ab(e){var t,a,i,h,b,N,C,q,H;let{changeDisplayedConversationPath:X,chatInputDefaultMessage:et,conversationTitle:ea,conversationUuid:es,editMessage:en,isStreaming:er,isTemporary:eo=!1,isLoading:ed,messageUuids:ec,name:eu,onRetry:em,onSend:ex,projectUuid:ep,setPersonalizedStyleCallback:eg,retryCount:eh,todos:eb,onStopSampling:ev,sessionStatusMessage:ey,isReconnected:ej=!1,session:ew,sessionMcpServers:eN,debugInfo:e_,toolPermissionRequests:ek,onToolDecision:eM,agentModeCompactionStatus:eC,resourceActivity:eS}=e,eA=(0,ee.Zx)(es),eE=(0,el.mL)(),eI=(0,el.PF)(),eT=(0,j.V)(),eL=(0,v.fS)("chat-ui-core"),{isCmdKOpen:eR}=(0,U.l)(),eF=(0,Y.fQ)(),ez=null!=(H=null==eF?void 0:eF.isOpen)&&H,eO=(0,$.n5)(es),eU=(0,$.U4)(es),eD=(0,$.Ci)(es,er),eP=(0,$.zg)(es),eB=ec[ec.length-1]||null,{account:eG,activeOrganization:eW}=(0,p.YL)(),eq=(0,g.B)(),eH=(0,T.A)(),eY=(0,R.P2)(),eV=(0,E.useRef)(null),[eJ,eK]=(0,E.useState)(null),eX=(0,E.useRef)(null);eX.current=ec[ec.length-1]||null;let{chatResourceState:e$,dispatchChatResource:eQ}=(0,ef.i)(),{setSandboxState:eZ}=(0,l.q)(),e0=(0,A.useSearchParams)(),e2=(0,E.useRef)({lastAssistantMessage:(0,E.useRef)(null),lastHumanMessage:(0,E.useRef)(null),chatInput:(0,E.useRef)(null),extras:(0,E.useRef)(null),extraSpace:(0,E.useRef)(null)}).current,e5=(0,E.useCallback)(()=>{let e=e2.lastAssistantMessage.current;if(!e)return!0;let t=e.getBoundingClientRect(),a=window.innerHeight;return t.bottom<a+50},[e2.lastAssistantMessage]);(0,E.useEffect)(()=>(er?o.Z.setVisibilityCheck(e5):o.Z.clearVisibilityCheck(),()=>{o.Z.clearVisibilityCheck()}),[er,e5]);let e3=(0,E.useRef)(null),e4=(0,E.useCallback)(async e=>{let{prompt:t,attachments:a,files:s,syncSources:n,personalized_style:l,compass_mode:i,createConversationParams:r}=e;if(er&&!eA&&!eI)return;eQ({type:"SET_ACTIVE_MESSAGE_UUID",uuid:void 0}),eZ(es,{conversationFiles:[...e$.files,...s],allAttachments:[...e$.attachments,...a],projectUuid:ep});let o={prompt:t,attachments:a,files:s,syncSources:n,rethrowErrors:!0,parent_message_uuid:eX.current||d.gF,personalized_style:l,compass_mode:i,createConversationParams:r};await ex(o)},[eI,eA,er,eQ,eZ,es,e$.files,e$.attachments,ex,ep]),e8=(0,E.useCallback)((e,t)=>{eQ({type:"SET_ACTIVE_MESSAGE_UUID",uuid:void 0}),eZ(es,{conversationFiles:e$.files,allAttachments:e$.attachments,projectUuid:ep}),em(e,t)},[eQ,eZ,es,e$.files,e$.attachments,ep,em]),e6=(0,E.useCallback)(async()=>{if(er)return;let e=eH.formatMessage({defaultMessage:"Continue",id:"acrOozm08x"});await ex({prompt:e,attachments:[],files:[],syncSources:[],rethrowErrors:!0,parent_message_uuid:eX.current||d.gF})},[eH,er,eX,ex]),e9=(0,E.useCallback)((e,t)=>{en&&(eQ({type:"CLEAR_SELECTED"}),en(e,t))},[eQ,en]),e7=(0,E.useMemo)(()=>(0,M.A)(),[]);(0,E.useEffect)(()=>(e7.on("retry",e=>{let{parent_message_uuid:t,paprika_mode:a}=e;e8(t,a)}),e7.on("edit",e=>{let{message:t,text:a}=e;e9(t,a)}),()=>{e7.off("retry"),e7.off("edit")}),[e7,e8,e9]);let{files:te,attachments:tt,selectedItem:ta}=e$,{isDrawerExpanded:ts,setIsDrawerExpanded:tl}=(0,tn.x)(),ti=(0,E.useCallback)(()=>{eQ({type:"CLEAR_SELECTED"}),tl(!0)},[eQ,tl]),tr=(0,E.useCallback)(()=>{tl(!1)},[tl]),to=(0,$.QS)(),td=(0,$.P8)(),tc=(0,$.w0)();(0,E.useEffect)(()=>{eQ({type:"UPDATE_FILES",files:to})},[to,eQ]),(0,E.useEffect)(()=>{eQ({type:"UPDATE_ATTACHMENTS",attachments:td})},[eQ,td]),(0,E.useEffect)(()=>{eQ({type:"UPDATE_SYNC_SOURCES",syncSources:tc})},[eQ,tc]);let tu=(0,E.useCallback)(e=>{ti(),eQ({type:"SELECT_ATTACHMENT",attachment:e})},[eQ,ti]),tm=(0,E.useMemo)(()=>!!((null==eq?void 0:eq.preview_feature_uses_artifacts)||eP),[eq,eP]),tx=(0,z.QY)(),tf=(0,E.useCallback)((e,t,a)=>{ti(),eQ({type:"SELECT_ARTIFACT",id:e,versionUuid:a}),eQ({type:"SET_ACTIVE_MESSAGE_UUID",uuid:t||""})},[eQ,ti]),tp=(0,E.useCallback)((e,t)=>{let a=decodeURIComponent(e.replace("computer://",""));ti(),eQ({type:"SELECT_FILE",path:a,toolType:"create_file",messageId:t})},[eQ,ti]),tg=(0,$.SY)(),th=(0,E.useRef)({lastOpenedId:null}),tv=(0,w.l)();(0,E.useEffect)(()=>{if(tv.width<K.gU)return;let e=th.current.lastOpenedId===tg;er&&tg&&!e&&(th.current.lastOpenedId=tg,tf(tg))},[er,tg,tf,tv.width]),(0,E.useEffect)(()=>{let e=e0.get("artifactId"),t=e0.get("versionUuid");e&&(ti(),eQ({type:"SELECT_ARTIFACT",id:e,versionUuid:t||void 0}))},[]);let ty=(0,E.useRef)(!1);(0,E.useEffect)(()=>{(null==eb?void 0:eb.length)&&!ty.current&&(ty.current=!0,ti())},[ti,eb]);let tj=(0,E.useMemo)(()=>{if(er&&eD&&eD.content)return eD.content[eD.content.length-1]},[er,eD]),tw=er&&(!eD||!(null==(t=eD.content)?void 0:t[0])&&0===eD.attachments.length&&0===eD.files.length&&0===eD.files_v2.length),tN=tj&&("tool_use"===tj.type||"tool_result"===tj.type),t_=tj&&("tool_use"===tj.type||"tool_result"===tj.type||"thinking"===tj.type),tE=(0,E.useMemo)(()=>{if(eD&&!er)return(0,Q.eb)(eD)},[er,eD]),tI=!er&&!eI&&void 0!==tE,{compassStatus:tT}=(0,V.CH)({organizationUuid:null==eW?void 0:eW.uuid,conversationUuid:es,taskId:tE,isShared:!1,enabled:tI}),tL=(0,E.useMemo)(()=>{if(!eD||er)return!1;let e=(0,Q.nb)(eD);return!!(e&&!e.is_error&&(0,y.i3)(null==tT?void 0:tT.status))&&!(0,Q.OC)(eD)},[er,tT,eD]),tR=(0,J.Wo)(),tF=(0,J.hG)(),tz=(0,F.Lr)(),tO=(0,F.KG)("compass"),tD=(0,F.KG)("completion"),tP=(0,v.fS)("compass_enable_notifications_web")&&!eT,tB=(0,v.fS)("web_completion_notif")&&!eT,tG=(0,E.useCallback)(async()=>{let{success:e}=await tF();return e&&await tz(!0),e},[tF,tz]),tW=(0,E.useCallback)(async()=>{let{success:e}=await tF();return e&&await tz(!0),e},[tF,tz]),tq=(0,E.useMemo)(()=>tw?"thinking":tN||tL||eA&&er?"shimmer":er?"writing":"static",[tw,tN,tL,er,eA]);((e,t,a)=>{let s=(0,v.T9)("claude_ai_tabbed_out_notifications","features",t5,t2),n="visible"===(0,tQ.f)(),{setThinkingTitle:l,setReceivedTitle:i,resetTitle:r}=((e,t,a)=>{let s=(0,E.useRef)(null),n=(0,E.useCallback)(()=>{s.current&&(clearInterval(s.current),s.current=null),document.title="Working on it..."},[]),l=(0,E.useCallback)(()=>{if(s.current)return;let t=0;s.current=setInterval(()=>{document.title=e[t],t=(t+1)%e.length},a)},[a,e]),i=(0,E.useCallback)(()=>{s.current&&(clearInterval(s.current),s.current=null),document.title=t},[t]);return(0,E.useMemo)(()=>({setThinkingTitle:n,setReceivedTitle:l,resetTitle:i}),[n,l,i])})(["Ready to chat",e],e,s.titleDelayMs||1600),{setWritingFavicon:o,setCompleteFavicon:d,resetFavicon:c}=(e=>{let t=(0,E.useRef)(null),a=(0,E.useCallback)(e=>{let t=document.querySelector("link[rel~='icon']")||document.createElement("link");t.rel="icon",t.href=e,document.head.appendChild(t)},[]),s=(0,E.useCallback)(()=>{t.current&&clearInterval(t.current),t.current=null,a("/favicon.ico")},[a]),n=(0,E.useCallback)(()=>{if(t.current)return;let s=0;t.current=setInterval(()=>{a("".concat(tZ,"/").concat(t0[s],".svg")),s=(s+1)%t0.length},e)},[e,a]),l=(0,E.useCallback)(()=>{s(),a(t1)},[a,s]);return(0,E.useMemo)(()=>({setWritingFavicon:n,setCompleteFavicon:l,resetFavicon:s}),[n,l,s])})(s.faviconDelayMs||100),{playSound:u,resetSound:m}=(()=>{let e=(0,E.useRef)(null),t=(0,E.useRef)(!1);(0,E.useEffect)(()=>{try{e.current=new Audio("/click.mp3")}catch(e){}},[]);let a=(0,E.useCallback)(()=>{if(!t.current){t.current=!0;try{e.current||(e.current=new Audio("/click.mp3"))}finally{var a;null==(a=e.current)||a.play()}}},[]),s=(0,E.useCallback)(()=>{t.current=!1},[]);return(0,E.useMemo)(()=>({playSound:a,resetSound:s}),[a,s])})(),x=(0,E.useRef)(!1);(0,E.useEffect)(()=>{let e=t&&a,f=!t&&a,p=!t&&!a;e&&!x.current&&(x.current=!0);let g=p&&x.current;if(g&&(x.current=!1),n){s.changeTitle&&r(),s.changeFavicon&&c();return}s.changeTitle&&(e||f?l():g&&i()),s.changeFavicon&&(f?o():g&&(d(),x.current=!1)),s.playSound&&(e?m():g&&u())},[s,t,a,n,l,i,r,o,d,c,u,m])})(ea,tw,er);let{getCreateParamsForConvo:tH}=(0,x.I)();(0,E.useEffect)(()=>{if(ed)return;let e=tH(es);e&&void 0!==e.prompt&&(e.prompt.length>0||e.files.length>0||e.attachments.length>0||e.syncSources.length>0)&&e4({...e,createConversationParams:e.inlineCreateConversationParams}).catch(()=>{var t;null==(t=e3.current)||t.setContent(e.prompt,e.attachments,e.files)})},[es,e4,tH,ed]);let{data:tY}=(0,O.fo)(ep),tV=(0,P.K)(),tK=(0,D.ED)(ep),{mutate:t8,isPending:ae}=(0,n.aC)(es),at=(0,x.E)(),aa=(0,E.useCallback)((e,t)=>{eQ({type:"CLEAR_SELECTED"}),null==X||X(e,t)},[X,eQ]),as=(0,c.Z3)(es);(0,tC.hq)(es);let an=(0,E.useMemo)(()=>!!eD&&!er&&!!eD.content&&eD.content.some(e=>"tool_use"===e.type&&"end_conversation"===e.name),[eD,er]),{activeModelOptions:al}=(0,m.A9)(),ai=L.YO(L.Yj()),ar=(0,v.T9)("invite_contest_name","model_prefixes",[],ai),{data:ao}=(0,n.Fn)();(0,E.useEffect)(()=>{if(!er&&2===ec.length&&(null==eO?void 0:eO.sender)==="human"&&"assistant"===eU&&ar.some(e=>null==as?void 0:as.startsWith(e))&&ao&&ao.count>=2){let e=new CustomEvent("firstClaudeMessage",{detail:{conversationUuid:es,model:as}});window.dispatchEvent(e)}},[er,ec.length,eO,eU,as,es,ar,ao]);let ad=(0,E.useMemo)(()=>{let e=eH.formatMessage({defaultMessage:"Learn about Claude’s responses ↗",id:"dD0oo8Rjtz"}),t=al.find(e=>e.model===as);if(!t||!t.knowledgeCutoff)return e;let a=k.c9.fromFormat(t.knowledgeCutoff,"LLLL yyyy",{locale:"en-US"});if(!a.isValid)return eH.formatMessage({defaultMessage:"Knowledge limited past {cutoff}. Learn more ↗",id:"fozOi7zOey"},{cutoff:t.knowledgeCutoff});{let e=a.toLocaleString({year:"numeric",month:"long"},{locale:eH.locale});return eH.formatMessage({defaultMessage:"Knowledge limited past {cutoff}. Learn more ↗",id:"fozOi7zOey"},{cutoff:e})}},[as,al,eH]),ac=(0,E.useMemo)(()=>ts&&e$.selectedItem?e$.selectedItem:void 0,[ts,e$.selectedItem]),au=(0,E.useCallback)(e=>(0,s.jsx)(af.A,{...e,conversationUuid:es,onOpenArtifact:tm?tf:void 0,selectedDrawerItem:ac,autoscrollRef:eV,isSessionChat:eA,toolPermissionRequests:ek,onToolDecision:eM}),[es,tm,tf,ac,eA,ek,eM]),am=(null==ew?void 0:ew.type)==="local_agent_mode_session"||null==ew?void 0:ew.id,ap=(0,E.useMemo)(()=>({id:es,messagesSoFar:ec.length,files:te,attachmentsSoFar:tt.length,isSampling:er,isStoppingSampling:ae,model:as,projectKnowledgebaseTokens:null!=tK?tK:0,conversationSettings:eq,sessionId:am,isSessionActivelyWorking:eA&&er}),[tt.length,eq,es,te,ae,er,ec.length,as,tK,am,eA]),ab=(0,E.useMemo)(()=>!!eD&&!er&&"assistant"===eD.sender&&eD.content&&eD.content.some(e=>"tool_result"===e.type&&"web_search"===e.name),[eD,er]),ay=(0,E.useCallback)(()=>{(0,r.I)(),t8(),ev&&ev()},[t8,ev]),aj=(0,E.useCallback)(async e=>{await e4({prompt:e.prompt,attachments:[],files:e.files,syncSources:[]})},[e4]),aw=(0,E.useMemo)(()=>{var e;return(null==ap||null==(e=ap.conversationSettings)?void 0:e.create_mode)&&0===ec.length?null:an?(0,s.jsx)("div",{ref:e2.chatInput,className:"sticky bottom-0 mx-auto w-full pt-6 z-[5]",children:(0,s.jsx)(tk,{conversationUuid:es})}):(0,s.jsxs)("div",{ref:e2.chatInput,className:"sticky bottom-0 mx-auto w-full pt-6 z-[5] relative",children:[(0,s.jsx)(t6,{autoscrollRef:eV,sentinelElement:eJ,isStreaming:er,avatarState:tq}),(0,s.jsx)(B.V,{ref:e3,placement:"bottom",disabled:ed||!!(eX.current&&!(0,d.GN)(eX.current)),onRetry:(e,t)=>em(e,void 0,void 0,t),disableDropZone:eR||ez,enableScreenDrop:!ez,sessionMcpServers:eN,isRunningToolOrThinking:t_}),eL&&!eA&&(0,s.jsx)("div",{role:"note",className:"bg-bg-100 text-text-500 text-center text-xs py-2",children:eo?eY:(0,s.jsx)(S(),{href:"https://support.anthropic.com/en/articles/8525154-claude-is-providing-incorrect-or-misleading-responses-what-s-going-on",target:"_blank",rel:"noopener noreferrer",className:"hover:text-text-300 transition",children:ab?(0,s.jsx)(I.A,{defaultMessage:"Claude is AI and can make mistakes. Please double-check cited sources.",id:"FGmLea0H7Z"}):(0,s.jsx)(I.A,{defaultMessage:"Claude is AI and can make mistakes. Please double-check responses.",id:"Hz3uf5n9Ga"})})})]})},[null==ap||null==(a=ap.conversationSettings)?void 0:a.create_mode,ec.length,an,e2.chatInput,eJ,er,t_,tq,ed,eR,ez,es,em,eN,eL,eA,eo,eY,ab]),aN=(0,f.u9)(),{context:a_}=(0,u.j)(es),ak=eE||eI?"compacting"===eC:(null==a_?void 0:a_.compactionStatus)&&(null==a_?void 0:a_.compactionStatus)!=="failed",aM=(0,E.useMemo)(()=>{let e=$.oz.getState(),t=function(e,t){let a=[],s=[],n=null;for(let l=0;l<e.length;l++){let i=e[l],r=t[i];if(!r){s.length>0&&(a.push(Z(s,t)),s=[],n=null);continue}"assistant"===r.sender?("assistant"===n||null===n?s.push(i):(s.length>0&&a.push(Z(s,t)),s=[i]),n="assistant"):(s.length>0&&a.push(Z(s,t)),s=[i],n="human")}return s.length>0&&a.push(Z(s,t)),a}(ec,e.messageByUuid);return t.map((a,s)=>{let n=e.messageByUuid[a.firstMessageUuid],l=e.messageByUuid[a.lastMessageUuid],i=s===t.length-1,r=s===t.length-2,o=a.isChain&&l&&n?{...n,content:a.mergedContent,stop_reason:l.stop_reason,updated_at:l.updated_at}:void 0,d=(null==l?void 0:l.sender)==="human"&&(r||i),c=s>0?t[s-1]:null;return{chain:a,displayMessage:o,isLastMsg:i,isLastHuman:d,previousMessageUuid:null==c?void 0:c.lastMessageUuid,lastMessage:l}})},[ec]);if(!eG)return null;let aC=er&&(eh||2===ec.length||ak);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ax,{isStreaming:er,conversationUuid:es,dispatchChatResource:eQ,openControlsSidebar:ti,isDrawerExpanded:ts,maxTrackedFiles:ah,selectComputerFile:tp,lastMessageUuid:eB||void 0}),(0,s.jsx)(tS.b,{autoscrollRef:eV,autoScrollInnerClassName:0===ec.length?"h-full":"",rightSidebarElement:aN?(0,s.jsx)(tb,{conversationUuid:es,projectUuid:ep,sessionId:null==ew?void 0:ew.id,isStreaming:er,isTemporary:eo,messagesLength:ec.length,debugInfo:e_}):null,mainElement:(0,s.jsx)(t9.L,{debugInfo:e_,children:(0,s.jsx)(tM._A,{conversation:ap,session:ew,projectUuid:ep,onSend:e4,onCreate:at,onStopSampling:ay,setPersonalizedStyleCallback:eg,children:(0,s.jsxs)(ei.eN,{children:[(0,s.jsx)(t3.Q,{chatId:es,chatName:eu,onSend:aj,hasFirstMessage:!!eO&&!ed}),(0,s.jsxs)("div",{className:"mx-auto flex size-full max-w-3xl flex-col md:px-2",children:[(0,s.jsx)(tU,{conversationUuid:es}),(0,s.jsx)(_.N,{mode:"wait",children:ed?(0,s.jsx)(av,{className:"pt-2",children:(0,s.jsx)(W,{})}):0===ec.length?(0,s.jsx)(s.Fragment,{children:(null==ap||null==(i=ap.conversationSettings)?void 0:i.create_mode)?(0,s.jsx)(av,{className:"pt-1",children:(0,s.jsx)(tJ,{})}):(0,s.jsx)(av,{className:"justify-center items-center",children:(0,s.jsx)(t$,{})})}):(0,s.jsxs)(av,{className:"pt-1",children:[(null==ap||null==(h=ap.conversationSettings)?void 0:h.create_mode)&&(0,s.jsx)(tJ,{selectedLabel:(null==eO||null==(N=eO.content)||null==(b=N[0])?void 0:b.type)==="text"?null==eO||null==(q=eO.content)||null==(C=q[0])?void 0:C.text:void 0,disabled:ec.length>0}),(0,s.jsx)(tA.$,{renderToolUseCell:au,toolPermissionRequests:ek,onToolDecision:eM,children:aM.map((e,t)=>{var a;return(0,s.jsx)(G.c,{lastHumanMessageRef:e2.lastHumanMessage,lastAssistantMessageRef:e2.lastAssistantMessage,previousMessageUuid:e.previousMessageUuid,messageUuid:e.chain.firstMessageUuid,...e.displayMessage&&!(er&&e.isLastMsg)&&{message:e.displayMessage},conversationUuid:es,conversationSettings:eq,isStreaming:er,isLastMessage:e.isLastMsg,isLastHumanMessage:e.isLastHuman,isFirstAssistantMessage:1===t&&"assistant"===eU,onOpenArtifact:tm?tf:void 0,onOpenWiggleFile:tp,selectAttachment:tu,changeDisplayedConversationPath:aa,editable:!0,actionEmitter:e7,onSendContinue:e6,isResearchPending:tL,isTemporary:eo,model:as,extendedThinkingSetting:null!=(a=null==eq?void 0:eq.paprika_mode)?a:null,showArtifacts:tm,chatFeedbackEnabled:tx,isInteractive:!0,shareType:null,showSharedImageMissing:!1,showSharedFileMissing:!1,isSessionConversation:eA},t)})}),ek&&eE?(0,s.jsx)(t7,{toolPermissionRequests:ek,onToolDecision:eM}):null,null,(0,s.jsx)(t4,{ref:eK}),(0,s.jsx)(ag,{isStreaming:er,hasWebSearchResponse:!!ab,shouldShowWaitingText:!!aC,retryCount:eh,conversationUuid:es,currentAvatarState:tq,scrollRef:e2.extras,isTemporary:eo,incognitoString:eY,isResearchPending:tL,enableCompassNotificationsUI:tP,enableCompletionNotificationsUI:tB,isRunningToolOrThinking:t_,tooltipContent:ad,notificationPermission:tR,enableCompassNotifications:tG,enableCompletionNotifications:tW,isCompassNotificationEnabled:tO,isCompletionNotificationEnabled:tD,isSession:eA,sessionStatusMessage:ey,debugInfo:e_,agentModeCompactionStatus:eC}),eL&&(0,s.jsx)("div",{className:"h-12"}),(0,s.jsx)(tX,{scrollRefs:e2,autoScrollRef:eV,messageCount:ec.length})]})}),aw]})]})})}),drawerElement:(0,s.jsx)(e1,{conversationUuid:es,isOpen:ts,onClose:tr,isStreaming:er,projectUuid:ep,sendMessage:e4,isTemporary:eo,resourceActivity:eS}),isDrawerOpen:!!(ts&&ta),headerProps:{conversationUuid:es,name:eu,project:tV?tY:void 0,controlsSidebarIsOpen:ts,closeControlsSidebar:tr,openControlsSidebar:ti,isStreaming:er,isLoading:ed,messagesLength:ec.length}})]})}function av(e){let{className:t,...a}=e,n=(0,v.fS)("chat-ui-core");return(0,s.jsx)("div",{...a,className:(0,N.A)("flex-1 flex flex-col px-4 max-w-3xl mx-auto w-full",!n&&"gap-3",t)})}},0xebf0737a:(e,t,a)=>{"use strict";a.d(t,{a:()=>b});var s=a(0x22102fd88),n=a(0x8daa74e8),l=a(0xf32c56dd),i=a(0x14de19ae8),r=a(0x139b5e710),o=a(0x225bae024),d=a(0x1016c6ed2),c=a(0xef41e510),u=a.n(c),m=a(0xfc89b4a4),x=a(0x1ab0d1ca1),f=a(0x38e6572),p=a(0x84bd1d62),g=a(0x11c7a82c2);function h(e){let{skillName:t,isOpen:a,isLoading:n,onConfirm:l,onCancel:i}=e,r=(0,x.A)();return(0,s.jsx)(g.R,{isOpen:a,onClose:i,onConfirm:l,title:r.formatMessage({defaultMessage:"Replace “{skillName}” skill?",id:"RSqxaAn/FM"},{skillName:t}),message:r.formatMessage({defaultMessage:"There’s an existing skill with the same name. Uploading this skill will replace the existing one, which can’t be restored.",id:"dRMF/vTgCW"}),confirmText:r.formatMessage({defaultMessage:"Upload and replace",id:"TtbWBGHNcO"}),cancelText:r.formatMessage({defaultMessage:"Cancel",id:"47FYwba+bI"}),variant:"danger",isLoading:n})}function b(e){let{file:t,conversationUuid:a,source:c,variant:g="ghost",size:b="default",className:v}=e,{activeOrganization:y}=(0,i.YL)(),{addError:j,addSuccess:w}=(0,r.Yf)(),N=(0,l.st)(),_=(0,x.A)(),[k,M]=(0,m.useState)(!1),[C,S]=(0,m.useState)(!1),[A,E]=(0,m.useState)(""),[I,T]=(0,m.useState)(!1),[L,R]=(0,m.useState)(null),[F,z]=(0,m.useState)(!1),O=(0,p.oE)({meta:{noToast:!0},onSuccess:e=>{let{skill:t,validationErrors:a}=e;(I?T:M)(!1),t&&(z(!0),w((0,s.jsxs)("span",{children:[(0,s.jsx)(f.A,{defaultMessage:"Copied to your skills. ",id:"RJYNGpZpGZ"}),(0,s.jsx)(u(),{href:"/settings/capabilities#skills",className:"underline hover:no-underline",children:(0,s.jsx)(f.A,{defaultMessage:"Manage",id:"0AzlrbMWV9"})})]})),I&&(S(!1),R(null),E(""))),a.length>0&&a.forEach(e=>{j(e.message,{errorContext:{tags:{code:e.error_code}}})})},onError:e=>{e instanceof d.LG&&"upload_skill_already_exists"===e.errorCode?(E(e.extra.details.skill_name),S(!0),M(!1)):((I?T:M)(!1),j(e instanceof Error&&e.message?e.message:_.formatMessage({defaultMessage:"Failed to upload skill. You can try again.",id:"3wfKKwlXcY"}),{error:e,errorContext:{tags:{source:"skill_file_upload"}},messageForLogging:"Failed to upload skill."}))}}),U=(0,m.useCallback)(async(e,t)=>{let a=t?T:M;a(!0);try{let a=new FormData;a.append("file",e),a.append("overwrite",t?"true":"false"),await O.mutateAsync(a)}catch(e){a(!1)}},[O]),D=(0,m.useCallback)(async()=>{if(null==y?void 0:y.uuid){N.track({event_key:"claudeai.skills.file_save_skill.clicked",source:c,file_path:t.path}),M(!0);try{let e=(0,n.T)({organizationUuid:y.uuid,conversationUuid:a,filePath:t.path.replace(/^computer:\/\//,""),isShared:!1}),s=await fetch(e);if(!s.ok)throw Error("Failed to download file: ".concat(s.status," ").concat(s.statusText));let l=await s.blob(),i=t.path.split("/").pop()||"skill.skill",r=new File([l],i,{type:l.type});R(r),await U(r,!1)}catch(t){M(!1);let e=t instanceof Error?t:Error(String(t));j(e.message||_.formatMessage({defaultMessage:"Failed to download and upload skill. You can try again.",id:"KTwAodcnD6"}),{error:e,errorContext:{tags:{source:"skill_file_download"}},messageForLogging:"Failed to download and upload skill."})}}},[y,N,a,t.path,c,U,j,_]),P=(0,m.useCallback)(async()=>{L&&await U(L,!0)},[L,U]),B=(0,m.useCallback)(()=>{S(!1),R(null),E(""),T(!1)},[]);return t.path.endsWith(".skill")?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.$,{variant:g,size:b,loading:k,disabled:F,onClick:e=>{e.preventDefault(),e.stopPropagation(),D()},className:v,children:F?(0,s.jsx)(f.A,{defaultMessage:"Copied",id:"p556q3uvbn"}):(0,s.jsx)(f.A,{defaultMessage:"Copy to your skills",id:"Oiktxwaujx"})}),(0,s.jsx)(h,{skillName:A,isOpen:C,isLoading:I,onConfirm:P,onCancel:B})]}):null}},0xee2e6e74:(e,t,a)=>{"use strict";a.d(t,{ME:()=>x,US:()=>p,tE:()=>f,y8:()=>g});var s=a(0x22102fd88),n=a(0x19c88845),l=a(0x23977865),i=a(0x1bd175d8c),r=a(0x1a1f6dda6),o=a(0x203eb31fb),d=a(0x1ab0d1ca1),c=a(0x1cf5ab98a),u=a(0x2fb9ea43),m=a.n(u);let x=6500;function f(e){let{children:t}=e,a=(0,d.A)();return(0,s.jsx)(o.Kq,{swipeDirection:"right",label:a.formatMessage({defaultMessage:"Notification",id:"0V1V61s69r"}),children:t})}function p(){let e=(0,d.A)(),t=(0,i.V)(l.E_);return(0,s.jsx)(o.LM,{className:(0,r.A)("fixed right-0 top-0 z-toast flex flex-col gap-3 p-4",t&&l.DG),label:e.formatMessage({defaultMessage:"Notifications (F8)",id:"1hc+xdSt1a"}),role:"status","aria-atomic":void 0})}function g(e){let{title:t,message:a,type:l,debugDetails:i,onOpenChange:u,duration:f=x}=e,p=(0,d.A)(),g="error"===l?n.Warning:n.Info;return(0,s.jsx)(o.bL,{duration:f,onOpenChange:u,role:void 0,"aria-atomic":void 0,className:(0,r.A)("flex justify-end",m().toastAnimation),children:(0,s.jsxs)("div",{"data-color-context":"error"===l?"danger":void 0,className:(0,r.A)("max-w-lg rounded-xl border-0.5 shadow-md p-2 text-sm overflow-hidden bg-bg-000 border-border-100","error"===l&&"bg-danger-900 border-danger-200"),children:[(0,s.jsxs)("div",{className:(0,r.A)("flex gap-2 justify-between ml-1","error"===l&&"text-danger-000"),children:[(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)("div",{className:"h-6 flex items-center",children:(0,s.jsx)(g,{size:20,alt:p.formatMessage({defaultMessage:"Error",id:"KN7zKn8z4F"})})}),(0,s.jsxs)("div",{className:"mt-0.5",children:[t&&(0,s.jsx)(o.hE,{className:"font-base-bold",children:t}),(0,s.jsx)(o.VY,{children:a})]})]}),(0,s.jsx)(o.bm,{asChild:!0,children:(0,s.jsx)(c.$,{variant:"ghost",size:"icon_xs","aria-label":p.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}),colorized:!0,children:(0,s.jsx)(n.X,{size:12})})})]}),i&&(0,s.jsx)("div",{className:"bg-bg-300 border-border-300 -mx-2 -mb-2 mt-2 rounded-b-lg border-t-0.5 px-2 py-1.5 font-mono text-xs text-text-300",children:i})]})})}},0xf02ef1a6:(e,t,a)=>{"use strict";a.d(t,{K:()=>h,h:()=>b});var s=a(0x22102fd88),n=a(0xf32c56dd),l=a(0x14de19ae8),i=a(0x19c88845),r=a(0x1d0c32e96),o=a(0x401a1006),d=a(0x225bae024),c=a(0x183548b63),u=a(0x1b813d90),m=a(0xfc89b4a4),x=a(0x38e6572),f=a(0x1334f6ecc),p=a(0x4d9fc74e),g=a(0x18175ce17),h=function(e){return e.NOT_CONNECTED="not_connected",e.MISSING_SCOPE="missing_scope",e.UNKNOWN="unknown",e}({});let b=e=>{let{isOpen:t,onClose:a,errorType:h,onConnectionSuccess:b,callerIdentifier:v,pathname:y}=e,j=(0,n.st)(),{activeOrganization:w}=(0,l.YL)(),[N,_]=(0,m.useState)(!1),k=(0,g.kO)(),{serverId:M}=(0,f.cj)(),C=(0,p.QD)({pathname:y,queryString:"gdrive_export_success=".concat(v||"gdrive-export-modal")}),{initDriveAuth:S}=(0,f.cI)({callerIdentifier:v||"gdrive-export-modal",pathname:y,handleAuthSuccess:()=>{_(!1),j.track({event_key:"wiggle.gdrive.connection.success",organization_id:null==w?void 0:w.uuid,error_type:h,caller_identifier:v}),a(),setTimeout(()=>{null==b||b()},100)}});if((0,g.FZ)({callerIdentifier:v||"gdrive-export-modal",successParam:"gdrive_export_success",handleOpen:()=>{_(!1),j.track({event_key:"wiggle.gdrive.connection.success",organization_id:null==w?void 0:w.uuid,error_type:h,caller_identifier:v}),a(),setTimeout(()=>{null==b||b()},100)}}),(0,m.useEffect)(()=>{t&&j.track({event_key:"wiggle.gdrive.connection.modal_shown",organization_id:null==w?void 0:w.uuid,error_type:h,caller_identifier:v})},[t,h,v,null==w?void 0:w.uuid,j]),"unknown"===h)return null;let{title:A,description:E,buttonText:I}=(()=>{switch(h){case"not_connected":return{title:"Connect Claude to Google Drive",description:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"This will allow Claude to:",id:"Fh77iGv4CM"})}),(0,s.jsxs)("ul",{className:"list-disc pl-5 text-sm text-text-300 space-y-1",children:[(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Add DOCX, XLSX, and PPTX files that it creates directly to Google Drive",id:"H4PCn1IJGu"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Search and summarize Google Drive files",id:"o+UM/Lfa+u"})})]})]}),buttonText:"Connect"};case"missing_scope":return{title:"Reconnect Claude to Google Drive",description:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"This will give Claude permission to see, edit, create, and delete files that it creates in Google Drive.",id:"vHppAPeTNV"})}),(0,s.jsx)(o.l,{icon:i.Info,message:(0,s.jsx)(x.A,{defaultMessage:"You’ll only need to do this once. Any existing Google Drive capabilities in Claude will still work.",id:"v8YR2us4Y6"})})]}),buttonText:"Reconnect"}}})();return(0,s.jsx)(c.aF,{modalSize:"lg",isOpen:t,onClose:a,hasCloseButton:!0,title:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(r.A9,{type:u.v8.GDRIVE,size:20}),(0,s.jsx)("span",{children:A})]}),children:(0,s.jsxs)("div",{className:"mt-5 space-y-6",children:[E,(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(d.$,{onClick:a,variant:"secondary",children:(0,s.jsx)(x.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(d.$,{onClick:()=>{_(!0),j.track({event_key:"wiggle.gdrive.connection.initiated",organization_id:null==w?void 0:w.uuid,error_type:h,caller_identifier:v}),k&&M?C({uuid:M,url:"https://api.anthropic.com/mcp/gdrive/sse"}):S()},loading:N,disabled:N,children:I})]})]})})}},0x1050bd590:(e,t,a)=>{"use strict";a.d(t,{L:()=>C,d:()=>S});var s=a(0x22102fd88),n=a(0x1381f2bb),l=a(0x14de19ae8),i=a(0xac309a83),r=a(0x1888e36ef),o=a(0xa0ad5e93),d=a(0xf0b8bdc2),c=a(0xf0b8fe63),u=a(0xa7346e51),m=a(0x206efe2ad),x=a(0x966ab2f0),f=a(0xfc89b4a4),p=a(0x1ab0d1ca1),g=a(0x38e6572),h=a(0x156c4e43b),b=a(0x1037073d3),v=a(0xe824fb1c),y=a(0xde8f44d0),j=a(0x1e140f433),w=a(0x1df1902be),N=a(0x152f2a28d),_=a(0x1f7748bd);let k=h.g1(h.Ik({name:h.Yj(),icon:h.Yj()})),M={FileMagnifyingGlass:o.C5,FilePlus:d.p,FileText:c.i,MagnifyingGlass:u.e,PencilSimple:m.I,Terminal:x.B},C=e=>{let{input:t,toolResult:a}=e,n=(0,p.A)(),{activeOrganization:i}=(0,l.YL)(),r=null==i?void 0:i.uuid,o="";if(void 0!==t){try{o=JSON.stringify(t,null,2)}catch(e){o=String(t)}o=(o=o.replace(/\\n/g,"\n").replace(/\\t/g,"	")).replace(RegExp('(?<!\\\\)"',"g"),"`")}return(0,s.jsxs)("div",{className:"flex flex-col gap-3 p-3 pt-1",children:[(0,s.jsx)(y.z,{title:n.formatMessage({defaultMessage:"Request",id:"p1P+hQq6tY"}),language:"javascript",code:o}),null==a?void 0:a.content.map((e,t)=>"text"===e.type?(0,s.jsx)(y.z,{title:n.formatMessage({defaultMessage:"Response",id:"MgdnPiJHcj"}),language:"json",code:e.text},t):"image"===e.type?(0,s.jsx)("img",{src:"/api/".concat(r,"/files/").concat(e.file_uuid,"/preview"),alt:n.formatMessage({defaultMessage:"Tool result",id:"OJmR+3dTK6"}),className:"max-w-md max-h-md h-auto rounded-md"},t):void 0)]})},S=e=>{var t,a;let{toolName:l,toolMessage:o,integrationName:d,integrationIcon:c,approvalData:u,isSessionChat:m,...x}=e,{input:p,toolResult:h,groupItemKey:y,autoscrollRef:S,shareType:A,mcpAuthRequired:E}=x,I=(0,r.q)(),T=(0,f.useRef)(!1),L=!!(null==u?void 0:u.approvalRequired),[R,F]=(0,f.useState)(!1),z=L||!!E&&!R,{isExpanded:O,setIsExpanded:U,snappyTransition:D}=(0,_.a)(!1,y,z),P=z||!!A,B=(0,i.iW)("claudeai_yukon_gold_tool_display",{},k)[l],G=(0,v.pK)(l),W=(null==B?void 0:B.name)||(null==G||null==(t=G.tool)?void 0:t.displayName)||l.split("__")[2]||l.split(":").pop()||l,q=(null==B?void 0:B.icon)?M[B.icon]:void 0;(0,v.Q1)();let H=(0,f.useCallback)(()=>{F(!0),U(!1)},[U]),Y=L?d?(0,s.jsx)(g.A,{defaultMessage:"Claude wants to use {toolName} from {integrationName}",id:"wPBSjwhfE4",values:{toolName:W,integrationName:d}}):(0,s.jsx)(g.A,{defaultMessage:"Claude wants to use {toolName}",id:"ZNLjFNb5bD",values:{toolName:W}}):null!=o?o:W,V=null==h||null==(a=h.content)?void 0:a[0];return(0,s.jsx)(j.sH,{isExpanded:I&&O,setIsExpanded:U,isExpandingDisabled:P,text:Y,isError:null==h?void 0:h.is_error,errorMessage:(null==V?void 0:V.type)==="text"?V.text:void 0,icon:q?(0,s.jsx)(n.O,{size:16,children:(0,s.jsx)(q,{size:12,className:"text-text-300"})}):(0,s.jsx)(b.z,{size:16,type:G?G.server.iconType:"favicon",src:G?G.server.iconSrc:c,name:d||W}),...x,children:(0,s.jsx)(j.NG,{isExpanded:I&&O,snappyTransition:D,onAnimationComplete:()=>{if(z&&!T.current){var e;null==S||null==(e=S.current)||e.scrollToBottom("smooth",{onlyIfPinned:!0}),T.current=!0}},isScrollable:!0,footer:L?(0,s.jsx)(N.E,{...u,setIsExpanded:U}):E&&!R?(0,s.jsx)(w.Z,{mcpAuthRequired:E,onAuthSuccess:H}):null,children:(0,s.jsx)(C,{input:p,toolResult:h})})})}},0x128782146:(e,t,a)=>{"use strict";function s(e){if(!(null==e?void 0:e.content))return[];try{if(Array.isArray(e.content)){let t=e.content.filter(e=>{var t;return"knowledge"===e.type&&(null==(t=e.metadata)?void 0:t.type)==="webpage_metadata"});if(t.length>0)return t.map(e=>{var t,a;return{title:e.title||"",url:e.url||"",siteDomain:null==(t=e.metadata)?void 0:t.site_domain,faviconUrl:null==(a=e.metadata)?void 0:a.favicon_url}})}let t="";return"string"==typeof e.content?t=e.content:Array.isArray(e.content)&&(t=e.content.filter(e=>"text"===e.type).map(e=>e.text).join("\n")),function(e){let t=e.indexOf("Links:");if(-1===t)return[];let a=e.slice(t+6).trim();if(!a.startsWith("["))return[];let s=0,n=-1,l=!1,i=!1;for(let e=0;e<a.length;e++){let t=a[e];if(i){i=!1;continue}if("\\"===t){i=!0;continue}if('"'===t){l=!l;continue}if(!l){if("["===t)s++;else if("]"===t&&0==--s){n=e+1;break}}}if(-1===n)return[];try{let e=a.slice(0,n),t=JSON.parse(e);if(!Array.isArray(t))return[];return t.filter(e=>"string"==typeof(null==e?void 0:e.url)).map(e=>{let t;try{t=new URL(e.url).hostname}catch(e){}return{title:e.title||"",url:e.url,siteDomain:t}})}catch(e){return[]}}(t)}catch(e){return[]}}a.d(t,{O:()=>s})},0x12c26b561:(e,t,a)=>{"use strict";a.d(t,{X:()=>i,c:()=>r});var s=a(0x113daa220),n=a(0xfc89b4a4),l=a(0x17e7bc007);let i=2500;function r(e){let{conversationUuid:t,refetch:a,isWorking:r,messagesLength:o,enabled:d=!0,expansionTrigger:c}=e,u=(0,l.fy)(t),m=(0,s.Y)(a,{leading:!1,delay:i});(0,n.useEffect)(()=>{d&&m()},[u,c,d]);let x=(0,n.useRef)(!1);(0,n.useEffect)(()=>{if(d&&o){if(x.current&&!r){let e=l.oz.getState(),s=e.pathUuidsByConversation[t]||[],n=s[s.length-1],i=n?e.messageByUuid[n]:void 0;if(i&&"assistant"===i.sender&&Array.isArray(i.content)&&i.content.some(e=>(null==e?void 0:e.type)==="tool_use"&&(e.input?JSON.stringify(e.input):"").includes("outputs"))){let e=setTimeout(()=>{a()},2e3);return()=>clearTimeout(e)}}x.current=r}},[r,t,a,o,d])}},0x1398bcf3b:(e,t,a)=>{"use strict";a.d(t,{O:()=>r,f:()=>i});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x1f22b8dda);let i=e=>{let{conversationUuid:t,source:a}=e,{activeOrganization:i}=(0,n.YL)(),r=null==i?void 0:i.uuid,o=(0,l.Zx)(t),d=new URLSearchParams;a&&d.append("source",a);let c=d.toString()?"?".concat(d.toString()):"";return(0,s.Sk)("/api/organizations/".concat(r,"/artifacts/").concat(t,"/versions").concat(c),{queryKey:["conversation_artifacts_query_key",{organizationUuid:r,conversationUuid:t}],enabled:!!r&&!!t&&!o,meta:{noToast:!0}})},r=e=>{let{conversationUuid:t}=e,{activeOrganization:a}=(0,n.YL)(),l=null==a?void 0:a.uuid;return(0,s.L2)("/api/organizations/".concat(l,"/conversations/").concat(t,"/wiggle/convert-file-to-artifact"),"POST",{enabled:!!l&&!!t})}},0x14769f769:(e,t,a)=>{"use strict";a.d(t,{R:()=>s.FullPageNotice});var s=a(0x14c467420)},0x152f2a28d:(e,t,a)=>{"use strict";a.d(t,{E:()=>r});var s=a(0x22102fd88),n=a(0x225bae024),l=a(0x37e18afd),i=a(0x38e6572);function r(e){let{disabled:t,submitToolApproval:a,showAlwaysAllowed:r,setIsExpanded:o}=e,d=e=>{a(e),o(!1)};return(0,l.W)("keydown",e=>{if("Escape"===e.key){e.preventDefault(),d("deny");return}if("Enter"===e.key){let t=e.metaKey||e.ctrlKey;t&&r?(e.preventDefault(),d("always")):t||(e.preventDefault(),d("once"))}}),(0,s.jsx)("div",{className:"flex flex-col gap-3 p-3 pt-0",children:(0,s.jsxs)("div",{className:"self-end flex gap-2",children:[(0,s.jsx)(n.$,{variant:"secondary",onClick:()=>d("deny"),shortcut:"escape",children:(0,s.jsx)(i.A,{defaultMessage:"Deny",id:"htvX+Z11l+"})}),r&&(0,s.jsx)(n.$,{variant:"secondary",disabled:t,onClick:()=>d("always"),shortcut:"cmd+enter",children:(0,s.jsx)(i.A,{defaultMessage:"Always allow",id:"lr3QX/nctD"})}),(0,s.jsx)(n.$,{variant:"primary",disabled:t,onClick:()=>d("once"),shortcut:"enter",children:(0,s.jsx)(i.A,{defaultMessage:"Allow once",id:"O2tb5KUxpc"})})]})})}},0x163bd16bb:(e,t,a)=>{"use strict";a.d(t,{t:()=>r});var s=a(0x22102fd88),n=a(0x14de19ae8),l=a(0x38e6572),i=a(0xbebfc702);function r(e){let t,{project:a,className:r}=e,{account:o}=(0,n.YL)();if(a.is_starter_project)t=(0,s.jsx)(l.A,{defaultMessage:"Created by Anthropic",id:"qWDgsCW3nw"});else if(a.type===i.gM.Haystack)t=(0,s.jsx)(l.A,{defaultMessage:"Created by your admin",id:"QV1CaRw5pU"});else{var d;t=(null==(d=a.creator)?void 0:d.full_name)?a.creator.uuid===(null==o?void 0:o.uuid)?(0,s.jsx)(l.A,{defaultMessage:"Created by you",id:"WEhuQZAqE6"}):(0,s.jsx)(l.A,{defaultMessage:"Created by {author}",id:"7POMfMfi+y",values:{author:a.creator.full_name}}):(0,s.jsx)(l.A,{defaultMessage:"Created by unknown",id:"QEI1plMxfE"})}return(0,s.jsx)("span",{className:r,children:t})}},0x16a96a9a2:(e,t,a)=>{"use strict";a.d(t,{W:()=>s,m:()=>n});let s=e=>(e.split("/").pop()||e).replace(/\.[^/.]+$/,"").split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),n=(e,t)=>{if(!t)return!0;let a=e.replace("computer://","");if("org_scoped"===t)return a.startsWith("/mnt/user-data/");if("public"===t)return!1;throw Error("Unknown share type: ".concat(t))}},0x16f861148:(e,t,a)=>{"use strict";a.d(t,{Dr:()=>E,Hz:()=>A,L_:()=>C,_L:()=>M,gy:()=>I});var s=a(0x22102fd88),n=a(0x1dd44336e),l=a(0xf32c56dd),i=a(0xa5acf583),r=a(0x246846ae8),o=a(0x19c88845),d=a(0x225bae024),c=a(0x183548b63),u=a(0x22fc8d729),m=a(0x1b370f49d),x=a(0x1e1f2a153),f=a(0xb844abc8),p=a(0xac309a83),g=a(0x1a1f6dda6),h=a(0x16ab3413b),b=a.n(h),v=a(0xcaa21d58),y=a(0xef41e510),j=a.n(y),w=a(0xfc89b4a4),N=a(0x38e6572),_=a(0x1ab0d1ca1);let k=e=>{let{artifact:t,selectedVersion:a,messageUuid:r,isOpen:o,richSandboxRef:d,copyToClipboard:c}=e,{track:u}=(0,l.st)(),{publishedArtifactsBaseUrl:m}=(0,i._r)(),{mutateAsync:x,isPending:f}=(0,n.yx)(),[p,g]=(0,w.useState)(),h=(0,w.useCallback)(async()=>{var e;let t=await (null==(e=d.current)?void 0:e.getScreenshot());t&&g(t)},[d]);return(0,w.useEffect)(()=>{o&&d.current&&h()},[d,o,h]),(0,s.jsx)(M,{canScreenshot:!0,title:t.title,isLoading:f,screenshot:p,fetchScreenshot:h,setScreenshot:g,handlePublishArtifact:()=>{var e;x({title:t.title,artifact_type:t.type,code_language:t.language,message_uuid:r,artifact_identifier:t.id,content:null!=(e=t.versions[a].resultState)?e:"",screenshot:p,artifact_version_uuid:t.versions[a].uuid}).then(e=>{let{published_artifact_uuid:t}=e;return c("".concat(m,"/public/artifacts/").concat(t))}),u({event_key:"artifact.publish.modal.publish_button_clicked",message_uuid:r,artifact_type:null==t?void 0:t.type,artifact_language:null==t?void 0:t.language})}})};function M(e){let{canScreenshot:t,title:a,isLoading:n,screenshot:l,fetchScreenshot:i,setScreenshot:r,handlePublishArtifact:c}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-text-400 flex flex-col gap-3 py-3",children:(0,s.jsx)("p",{children:(0,s.jsx)(N.A,{defaultMessage:"Publishing this Artifact will make it accessible to anyone on the internet and potentially visible in search engine results. Your chat will remain private.",id:"zG4O5rdNXZ"})})}),(0,s.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col sm:flex-row gap-4 rounded-xl py-3 pl-3 pr-5 items-center",children:[t?(0,s.jsxs)("div",{className:"relative group w-[160px] h-[84px]",children:[(0,s.jsxs)("div",{className:"rounded-lg overflow-hidden shrink-0 relative w-full h-full",children:[l?(0,s.jsx)("img",{src:l,alt:a,className:"w-full h-auto bg-always-white"}):(0,s.jsx)(v.default,{src:"/images/claude_ogimage.png",alt:a,className:"w-full h-auto",width:1138,height:640}),!l&&(0,s.jsx)(L,{handleCapture:()=>void i()})]}),l&&(0,s.jsx)("div",{className:"absolute top-0 right-0 translate-x-1/4 -translate-y-1/4 hidden group-hover:block",children:(0,s.jsx)(T,{handleRemove:()=>r(void 0)})})]}):null,(0,s.jsx)("div",{children:null!=a?a:(0,s.jsx)(N.A,{defaultMessage:"Claude Artifact",id:"l6aMQuX1m4"})})]}),(0,s.jsxs)("div",{className:"bg-bg-300 text-text-300 mt-3 flex gap-3 rounded-xl px-4 py-3 text-sm leading-normal",children:[(0,s.jsx)(o.Info,{size:16,className:"mt-0.5 shrink-0"}),(0,s.jsx)("span",{children:(0,s.jsx)(N.A,{defaultMessage:"Anthropic’s <link>Usage Policy</link> prohibits use of Claude for harmful use cases like producing violent, abusive, or deceptive content. Don’t share personal information or third-party content without permission.",id:"3BDMxIIlWR",values:{link:e=>(0,s.jsx)(u.Y,{href:"https://www.anthropic.com/legal/aup",target:"_blank",children:e})}})})]}),(0,s.jsx)("div",{className:"mt-3 flex w-full items-center justify-end gap-2",children:(0,s.jsx)(d.$,{size:"lg",loading:n,onClick:c,children:(0,s.jsx)(N.A,{defaultMessage:"Publish & copy link",id:"q8Svey6avC"})})})]})}let C=e=>{let{artifactUuid:t,publishedLink:a,onClose:l,onUnpublish:i}=e,{copyToClipboard:r,didCopy:c}=(0,x.C)(),{mutateAsync:u,isPending:m}=(0,n.lT)(t),f=async()=>{await u({}),null==i||i(),l()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"border-0.5 border-border-300 text-text-100 flex flex-col rounded-xl my-3",children:[(0,s.jsxs)("div",{className:"border-b-0.5 border-border-300 flex gap-3 py-3 pl-3 pr-5",children:[(0,s.jsx)("div",{children:(0,s.jsx)(o.Globe,{className:"mt-1",size:16})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h6",{className:"font-medium",children:(0,s.jsx)(N.A,{defaultMessage:"Published (Public)",id:"7G+T0FbG5h"})}),(0,s.jsx)("p",{className:"text-text-300",children:(0,s.jsx)(N.A,{defaultMessage:"Anyone on the web with the link can view the Artifact only. Your chat will remain private.",id:"lJBHtZSUCz"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 py-3 pl-3 pr-5",children:[(0,s.jsx)(j(),{className:"text-text-300 truncate text-sm",href:a,children:a}),(0,s.jsx)("div",{children:(0,s.jsx)(d.$,{variant:"ghost",className:"!text-accent-secondary-000 hover:bg-accent-secondary-900 font-medium",onClick:()=>{r(a)},prepend:c?(0,s.jsx)(o.CheckCircle,{size:16}):(0,s.jsx)(o.LinkSimple,{size:16}),children:c?(0,s.jsx)(N.A,{defaultMessage:"Link copied",id:"zU/q1NoIdN"}):(0,s.jsx)(N.A,{defaultMessage:"Copy link",id:"lbr3Lq2Lnm"})})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(d.$,{size:"lg",variant:"secondary",loading:m,onClick:f,children:(0,s.jsx)(N.A,{defaultMessage:"Unpublish",id:"VjZ6FKc+ZZ"})}),(0,s.jsxs)("p",{className:"text-text-400 text-xs",children:[(0,s.jsx)(N.A,{defaultMessage:"Once Artifact is unpublished, it cannot be republished.",id:"HKGP87Xpbb"}),(0,s.jsx)("br",{}),(0,s.jsx)(N.A,{defaultMessage:"A new Artifact must be created.",id:"vWfM4LMkFW"})]})]})]})},S=e=>e.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0);function A(e){let{artifactUuid:t,closeEmbedSettings:a,embedLink:l}=e,i=(0,_.A)(),{mutateAsync:c}=(0,n.eH)(t),{data:u,isSuccess:m}=(0,n.gY)(t),{copyToClipboard:f,didCopy:p}=(0,x.C)(),g='<iframe src="'.concat(l,'" title="Claude Artifact" width="100%" height="600" frameborder="0" allow="clipboard-write" allowfullscreen></iframe>'),[h,v]=(0,w.useState)(""),[y,j]=(0,w.useState)(!1),[k,M]=(0,w.useState)(!1),C=/^(?:(\*\.)?)(?:[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,24}[a-z0-9]$/,A=S(h),E=A.filter(e=>!C.test(e)),[I,T]=(0,w.useState)([]),L=!b()([...A].sort(),[...I].sort());(0,w.useEffect)(()=>{if(u){var e,t;let a=null!=(t=null==(e=u.embed_whitelist)?void 0:e.join(", "))?t:"";v(a),T(S(a))}},[m,u]);let R=async()=>{t&&(await c({embed_whitelist:A}),T(A),M(!0))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-text-100 font-base-bold",children:(0,s.jsx)(N.A,{defaultMessage:"Allowed domains",id:"J1MOf/PGed"})}),(0,s.jsx)("p",{className:"text-text-300 font-small mb-2",children:(0,s.jsx)(N.A,{defaultMessage:"Only these domains can embed this artifact. Separate with commas.",id:"mySCaN71No"})}),(0,s.jsx)(r.fs,{value:h,onValueChange:e=>{v(null!=e?e:""),j(!0),M(!1)},onBlur:()=>{j(!1),L&&0===E.length&&R()},placeholder:"www.example.com, www.myblog.com",minRows:1,className:"text-sm"}),(0,s.jsx)("div",{className:"font-base mt-2 text-danger-000",children:E.length>0&&!y?1===E.length?i.formatMessage({defaultMessage:"{invalidDomain} is not a valid domain",id:"4BVWTznQQj"},{invalidDomain:E[0]}):i.formatMessage({defaultMessage:"{invalidDomains} are not valid domains",id:"woDBbyq+SX"},{invalidDomains:"".concat(E.slice(0,E.length-1).join(", ")," and ").concat(E[E.length-1])}):void 0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-text-100 font-base-bold mb-2",children:(0,s.jsx)(N.A,{defaultMessage:"Embed code",id:"O4prKQr/hN"})}),(0,s.jsx)(r.fs,{value:g,readOnly:!0,className:"text-sm read-only:text-text-200 read-only:!opacity-100",rows:5}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-4",children:[k&&(0,s.jsxs)("div",{className:"text-xs flex-grow flex items-center gap-1",children:[(0,s.jsx)(o.Check,{size:12,className:"inline"}),(0,s.jsx)(N.A,{defaultMessage:"Saved",id:"fsB/4pdUqN"})]}),(0,s.jsx)(d.$,{size:"default",variant:"secondary",onClick:a,children:(0,s.jsx)(N.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(d.$,{size:"default",variant:"primary",prepend:p?(0,s.jsx)(o.CheckCircle,{size:14}):(0,s.jsx)(o.Copy,{size:14}),onClick:()=>f(g),className:"w-28",children:(0,s.jsx)(N.A,{defaultMessage:"Copy code",id:"CNXQN5zp9z"})})]})]})]})}let E=e=>{let t,a,{onClose:n,isOpen:l,artifact:r,selectedVersion:d,messageUuid:u,publishedArtifactUuid:m,richSandboxRef:f}=e,p=(0,_.A)(),{publishedArtifactsBaseUrl:h,publishedArtifactsEmbedBaseUrl:b}=(0,i._r)(),v=!!m,[y,j]=(0,w.useState)(!1),M="".concat(h,"/public/artifacts/").concat(m),S="".concat(b,"/public/artifacts/").concat(m,"/embed"),[E,T]=(0,w.useState)("");(0,w.useEffect)(()=>{if(""===E)return;let e=setTimeout(()=>T(""),5e3);return()=>clearTimeout(e)},[E]);let{copyToClipboard:L}=(0,x.C)(),R=v?"shared":"private",F=(0,w.useRef)(R);F.current!==R&&("private"===R&&T(p.formatMessage({defaultMessage:"Artifact no longer published",id:"2ERgiFTuIj"})),F.current=R);let z=()=>{T(""),j(!1),n()};return y?(t=(0,s.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,s.jsx)("button",{onClick:()=>j(!1),children:(0,s.jsx)(o.CaretLeft,{})}),(0,s.jsx)(N.A,{defaultMessage:"Get embed code",id:"3TjDDwZ836"})]}),a=(0,s.jsx)(A,{artifactUuid:null!=m?m:"",closeEmbedSettings:()=>j(!1),embedLink:S})):v?(t=(0,s.jsx)(N.A,{defaultMessage:"Artifact published",id:"ykyvCB8a6W"}),a=(0,s.jsx)(C,{artifactUuid:null!=m?m:"",publishedLink:M,onClose:z})):(t=(0,s.jsx)(N.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"}),a=(0,s.jsx)(k,{artifact:r,selectedVersion:d,messageUuid:u,isOpen:l,richSandboxRef:f,copyToClipboard:L})),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(c.aF,{title:(0,s.jsx)("span",{className:"text-text-200 font-heading  font-medium",children:t}),isOpen:l,onClose:z,modalSize:"lg",hasCloseButton:!0,className:(0,g.A)(!y&&"-mt-20","!p-8 !rounded-2xl"),children:[(0,s.jsxs)("div",{className:"mt-2 flex flex-col gap-2.5",children:[E&&(0,s.jsx)("div",{className:"bg-accent-secondary-900 text-accent-secondary-000 rounded-2xl px-3 py-2 text-sm",children:E}),a]}),(0,s.jsx)(I,{isPublished:v,onOpen:()=>{j(!0)}})]})})};function I(e){let{isPublished:t=!0,isEmbedSettingsOpen:a=!1,onOpen:n}=e;return(0,p.fS)("embed_artifacts")&&t&&!a?(0,s.jsx)("div",{className:"absolute top-full left-0 right-0 mt-3",children:(0,s.jsx)("div",{className:"bg-bg-100 border-0.5 border-border-300 rounded-2xl shadow-lg p-3",onClick:n,children:(0,s.jsxs)(d.$,{variant:"ghost",className:"flex items-center justify-between py-3 pl-3 pr-3 cursor-pointer hover:bg-bg-200/50 transition-colors rounded-xl w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded-md flex items-center justify-center",children:(0,s.jsx)(o.CodeBlock,{size:16,className:"text-text-300"})}),(0,s.jsx)("span",{className:"text-text-100",children:(0,s.jsx)(N.A,{defaultMessage:"Get embed code",id:"3TjDDwZ836"})})]}),(0,s.jsx)(o.CaretRight,{size:16,className:"text-text-300"})]})})}):null}let T=e=>{let{handleRemove:t}=e;return(0,s.jsx)(m.m,{tooltipContent:(0,s.jsx)(N.A,{defaultMessage:"Remove",id:"G/yZLul6P1"}),side:"bottom",children:(0,s.jsx)("button",{className:(0,g.A)("transition-all hover:bg-bg-000/50 text-text-500 hover:text-text-200 w-5 h-5 rounded-full border-0.5 border-border-300/25 bg-bg-000/90 backdrop-blur-sm flex items-center justify-center",(0,f.Fr)()&&"!opacity-100 !bg-bg-000/50"),onClick:e=>{e.stopPropagation(),e.preventDefault(),t()},children:(0,s.jsx)(o.X,{size:12})})})},L=e=>{let{handleCapture:t}=e;return(0,s.jsx)("div",{className:"absolute inset-0 items-center justify-center bg-accent-main-900/20 hidden group-hover:flex",children:(0,s.jsx)(m.m,{tooltipContent:(0,s.jsx)(N.A,{defaultMessage:"Capture screenshot",id:"4aPgLNzYUy"}),side:"right",children:(0,s.jsx)(d.$,{variant:"secondary",size:"icon",onClick:t,className:"!bg-bg-100",children:(0,s.jsx)(o.Camera,{})})})})}},0x177b82062:(e,t,a)=>{"use strict";a.d(t,{h:()=>o});var s=a(0x22102fd88),n=a(0x246846ae8),l=a(0x19c88845),i=a(0xfc89b4a4),r=a(0x1ab0d1ca1);let o=(0,i.memo)(e=>{let{viewing:t,onViewingChange:a}=e,i=(0,r.A)();return(0,s.jsx)(n.Iz,{options:[{key:"normal",label:(0,s.jsx)(l.Eye,{size:20}),ariaLabel:i.formatMessage({defaultMessage:"Preview",id:"TJo5E6JuIN"})},{key:"raw",label:(0,s.jsx)(l.Code,{size:20}),ariaLabel:i.formatMessage({defaultMessage:"Code",id:"h2vipunVVd"})}],selectedKey:t,onSelect:e=>a("normal"===e?"normal":"raw"),itemClassName:"!px-1"})});o.displayName="FileViewModeToggle"},0x185cf2deb:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(0x22102fd88),n=a(0xab069d99),l=a(0x1a1f6dda6),i=a(0xfc89b4a4);function r(e){let{ref:t,children:a,parentClassName:r,innerClassName:o,pinToBottomConfig:d={disabled:!1,initialValue:!1},containerRef:c}=e,u=(0,i.useRef)((null==c?void 0:c.current)||null),m=(0,n.pc)(c,u),x=(0,i.useRef)(null),f=(0,i.useRef)(d.initialValue),p=(0,i.useRef)(!1),g=(0,i.useRef)(!1),h=(0,i.useRef)(null),b=(0,i.useRef)(0),v=(0,i.useCallback)(()=>u.current,[]),y=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",t=arguments.length>1?arguments[1]:void 0;if(!u.current||(null==t?void 0:t.onlyIfPinned)&&!f.current)return;let{scrollHeight:a,scrollTop:s,clientHeight:n}=u.current;s>a-n||(g.current=!0,u.current.scrollTo({top:u.current.scrollHeight,behavior:e}),h.current&&clearTimeout(h.current),h.current=window.setTimeout(()=>{g.current=!1},0))},[]),j=(0,i.useCallback)(e=>{f.current=e},[]);return(0,i.useImperativeHandle)(t,()=>({getScrollContainer:v,scrollToBottom:y,setPinToBottom:j,innerRef:x}),[v,y,j]),(0,i.useLayoutEffect)(()=>{let e=u.current,t=x.current;if(!e||!t||d.disabled)return;let a=()=>{if(g.current)return;let{scrollHeight:t,scrollTop:a,clientHeight:s}=e,n=8>Math.floor(t-a-s);p.current=n;let l=a<b.current;b.current=a,!n&&l&&(f.current=!1)},s=new ResizeObserver(()=>{f.current&&y()});return e.addEventListener("scroll",a),s.observe(t),s.observe(e),()=>{e.removeEventListener("scroll",a),s.disconnect(),h.current&&clearTimeout(h.current)}},[x,d.disabled,y]),(0,s.jsx)("div",{className:(0,l.A)("overflow-y-scroll overflow-x-hidden",r),ref:m,children:(0,s.jsx)("div",{className:(0,l.A)("relative w-full min-h-full",o),ref:x,children:a})})}},0x18ca729ac:(e,t,a)=>{"use strict";a.d(t,{EI:()=>n,_H:()=>i,_x:()=>l});var s=a(0x149068dd9);function n(e){if(0===e.length)return!1;let t=e[0].path.split("/").filter(Boolean);if(0===t.length)return!1;let a=t[0];return e.every(e=>{let t=e.path.split("/").filter(Boolean);return t.length>0&&t[0]===a})}function l(e){let t=function(e){if(0===e.length)throw Error("Cannot find common root directory: no files provided");let t=e[0].path.split("/").filter(Boolean);if(0===t.length)throw Error("Cannot find common root directory: invalid file path");let a=t[0];if(!e.every(e=>{let t=e.path.split("/").filter(Boolean);return t.length>0&&t[0]===a}))throw Error("Cannot find common root directory: files do not share a common root");return a}(e),a={name:"",path:"",type:"directory",children:[]};for(let s of e){let e=s.path.split("/").filter(Boolean);e[0]===t&&e.shift();let n=a;for(let t=0;t<e.length;t++){let a=e[t],l=t===e.length-1,i=e.slice(0,t+1).join("/");n.children||(n.children=[]);let r=n.children.find(e=>e.name===a);r||(r={name:a,path:i,type:l?"file":"directory",children:l?void 0:[],content:l?s.content:void 0},n.children.push(r)),n=r}}return a.children&&function(e){let t=e.findIndex(e=>"SKILL.md"===e.name);if(t>0){let a=e[t];e.splice(t,1),e.unshift(a)}}(a.children),a}function i(e){var t,a;let n,l=e.match(/^---\n([\s\S]*?)\n---\n?([\s\S]*)$/);if(!l)return{description:null,otherFields:[],content:e};let i=l[1],r=l[2].trim();try{n=null!=(t=(0,s.qg)(i))?t:{}}catch(e){return{description:null,otherFields:[],content:r}}let o=function e(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let[s,n]of Object.entries(t))if(null===n||"object"!=typeof n||Array.isArray(n)){if(null!=n){let e=String(n).trim();e&&a.push({key:s,value:e})}}else e(n,a);return a}(n),d=o.find(e=>"description"===e.key);return{description:null!=(a=null==d?void 0:d.value)?a:null,otherFields:o.filter(e=>"description"!==e.key&&"name"!==e.key),content:r}}},0x18d835460:(e,t,a)=>{"use strict";a.d(t,{F:()=>s.F});var s=a(0x5497a152)},0x18f6e74fb:(e,t,a)=>{"use strict";a.d(t,{R:()=>S});var s=a(0x22102fd88),n=a(0x1a1f6dda6),l=a(0xfc89b4a4),i=a(0x38e6572),r=a(0x1ab0d1ca1),o=a(0x1d096b190);let d={GSW:{color:"#1D428A",accent:"#FFC72C"},LAL:{color:"#552583",accent:"#FDB927"},BOS:{color:"#007A33",accent:"#BA9653"},NYK:{color:"#006BB6",accent:"#F58426"},MIA:{color:"#98002E",accent:"#F9A01B"},CHI:{color:"#CE1141",accent:"#000000"},BKN:{color:"#000000",accent:"#FFFFFF"},PHX:{color:"#1D1160",accent:"#E56020"},DEN:{color:"#0E2240",accent:"#FEC524"},MIL:{color:"#00471B",accent:"#EEE1C6"},KC:{color:"#E31837",accent:"#FFB81C"},SF:{color:"#AA0000",accent:"#B3995D"},DAL:{color:"#003594",accent:"#869397"},GB:{color:"#203731",accent:"#FFB612"},ARS:{color:"#EF0107",accent:"#FFFFFF"},LIV:{color:"#C8102E",accent:"#00B2A9"},MCI:{color:"#6CABDD",accent:"#1C2C5B"},MUN:{color:"#DA291C",accent:"#FBE122"},BAR:{color:"#A50044",accent:"#004D98"},RMA:{color:"#FEBE10",accent:"#00529F"}},c={NBA:{ATL:"nba.com/hawks",BOS:"celtics.com",BKN:"nba.com/nets",CHA:"nba.com/hornets",CHI:"nba.com/bulls",CLE:"nba.com/cavaliers",DAL:"mavs.com",DEN:"nba.com/nuggets",DET:"nba.com/pistons",GSW:"warriors.com",HOU:"rockets.com",IND:"nba.com/pacers",LAC:"nba.com/clippers",LAL:"lakers.com",MEM:"nba.com/grizzlies",MIA:"nba.com/heat",MIL:"nba.com/bucks",MIN:"nba.com/timberwolves",NOP:"nba.com/pelicans",NYK:"nyknicks.com",OKC:"nba.com/thunder",ORL:"nba.com/magic",PHI:"nba.com/sixers",PHX:"nba.com/suns",POR:"nba.com/blazers",SAC:"nba.com/kings",SAS:"spurs.com",TOR:"nba.com/raptors",UTA:"utahjazz.com",WAS:"nba.com/wizards"},NFL:{ARI:"azcardinals.com",ATL:"atlantafalcons.com",BAL:"baltimoreravens.com",BUF:"buffalobills.com",CAR:"panthers.com",CHI:"chicagobears.com",CIN:"bengals.com",CLE:"clevelandbrowns.com",DAL:"dallascowboys.com",DEN:"denverbroncos.com",DET:"detroitlions.com",GB:"packers.com",HOU:"houstontexans.com",IND:"colts.com",JAX:"jaguars.com",KC:"chiefs.com",LAC:"chargers.com",LAR:"therams.com",LV:"raiders.com",MIA:"miamidolphins.com",MIN:"vikings.com",NE:"patriots.com",NO:"neworleanssaints.com",NYG:"giants.com",NYJ:"newyorkjets.com",PHI:"philadelphiaeagles.com",PIT:"steelers.com",SEA:"seahawks.com",SF:"49ers.com",TB:"buccaneers.com",TEN:"tennesseetitans.com",WAS:"commanders.com"},EPL:{ARS:"arsenal.com",AVL:"avfc.co.uk",CHE:"chelseafc.com",EVE:"evertonfc.com",LIV:"liverpoolfc.com",MCI:"mancity.com",MUN:"manutd.com",NEW:"nufc.co.uk",TOT:"tottenhamhotspur.com",WHU:"whufc.com"},LALIGA:{ATM:"atleticodemadrid.com",BAR:"fcbarcelona.com",RMA:"realmadrid.com",SEV:"sevillafc.es"}},u={PREMIERLEAGUE:"EPL",ENGLISHPREMIERLEAGUE:"EPL",LALIGASPAIN:"LALIGA",SPANISHLALIGA:"LALIGA"};function m(e){if(!e)return;let t=e.toUpperCase().replace(/\s+/g,"");return u[t]||t}function x(e){var t;if(null==e?void 0:e.primary_color)return{color:e.primary_color,accent:e.accent_color||e.primary_color};let a=null==e||null==(t=e.abbreviation)?void 0:t.toUpperCase();return a&&d[a]?d[a]:{color:"#6366f1",accent:"#a855f7"}}var f=a(0x1c29096e8);let p=(0,l.memo)(e=>{var t,a,n;let{team:i,league:r,size:o=36}=e,[d,u]=(0,l.useState)(!1),f=x(i),p=(null==i||null==(t=i.abbreviation)?void 0:t.substring(0,3))||(null==i||null==(a=i.name)?void 0:a.substring(0,2))||"??",g=null==i||null==(n=i.abbreviation)?void 0:n.toUpperCase(),h=m(r),b=h?c[h]:void 0,v=g&&b?b[g]:void 0,y=(0,l.useCallback)(()=>u(!0),[]);return(null==i?void 0:i.logo_url)&&!d?(0,s.jsx)("img",{src:i.logo_url,alt:i.name||"Team",className:"rounded-lg object-cover",style:{width:o,height:o},onError:y}):v&&!d?(0,s.jsx)("img",{src:"https://www.google.com/s2/favicons?domain=".concat(v,"&sz=64"),alt:(null==i?void 0:i.name)||g||"Team",className:"rounded-lg object-contain bg-bg-000 p-1.5 border-0.5 border-border-300",style:{width:o,height:o},onError:y}):(0,s.jsx)("div",{className:"rounded-lg flex items-center justify-center font-bold text-always-white",style:{width:o,height:o,background:"linear-gradient(135deg, ".concat(f.color," 0%, ").concat(f.accent," 100%)"),fontSize:.32*o},children:p.toUpperCase()})});p.displayName="TeamLogo";let g=(0,l.memo)(e=>{var t;let{team:a,league:n,position:i}=e,[r,o]=(0,l.useState)(!1),d=x(a),u=null==a||null==(t=a.abbreviation)?void 0:t.toUpperCase(),f=m(n),p=f?c[f]:void 0,g=u&&p?p[u]:void 0,h=(0,l.useCallback)(()=>o(!0),[]),b=(null==a?void 0:a.logo_url)||(g?"https://www.google.com/s2/favicons?domain=".concat(g,"&sz=64"):null),v={"top-left":"-top-16 -left-16","bottom-right":"-bottom-16 -right-16",center:"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"}[i];return b&&!r?(0,s.jsx)("div",{className:"absolute ".concat(v," pointer-events-none"),children:(0,s.jsx)("img",{src:b,alt:"",className:"w-44 h-44 object-contain opacity-15",style:{filter:"blur(60px) saturate(1.5)"},onError:h})}):(0,s.jsx)("div",{className:"absolute ".concat(v," pointer-events-none"),children:(0,s.jsx)("div",{className:"w-44 h-44 rounded-full opacity-8",style:{background:"radial-gradient(circle, ".concat(d.color," 0%, transparent 70%)"),filter:"blur(60px)"}})})});g.displayName="TeamGlow";let h=(0,l.memo)(()=>(0,s.jsxs)("div",{className:"rounded-2xl p-5 animate-pulse bg-bg-100",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("div",{className:"h-2 w-12 bg-bg-300 rounded"}),(0,s.jsx)("div",{className:"h-2 w-16 bg-bg-300 rounded"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"h-4 w-10 bg-bg-300 rounded"}),(0,s.jsx)("div",{className:"flex-1 h-1.5 bg-bg-300 rounded-full"}),(0,s.jsx)("div",{className:"h-6 w-8 bg-bg-300 rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"h-4 w-10 bg-bg-300 rounded"}),(0,s.jsx)("div",{className:"flex-1 h-1.5 bg-bg-300 rounded-full"}),(0,s.jsx)("div",{className:"h-6 w-8 bg-bg-300 rounded"})]})]})]}));h.displayName="ShimmerGameCard";let b=(0,l.memo)(e=>{var t,a,l,r,o,d;let{game:c,league:u}=e,m=x(c.away_team),f=x(c.home_team),h=null!=(o=c.away_score)?o:0,b=null!=(d=c.home_score)?d:0,v=h+b||1,y=h/v*100,j=b/v*100,w=h>b,N=b>h;return(0,s.jsxs)("div",{className:"relative overflow-hidden rounded-2xl bg-bg-000 border-0.5 border-border-300 shadow-sm p-5",children:[(0,s.jsx)("style",{children:"\n        @keyframes livePulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.4; }\n        }\n        @keyframes barGlow {\n          0%, 100% { filter: brightness(1); }\n          50% { filter: brightness(1.2); }\n        }\n      "}),(0,s.jsx)(g,{team:c.away_team,league:u,position:"top-left"}),(0,s.jsx)(g,{team:c.home_team,league:u,position:"bottom-right"}),(0,s.jsxs)("div",{className:"relative flex justify-between items-center mb-5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-danger-100",style:{animation:"livePulse 2s ease-in-out infinite",boxShadow:"0 0 8px hsl(var(--danger-100))"}}),(0,s.jsx)("span",{className:"font-small-bold text-text-300 uppercase tracking-widest",children:(0,s.jsx)(i.A,{defaultMessage:"Live",id:"Dn82ALx/+V"})})]}),(0,s.jsx)("span",{className:"font-small text-text-400",children:(0,s.jsx)(i.A,{defaultMessage:"{period} \xb7 {clock}",id:"GpfAmAdI2P",description:"Game period and clock separated by middle dot, e.g. 'Q3 \xb7 4:32'. The middle dot (\xb7) is a visual separator.",values:{period:c.period,clock:c.clock}})})]}),(0,s.jsxs)("div",{className:"relative space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(p,{team:c.away_team,league:u,size:32}),(0,s.jsx)("span",{className:(0,n.A)("font-base-bold flex-1",w?"text-text-100":"text-text-400"),children:(null==(t=c.away_team)?void 0:t.abbreviation)||"AWAY"}),(0,s.jsx)("div",{className:"w-24 h-1.5 bg-bg-300 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full rounded-full transition-all duration-500",style:{width:"".concat(y,"%"),background:"linear-gradient(90deg, ".concat(m.color,", ").concat(m.accent,")"),animation:w?"barGlow 3s ease-in-out infinite":"none"}})}),(0,s.jsx)("span",{className:(0,n.A)("font-xl w-10 text-right tabular-nums",w?"text-text-100":"text-text-400"),style:{fontWeight:300,letterSpacing:"-0.02em"},children:h})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(p,{team:c.home_team,league:u,size:32}),(0,s.jsx)("span",{className:(0,n.A)("font-base-bold flex-1",N?"text-text-100":"text-text-400"),children:(null==(a=c.home_team)?void 0:a.abbreviation)||"HOME"}),(0,s.jsx)("div",{className:"w-24 h-1.5 bg-bg-300 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full rounded-full transition-all duration-500",style:{width:"".concat(j,"%"),background:"linear-gradient(90deg, ".concat(f.color,", ").concat(f.accent,")"),animation:N?"barGlow 3s ease-in-out infinite":"none"}})}),(0,s.jsx)("span",{className:(0,n.A)("font-xl w-10 text-right tabular-nums",N?"text-text-100":"text-text-400"),style:{fontWeight:300,letterSpacing:"-0.02em"},children:b})]})]}),(0,s.jsxs)("div",{className:"relative flex justify-between mt-4 pt-3 border-t border-border-300",children:[(0,s.jsx)("span",{className:"font-small text-text-500",children:null==(l=c.away_team)?void 0:l.name}),(0,s.jsx)("span",{className:"font-small text-text-500",children:(0,s.jsx)(i.A,{defaultMessage:"@ {team}",id:"0GIfpEMIZZ",description:"Sports notation showing home team with @ symbol, e.g. '@ Lakers'. The @ indicates 'at' (playing at home team's venue).",values:{team:null==(r=c.home_team)?void 0:r.name}})})]})]})});b.displayName="LiveGameCard";let v=(0,l.memo)(e=>{var t,a,l,r,o,d;let{game:c,league:u}=e,m=x(c.away_team),f=x(c.home_team),h=null!=(o=c.away_score)?o:0,b=null!=(d=c.home_score)?d:0,v=h>b,y=b>h,j=v?c.away_team:c.home_team;return(0,s.jsxs)("div",{className:"relative overflow-hidden rounded-2xl bg-bg-000 border-0.5 border-border-300 shadow-sm p-5",children:[(0,s.jsx)(g,{team:j,league:u,position:"center"}),(0,s.jsx)("div",{className:"relative mb-4",children:(0,s.jsx)("span",{className:"font-small text-text-400 uppercase tracking-widest",children:(0,s.jsx)(i.A,{defaultMessage:"Final",id:"6/JzkWi0di"})})}),(0,s.jsxs)("div",{className:"relative flex items-center justify-center gap-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(p,{team:c.away_team,league:u,size:40}),(0,s.jsx)("span",{className:(0,n.A)("font-small-bold tracking-wider",v?"text-text-100":"text-text-400"),children:null==(t=c.away_team)?void 0:t.abbreviation}),(0,s.jsx)("span",{className:(0,n.A)("text-4xl",v?"text-text-100":"text-text-500"),style:{fontWeight:200,letterSpacing:"-0.04em",textShadow:v?"0 0 40px ".concat(m.color,"50"):"none"},children:h})]}),(0,s.jsx)("div",{className:"w-px h-20",style:{background:"linear-gradient(180deg, transparent, hsl(var(--text-500)), transparent)"}}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(p,{team:c.home_team,league:u,size:40}),(0,s.jsx)("span",{className:(0,n.A)("font-small-bold tracking-wider",y?"text-text-100":"text-text-400"),children:null==(a=c.home_team)?void 0:a.abbreviation}),(0,s.jsx)("span",{className:(0,n.A)("text-4xl",y?"text-text-100":"text-text-500"),style:{fontWeight:200,letterSpacing:"-0.04em",textShadow:y?"0 0 40px ".concat(f.color,"50"):"none"},children:b})]})]}),(0,s.jsx)("div",{className:"relative text-center mt-4",children:(0,s.jsx)("span",{className:"font-small text-text-500",children:(0,s.jsx)(i.A,{defaultMessage:"{awayTeam} @ {homeTeam}",id:"qJoGtx4NJ3",description:"Sports matchup notation, e.g. 'Warriors @ Lakers'. The @ means 'at' (away team playing at home team's venue).",values:{awayTeam:null==(l=c.away_team)?void 0:l.name,homeTeam:null==(r=c.home_team)?void 0:r.name}})})})]})});v.displayName="FinalGameCard";let y=(0,l.memo)(e=>{var t,a;let{game:n,league:o}=e,d=(0,r.A)(),c=(0,l.useMemo)(()=>{if(!n.start_time)return null;try{let e=new Date(n.start_time);return d.formatDate(e,{hour:"numeric",minute:"2-digit"})}catch(e){return n.start_time}},[n.start_time,d]),u=(0,l.useMemo)(()=>{if(!n.start_time)return null;try{let e=new Date(n.start_time);return d.formatDate(e,{month:"short",day:"numeric"})}catch(e){return null}},[n.start_time,d]);return(0,s.jsxs)("div",{className:"relative overflow-hidden rounded-2xl bg-bg-000 border-0.5 border-border-300 shadow-sm p-5",children:[(0,s.jsx)(g,{team:n.away_team,league:o,position:"top-left"}),(0,s.jsx)(g,{team:n.home_team,league:o,position:"bottom-right"}),(0,s.jsx)("div",{className:"relative mb-4",children:(0,s.jsx)("span",{className:"font-small text-text-400 uppercase tracking-widest",children:(0,s.jsx)(i.A,{defaultMessage:"Upcoming",id:"6/aEFZbs2i"})})}),(0,s.jsxs)("div",{className:"relative flex items-center justify-center gap-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(p,{team:n.away_team,league:o,size:48}),(0,s.jsx)("span",{className:"font-small-bold text-text-200",children:null==(t=n.away_team)?void 0:t.abbreviation})]}),(0,s.jsx)("span",{className:"font-small text-text-500 tracking-widest",children:(0,s.jsx)(i.A,{defaultMessage:"VS",id:"RGryZ4QN2Q",description:"Abbreviation for 'versus' shown between two sports teams. Common to keep as 'VS' in many languages."})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(p,{team:n.home_team,league:o,size:48}),(0,s.jsx)("span",{className:"font-small-bold text-text-200",children:null==(a=n.home_team)?void 0:a.abbreviation})]})]}),(0,s.jsxs)("div",{className:"relative flex justify-center items-baseline gap-2 mt-4",children:[(0,s.jsx)("span",{className:"font-base-bold text-text-200",children:c}),u&&(0,s.jsx)("span",{className:"font-small text-text-400",children:u})]})]})});y.displayName="UpcomingGameCard";let j=(0,l.memo)(e=>{let{game:t,league:a}=e;return"in_progress"===t.status?(0,s.jsx)(b,{game:t,league:a}):"final"===t.status?(0,s.jsx)(v,{game:t,league:a}):(0,s.jsx)(y,{game:t,league:a})});j.displayName="GameCard";let w=(0,l.memo)(e=>{let{games:t,league:a}=e;return t.length?(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.map((e,t)=>(0,s.jsx)(j,{game:e,league:a},e.id||t))}):null});w.displayName="ScoresView";let N=(0,l.memo)(e=>{var t,a,l,i,r,o;let{team:d,idx:c,totalInGroup:u,gridCols:m,dataSignature:x,isSoccer:f,league:g,intl:h}=e,b=(d.rank||c+1)===(f?4:8)&&c<u-1;return(0,s.jsxs)("div",{className:(0,n.A)("grid gap-3 px-4 py-3 items-center",c!==u-1&&!b&&"border-b border-border-300",b&&"border-b border-border-100"),style:{gridTemplateColumns:m},children:[(0,s.jsx)("div",{className:"text-center font-base-bold text-text-300",children:d.rank||c+1}),(0,s.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,s.jsx)(p,{team:d.team,league:g,size:28}),(0,s.jsx)("span",{className:"font-base-bold text-text-100 truncate",children:(null==(t=d.team)?void 0:t.name)||(null==(a=d.team)?void 0:a.abbreviation)})]}),(0,s.jsx)("div",{className:"text-center font-base tabular-nums text-text-200",children:null!=(l=d.wins)?l:"-"}),x.hasDraws&&(0,s.jsx)("div",{className:"text-center font-base tabular-nums text-text-200",children:null!=(i=d.draws)?i:"-"}),(0,s.jsx)("div",{className:"text-center font-base tabular-nums text-text-200",children:null!=(r=d.losses)?r:"-"}),x.hasPoints&&(0,s.jsx)("div",{className:"text-center font-base-bold tabular-nums text-text-100",children:null!=(o=d.points)?o:"-"}),x.hasWinPct&&(0,s.jsx)("div",{className:"text-center font-base tabular-nums text-text-200",children:void 0!==d.win_percentage?h.formatNumber(d.win_percentage,{minimumFractionDigits:3,maximumFractionDigits:3}):"-"})]})});N.displayName="StandingsRow";let _=(0,l.memo)(e=>{let{gridCols:t,dataSignature:a}=e;return(0,s.jsxs)("div",{className:"grid gap-3 px-4 py-3 border-b border-border-300 font-small-bold text-text-400 uppercase tracking-wider",style:{gridTemplateColumns:t},children:[(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i.A,{defaultMessage:"#",id:"B/4y9yCC1y",description:"Column header for rank/position number in standings table. '#' is common but can be translated to rank symbol."})}),(0,s.jsx)("div",{children:(0,s.jsx)(i.A,{defaultMessage:"Team",id:"wsUmh9XWBm"})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i.A,{defaultMessage:"W",id:"Py0U3bDvKg",description:"Column header abbreviation for 'Wins' in sports standings. Single letter abbreviation."})}),a.hasDraws&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i.A,{defaultMessage:"D",id:"L+3FNdy6+/",description:"Column header abbreviation for 'Draws' in sports standings. Single letter abbreviation."})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i.A,{defaultMessage:"L",id:"qA/DThDP/S",description:"Column header abbreviation for 'Losses' in sports standings. Single letter abbreviation."})}),a.hasPoints&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i.A,{defaultMessage:"Pts",id:"4b8nKXXh1z",description:"Column header abbreviation for 'Points' in sports standings (soccer/football leagues)."})}),a.hasWinPct&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i.A,{defaultMessage:"PCT",id:"i7pjnNOVhV",description:"Column header abbreviation for 'Winning Percentage' in sports standings."})})]})});_.displayName="StandingsHeader";let k=(0,l.memo)(e=>{let{standings:t,league:a}=e,n=(0,r.A)(),i=(0,l.useMemo)(()=>{let e=t.some(e=>void 0!==e.draws),a=t.some(e=>void 0!==e.points),s=t.some(e=>void 0!==e.win_percentage);return{hasDraws:e,hasPoints:a,hasWinPct:s,hasConference:t.some(e=>void 0!==e.conference),hasDivision:t.some(e=>void 0!==e.division)}},[t]),o=i.hasPoints||i.hasDraws,d=(0,l.useMemo)(()=>{let e=["32px","1fr","48px"];return i.hasDraws&&e.push("48px"),e.push("48px"),i.hasPoints&&e.push("48px"),i.hasWinPct&&e.push("64px"),e.join(" ")},[i]),c=(0,l.useMemo)(()=>{if(!i.hasConference&&!i.hasDivision)return null;let e=new Map,a=i.hasDivision?"division":"conference";for(let s of t){let t=s[a]||"Other";e.has(t)||e.set(t,[]),e.get(t).push(s)}return e},[t,i.hasConference,i.hasDivision]);if(!t.length)return null;if(c){let e=Array.from(c.entries());return(0,s.jsx)("div",{className:"space-y-4",children:e.map((e,t)=>{let[l,r]=e;return(0,s.jsxs)("div",{className:"rounded-2xl bg-bg-000 border-0.5 border-border-300 shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"px-4 py-2.5 bg-bg-100 border-b border-border-300",children:(0,s.jsx)("span",{className:"font-small-bold text-text-200 uppercase tracking-wider",children:l})}),(0,s.jsx)(_,{gridCols:d,dataSignature:i}),r.map((e,l)=>{var c;return(0,s.jsx)(N,{team:e,idx:l,totalInGroup:r.length,gridCols:d,dataSignature:i,isSoccer:o,league:a,intl:n},(null==(c=e.team)?void 0:c.abbreviation)||"".concat(t,"-").concat(l))})]},l)})})}return(0,s.jsxs)("div",{className:"rounded-2xl bg-bg-000 border-0.5 border-border-300 shadow-sm overflow-hidden",children:[(0,s.jsx)(_,{gridCols:d,dataSignature:i}),t.map((e,l)=>{var r;return(0,s.jsx)(N,{team:e,idx:l,totalInGroup:t.length,gridCols:d,dataSignature:i,isSoccer:o,league:a,intl:n},(null==(r=e.team)?void 0:r.abbreviation)||l)})]})});k.displayName="StandingsView";let M=(0,l.memo)(e=>{let{stats:t,category:a,league:l}=e,o=(0,r.A)();return t.length?(0,s.jsxs)("div",{className:"rounded-2xl bg-bg-000 border-0.5 border-border-300 shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border-300",children:(0,s.jsx)("span",{className:"font-small-bold text-text-400 uppercase tracking-wider",children:a||(0,s.jsx)(i.A,{defaultMessage:"Leaders",id:"AKReGzRAHX"})})}),(0,s.jsx)("div",{className:"divide-y divide-border-300",children:t.map((e,t)=>{var a,i;return(0,s.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3",children:[(0,s.jsx)("div",{className:(0,n.A)("w-7 h-7 rounded-full flex items-center justify-center font-base-bold",0===t&&"bg-warning-100 text-always-white",1===t&&"bg-bg-400 text-text-200",2===t&&"bg-accent-secondary-100 text-always-white",t>2&&"bg-bg-300 text-text-300"),children:e.rank||t+1}),(0,s.jsx)(p,{team:e.team,league:l,size:32}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-base-bold text-text-100 truncate",children:e.player_name}),(0,s.jsxs)("div",{className:"font-small text-text-300",children:[(null==(a=e.team)?void 0:a.abbreviation)||(null==(i=e.team)?void 0:i.name),e.position&&" \xb7 ".concat(e.position)]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-xl-bold text-text-100 tabular-nums",children:"number"==typeof e.stat_value?o.formatNumber(e.stat_value,{maximumFractionDigits:1}):e.stat_value}),e.stat_label&&(0,s.jsx)("div",{className:"font-small text-text-300",children:e.stat_label})]})]},e.player_name||t)})})]}):null});M.displayName="StatsView";let C=(0,l.memo)(e=>{let{activeMode:t,onModeChange:a,availableModes:n}=e,i=(0,r.A)(),d=(0,l.useMemo)(()=>[{key:"scores",label:i.formatMessage({defaultMessage:"Scores",id:"Hcfi6DFcRi"})},{key:"standings",label:i.formatMessage({defaultMessage:"Standings",id:"o2v7SB+ObO"})},{key:"stats",label:i.formatMessage({defaultMessage:"Stats",id:"U86B6w/7iP"})}],[i]),c=(0,l.useMemo)(()=>d.filter(e=>n.includes(e.key)),[d,n]);return(0,s.jsx)(o.I,{options:c,selectedKey:t,onSelect:a})});C.displayName="ViewModeToggle";let S=(0,l.memo)(e=>{var t;let{input:a,isStreaming:n}=e,r=(0,l.useMemo)(()=>(function(e){if(!e||"object"!=typeof e)return null;let t=Array.isArray(e.games)&&e.games.length>0,a=Array.isArray(e.standings)&&e.standings.length>0,s=Array.isArray(e.player_stats)&&e.player_stats.length>0;return(t||a||s)&&(void 0===e.sport||"string"==typeof e.sport)&&(void 0===e.league||"string"==typeof e.league)&&(void 0===e.title||"string"==typeof e.title)?e:null})(a),[a]),o=(0,l.useMemo)(()=>{var e,t,a;if(!r)return[];let s=[];return(null==(e=r.games)?void 0:e.length)&&s.push("scores"),(null==(t=r.standings)?void 0:t.length)&&s.push("standings"),(null==(a=r.player_stats)?void 0:a.length)&&s.push("stats"),s},[r]),[d,c]=(0,l.useState)(null),u=(0,l.useMemo)(()=>d&&o.includes(d)?d:(null==r?void 0:r.display_type)&&o.includes(r.display_type)?r.display_type:o[0]||"scores",[d,null==r?void 0:r.display_type,o]),m=(0,l.useCallback)(e=>{c(e)},[]);return n&&!r?(0,s.jsxs)(f.n2,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("div",{className:"h-5 w-32 bg-bg-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-8 w-48 bg-bg-200 rounded-lg animate-pulse"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(h,{}),(0,s.jsx)(h,{})]})]}):r?"scores"===u&&(null==(t=r.games)?void 0:t.length)===1?(0,s.jsx)("div",{className:"font-ui -mx-1 mb-4",children:(0,s.jsx)(j,{game:r.games[0],league:r.league})}):(0,s.jsxs)(f.uM,{children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("h3",{className:"font-large-bold text-text-100 truncate",children:r.title||r.league||r.sport||(0,s.jsx)(i.A,{defaultMessage:"Sports",id:"qEuXjx1B4z"})}),(r.subtitle||r.season)&&(0,s.jsx)("p",{className:"font-base text-text-300 truncate",children:r.subtitle||r.season})]}),o.length>1&&(0,s.jsx)(C,{activeMode:u,onModeChange:m,availableModes:o})]}),"scores"===u&&r.games&&(0,s.jsx)(w,{games:r.games,league:r.league}),"standings"===u&&r.standings&&(0,s.jsx)(k,{standings:r.standings,league:r.league}),"stats"===u&&r.player_stats&&(0,s.jsx)(M,{stats:r.player_stats,category:r.stat_category,league:r.league})]}):(0,s.jsx)(f.MO,{})});S.displayName="SportsToolUseCell"},0x1936feed4:(e,t,a)=>{"use strict";function s(e){throw Error("Unhandled discriminated union member: ".concat(JSON.stringify(e)))}a.d(t,{x:()=>s})},0x193cc7eb2:(e,t,a)=>{"use strict";a.d(t,{Q:()=>x,k:()=>m});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x21e26ba67),i=a(0x189ce0fd0),r=a(0x4d348f95),o=a(0xfc89b4a4),d=a(0x120e6a4a3),c=a(0xedac311);let u=null,m=e=>{u={payload:e,received:new Date}};function x(e){let{chatId:t,chatName:a,onSend:m,hasFirstMessage:x}=e,{activeOrganization:f}=(0,n.YL)(),p=(0,s.mn)(),g=(0,o.useRef)(!1),h=(0,r.useSearchParams)(),b=(0,c.useUpdateSearchParams)(),v=(0,o.useCallback)(e=>e.chatId===t&&!g.current&&!!f&&(g.current=!0,(async()=>{try{let t=[];if("images"in e)for(let a of e.images)try{t.push(...await (0,d.bl)(a.base64,a.mimeType,f.uuid,p))}catch(e){}else if(e.imageBase64&&e.imageMimeType)try{t.push(...await (0,d.bl)(e.imageBase64,e.imageMimeType,f.uuid,p))}catch(e){}return await m({prompt:e.text,files:t}),!0}catch(e){return!1}finally{g.current=!1}})(),!0),[f,t,m,p]);return(0,o.useEffect)(()=>{if(!x)return;let e=u,a="1"===h.get("desktop_quick_entry");a&&b("desktop_quick_entry",null),e&&Date.now()-e.received.getTime()<=6e4&&e.payload.chatId&&e.payload.chatId===t&&a&&(u=null,setTimeout(()=>v(e.payload),1))},[x,t,v,h,b]),(0,l._v)(i.A.ChatInfo,{getCurrentChatInfo:()=>Promise.resolve({chatId:t,chatName:a}),sendToChatWithPayload:v},[t,a,f,p,m]),null}},0x1a65cb992:(e,t,a)=>{"use strict";a.d(t,{M:()=>u});var s=a(0x22102fd88),n=a(0x1d0c32e96),l=a(0x225bae024),i=a(0x1b370f49d),r=a(0x38e6572),o=a(0x18175ce17),d=a(0xf02ef1a6),c=a(0x21010ec24);function u(e){let{file:t,conversationUuid:a,source:u,variant:m="ghost",size:x="icon_lg",className:f}=e,p=(0,o.kO)(),{handleOpenInGoogleDrive:g,showConnectionModal:h,setShowConnectionModal:b,connectionError:v,isExporting:y}=(0,c.N)({conversationUuid:a,source:u});return(0,c.z)(t.path,p)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.m,{tooltipContent:(0,s.jsx)(r.A,{defaultMessage:"Open in Drive",id:"r80/2fFyeU"}),side:"bottom",children:(0,s.jsx)(l.$,{variant:y?"secondary":m,size:x,loading:y,onClick:e=>{e.preventDefault(),e.stopPropagation(),g(t.path)},className:f,children:!y&&(0,s.jsx)(n.ft,{size:"icon_sm"===x?16:"icon"===x?20:24})})}),(0,s.jsx)(d.h,{isOpen:h,onClose:()=>{b(!1)},errorType:v,callerIdentifier:"google-drive-export-button",pathname:"/chat/".concat(a)})]}):null}},0x1b35c88fb:(e,t,a)=>{"use strict";a.d(t,{c:()=>c});var s=a(0x22102fd88),n=a(0x139b5e710),l=a(0x1b6318607),i=a(0x225bae024),r=a(0x183548b63),o=a(0x38e6572),d=a(0xf071fd84);let c=e=>{let{isOpen:t,onClose:a,entityId:c,artifactEntityType:u,conversationUuid:m,filePath:x}=e,{addError:f}=(0,n.Yf)(),{mutateAsync:p,isPending:g}=(0,d.rz)({entityId:c,artifactEntityType:u,conversationUuid:m,filePath:x}),h=async()=>{try{await p(void 0),a()}catch(e){f((0,s.jsx)(l.YX,{id:"cotton_camel_pyramid"}),{error:e})}};return(0,s.jsx)(r.aF,{title:(0,s.jsx)(l.YX,{id:"silver_apple_jungle"}),isOpen:t,onClose:a,modalSize:"md",hasCloseButton:!0,children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)("p",{className:"text-text-400",children:(0,s.jsx)(l.YX,{id:"golden_pear_forest"})}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(i.$,{variant:"secondary",onClick:a,disabled:g,children:(0,s.jsx)(o.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(i.$,{variant:"primary",onClick:h,loading:g,children:(0,s.jsx)(l.YX,{id:"silver_apple_jungle"})})]})]})})}},0x1b4b4fb37:(e,t,a)=>{"use strict";a.d(t,{q:()=>y});var s=a(0x22102fd88),n=a(0xf02f2f3c),l=a(0x1a1f6dda6),i=a(0xfc89b4a4),r=a(0x247840ebf),o=a(0x38e6572),d=a(0x1ab0d1ca1),c=a(0x1d096b190),u=a(0x1c29096e8);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",a=arguments.length>2?arguments[2]:void 0;return void 0===e?"—":a.formatNumber(e,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2})}function x(e,t){return void 0===e?"—":t.formatNumber(e,{notation:"compact",compactDisplay:"short",maximumFractionDigits:2})}function f(e,t){return void 0===e?"—":"".concat(e>0?"+":"").concat(t.formatNumber(e/100,{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}))}n.t1.register(n.PP,n.kc,n.FN,n.No,n.E8,n.hE,n.m_,n.s$,n.dN);let p=(0,i.memo)(()=>(0,s.jsx)("div",{className:"h-[200px] bg-bg-200 rounded-lg animate-pulse"}));p.displayName="ShimmerChart";let g=(0,i.memo)(()=>(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("div",{className:"h-3 w-16 bg-bg-300 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-5 w-24 bg-bg-200 rounded animate-pulse"})]}));g.displayName="ShimmerStat";let h=(0,i.memo)(()=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-8 w-8 bg-bg-300 rounded animate-pulse"}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("div",{className:"h-5 w-24 bg-bg-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-3 w-32 bg-bg-300 rounded animate-pulse"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,s.jsx)("div",{className:"h-6 w-20 bg-bg-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-4 w-16 bg-bg-300 rounded animate-pulse"})]})]}));h.displayName="ShimmerHeader";let b=(0,i.memo)(e=>{let{activeWindow:t,onWindowChange:a,availableWindows:n}=e,l=(0,i.useMemo)(()=>n.map(e=>({key:e,label:e})),[n]);return(0,s.jsx)(c.I,{options:l,selectedKey:t,onSelect:a,itemClassName:"text-xs"})});b.displayName="TimeWindowSelector";let v=(0,i.memo)(e=>{let{status:t}=e;if(!t||"open"===t)return null;let a={closed:{label:(0,s.jsx)(o.A,{defaultMessage:"Closed",id:"Fv1ZSzMOV6"}),className:"bg-bg-300 text-text-300"},pre_market:{label:(0,s.jsx)(o.A,{defaultMessage:"Pre-Market",id:"8y93h1dAbn"}),className:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400"},after_hours:{label:(0,s.jsx)(o.A,{defaultMessage:"After Hours",id:"unORSkCtYY"}),className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}}[t];return a?(0,s.jsx)("span",{className:(0,l.A)("px-2 py-0.5 font-small-bold rounded-full",a.className),children:a.label}):null});v.displayName="MarketStatusBadge";let y=(0,i.memo)(e=>{var t,a,n;let{input:c,isStreaming:y}=e,j=(0,d.A)(),w=(0,i.useMemo)(()=>(function(e){return e&&"object"==typeof e&&"string"==typeof e.symbol&&e.symbol&&(void 0===e.current_price||"number"==typeof e.current_price)&&(void 0===e.company_name||"string"==typeof e.company_name)&&(void 0===e.currency||"string"==typeof e.currency)&&(void 0===e.price_change_percent||"number"==typeof e.price_change_percent)?e:null})(c),[c]),N=(0,i.useMemo)(()=>(null==w?void 0:w.price_history)?Object.keys(w.price_history).filter(e=>{var t;return(null==(t=w.price_history)?void 0:t[e])&&w.price_history[e].length>0}):[],[null==w?void 0:w.price_history]),[_,k]=(0,i.useState)(null),M=(0,i.useMemo)(()=>_&&N.includes(_)?_:N.includes("1M")?"1M":N[0]||"1M",[_,N]),C=(0,i.useCallback)(e=>{k(e)},[]),S=(0,i.useMemo)(()=>{var e;return(null==w||null==(e=w.price_history)?void 0:e[M])?w.price_history[M]:[]},[null==w?void 0:w.price_history,M]),A=(0,i.useMemo)(()=>{var e;if(null==w?void 0:w.current_price){if((null==(e=w.stats)?void 0:e.previous_close)!==void 0)return w.current_price-w.stats.previous_close;if(void 0!==w.price_change_percent){let e=w.price_change_percent;return w.current_price*e/(100+e)}}},[null==w?void 0:w.current_price,null==w||null==(t=w.stats)?void 0:t.previous_close,null==w?void 0:w.price_change_percent]),E=(null!=(n=null!=(a=null==w?void 0:w.price_change_percent)?a:A)?n:0)>=0,I=E?"#16a34a":"#dc2626",T=E?"rgba(22, 163, 74, 0.1)":"rgba(220, 38, 38, 0.1)",L=E?"rgba(22, 163, 74, 0.08)":"rgba(220, 38, 38, 0.08)",R=(0,i.useMemo)(()=>{if(0===S.length)return null;let e=S.map(e=>{let t=e.timestamp||e.date||"";if(!t)return"";let a=new Date(t);return"1D"===M?a.toLocaleTimeString(j.locale,{hour:"numeric",minute:"2-digit"}):"1W"===M||"1M"===M?a.toLocaleDateString(j.locale,{month:"short",day:"numeric"}):"5Y"===M?a.toLocaleDateString(j.locale,{year:"numeric"}):a.toLocaleDateString(j.locale,{month:"short",year:"2-digit"})}),t=S.map(e=>{var t,a;return null!=(a=null!=(t=e.price)?t:e.value)?a:0}),a=S.map(e=>e.timestamp||e.date||"");return{data:{labels:e,datasets:[{label:(null==w?void 0:w.symbol)||"Price",data:t,borderColor:I,borderWidth:1.5,pointRadius:0,pointHoverRadius:4,pointHoverBackgroundColor:I,pointHoverBorderColor:"#fff",pointHoverBorderWidth:2,tension:.3,fill:!0,backgroundColor:e=>{let{ctx:t,chartArea:a}=e.chart;return a?((e,t)=>{let a=e.createLinearGradient(0,t.top,0,t.bottom);return a.addColorStop(0,E?"rgba(22, 163, 74, 0.3)":"rgba(220, 38, 38, 0.3)"),a.addColorStop(1,E?"rgba(22, 163, 74, 0)":"rgba(220, 38, 38, 0)"),a})(t,a):T}}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(30, 30, 30, 0.95)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(128, 128, 128, 0.3)",borderWidth:1,padding:10,cornerRadius:8,displayColors:!1,callbacks:{title:e=>{let t=a[e[0].dataIndex];if(!t)return"";try{let e=new Date(t);if("1D"===M)return j.formatDate(e,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return j.formatDate(e,{weekday:"short",month:"short",day:"numeric",year:"numeric"})}catch(e){return t}},label:e=>m(e.parsed.y,null==w?void 0:w.currency,j)}}},scales:{x:{display:!0,grid:{display:!1},border:{display:!1},ticks:{color:"#888888",font:{size:10},maxTicksLimit:6,autoSkip:!0}},y:{display:!0,position:"right",grid:{color:"rgba(128, 128, 128, 0.15)",lineWidth:1},border:{display:!1},ticks:{color:"#888888",font:{size:10},maxTicksLimit:4,callback:e=>m(e,null==w?void 0:w.currency,j)}}}},fullDates:a}},[S,j,M,null==w?void 0:w.symbol,null==w?void 0:w.currency,I,T,E]);return y&&!w?(0,s.jsxs)(u.n2,{children:[(0,s.jsx)(h,{}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("div",{className:"h-8 w-48 bg-bg-200 rounded-lg animate-pulse"})}),(0,s.jsx)(p,{}),(0,s.jsx)("div",{className:(0,l.A)("grid grid-cols-5 gap-3 pt-3",u.C_),children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(g,{},t))})]}):w?(0,s.jsxs)(u.uM,{className:"!p-0 !space-y-0 relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute -top-10 -right-10 w-40 h-40 rounded-full pointer-events-none",style:{background:"radial-gradient(circle, ".concat(L," 0%, transparent 70%)"),filter:"blur(40px)"}}),(0,s.jsxs)("div",{className:"relative p-5 space-y-5",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsx)("span",{className:"font-xl-bold text-text-100",children:w.symbol}),void 0!==w.price_change_percent&&(0,s.jsx)("span",{className:(0,l.A)("px-2.5 py-1 rounded-md font-small-bold",E?"bg-success-100/15 text-success-100":"bg-danger-100/15 text-danger-100"),children:f(w.price_change_percent,j)}),(0,s.jsx)(v,{status:w.market_status})]}),w.company_name&&(0,s.jsx)("span",{className:"font-small text-text-400",children:w.company_name})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-text-100",style:{fontSize:26,fontWeight:400,letterSpacing:"-0.03em"},children:m(w.current_price,w.currency,j)}),(void 0!==A||void 0!==w.price_change_percent)&&(0,s.jsxs)("div",{className:(0,l.A)("font-base-bold",E?"text-success-100":"text-danger-100"),children:[void 0!==A&&(0,s.jsxs)(s.Fragment,{children:[E?"+":"",m(A,w.currency,j)]}),void 0!==A&&void 0!==w.price_change_percent&&" ",void 0!==w.price_change_percent&&(0,s.jsx)(o.A,{defaultMessage:"({percent})",id:"2pwiUTTeI6",description:"Parentheses wrapping a percentage value, e.g. (+2.5%). Keep parentheses in translation.",values:{percent:f(w.price_change_percent,j)}})]})]})]}),N.length>0&&(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(b,{activeWindow:M,onWindowChange:C,availableWindows:N})}),R&&S.length>0?(0,s.jsx)("div",{className:"h-[140px]",children:(0,s.jsx)(r.N1,{data:R.data,options:R.options})}):(0,s.jsx)("div",{className:"h-[100px] flex items-center justify-center bg-bg-100 rounded-lg",children:(0,s.jsx)("span",{className:"font-small text-text-400",children:(0,s.jsx)(o.A,{defaultMessage:"No price data available",id:"JMOxCPJFWp"})})}),w.stats&&(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[void 0!==w.stats.volume&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-[10px] text-text-400 uppercase tracking-widest mb-1",children:(0,s.jsx)(o.A,{defaultMessage:"Volume",id:"y867VsgbzT"})}),(0,s.jsx)("div",{className:"font-base-bold text-text-100",children:x(w.stats.volume,j)})]}),void 0!==w.stats.market_cap&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-[10px] text-text-400 uppercase tracking-widest mb-1",children:(0,s.jsx)(o.A,{defaultMessage:"Mkt Cap",id:"nBmAu+6xxl"})}),(0,s.jsx)("div",{className:"font-base-bold text-text-100",children:x(w.stats.market_cap,j)})]}),void 0!==w.stats.pe_ratio&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-[10px] text-text-400 uppercase tracking-widest mb-1",children:(0,s.jsx)(o.A,{defaultMessage:"P/E Ratio",id:"fWnwRImZ9W"})}),(0,s.jsx)("div",{className:"font-base-bold text-text-100",children:j.formatNumber(w.stats.pe_ratio,{maximumFractionDigits:1})})]})]})]})]}):(0,s.jsx)(u.MO,{})});y.displayName="StockMarketToolUseCell"},0x1babd1d4e:(e,t,a)=>{"use strict";a.d(t,{O:()=>y,_:()=>j});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0xf32c56dd),i=a(0x139b5e710),r=a(0x19c88845),o=a(0x225bae024),d=a(0x23977865),c=a(0x1bd175d8c),u=a(0x1a1f6dda6),m=a(0x23506e4da),x=a(0xfc89b4a4),f=a(0x38e6572),p=a(0x1ab0d1ca1),g=a(0x1449f94a5),h=a(0x142811145),b=a(0x1611828d);let v=(0,m.default)(()=>Promise.all([a.e(87983),a.e(84052)]).then(a.bind(a,0xa933a7a4)).then(e=>e.ShareModal),{loadableGenerated:{webpack:()=>[0xa933a7a4]},ssr:!1});function y(e){let{controlsSidebarIsOpen:t,closeControlsSidebar:a,openControlsSidebar:n,conversationUuid:l,isStreaming:i,isTemporary:m,hasConversationLoaded:x=!1}=e,p=(0,c.V)(d.E_),h=(0,b.mL)(),y=(0,b.PF)(),w=j({conversationUuid:l,isStreaming:i}),N=!!n&&!!a&&!t;return(0,s.jsxs)("div",{className:(0,u.A)("flex items-center gap-1","transition-opacity duration-300",t?"md:opacity-0 pointer-events-none user-select-none":"md:opacity-100",!N&&"hidden"),"data-testid":"chat-actions",children:[!m&&!i&&x&&(0,s.jsx)(o.$,{tooltip:p&&(0,s.jsx)(f.A,{defaultMessage:"Share chat",id:"bXa+lJhlYV"}),variant:p?"ghost":"secondary",size:p?"icon_sm":"sm",onClick:w.handleShareClick,disabled:w.isCheckingShareability||!N,prepend:p&&(0,s.jsx)(r.Share,{}),children:!p&&(0,s.jsx)(f.A,{defaultMessage:"Share",id:"OKhRC6eWRw"})}),p&&(0,s.jsx)(o.$,{tooltip:(0,s.jsx)(f.A,{defaultMessage:"New chat",id:"ATDyLPIoxz"}),href:h||y?g.Hg:"/new",size:"icon_sm",variant:"claude",disabled:!N,className:"ml-1",children:(0,s.jsx)(r.Add,{size:16})}),w.showShareModal&&(0,s.jsx)(v,{...w})]})}function j(e){let{track:t}=(0,l.st)(),{addError:a,addSuccess:s}=(0,i.Yf)(),r=(0,p.A)(),{data:o,refetch:d,isFetching:c}=(0,n.O2)(e.conversationUuid),[u,m]=(0,x.useState)(!1),f=(0,x.useCallback)(()=>{m(!0)},[m]),g=(0,x.useCallback)(async()=>{t({event_key:"chat.share.button.clicked",conversation_uuid:e.conversationUuid});let n=await d();if(n.data)if(n.data.shareable||n.data.snapshot)f();else{var l;s(null!=(l=n.data.disabled_reason)?l:r.formatMessage({defaultMessage:"This chat cannot be shared.",id:"WaiZiv2Q4Y"}))}else a(r.formatMessage({defaultMessage:"Failed to check share status. You can try again.",id:"kYQG+MMTz7"}),{errorContext:{tags:{source:"share_check"}}})},[t,e.conversationUuid,d,f,a,s,r]);(0,h.Kh)("share_chat",g);let b=!!(null==o?void 0:o.snapshot);return{conversationUuid:e.conversationUuid,showShareModal:u,openShareModal:g,closeShareModal:()=>m(!1),handleShareClick:g,isCheckingShareability:c,isShared:b,disabled:!!o&&!o.shareable,refetch:d,...o}}},0x1c29096e8:(e,t,a)=>{"use strict";a.d(t,{C_:()=>d,LB:()=>f,MO:()=>p,n2:()=>x,uM:()=>m});var s=a(0x22102fd88),n=a(0x1a1f6dda6),l=a(0xfc89b4a4),i=a(0x38e6572);let r=(0,n.A)("font-ui","bg-bg-000/50","border-0.5 border-border-300","shadow-sm","rounded-2xl","p-4","-mx-1","mb-4","space-y-4"),o=(0,n.A)("bg-bg-100","rounded-xl","p-4","transition-all");(0,n.A)("text-sm","font-medium","text-text-100");let d=(0,n.A)("border-t","border-border-300"),c=(0,n.A)("text-xs","text-text-400","text-right"),u=(0,n.A)("bg-bg-300","rounded","animate-pulse"),m=(0,l.memo)(e=>{let{children:t,className:a,style:l}=e;return(0,s.jsx)("div",{className:(0,n.A)(r,a),style:l,children:t})});m.displayName="WidgetContainer";let x=(0,l.memo)(e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,n.A)(r,a),children:t})});x.displayName="WidgetShimmerContainer",(0,l.memo)(e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,n.A)(o,a),children:t})}).displayName="WidgetInnerCard",(0,l.memo)(e=>{let{className:t}=e;return(0,s.jsx)("div",{className:(0,n.A)(d,t)})}).displayName="WidgetDivider",(0,l.memo)(e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,n.A)(c,a),children:t})}).displayName="WidgetFooter";let f=(0,l.memo)(e=>{let{width:t,height:a,className:l}=e;return(0,s.jsx)("div",{className:(0,n.A)(u,l),style:{width:t,height:a}})});f.displayName="ShimmerBox";let p=(0,l.memo)(e=>{let{className:t}=e;return(0,s.jsx)("div",{className:(0,n.A)(r,"flex items-center justify-center py-8",t),children:(0,s.jsx)("span",{className:"text-text-400 font-small",children:(0,s.jsx)(i.A,{defaultMessage:"Unable to display data",id:"pLzpxcnx35"})})})});p.displayName="WidgetErrorState"},0x1c6cf1a02:(e,t,a)=>{"use strict";a.d(t,{f:()=>c});var s=a(0x22102fd88),n=a(0x224a0d05),l=a(0x13c38b3e7),i=a(0x225bae024),r=a(0x761f2ec),o=a(0x1ab362a20),d=a(0xfc89b4a4);let c=e=>{let{attachment:t,goBack:a,onClose:c}=e,u=(0,d.useMemo)(()=>(0,l.E)(t),[t]);return(0,s.jsxs)("div",{className:"flex h-full flex-col pb-1 pl-5 pt-3",children:[(0,s.jsxs)("div",{className:"sticky flex items-center gap-1 pr-5",children:[a&&(0,s.jsx)(i.$,{onClick:a,variant:"ghost",size:"icon",className:"-ml-2 shrink-0",children:(0,s.jsx)(r.n,{size:20})}),(0,s.jsx)("h2",{className:"font-ui flex-1 truncate text-lg font-medium",children:u.title}),(0,s.jsx)(i.$,{variant:"ghost",size:"icon",className:"-mr-2",onClick:c,"data-testid":"close-file-preview",children:(0,s.jsx)(o.X,{size:20})})]}),(0,s.jsxs)("div",{className:"mb-1 flex flex-col pb-3 pr-5 min-h-0 flex-1",children:[(0,s.jsx)(n.G,{metaData:u.metaData}),(0,s.jsx)("div",{className:"-m-1 mt-0 min-h-0 flex-1 whitespace-pre-wrap break-all text-xs p-4 bg-bg-000 rounded-lg border-0.5 border-border-300  overflow-y-auto font-mono shadow-sm",children:t.extracted_content})]})]})}},0x1cdcf3e5a:(e,t,a)=>{"use strict";a.d(t,{yL:()=>ep});var s=a(0x22102fd88),n=a(0x1575c7741),l=a(0xf32c56dd),i=a(0xa5acf583),r=a(0x14de19ae8),o=a(0x139b5e710),d=a(0x19c88845),c=a(0x225bae024),u=a(0x1b03847fb),m=a(0x183548b63),x=a(0x1b370f49d),f=a(0x1e1f2a153),p=a(0x24fcf6beb),g=a(0x9f369389),h=a(0x9845e38c),b=a(0xac309a83),v=a(0x965113a9),y=a(0x1bd175d8c),j=a(0x3dfb3b63),w=a(0x113daa220),N=a(0x1a1f6dda6),_=a(0x160045b25),k=a(0x18c2bb2d),M=a(0xc6536c20),C=a(0x4d348f95),S=a(0xfc89b4a4),A=a(0x38e6572),E=a(0x1ab0d1ca1),I=a(0xb1890cb4),T=a(0x1398bcf3b),L=a(0xbebfc702),R=a(0x18175ce17),F=a(0x8daa74e8);async function z(e){let t=(0,F.T)(e),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch file: ".concat(a.status," ").concat(a.statusText));return a}var O=a(0x213592df7),U=a(0x6f2a2354),D=a(0x1bf083d8d),P=a(0x16f861148),B=a(0x3cebcb0f),G=a(0x1f507121),W=a(0x1a65cb992),q=a(0xebf0737a),H=a(0x1fe2ab707),Y=a(0x20d6272f9),V=a(0x20e358666),J=a(0x21010ec24),K=a(0x1611828d),X=a(0xd4b9b976),$=a(0xd3117c3a),Q=a(0xf071fd84),Z=a(0x1334f6ecc),ee=a(0x1b35c88fb),et=a(0x1f22b8dda),ea=a(0x1dd44336e),es=a(0x1bb0f43cc),en=a(0x1b6318607),el=a(0x17e725145),ei=a(0xbac8f8ca),er=a(0x177b82062),eo=a(0xce58ec20),ed=a(0x18ca729ac),ec=a(0x695f5df2),eu=a(0x1eb594abd),em=a(0x1e557eaf4);let ex=(0,S.memo)(e=>{var t;let{files:a,onSelectedPathChange:n}=e,{copyToClipboard:l,didCopy:i}=(0,f.C)(),r=(0,S.useMemo)(()=>(0,ed.EI)(a),[a]),o=(0,S.useMemo)(()=>r?(0,ed._x)(a):null,[a,r]),d=(0,S.useMemo)(()=>{if(!(null==o?void 0:o.children))return null;let e=o.children.find(e=>"SKILL.md"===e.name);return e||o.children[0]||null},[o]),[c,u]=(0,S.useState)((null==d?void 0:d.path)||null),[m,x]=(0,S.useState)(null==d?void 0:d.content),[p,g]=(0,eu.u)(),[h,b]=(0,S.useState)("normal");(0,S.useEffect)(()=>{null==n||n(c)},[c,n]);let v=(0,S.useCallback)((e,t)=>{u(e),x(t.content),b("normal")},[]),y=null!=(t=null==c?void 0:c.split("/").pop())?t:"file",{fileMimeType:j,fileSyntax:w,displayFileType:N,showViewToggle:_,isTextContent:k}=(0,H.G)(c||""),M=(0,S.useCallback)(async()=>{"string"==typeof m&&await l(m)},[l,m]),C=a.length>1;return r?(0,s.jsxs)("div",{className:"flex h-full border-t border-border-300",children:[C&&o&&(0,s.jsx)(ec.t,{fileTree:o,selectedPath:c,expandedFolders:p,onFileSelect:v,onToggleFolder:g,className:"bg-bg-000 p-3"}),(0,s.jsx)("div",{className:"flex-1 min-w-0 flex flex-col",children:(0,s.jsxs)("div",{className:"bg-bg-000 flex flex-col h-full overflow-hidden relative group",children:[k&&(0,s.jsx)(em.j,{viewing:h,onViewingChange:b,onCopy:M,didCopy:i,showToggle:_}),(0,s.jsx)("div",{className:"flex-1 min-h-0 overflow-auto",children:void 0!==m?(0,s.jsx)(ei.as,{content:m,displayFileType:N,language:w,showRaw:"raw"===h,fileName:y,mimeType:j}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-text-300",children:(0,s.jsx)(A.A,{defaultMessage:"Select a file to view its content",id:"Cag1YO8/Qh"})})})]})})]}):(0,s.jsx)("div",{className:"flex h-full border-t border-border-300",children:(0,s.jsx)("div",{className:"flex-1 flex items-start justify-center pt-12 px-4",children:(0,s.jsx)("div",{className:"text-text-300 text-center max-w-xs",children:(0,s.jsx)(A.A,{defaultMessage:"Skill has multiple root directories. Try asking Claude to put the whole skill under a single directory.",id:"iHsELDIVlS"})})})})});ex.displayName="SkillFileViewer";let ef=e=>{let{onLoad:t}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-text-300 gap-4",children:[(0,s.jsx)(A.A,{defaultMessage:"No file content available",id:"H8DU08sy24"}),(0,s.jsx)(c.$,{variant:"secondary",size:"sm",onClick:t,children:(0,s.jsx)(A.A,{defaultMessage:"Load file",id:"xvpw6mFG1S"})})]})},ep=e=>{var t,a,F,ed,ec,eu,em,ep,eg,eh,eb;let{file:ev,goBack:ey,onClose:ej,isShared:ew,projectUuid:eN,isTemporary:e_,isStreaming:ek,showBackButton:eM,streamingFile:eC,artifactVersions:eS,cacheBuster:eA,onUpdate:eE}=e,eI=ew?e.snapshotUuid:e.conversationUuid,[eT,eL]=(0,S.useState)(void 0),[eR,eF]=(0,S.useState)(!1),[ez,eO]=(0,S.useState)(!1),[eU,eD]=(0,S.useState)(!1),[eP,eB]=(0,S.useState)(null),[eG,eW]=(0,S.useState)(null),[eq,eH]=(0,S.useState)("normal"),[eY,eV]=(0,S.useState)([]),[eJ,eK]=(0,S.useState)(null),{activeOrganization:eX}=(0,r.YL)(),{copyToClipboard:e$}=(0,f.C)(),{addSuccess:eQ,addError:eZ}=(0,o.Yf)(),e0=(0,l.st)(),e1=(0,S.useRef)(null),e2=(0,E.A)(),e5=(0,C.useRouter)(),e3=(0,K.PF)(),e4=(0,y.V)(),[e8,e6]=(0,S.useState)(null),e9=ev.path.split("/").pop()||ev.path,e7=(0,el.useQueryClient)(),te=(0,b.fS)("claudeai_wiggle_pebble_stone_enabled"),tt=(0,S.useMemo)(()=>!te||ew||e3?void 0:{uuid:(0,I.A)("path:".concat(ev.path),eI),type:"wiggle_artifact",file_path:ev.path.replace(/^\/mnt\/user-data\//,"/"),conversation_uuid:eI},[ev.path,eI,e3,te,ew]),ta=(0,n.f)({artifactContext:tt}),ts=(0,S.useCallback)(()=>{e7.invalidateQueries({queryKey:[Q.r$]})},[e7]),tn=(0,es.j)({artifactContext:tt,chatConversationUuid:eI,onStorageChange:ts}),{data:tl}=(0,Q.Ns)({entityId:null!=(ep=null==tt?void 0:tt.uuid)?ep:"",artifactEntityType:"wiggle_artifact",conversationUuid:null==tt?void 0:tt.conversation_uuid,filePath:null==tt?void 0:tt.file_path},{enabled:!!tt&&!ek}),{data:ti}=(0,Q.mt)({entityId:null!=(eg=null==tt?void 0:tt.uuid)?eg:"",artifactEntityType:"wiggle_artifact",conversationUuid:null==tt?void 0:tt.conversation_uuid,filePath:null==tt?void 0:tt.file_path}),tr=!!(null==ti||null==(t=ti.mcp_servers)?void 0:t.length),to=(0,S.useMemo)(()=>(null==ti?void 0:ti.mcp_servers)||[],[ti]),[td,tc]=(0,S.useState)(!1),[tu,{open:tm,close:tx}]=(0,j.j)(!1),tf=(0,S.useMemo)(()=>({claudeComplete:ta,storage:tn}),[ta,tn]),tp=(null==eC?void 0:eC.renderAs)===p.vU.Markdown?"markdown":void 0,{fileMimeType:tg,fileSyntax:th,isImage:tb,isMarkdown:tv,isTextContent:ty,showViewToggle:tj,displayFileType:tw}=(0,H.G)(ev.path,tp),[tN,t_]=(0,S.useState)(!1),[tk,tM]=(0,S.useState)(!1),[tC,tS]=(0,S.useState)(!1),tA=(0,r.mV)(),tE=(0,L.fo)(eN),tI=(0,S.useMemo)(()=>ty&&void 0!==eT?new Blob([eT]).size<1e6:null,[ty,eT]),tT=(0,S.useMemo)(()=>{if(eT&&ty&&"string"==typeof eT)return null==eS?void 0:eS.find(e=>e.result_state===eT)},[eS,eT,ty]),{mutateAsync:tL}=(0,ea.yE)((null==tT?void 0:tT.uuid)||""),tR=(null==tT?void 0:tT.published_artifact_uuid)&&(null==tT?void 0:tT.published_artifact_deleted_at),tF=!e_&&"conversationUuid"in e&&e.conversationUuid&&eT&&!ek&&!tR&&ty&&tI,tz=(0,T.O)({conversationUuid:"conversationUuid"in e?e.conversationUuid:void 0}),tO=e_||ew?null:tA?"share":"publish",{publishedArtifactsBaseUrl:tU,publishedArtifactsEmbedBaseUrl:tD}=(0,i._r)(),tP=(null==(a=tz.data)?void 0:a.published_artifact_uuid)?"".concat(tD,"/public/artifacts/").concat(null==(F=tz.data)?void 0:F.published_artifact_uuid,"/embed"):null,tB=(null==(ed=tz.data)?void 0:ed.published_artifact_uuid)||(null==tT||null==(ec=tT.published_artifact_uuid)?void 0:ec.toString()),tG=(0,S.useMemo)(()=>tO?tz.data?(0,eo.x)(tO,tz.data,tU):tT?(0,eo.x)(tO,{artifact_uuid:tT.artifact_uuid,artifact_version_uuid:tT.uuid,message_uuid:tT.message_uuid,published_artifact_uuid:tT.published_artifact_uuid},tU):void 0:null,[tO,tz.data,tU,tT]),{handleProjectFileUpload:tW}=(0,O.IE)({projectUuid:eN,onError:()=>{eZ(e2.formatMessage({defaultMessage:"Error adding file to project",id:"807qgLdlHv"}),{messageForLogging:"Error adding file to project"})},onSuccess:()=>{eQ(e2.formatMessage({defaultMessage:"File added to project",id:"aXguBORPUO"}))}}),tq=(0,O.ED)(eN),{maxKbTokens:tH}=(0,O.AO)(),tY=(0,S.useMemo)(()=>null!==eG&&!ty&&!tb&&!(0,p.IO)(ev.path),[eG,ty,tb,ev.path]),tV=(0,Z.Gk)(),tJ=(0,R.kO)(),tK=tg===p.qK.Skill,tX=tV&&(0,J.z)(ev.path,tJ),t$=("markdown"===th||"plaintext"===th)&&ty,tQ=(0,et.Zx)(ew?void 0:e.conversationUuid),tZ=eT&&ty&&!tQ,t0=(0,p.Ys)(ev.path,tg)&&ty,t1=(e=>{let[t,a]=(0,S.useState)("");return(0,S.useEffect)(()=>{if(!e)return void a("");let t=()=>{let t=M.c9.fromJSDate(e).toISO();if(!t)return void a("");a((0,v.d)(t)||"")};t();let s=setInterval(t,6e4);return()=>clearInterval(s)},[e]),t})(eG),t2=(0,S.useMemo)(()=>(0,$.k)({filePath:ev.path,isShared:ew,conversationUuid:ew?void 0:eI,snapshotUuid:ew?eI:void 0,source:"file_detail_view"}),[ev.path,ew,eI]),t5=(0,S.useCallback)(async()=>{if(!(null==eX?void 0:eX.uuid))return void eB(e2.formatMessage({defaultMessage:"Unable to load file content",id:"0IswH+G61x"}));if(!(0,p.IO)(ev.path)&&!e3){eL(void 0),eV([]),eD(!1),eF(!1),eB(null),eW(new Date);return}if(eD(!0),eB(null),eV([]),e3){try{var e;let t=ev.path.replace("computer://",""),a=await (null===g.Q2||void 0===g.Q2||null==(e=g.Q2.readLocalFile)?void 0:e.call(g.Q2,eI,t));if(!a)return void eB(e2.formatMessage({defaultMessage:"Unable to read local file.",id:"wThTQW8q/h"}));if("base64"===a.encoding){let e=atob(a.content),t=new Uint8Array(e.length);for(let a=0;a<e.length;a++)t[a]=e.charCodeAt(a);tb?eL(new Blob([t],{type:a.mimeType})):eL(t.buffer)}else eL(a.content);eB(null),eW(new Date)}catch(e){h.v.error(h.u.LOCAL_SESSION,"Failed to load local file:",e),eB(e2.formatMessage({defaultMessage:"Failed to load local file.",id:"vHSpGQkAku"}))}finally{eF(!1),eD(!1)}return}try{let e=ev.path.replace("computer://",""),t=await z(ew?{organizationUuid:eX.uuid,snapshotUuid:eI,filePath:e,isShared:!0}:{organizationUuid:eX.uuid,conversationUuid:eI,filePath:e,isShared:!1});if(tb){let e=await t.blob();eL(e),eV([])}else if(tK){let e=await t.arrayBuffer();try{let t=await (0,V.j)(e);eV(t),eL(void 0)}catch(e){eB(e2.formatMessage({defaultMessage:"Failed to extract skill contents.",id:"wHyr3jEmbl"}));return}}else if(ty){let e=await t.text();eL(e),eV([])}else{let e=await t.arrayBuffer();eL(e),eV([])}eB(null),eW(new Date)}catch(e){eB(e2.formatMessage({defaultMessage:"Failed to load file content",id:"6u3/Jh2Vzp"}))}finally{eF(!1),eD(!1)}},[null==eX?void 0:eX.uuid,ev.path,e2,tb,tK,ew,eI,ty,e3]);(0,S.useEffect)(()=>{eH("normal"),eV([])},[ev.path]),(0,S.useEffect)(()=>{let e=!0;if(e4&&e3&&(null===g.Q2||void 0===g.Q2?void 0:g.Q2.whichApplication)){let t=ev.path.replace(/^computer:\/\//,"");return g.Q2.whichApplication(t).then(t=>{e&&e6(t)}),()=>{e=!1}}e6(null)},[ev.path,e4,e3]),(0,S.useEffect)(()=>{(null==eC?void 0:eC.content)!==void 0?(eL(eC.content),eD(!1),eB(null),eW(new Date),eV([])):t5()},[t5,null==eC?void 0:eC.content,ev.path]);let t3=(0,w.Y)(t5,{leading:!1,delay:2500});(0,S.useEffect)(()=>{(0,p.IO)(ev.path)&&eF(!0),t3()},[t3,eA,null==eC?void 0:eC.content,ev.path]);let t4=(0,G.P)(),t8=()=>{(null==eX?void 0:eX.uuid)&&t4(ew?{filepath:ev.path,orgUuid:eX.uuid,snapshotUuid:eI,isShared:!0,source:"file_detail_view_header_button"}:{filepath:ev.path,orgUuid:eX.uuid,conversationUuid:eI,isShared:!1,source:"file_detail_view_header_button"})},t6=async()=>{if(!tb&&"string"==typeof eT){if(e0.track({event_key:"wiggle.file.copy_to_clipboard",...t2}),tv)try{let e=(0,X.u)(eT);await e$({text:eT,html:e})}catch(e){await e$(eT)}else await e$(eT);eO(!0),setTimeout(()=>eO(!1),2e3)}},t9=async t=>{let{operation:a}=t;if(e.isShared)return;let s=await tz.mutateAsync({path:ev.path,operation:a}),n=(0,eo.x)(a,s,tU);n&&await e$(n)},t7=(0,S.useCallback)(async()=>{if(void 0!==eT){e0.track({event_key:"wiggle.file.add_to_project",...t2}),tS(!0);try{let e=new File([eT],e9);await tW([e],tH-(null!=tq?tq:0))}finally{tS(!1)}}},[eT,e9,tW,tH,tq,e0,t2]),ae=ev.name.replace(/\.skill$/i,""),at=null==eJ?void 0:eJ.split("/").pop(),{displayName:aa,displayExt:as}=tK?{displayName:at?"".concat(ae," / ").concat(at):ae,displayExt:null}:(0,Y.FT)(ev.name);return(0,s.jsxs)("div",{className:"flex h-full flex-col relative",children:[(0,s.jsx)(s.Fragment,{children:"share"===tO?(0,s.jsx)(U.ke,{isOpen:tN,isProjectArtifact:!!(null==(eu=tE.data)?void 0:eu.is_private),isLoading:tz.isPending,sharedLink:tG||"",isShared:!!tz.data||(null==tT?void 0:tT.visibility)==="shared",onClose:()=>t_(!1),handleClickShareButton:async()=>{await t9({operation:"share"}),null==eE||eE()},updateSharedState:async e=>{"loading"!==e&&(await tL({visibility:e}),null==eE||eE())}}):"publish"===tO?(0,s.jsxs)(m.aF,{hasCloseButton:!0,modalSize:"lg",isOpen:tN,onClose:()=>{t_(!1),tM(!1)},title:(0,s.jsx)("span",{className:"text-text-200 font-claude-response text-xl font-medium",children:(0,s.jsx)(A.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"})}),children:[(0,s.jsx)("div",{className:"mt-2 flex flex-col gap-2.5",children:tk&&tB&&tP?(0,s.jsx)(P.Hz,{artifactUuid:tB,closeEmbedSettings:()=>tM(!1),embedLink:tP}):tB?(0,s.jsx)(P.L_,{artifactUuid:tB,publishedLink:tG||"",onClose:()=>t_(!1)}):(0,s.jsx)(P._L,{title:e9,isLoading:tz.isPending,fetchScreenshot:()=>Promise.resolve(),setScreenshot:()=>void 0,handlePublishArtifact:()=>{t9({operation:"publish"})}})}),(0,s.jsx)(P.gy,{isPublished:!!(null==(em=tz.data)?void 0:em.published_artifact_uuid),isEmbedSettingsOpen:tk,onOpen:()=>tM(!0)})]}):null}),(0,s.jsxs)("div",{className:"flex items-center justify-between px-2 py-2 bg-bg-000 gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 overflow-hidden pl-3",children:[tj&&(0,s.jsx)(er.h,{viewing:eq,onViewingChange:eH}),(0,s.jsxs)("h2",{className:(0,N.A)("text-sm font-normal text-text-200 truncate flex-1 min-w-0"),title:aa,children:[aa,as?(0,s.jsx)("span",{className:"text-text-400 opacity-50",children:" \xb7 "}):"",as&&(0,s.jsx)("span",{className:"text-text-400",children:as})]}),tK&&(eR||eU)&&(0,s.jsx)("div",{className:"ml-1.5 flex-shrink-0 w-3.5 h-3.5 flex items-center justify-center",children:(0,s.jsx)(d.Reload,{size:14,className:"animate-spin text-text-300"})}),(0,s.jsx)(_.N,{children:ez&&(0,s.jsxs)(k.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{enter:{duration:.4,ease:"easeOut"},exit:{duration:.3,ease:"easeIn"}},className:"flex items-center gap-1 text-sm text-success-200 ml-2 mr-3 flex-shrink-0",children:[(0,s.jsx)(d.CheckCircle,{size:16,className:"text-success-200"}),(0,s.jsx)("span",{className:"text-success-200",children:(0,s.jsx)(A.A,{defaultMessage:"Copied",id:"p556q3uvbn"})})]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[tK?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u.ms,{align:"end",trigger:(0,s.jsx)(c.$,{variant:"ghost",size:"icon","aria-label":e2.formatMessage({defaultMessage:"More options",id:"IzCVhGdYVc"}),children:(0,s.jsx)(d.DotsHorizontal,{size:20})}),children:[(0,s.jsx)(u.tJ,{onSelect:t8,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Download,{size:16}),(0,s.jsx)(A.A,{defaultMessage:"Download",id:"5q3qC0sC3r"})]})},"download"),(0,s.jsx)(u.tJ,{onSelect:()=>{e5.push("/settings/capabilities#skills")},children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.BookText,{size:16}),(0,s.jsx)(A.A,{defaultMessage:"View all skills",id:"hkcN1dpA8L"})]})},"view-all-skills"),(0,s.jsx)(u.DG,{}),(0,s.jsx)(u.tJ,{onSelect:t5,disabled:eU||tY,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Reload,{size:16,className:(0,N.A)((eR||eU)&&"animate-spin")}),(0,s.jsx)(A.A,{defaultMessage:"Refresh",id:"rELDbByu8U"})]})},"refresh")]}),!ew&&e.conversationUuid&&(0,s.jsx)(q.a,{file:ev,conversationUuid:e.conversationUuid,source:"file_detail_view",variant:"secondary",size:"sm",className:"!rounded-lg"})]}):(0,s.jsxs)(s.Fragment,{children:[tX&&!ew&&e.conversationUuid&&!e3&&(0,s.jsx)(W.M,{file:ev,conversationUuid:e.conversationUuid,source:"file_detail_view",variant:"secondary",size:"icon_sm",className:"!rounded-lg"}),!ew&&e.conversationUuid&&(0,s.jsx)(q.a,{file:ev,conversationUuid:e.conversationUuid,source:"file_detail_view",variant:"secondary",size:"sm",className:"!rounded-lg"}),!e3&&(ty||eN||t$||tZ)?(0,s.jsx)("div",{className:"[&_button]:!text-xs [&>div]:!rounded-lg",children:(0,s.jsxs)(u.AM,{mainButtonText:t0?(0,s.jsx)(A.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}):(0,s.jsx)(A.A,{defaultMessage:"Download",id:"5q3qC0sC3r"}),onClickMainButton:t0?t6:t8,children:[ty&&(0,s.jsx)(u.tJ,{onSelect:t0?t8:t6,children:t0?(0,s.jsx)(A.A,{defaultMessage:"Download",id:"5q3qC0sC3r"}):(0,s.jsx)(A.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"})},t0?"download":"copy"),eN&&(0,s.jsx)(u.tJ,{onSelect:t7,disabled:tC||!eT,children:(0,s.jsx)(A.A,{defaultMessage:"Add to project",id:"+mqxxzVczn"})},"addToProject"),t$&&(0,s.jsx)(u.tJ,{onSelect:async()=>{e0.track({event_key:"wiggle.file.download_as_pdf",...t2});try{await (0,B.NX)(ev)}catch(e){eB(e2.formatMessage({defaultMessage:"Error downloading PDF",id:"fes7nfwp3b"}))}},children:(0,s.jsx)(A.A,{defaultMessage:"Download as PDF",id:"camH0DLf91"})},"downloadAsPdf"),tZ&&(0,s.jsx)(u.tJ,{disabled:!tF,onSelect:()=>{e0.track({event_key:"share"===tO?"wiggle.file.share_artifact":"wiggle.file.publish_artifact",...t2}),t_(!0)},children:(0,s.jsxs)("div",{className:"flex flex-col",children:["share"===tO?(0,s.jsx)(A.A,{defaultMessage:"Share artifact",id:"FeSSOL+/49"}):(0,s.jsx)(A.A,{defaultMessage:"Publish artifact",id:"D1fyBhklj/"}),(0,s.jsxs)("span",{className:"text-text-300 text-xs",children:[tT&&tO&&("share"===tO?(0,s.jsx)(A.A,{defaultMessage:"Content already shared",id:"nTW7eXdjH7"}):tR?(0,s.jsx)(A.A,{defaultMessage:"Unpublished",id:"wbU4tD+0G+"}):(0,s.jsx)(A.A,{defaultMessage:"Content already published",id:"h9MXOgEjET"})),!(tT&&tO)&&!tI&&(0,s.jsx)(A.A,{defaultMessage:"File is too large",id:"uFwMw7Ndmt"})]})]})},(null!=tO?tO:"")+"-"+ev.path)]})}):e3?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.m,{tooltipContent:e2.formatMessage({defaultMessage:"Show in Folder",id:"qJzHPN7NHs"}),delayDuration:50,children:(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:()=>{var e;null===g.Q2||void 0===g.Q2||null==(e=g.Q2.openLocalFile)||e.call(g.Q2,eI,ev.path.replace(/^computer:\/\//,""),!0).catch(()=>{eZ(e2.formatMessage({defaultMessage:"Failed to show file in folder.",id:"FQYzrsgaNq"}),{messageForLogging:"Failed to show file in folder"})})},children:(0,s.jsx)(d.Folder,{size:20})})}),(0,s.jsx)(x.m,{tooltipContent:e8?e2.formatMessage({defaultMessage:"Open in {appName}",id:"AsiqC3lr7Z"},{appName:e8.appName}):e2.formatMessage({defaultMessage:"Open",id:"JfG49wNHKP"}),delayDuration:50,children:(0,s.jsx)(c.$,{variant:"ghost",size:e8?"sm":"icon",onClick:()=>{var e;null===g.Q2||void 0===g.Q2||null==(e=g.Q2.openLocalFile)||e.call(g.Q2,eI,ev.path.replace(/^computer:\/\//,"")).catch(()=>{eZ(e2.formatMessage({defaultMessage:"Failed to open file.",id:"/xJLpYnG2S"}),{messageForLogging:"Failed to open file"})})},prepend:(null==e8?void 0:e8.appIconBase64)&&(0,s.jsx)("img",{src:e8.appIconBase64,height:20,width:20,alt:e2.formatMessage({defaultMessage:"Open file on desktop",id:"7tjfei6CPJ"})}),children:e8?(0,s.jsx)(A.A,{id:"AsiqC3lr7Z",defaultMessage:"Open in {appName}",values:{appName:e8.appName}}):(0,s.jsx)(d.ArrowUpRight,{size:20})})})]}):(0,s.jsx)(c.$,{"aria-label":e2.formatMessage({id:"5q3qC0sC3r",defaultMessage:"Download"}),variant:"secondary",onClick:t8,size:"icon_sm",className:"!rounded-lg",children:(0,s.jsx)(d.Download,{size:16,className:"text-text-400"})}),((null!=(eh=null==tl?void 0:tl.total_size_bytes)?eh:0)>0||tr)&&"normal"===eq&&(0,s.jsxs)(u.ms,{align:"end",trigger:(0,s.jsx)(c.$,{variant:"ghost",size:"icon","aria-label":e2.formatMessage({defaultMessage:"More options",id:"IzCVhGdYVc"}),children:(0,s.jsx)(d.DotsVertical,{size:20})}),children:[(null!=(eb=null==tl?void 0:tl.total_size_bytes)?eb:0)>0&&(0,s.jsx)(u.tJ,{onSelect:tm,children:(0,s.jsx)(en.YX,{id:"silver_apple_jungle"})},"reset-storage"),tr&&(0,s.jsx)(u.tJ,{onSelect:()=>tc(!0),children:(0,s.jsx)(A.A,{defaultMessage:"Manage connectors",id:"cqx+RdJnHp"})},"manage-connectors")]}),(0,s.jsx)(x.m,{tooltipContent:eR||eU?e2.formatMessage({defaultMessage:"Refreshing",id:"crQQNCV/SV"}):t1?e2.formatMessage({defaultMessage:"Last refreshed {time}",id:"qVxqSOlF4R"},{time:t1}):void 0,delayDuration:50,children:(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:t5,disabled:eU||tY,children:(0,s.jsx)(d.Reload,{size:20,className:(0,N.A)((eR||eU)&&"animate-spin")})})})]}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:eM?ey:ej,children:(0,s.jsx)(d.X,{size:20})})]})]}),(0,s.jsx)("div",{className:"flex-1 min-h-0 bg-bg-000 overflow-auto",children:!eP&&eY.length>0?(0,s.jsx)(ex,{files:eY,onSelectedPathChange:eK}):void 0!==eT||eU||eP||tY?(0,s.jsx)(ei.as,{content:eT,displayFileType:tY?"nonrenderable":tw,language:th,showRaw:"raw"===eq,richSandboxRef:e1,richSandboxCapabilities:tf,fileName:e9,onRefresh:t5,mimeType:tg,isLoading:eU&&void 0===eT&&0===eY.length,error:eP,onRetry:t5,artifactContext:tt,ArtifactMcpModal:D.I}):(0,s.jsx)(ef,{onLoad:t5})}),td&&tt&&(0,s.jsx)(D.I,{isOpen:td,requestedServers:to,onClose:()=>tc(!1),artifactContext:tt}),tu&&tt&&(0,s.jsx)(ee.c,{isOpen:tu,onClose:tx,entityId:tt.uuid,artifactEntityType:"wiggle_artifact",conversationUuid:tt.conversation_uuid,filePath:tt.file_path})]})}},0x1dad12e86:(e,t,a)=>{"use strict";a.d(t,{z:()=>d});var s=a(0x22102fd88),n=a(0x23977865),l=a(0x1bd175d8c),i=a(0x1a1f6dda6),r=a(0x151bca12b);function o(e){return(0,s.jsx)("div",{...e,className:"from-bg-100 via-bg-100 via-65% to-bg-100/0 pointer-events-none absolute inset-0 -bottom-5 z-[-1] bg-gradient-to-b blur-sm"})}function d(e){let{children:t,className:a,contentClassName:d,sticky:c,fixed:u,mdTitle:m,large:x,narrow:f}=e,{isMobile:p,isExpanded:g}=(0,r.VF)(),h=(0,l.V)(n.E_),b=!t&&!m,v=x&&!h;return(0,s.jsxs)("header",{className:(0,i.A)("flex w-full bg-bg-100",c&&"sticky top-0 z-header",u&&"fixed top-0 z-header",h?n.X_:"h-12",h&&[!g&&"pl-[133px]",!b&&n.zo],v&&["mx-auto md:h-24 md:items-end",f?"max-w-4xl":"max-w-7xl"],a),"aria-hidden":b,"data-testid":"page-header",children:[!h&&(c||u)&&(0,s.jsx)(o,{}),(0,s.jsx)("div",{className:(0,i.A)("flex w-full items-center justify-between gap-4",h&&g&&"lg:px-4",!h&&"pl-11 lg:px-8",h&&!(p&&g)&&"draggable","",d,v?"px-4 md:px-8":"pr-3"),children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:(0,i.A)("text-text-200 flex items-center gap-2 text-center max-md:hidden min-w-0",h?"font-medium leading-tight":"font-heading",!h&&(v?"text-2xl":"text-lg")),children:(0,s.jsx)("span",{className:"truncate",children:m})}),(0,s.jsx)("div",{}),t]}):t})]})}},0x1df1902be:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m});var s=a(0x22102fd88),n=a(0xf32c56dd),l=a(0x139b5e710),i=a(0x225bae024),r=a(0x1bd175d8c),o=a(0xfc89b4a4),d=a(0x1ab0d1ca1),c=a(0x38e6572),u=a(0x4d9fc74e);let m=e=>{let{mcpAuthRequired:t,onAuthSuccess:a}=e,{server_id:m,tool_use_id:x,conversation_uuid:f}=t,p=(0,d.A)(),{addSuccess:g,addError:h}=(0,l.Yf)(),{track:b}=(0,n.st)(),v=(0,u.hV)(),y=(0,r.V)(),j=(0,o.useRef)(null),[w,N]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(!w)return;let e=null;return"undefined"!=typeof BroadcastChannel&&((e=new BroadcastChannel(u.sg)).onmessage=e=>{let t=e.data;(null==t?void 0:t.type)===u.N7&&t.serverId===m&&(j.current&&!j.current.closed&&setTimeout(()=>{var e;null==(e=j.current)||e.close(),j.current=null},2e3),N(!1),"success"===t.step?(g(p.formatMessage({defaultMessage:"Authentication successful",id:"Fh0QP1M2C8"})),a()):h(p.formatMessage({defaultMessage:"Authentication failed. You can try connecting again.",id:"UvWS/5AQSR"}),{messageForLogging:"Authentication failed. You can try connecting again."}))}),()=>{null==e||e.close()}},[w,m,a,g,h,p]);let _=(0,o.useCallback)(()=>{if(j.current&&!j.current.closed)return void j.current.focus();if(N(!0),b({event_key:"claudeai.mcp.auth.init",uuid:m,url:void 0,source:"tool_use_footer"}),y){let e="claude://claude.ai/mcp-auth-callback/".concat(encodeURIComponent(m));window.location.href="".concat(window.location.origin).concat(v(m,e),"&conversation_uuid=").concat(encodeURIComponent(f),"&tool_use_id=").concat(encodeURIComponent(x),"&open_in_browser=1")}else{let e="".concat(window.location.origin,"/connector/").concat(encodeURIComponent(m),"/auth_done?_=1"),t="".concat(window.location.origin).concat(v(m,e),"&conversation_uuid=").concat(encodeURIComponent(f),"&tool_use_id=").concat(encodeURIComponent(x),"&popup=1"),a=window.screenX+(window.outerWidth-600)/2,s=window.screenY+(window.outerHeight-700)/2,n="width=".concat(600,",height=").concat(700,",left=").concat(a,",top=").concat(s,",popup=1");j.current=window.open(t,"mcp-auth",n)}},[m,x,f,v,b,y]);return(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3 p-3 pt-0",children:[(0,s.jsx)("span",{className:"text-sm text-text-300",children:(0,s.jsx)(c.A,{defaultMessage:"Authentication required to use this tool",id:"S3Gpcjmuj1"})}),(0,s.jsx)(i.$,{variant:"primary",onClick:_,loading:w,children:(0,s.jsx)(c.A,{defaultMessage:"Connect",id:"+vVZ/G11Zg"})})]})}},0x1e140f433:(e,t,a)=>{"use strict";a.d(t,{NG:()=>p,aX:()=>g,sH:()=>h});var s=a(0x22102fd88),n=a(0x17185943),l=a(0x19c88845),i=a(0x1cd2ec21c),r=a(0x8f813b9c),o=a(0x1b370f49d),d=a(0x31075f4f),c=a(0x1a1f6dda6),u=a(0x18c2bb2d),m=a(0xfc89b4a4),x=a(0x249008d3),f=a(0x214374164);let p=e=>{let{isExpanded:t,isScrollable:a,snappyTransition:n,children:l,className:r,onTransitionEnd:o,onAnimationComplete:x,collapsesHalfway:f,setIsExpanded:p,footer:g}=e,h=(0,m.useRef)(t),b=!!(f&&!t&&p),v=f&&!t;return(0,s.jsxs)(u.P.div,{className:(0,c.A)("overflow-hidden shrink-0",!t&&b&&"cursor-pointer"),tabIndex:-1,initial:{opacity:0,height:h.current?"auto":0},animate:t?"expanded":"collapsed",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:.6*!!f,height:72*!!f}},whileHover:{opacity:1},transition:n?{ease:d.A.snappyOut,duration:.4}:{ease:"easeInOut",duration:.4},onTransitionEnd:o,onAnimationComplete:x,onClick:b?()=>p(!0):void 0,children:[(0,s.jsx)(i.r,{gradientHeight:16,tabIndex:-1,style:{scrollbarGutter:"stable"},className:(0,c.A)("h-full",a&&"!max-h-[238px]",r,v&&"[mask-image:linear-gradient(to_bottom,_hsl(var(--always-black)/100%)_0%,_hsl(var(--always-black)/0%)_100%)]",!t&&"pointer-events-none"),children:l}),g]})},g=e=>{let{isBorderless:t,handleClick:a,isDisabled:i,isExpanded:d,isStreaming:m,isError:p,errorMessage:g,icon:h,text:b,badge:v,secondaryIcon:y,secondaryText:j,isFirstBlockOfMessage:w,isLastBlockOfMessage:N,className:_,wrapperClassName:k,children:M,renderMode:C=x.l.Standard,isFirstItemInGroup:S,isLastItemInGroup:A}=e,E=i||!a,I=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E?"div":"button",{onClick:E?void 0:a,className:(0,c.A)("group/row flex flex-row items-center justify-between gap-4 rounded-lg text-text-300 h-[2.625rem] py-2",!t&&"px-3",E?"cursor-default":"cursor-pointer transition-colors duration-200 hover:text-text-200 hover:text-text-000",_),children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[h&&C!==x.l.TimelineGroup&&(0,s.jsx)("div",{className:"w-5 h-5 flex items-center justify-center text-text-100",children:h}),(0,s.jsxs)("div",{className:"flex gap-2 relative bottom-[0.5px] font-base text-left leading-tight overflow-hidden overflow-ellipsis whitespace-nowrap flex-grow text-text-300",children:[m?(0,s.jsx)(r.N,{children:b}):b,v&&(0,s.jsx)(n.E,{children:v})]})]}),(0,s.jsx)("div",{className:"flex flex-row items-center gap-1.5 min-w-0 shrink-0",children:p?(0,s.jsx)(o.m,{tooltipContent:g,align:"center",children:(0,s.jsx)("span",{className:"inline-flex",children:(0,s.jsx)(l.Warning,{size:16,className:"text-danger-000"})})}):(0,s.jsxs)(s.Fragment,{children:[!!j&&(0,s.jsx)("p",{className:"relative bottom-[0.5px] pl-1 text-text-500 font-small leading-tight shrink-0 whitespace-nowrap",children:j}),y]})})]},m?"streaming":"non-streaming"),M]});return C===x.l.TimelineGroup?(0,s.jsx)(f.i1,{icon:h,isExpanded:d,isFirstItem:!!S,isLastItem:!!A,isActive:m&&N&&A,children:I}):(0,s.jsx)(u.P.div,{initial:{opacity:+!m},animate:{opacity:1},transition:{duration:.5,ease:"easeIn"},className:(0,c.A)("ease-out transition-all flex flex-col font-ui leading-normal my-3 min-h-[2.625rem] overflow-hidden",!t&&"border-0.5  border-border-300 rounded-lg",!i&&!d&&"hover:bg-bg-200",w?"mt-2":"mt-3",N?"mb-2":"mb-3",d&&!t&&"bg-bg-000 shadow-sm",k),children:I})},h=e=>{let{isExpandingDisabled:t,setIsExpanded:a,...n}=e,{isExpanded:i,isError:r,secondaryIcon:o}=n,d=t||r;return(0,s.jsx)(g,{...n,isError:r,isDisabled:d,handleClick:()=>a(!i),secondaryIcon:(0,s.jsxs)(s.Fragment,{children:[o,!d&&(0,s.jsx)("span",{className:(0,c.A)("inline-flex transition-transform duration-400 ease-snappy-out",i?"rotate-180":"rotate-0"),children:(0,s.jsx)(l.CaretDownSmall,{className:(0,c.A)("relative bottom-[0.5px] text-text-300",d&&"opacity-15"),size:16})})]})})}},0x1e557eaf4:(e,t,a)=>{"use strict";a.d(t,{j:()=>d});var s=a(0x22102fd88),n=a(0x19c88845),l=a(0x225bae024),i=a(0xfc89b4a4),r=a(0x1ab0d1ca1),o=a(0x177b82062);let d=(0,i.memo)(e=>{let{viewing:t,onViewingChange:a,onCopy:i,didCopy:d,showToggle:c}=e,u=(0,r.A)();return(0,s.jsxs)("div",{className:"absolute top-3 right-4 z-10 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c&&(0,s.jsx)(o.h,{viewing:t,onViewingChange:a}),(0,s.jsx)(l.$,{variant:"ghost",size:d?"sm":"icon_sm",onClick:i,"aria-label":u.formatMessage({defaultMessage:"Copy",id:"4l6vz1/eZ5"}),children:d?(0,s.jsx)("span",{className:"text-xs text-text-300",children:u.formatMessage({defaultMessage:"Copied",id:"p556q3uvbn"})}):(0,s.jsx)(n.Copy,{size:16})})]})});d.displayName="SkillViewerHoverActions"},0x1eb594abd:(e,t,a)=>{"use strict";a.d(t,{u:()=>n});var s=a(0xfc89b4a4);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Set,[t,a]=(0,s.useState)(e);return[t,(0,s.useCallback)(e=>{a(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[])]}},0x204e49c37:(e,t,a)=>{"use strict";a.d(t,{uD:()=>n,wg:()=>l});let s=(0,a(0x394ef833).v)()(e=>({isStatusDisplayVisible:!1,setIsStatusDisplayVisible:t=>e({isStatusDisplayVisible:t})})),n=()=>s(e=>e.isStatusDisplayVisible),l=()=>s(e=>e.setIsStatusDisplayVisible)},0x209960a1a:(e,t,a)=>{"use strict";a.d(t,{I:()=>n,q:()=>l});var s=a(0xfc89b4a4);let n=(0,s.createContext)(null),l=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useReplExecutionSandbox must be used within a ReplExecutionSandboxContextProvider");return e}},0x20b1f5782:(e,t,a)=>{"use strict";a.d(t,{c:()=>a8});var s=a(0x22102fd88),n=a(0x14de19ae8),l=a(0xfc89b4a4),i=a(0x17e7bc007),r=a(0xac309a83),o=a(0x18c2bb2d),d=a(0x1065e6d73),c=a(0x1cf5ab98a),u=a(0xa6a34c14),m=a(0x179b3ba41),x=a(0x1e6127894),f=a(0x1a1f6dda6),p=a(0x1ab0d1ca1),g=a(0x38e6572),h=a(0x8603234d);let b="flex flex-row gap-1 rounded-md p-2 text-xs select-none -mx-1 mb-1 mt-4 outline outline-1 text-text-100";function v(e){let{children:t,className:a,...n}=e;return(0,s.jsx)("div",{className:(0,f.A)(b,"bg-bg-300/80 text-text-300 outline-bg-400/80",a),...n,children:t})}function y(e){let{children:t,className:a,...n}=e;return(0,s.jsx)("div",{className:(0,f.A)(b,"bg-accent-secondary-200/20 outline-accent-secondary-200/30",a),...n,children:t})}function j(e){let{children:t,className:a,...n}=e;return(0,s.jsx)("div",{className:(0,f.A)(b,"cursor-pointer items-center bg-danger-900/50 hover:bg-danger-900/75 transition group/banner outline-danger-000/25 hover:outline-danger-000/50",a),...n,children:t})}let w=(0,l.memo)(function(e){var t;let{message:a,messageWarningPropsFromParent:n,hasLink:i,hasCode:r,hasDriveDocWithImages:o,onRetry:f,onSendContinue:b,conversationSettings:w,isLastMessage:N}=e,_=(0,p.A)(),k=(0,d.Yl)(),M=(0,d.u9)(),C=null==w?void 0:w.enabled_web_search,S=(0,l.useMemo)(()=>({a:e=>{let{node:t,...a}=e;return(0,s.jsx)("a",{...a,className:"underline"})}}),[]);if((null==n?void 0:n.style)==="prominent")return(0,s.jsxs)(y,{"data-testid":"message-warning",children:[(0,s.jsx)(u.N,{className:"shrink-0",size:16}),(0,s.jsx)(h.o,{components:S,children:n.contentMarkdown})]});let A="human"===a.sender;if(!A&&"error"===a.stop_reason&&f)return(0,s.jsxs)(j,{"data-testid":"message-warning",onClick:()=>f(a.parent_message_uuid),children:[(0,s.jsxs)("div",{className:"relative h-4 w-4 shrink-0 text-danger-000",children:[(0,s.jsx)(u.N,{className:"absolute inset-0 group-hover/banner:opacity-0 group-hover/banner:scale-75  opacity-50 transition",size:16}),(0,s.jsx)(m.o,{className:"absolute inset-0 group-hover/banner:opacity-75 group-hover/banner:rotate-0 rotate-[20deg] opacity-0 transition",size:16})]}),(0,s.jsx)("div",{className:"flex flex-grow text-danger-000",children:(0,s.jsx)(g.A,{defaultMessage:"This response didn’t load. Try again by chatting to Claude.",id:"g0FIIo0clM"})})]});if(!A&&N&&"max_tokens"===a.stop_reason&&b)return(0,s.jsx)(v,{"data-testid":"message-warning",children:(0,s.jsxs)("div",{className:"flex max-sm:flex-col gap-2 w-full",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(x.R,{className:"shrink-0",size:16}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(g.A,{defaultMessage:"This response paused because Claude reached its max length for a message. Hit continue to nudge Claude along.",id:"oje9UAHUmL"})})]}),(0,s.jsx)("div",{className:"ml-6",children:(0,s.jsx)(c.$,{variant:"secondary",size:"sm",className:"block flex-shrink-0",onClick:()=>null==b?void 0:b(),"aria-label":_.formatMessage({defaultMessage:"Continue",id:"acrOozm08x"}),children:(0,s.jsx)(g.A,{defaultMessage:"Continue",id:"acrOozm08x"})})})]})});if(!A&&N&&(null==(t=a.metadata)?void 0:t.is_resume_completion_placeholder_message))return(0,s.jsx)("div",{className:"m-2 w-full",children:(0,s.jsx)(v,{"data-testid":"message-warning",children:(0,s.jsx)("div",{className:"p-1",children:(0,s.jsx)(g.A,{defaultMessage:"Claude is still creating a response in the background. Once it’s complete, you’ll see it here.",id:"PBOdLw2o4Z"})})})});let E=[];return(i&&!C&&E.push(_.formatMessage({defaultMessage:"Turn on web search in Search and tools menu. Otherwise, links provided may not be accurate or up to date.",id:"uUjlNFGg26"})),A?o&&E.push(_.formatMessage({defaultMessage:"Claude cannot yet access images from Google Docs.",id:"8Wb1yCJBBv"})):(r&&k&&!M&&E.push(_.formatMessage({defaultMessage:"To run code, enable code execution and file creation in Settings > Capabilities.",id:"BHnMOtM/i0"})),a.stop_reason,"conversation_length_limit"===a.stop_reason&&E.push(_.formatMessage({defaultMessage:"Claude hit the maximum length for this conversation. Please start a new conversation to continue chatting with Claude.",id:"jujWu4WTLz"})),n&&E.push(n.contentMarkdown)),0===E.length)?null:(0,s.jsxs)(v,{"data-testid":"message-warning",children:[(0,s.jsx)(x.R,{className:"shrink-0",size:16}),(0,s.jsx)(h.o,{components:S,children:E.reverse().join(" ")})]})});var N=a(0x1fc7d761);let _=e=>{let{message:t,isLastMessage:a,conversationSettings:n,messageWarningPropsFromParent:l,hasDriveDocWithImages:i,onRetry:r,onSendContinue:o}=e,d=(0,N.LR)(t.uuid),c=(0,N.Kc)(t.uuid);return(0,s.jsx)(w,{message:t,hasLink:d,hasCode:c,isLastMessage:a,hasDriveDocWithImages:i,conversationSettings:n,messageWarningPropsFromParent:l,onRetry:r,onSendContinue:o})},k={initial:!1,animate:{y:0,opacity:1}},M={initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",damping:10,stiffness:100}},C={initial:{scale:1.02,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3,ease:"easeOut"}},S={initial:{height:"0px",opacity:0},animate:{height:"auto",opacity:1},transition:{ease:"linear",duration:.1}},A=(0,l.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.P.div,{ref:t,...n,className:(0,f.A)("group relative inline-flex gap-2 bg-bg-300 rounded-xl pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-col",a)})});A.displayName="UserMessageBubble";let E=(0,l.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(o.P.div,{ref:t,...n,className:(0,f.A)("group relative",a)})});function I(e){return(0,s.jsx)("div",{...e,className:"font-claude-response relative leading-[1.65rem] [&_pre>div]:bg-bg-000/50 [&_pre>div]:border-0.5 [&_pre>div]:border-border-400 [&_.ignore-pre-bg>div]:bg-transparent [&_.standard-markdown_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&_.standard-markdown_:is(p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&_.progressive-markdown_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&_.progressive-markdown_:is(p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"})}E.displayName="ClaudeResponseBubble";var T=a(0x14a6d5f1),L=a(0xf32c56dd),R=a(0x19c88845),F=a(0x225bae024),z=a(0x1b370f49d),O=a(0x1e1f2a153),U=a(0x24fcf6beb),D=a(0x1de4b2c21),P=a(0x160045b25),B=a(0x23506e4da),G=a(0x156c4e43b),W=a(0x22be9474c),q=a(0x31c535e9),H=a(0x17f3a2521),Y=a(0x8ca4d894);function V(e){var t,a;let{conversationUuid:n,message:i}=e,[r,o]=(0,l.useState)(void 0),[d,c]=(0,l.useState)(!1),u=e=>{"flag"===e?(null==r?void 0:r.startsWith("flag"))||o(H.kj.FLAG):r!==H.kj.UPVOTE&&o(H.kj.UPVOTE),c(!0)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:(0,f.A)("group/btn",(null==(t=i.chat_feedback)?void 0:t.type.includes("upvote"))&&"bg-bg-200 !text-accent-secondary-100"),tooltip:(0,s.jsx)(g.A,{defaultMessage:"Give positive feedback",id:"FGCv00cdfW"}),onClick:()=>u("upvote"),prepend:(0,s.jsx)(R.ThumbsUp,{size:16,className:"text-text-500 group-hover/btn:text-text-100"})}),(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:(0,f.A)("group/btn",(null==(a=i.chat_feedback)?void 0:a.type.includes("flag"))&&"bg-bg-200 !text-danger-100"),tooltip:(0,s.jsx)(g.A,{defaultMessage:"Give negative feedback",id:"ngzzQUJCXB"}),onClick:()=>u("flag"),prepend:(0,s.jsx)(R.ThumbsDown,{size:16,className:"text-text-500 group-hover/btn:text-text-100"})}),(0,s.jsx)(Y.B,{conversationUuid:n,message:i,requestedFeedbackType:r,setRequestedFeedbackType:o,isOpen:d,onClose:()=>c(!1)})]})}function J(e){let{children:t,onClick:a,tooltipContent:n,Icon:l,disabled:i,"data-testid":r}=e,o=(0,s.jsx)(F.$,{variant:"ghost",size:"sm",className:"!font-base !px-2 !h-7 !min-w-0",onClick:a,disabled:i,"data-testid":r,children:l||t});return n?(0,s.jsx)(z.m,{tooltipContent:n,children:o}):o}var K=a(0x1b6318607),X=a(0x1b03847fb),$=a(0xb22529cb);function Q(e){let{paprikaMode:t,supportedPaprikaModes:a,onRetry:n,parentMessageUuid:i,setPaprikaModeState:r}=e,[o,d]=(0,l.useState)(!1),c=(0,$.Wi)().filter(e=>e.paprika_mode_value&&e.paprika_mode_value!==t&&a.includes(e.paprika_mode_value)),u=(0,l.useCallback)((e,t)=>{n(e,t),r(t)},[n,r]);return(0,s.jsxs)(X.ms,{align:"start",unstyledTrigger:!0,onCloseAutoFocus:e=>e.preventDefault(),open:o,onOpenChange:d,trigger:(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn",tooltip:(0,s.jsx)(g.A,{defaultMessage:"Retry",id:"62nsdyMyIO"}),prepend:(0,s.jsx)(R.Reload,{className:"text-text-500 group-hover/btn:text-text-100"})}),children:[(0,s.jsx)(X.tJ,{className:"text-sm",onClick:()=>n(i),children:(0,s.jsx)(g.A,{defaultMessage:"With no changes",id:"h3WdKJh51e"})}),c.map(e=>(0,s.jsx)(X.tJ,{className:"text-sm",onClick:()=>u(i,e.paprika_mode_value),children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex flex-col",children:"extended"===e.id?(0,s.jsx)(g.A,{defaultMessage:"With extended thinking",id:"/zFAxhC9JS",description:"Lets the user try again using a different thinking mode"}):"With ".concat(e.title.toLowerCase()," thinking")}),(0,s.jsx)("div",{className:"text-text-500 text-xs",children:e.description_key?(0,s.jsx)(K.X5,{id:e.description_key}):e.description})]})},e.id))]})}var Z=a(0x1611828d),ee=a(0xd4b9b976),et=a(0x1f22b8dda);let ea=(0,B.default)(()=>a.e(81904).then(a.bind(a,0x1ecd58b10)).then(e=>e.ChatMessageDebugModal),{loadableGenerated:{webpack:()=>[0x1ecd58b10]},ssr:!1}),es={default:{allowed:"never"}},en=G.g1(G.Ik({allowed:G.k5(["never","first_turn","always"])})),el=e=>{let{isStreaming:t,isLastMessage:a,isInteractive:n,isAssistant:l,children:i,positionMode:r="absolute"}=e;if("flow"===r){let e=l&&t;return(0,s.jsx)("div",{className:(0,f.A)("flex justify-start",e&&"invisible",!a&&!e&&"opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition"),role:"group","aria-label":"Message actions",children:(0,s.jsx)("div",{className:"text-text-300",children:i})})}return(0,s.jsx)(P.N,{children:!t&&(0,s.jsx)(o.P.div,{className:"absolute bottom-0 right-2 pointer-events-none",initial:{scale:.95},animate:{scale:1},transition:{type:"spring",damping:30,stiffness:400},children:(0,s.jsx)("div",{className:(0,f.A)("rounded-lg transition min-w-max pointer-events-auto",l?"translate-x-2":"translate-y-4 bg-bg-100/80 backdrop-blur-sm translate-x-1 group-hover:translate-x-0.5 border-0.5 border-border-300 p-0.5 shadow-sm",a?"translate-y-full pt-2":"opacity-0 group-hover:opacity-100"),children:i})})})},ei=(0,l.memo)(function(e){var t,a,n,o,d,c;let{message:u,previousMessage:m,conversationUuid:x,isStreaming:p,isTemporary:h=!1,onRetry:b,isLastMessage:v,isLastHumanMessage:y,isInteractive:j=!0,changeDisplayedConversationPath:w,editMessage:N,editable:_=!1,isFirstAssistantMessage:k,isResearchPending:M,model:C,extendedThinkingSetting:S,showArtifacts:A=!1,chatFeedbackEnabled:E,positionMode:I="absolute",timestamp:P,fullTimestamp:B}=e,[G,H]=(0,l.useState)(!1),{track:Y}=(0,L.st)(),K="human"===u.sender,X="assistant"===u.sender,$=p&&v,ei=(0,r.fS)("anthropic_internal_only_expose_chat_debug"),eo=(0,r.fS)("chat-ui-core"),ed=!p&&(null!=(o=u.nOptions)?o:0)>1&&w,ec=eo&&K||!p,eu=ec&&!M&&_&&N&&u.parent_message_uuid&&j,em=null==u||null==(t=u.content)?void 0:t.some(e=>"tool_use"===e.type&&"end_conversation"===e.name),ex=ec&&!M&&j&&!em,ef=ex&&K&&!v&&!u.pending&&!(eo&&p),ep=(0,l.useCallback)((e,t,a)=>{Y({event_key:"claudeai.message.user_triggered_retry",is_last_human_message:"assistant_message_footer"===e?v:y,source:e}),b(t,a)},[Y,y,v,b]),{didCopy:eg,copyToClipboard:eh}=(0,O.C)(),eb=(0,l.useCallback)(async()=>{let e=i.oz.getState().messageByUuid[u.uuid],t=(0,D.C)(e),a=(A?(0,U.it)(t):t).trim();try{let e=(0,ee.u)(a);await eh({text:a,html:e})}catch(e){await eh(a)}},[A,u.uuid,eh]),ev=(0,W.QY)(),{toggleConversationSetting:ey}=(0,q.rX)({source:"messageActionBar"}),ej=(0,l.useCallback)(e=>{ey("paprika_mode",null!=e?e:null)},[ey]),{allModelOptions:ew}=(0,T.A9)(),eN=(0,r.iW)("claude_ai_paprika_retry",es,en),e_=(0,et.Zx)(x),ek=(0,Z.PF)(),eM=null!=(c=null!=(d=C&&(null==(a=eN[C])?void 0:a.allowed))?d:null==(n=eN.default)?void 0:n.allowed)?c:"never";if(ek||K&&!eu&&!ef&&!ed&&!eo)return null;let eC=ew.find(e=>e.model===C),eS=null==eC?void 0:eC.paprika_modes,eA=eS&&eS.length>0&&!S&&("always"===eM||"first_turn"===eM&&k);return(0,s.jsx)(el,{isStreaming:$,isLastMessage:v,isInteractive:j,isAssistant:X,positionMode:I,children:(0,s.jsxs)("div",{className:"text-text-300 flex items-stretch justify-between",children:[eo&&K&&P&&(0,s.jsx)(z.m,{tooltipContent:B,side:"bottom",children:(0,s.jsx)("span",{className:"text-text-500 text-xs flex items-center mr-2",children:P})}),X&&ei&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn",tooltip:(0,s.jsx)(g.A,{defaultMessage:"Debug",id:"z3UjXRZwzQ"}),onClick:()=>H(!0),prepend:(0,s.jsx)(R.Wrench,{className:"text-text-500 group-hover/btn:text-text-100"})}),(0,s.jsx)(ea,{isOpen:G,onClose:()=>H(!1),messageUuid:u.uuid,conversationUuid:x})]}),!e_&&K&&(eu||ef)&&(0,s.jsxs)("div",{className:"flex items-center",children:[ef&&(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn",onClick:()=>ep("human_message_hover",u.uuid),tooltip:(0,s.jsx)(g.A,{defaultMessage:"Retry",id:"62nsdyMyIO"}),prepend:(0,s.jsx)(R.Reload,{className:"text-text-500 group-hover/btn:text-text-100"})}),eu&&(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn",onClick:()=>N(u,"test edit message"),tooltip:(0,s.jsx)(g.A,{defaultMessage:"Edit",id:"wEQDC6Wv3/"}),prepend:(0,s.jsx)(R.Edit,{className:"text-text-500 group-hover/btn:text-text-100"})})]}),(X||eo&&K)&&(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn",onClick:eb,"data-testid":"action-bar-copy",tooltip:(0,s.jsx)(g.A,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}),prepend:eo?(0,s.jsxs)("div",{className:"relative text-text-500 group-hover/btn:text-text-100",children:[(0,s.jsx)(R.Copy,{className:(0,f.A)("transition-all",eg?"opacity-0 scale-50":"opacity-100 scale-100")}),(0,s.jsx)(R.Check,{className:(0,f.A)("absolute top-0 left-0 transition-all",eg?"opacity-100 scale-100":"opacity-0 scale-50")})]}):(0,s.jsx)(O.u,{didCopy:eg})}),X&&!$&&!M&&j&&"error"!==u.stop_reason&&(void 0!==E?E:ev)&&!h&&(0,s.jsx)(V,{conversationUuid:x,message:u}),(0,s.jsxs)("div",{className:"flex items-center",children:[X&&ex&&(eA?(0,s.jsx)(Q,{paprikaMode:S,supportedPaprikaModes:eS,onRetry:(e,t)=>ep("assistant_message_footer",null!=e?e:void 0,t),parentMessageUuid:u.parent_message_uuid,setPaprikaModeState:ej}):eo?(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn",onClick:()=>{ep("assistant_message_footer",u.parent_message_uuid)},tooltip:(0,s.jsx)(g.A,{defaultMessage:"Retry",id:"62nsdyMyIO"}),prepend:(0,s.jsx)(R.Reload,{className:"text-text-500 group-hover/btn:text-text-100"})}):(0,s.jsx)(J,{onClick:()=>{ep("assistant_message_footer",u.parent_message_uuid)},children:(0,s.jsx)(g.A,{defaultMessage:"Retry",id:"62nsdyMyIO"})})),ed&&(0,s.jsx)(er,{message:u,changeDisplayedConversationPath:w})]})]})})});function er(e){var t;let{message:a,changeDisplayedConversationPath:n}=e,l=(null!=(t=a.selectedOption)?t:0)+1,i=l===a.nOptions,r=(0,p.A)();return(0,s.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn !w-6",disabled:1===l,onClick:()=>n(a,-1),"aria-label":r.formatMessage({defaultMessage:"Previous",id:"JJNc3cbYIJ"}),prepend:(0,s.jsx)(R.CaretLeft,{className:"text-text-500 group-hover/btn:text-text-100"})}),(0,s.jsx)("span",{className:"self-center shrink-0 select-none font-small text-text-500",children:(0,s.jsx)(g.A,{defaultMessage:"{selectedOption} / {totalOptions}",id:"0zCqdBEnn7",values:{selectedOption:l,totalOptions:a.nOptions}})}),(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",className:"group/btn !w-6",disabled:i,onClick:()=>n(a,1),"aria-label":r.formatMessage({defaultMessage:"Next",id:"9+DdtuCqLw"}),prepend:(0,s.jsx)(R.CaretRight,{className:"text-text-500 group-hover/btn:text-text-100"})})]})}var eo=a(0x1d0c32e96),ed=a(0x18c088bb9),ec=a(0x78b33fbd),eu=a(0x1334f6ecc);let em=()=>{let e=(0,L.st)(),{initDriveAuth:t}=(0,eu.cI)({});return(0,l.useEffect)(()=>{e.track({event_key:"claudeai.in_chat_upsell.connect_gdrive.displayed"})},[e]),(0,s.jsx)(ex,{title:(0,s.jsx)(g.A,{defaultMessage:"Add context from all your docs more easily",id:"gHPka72Ai9"}),icon:(0,s.jsx)(ed.g,{size:18}),cta:(0,s.jsxs)(F.$,{className:"bg-bg-100 border-border-300",size:"sm",variant:"secondary",onClick:()=>{e.track({event_key:"claudeai.in_chat_upsell.connect_gdrive.start"}),t()},children:[(0,s.jsx)(eo.ft,{size:16,className:"mr-1"}),(0,s.jsx)(g.A,{defaultMessage:"Connect Drive",id:"XzTB2bvNw1"})]})})},ex=e=>{let{title:t,icon:a,cta:n}=e;return(0,s.jsx)(o.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"mt-3",children:(0,s.jsx)("div",{className:"overflow-hidden rounded-lg border-0.5 border-border-300 bg-bg-100 shadow-sm",children:(0,s.jsx)("div",{className:"px-2.5 py-2.5",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"rounded-lg bg-primary-100 p-1",children:a}),(0,s.jsx)("h3",{className:"text-sm text-text-100",children:t})]}),n]})})})})},ef=e=>{let{previousMessage:t}=e,a=(0,eu.LP)(),{isDriveAuthenticated:n}=(0,eu.cI)({}),i=(0,l.useMemo)(()=>!!t&&t.attachments.some(e=>"docx"===e.file_type),[t]),o=(0,r.fS)("pumpernickel_enabled"),d=(0,ec.useLayer)("trials_freemium").get("free_integrations",!1);return(o||d)&&a&&!n&&i?(0,s.jsx)(em,{}):null};var ep=a(0x21870d616),eg=a(0x401a1006),eh=a(0x9845e38c),eb=a(0x49fac030),ev=a(0x17e725145),ey=a(0x12c9046cd),ej=a(0x20e7b44d0);let ew=G.Ik({id:G.Yj(),name:G.Yj(),phoneNumber:G.Yj().optional(),smsNumber:G.Yj().optional(),webChatUrl:G.Yj().optional()}),eN=G.g1(G.Yj(),G.YO(ew)),e_={},ek=(0,l.memo)(e=>{var t;let{message:a,conversationUuid:n,onDismiss:i}=e,{track:o}=(0,L.st)(),d=(0,ej.H)(),[c,u]=(0,l.useState)(!1),m=(0,r.iW)("ssh_helplines",e_,eN),x=(0,l.useMemo)(()=>{var e;return d&&null!=(e=m[d])?e:null},[m,d]),f=null!=(t=null==x?void 0:x[0])?t:null,p=(0,l.useCallback)(()=>{((null==f?void 0:f.webChatUrl)||(null==f?void 0:f.smsNumber))&&(o({event_key:"claudeai.safety.self_harm_banner.chat_clicked",conversation_uuid:n,message_uuid:a.uuid,helpline_name:f.name}),f.webChatUrl?window.open(f.webChatUrl,"_blank","noopener,noreferrer"):f.smsNumber&&(window.location.href="sms:".concat(f.smsNumber)))},[n,a.uuid,f,o]),h=(0,l.useCallback)(()=>{(null==f?void 0:f.phoneNumber)&&(o({event_key:"claudeai.safety.self_harm_banner.call_clicked",conversation_uuid:n,message_uuid:a.uuid,helpline_name:f.name}),window.location.href="tel:".concat(f.phoneNumber))},[n,a.uuid,f,o]),b=(0,l.useCallback)(()=>{o({event_key:"claudeai.safety.self_harm_banner.browse_clicked",conversation_uuid:n,message_uuid:a.uuid,helpline_name:null==f?void 0:f.name}),window.open("https://claude.findahelpline.com/i/claude","_blank","noopener,noreferrer")},[n,a.uuid,null==f?void 0:f.name,o]),v=(0,l.useCallback)(e=>{u(e),e&&o({event_key:"claudeai.safety.self_harm_banner.dropdown_opened",conversation_uuid:n,message_uuid:a.uuid})},[n,a.uuid,o]);if(!f)return null;let y=!!(f.webChatUrl||f.smsNumber),j=!!f.phoneNumber,w=(0,s.jsxs)(X.ms,{open:c,onOpenChange:v,align:"end",trigger:(0,s.jsxs)(F.$,{variant:"secondary",colorized:!0,size:"sm",children:[(0,s.jsx)(g.A,{defaultMessage:"Find resources",id:"ViSIod1c4W"}),(0,s.jsx)(R.CaretDown,{size:16,className:"ml-1"})]}),children:[y&&(0,s.jsx)(X.tJ,{onSelect:p,icon:(0,s.jsx)(R.Chats,{size:20,className:"text-text-300"}),children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsx)(g.A,{defaultMessage:"Chat now",id:"Wpt2mdD04V"})}),f.smsNumber&&(0,s.jsx)("span",{className:"text-xs text-text-500",children:(0,s.jsx)(g.A,{defaultMessage:"Or text {smsNumber}",id:"/TilRc4Vfe",values:{smsNumber:f.smsNumber}})})]})}),j&&(0,s.jsx)(X.tJ,{onSelect:h,icon:(0,s.jsx)(R.Voice,{size:20,className:"text-text-300"}),children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsx)(g.A,{defaultMessage:"Call now",id:"ujkMRA0XIx"})}),f.phoneNumber&&(0,s.jsx)("span",{className:"text-xs text-text-500",children:(0,s.jsx)(g.A,{defaultMessage:"Or dial {phoneNumber}",id:"TzAwWlTTPg",values:{phoneNumber:f.phoneNumber}})})]})}),(0,s.jsx)(X.tJ,{onSelect:b,icon:(0,s.jsx)(R.BookText,{size:20,className:"text-text-300"}),children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:(0,s.jsx)(g.A,{defaultMessage:"Browse resources",id:"98tgK7c61W"})}),(0,s.jsx)("span",{className:"text-xs text-text-500",children:(0,s.jsx)(g.A,{defaultMessage:"More ways to get help",id:"hKkhoqnGsL"})})]})}),(0,s.jsx)(X.DG,{}),(0,s.jsxs)("div",{className:"px-2 py-1.5 flex items-start gap-1.5 text-xs text-text-500 max-w-64",children:[(0,s.jsx)(R.Info,{size:14,className:"mt-0.5 shrink-0"}),(0,s.jsx)("span",{children:(0,s.jsx)(g.A,{defaultMessage:"Support provided by {helplineName}, not Claude. <link>Learn more</link>",id:"464jLNgZUf",values:{helplineName:f.name,link:e=>(0,s.jsx)("a",{href:"https://support.claude.com/en/articles/13171706-crisis-helpline-support-in-claude",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-text-300",children:e})}})})]})]});return(0,s.jsx)("div",{className:"mb-3 mt-3",children:(0,s.jsx)(eg.l,{pictogram:ep.HandBird,message:(0,s.jsx)(g.A,{defaultMessage:"If you or someone you know is having a difficult time, free support is available.",id:"RhJ3DdQQuy"}),customAction:w,onClose:i})})});function eM(e){let{message:t,conversationUuid:a,isStreaming:i}=e,{track:o}=(0,L.st)(),d=(0,ev.useQueryClient)(),{activeOrganization:c}=(0,n.YL)(),u=null==c?void 0:c.uuid,m=(e=>{var t;if("assistant"!==e.sender)return!1;let a=null==(t=e.content)?void 0:t.some(e=>{var t,a;if("text"===(t=e).type||"thinking"===t.type||"tool_use"===t.type){return null==(a=e.flags)?void 0:a.includes("self_harm_risk")}return!1});return null!=a&&a})(t),[x,f]=(0,l.useState)(!1),p=(0,l.useRef)(!1),h=(()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid;return(0,ey.L2)(e=>"/api/organizations/".concat(t,"/chat_conversations/").concat(e.conversationUuid,"/chat_messages/").concat(e.messageUuid,"/flags"),"DELETE",{enabled:!!t,transformVariables:e=>({flag_name:e.flagName}),meta:{noToast:!0}})})(),b=function(){let e=(0,ej.H)(),t=(0,r.iW)("ssh_helplines",e_,eN);return(0,l.useMemo)(()=>{if(!e)return!1;let a=t[e];return!!(a&&a.length>0)},[t,e])}();(0,l.useEffect)(()=>{!m||x||i||p.current||(o({event_key:"claudeai.safety.self_harm_banner.viewed",conversation_uuid:a,message_uuid:t.uuid}),p.current=!0)},[m,x,i,a,t.uuid,o]);let v=(0,l.useCallback)(()=>{o({event_key:"claudeai.safety.self_harm_banner.dismissed",conversation_uuid:a,message_uuid:t.uuid}),f(!0),h.mutateAsync({conversationUuid:a,messageUuid:t.uuid,flagName:"self_harm_risk"}).then(()=>{d.setQueryData([eb.fC,{orgUuid:u},{uuid:a},{returnDanglingHumanMessage:!1}],e=>{var a,s,n,l;if(!e)return e;let i=(s=null!=(a=e.messageByUuid.get(t.uuid))?a:e.chat_messages.find(e=>e.uuid===t.uuid),n="self_harm_risk",{...s,content:null==(l=s.content)?void 0:l.map(e=>"flags"in e&&Array.isArray(e.flags)&&e.flags.includes(n)?{...e,flags:e.flags.filter(e=>e!==n)}:e)}),r=new Map(e.messageByUuid);return r.set(t.uuid,i),{...e,chat_messages:e.chat_messages.map(e=>e.uuid===t.uuid?i:e),messageByUuid:r}})}).catch(e=>{eh.v.error(eh.u.PRIVATE_API,"Failed to remove self_harm_risk flag",{error:e,conversationUuid:a,messageUuid:t.uuid})})},[a,t.uuid,o,h,d,u]),y=(0,l.useCallback)(()=>{o({event_key:"claudeai.safety.self_harm_banner.resources_clicked",conversation_uuid:a,message_uuid:t.uuid})},[a,t.uuid,o]);return!m||x||i?null:b?(0,s.jsx)(ek,{message:t,conversationUuid:a,onDismiss:v}):(0,s.jsx)("div",{className:"mb-3 mt-3",children:(0,s.jsx)(eg.l,{pictogram:ep.HandBird,message:(0,s.jsx)(g.A,{defaultMessage:"If you or someone you know is having a difficult time, free support is available.",id:"RhJ3DdQQuy"}),button:{href:"https://claude.findahelpline.com/i/claude",target:"_blank",onLinkClick:y,children:(0,s.jsx)(g.A,{defaultMessage:"Find resources",id:"ViSIod1c4W"})},onClose:v})})}ek.displayName="SelfHarmRiskBannerLocalized";let eC=e=>{let{title:t,text:a}=e,n=(0,p.A)();t=t||n.formatMessage({defaultMessage:"Untitled note",id:"fkEfiUjl/t"}),a=a||"";let{didCopy:l,copyToClipboard:i}=(0,O.C)(),r=async()=>{let e=t+"\n"+a;try{let t=(0,ee.u)(e);await i({text:e,html:t})}catch(t){await i(e)}};return(0,s.jsxs)("div",{className:"group relative mt-4 mb-1 rounded-2xl border-border-300/25 border font-claude-response-body",children:[(0,s.jsxs)("div",{className:"pt-1 pb-1 px-3 border-b-0.5 border-border-300/25 font-semibold flex justify-between items-center",children:[(0,s.jsx)("span",{className:"flex-1",children:t}),(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",onClick:r,children:(0,s.jsx)(O.u,{didCopy:l})})]}),(0,s.jsx)(h.o,{className:"px-4 pt-2 pb-4",children:a})]})};var eS=a(0xb844abc8),eA=a(0x1a3383306),eE=a(0x1c12b3087),eI=a(0x1936feed4),eT=a(0x108536636),eL=a(0x24fae723a),eR=a(0x15068fa65);let eF=(0,l.memo)(e=>{let{selection:t,activeRange:a,onOpen:n,showAddToPrompt:i,disableExplain:r}=e,o=(0,l.useRef)(null),{track:d}=(0,L.st)(),c=(0,l.useCallback)(()=>{if(!o.current||!a.current)return;let e=a.current.getBoundingClientRect(),t=e.left+e.width/2,s=e.top-40;o.current.style.transform="translate(".concat(t,"px, ").concat(s,"px) translateX(-50%)")},[a]),u=(null==t?void 0:t.text.length)||0;if((0,l.useEffect)(()=>{u<=1||d({event_key:"claudeai.mini_claude.tooltip_impression",selection_length:u})},[u,d]),(0,l.useEffect)(()=>{if(t)return c(),window.addEventListener("scroll",c,!0),window.addEventListener("resize",c),()=>{window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",c)}},[t,c]),!t||!a.current)return null;let m=!r;return m||i?(0,eR.createPortal)((0,s.jsx)("div",{ref:o,"data-selection-tooltip":"true",style:{position:"fixed",top:0,left:0,pointerEvents:"auto",willChange:"transform"},children:(0,s.jsxs)("div",{className:"flex bg-always-black/80 rounded-lg shadow-lg backdrop-blur border border-always-white/10 text-always-white items-center",children:[m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-px bg-always-white/20 my-1.5 self-stretch"}),(0,s.jsx)("button",{onClick:()=>n("explain"),className:"px-3 py-1.5 text-sm font-medium text-always-white hover:bg-always-white/10 transition-colors cursor-pointer border-none whitespace-nowrap flex ".concat(i?"rounded-l-lg":"rounded-lg"),children:(0,s.jsx)(g.A,{defaultMessage:"Tell me more",id:"k82q+r212G",description:"Button to explain selected text"})})]}),i&&(0,s.jsxs)(s.Fragment,{children:[m&&(0,s.jsx)("div",{className:"w-px bg-always-white/20 my-1.5 self-stretch"}),(0,s.jsxs)("button",{onClick:()=>n("addToPrompt"),className:"px-3 py-1.5 text-sm font-medium text-always-white hover:bg-always-white/10 transition-colors cursor-pointer border-none whitespace-nowrap flex items-center gap-1 ".concat(m?"rounded-r-lg":"rounded-lg"),children:[(0,s.jsx)(g.A,{defaultMessage:"Reply",id:"jNnlTJdFg7",description:"Button to bring the selected text into the chat input as a quote block"}),(0,s.jsx)(eL.Y,{"aria-hidden":"true"})]})]})]})}),document.body):null});eF.displayName="SelectionTooltip",(0,l.memo)(e=>{let{conversationUuid:t,children:a,disableExplain:n}=e,i=(0,l.useRef)(null),{selection:r,clearSelection:o,activeRange:d}=function(e){let[t,a]=(0,l.useState)(null),s=(0,l.useRef)(null),n=(0,l.useRef)(null),i=(0,l.useCallback)(t=>{if(t.target.closest('[data-selection-tooltip="true"]'))return;let l=window.getSelection(),i=(null==l?void 0:l.toString().trim())||"";if(!l||0===l.rangeCount||!i||i.length<2||!e.current){a(null),s.current=null,n.current=null;return}let r=l.getRangeAt(0),o=e.current,d=r.startContainer.nodeType===Node.TEXT_NODE?r.startContainer.parentNode:r.startContainer;if(!d||!o.contains(d)){a(null),s.current=null,n.current=null;return}if(null!==n.current&&i===n.current){a(null),s.current=null,n.current=null,l.removeAllRanges();return}let c=r.getBoundingClientRect();s.current=r,n.current=i,a({text:i,rect:c})},[e]),r=(0,l.useCallback)(()=>{var e;a(null),s.current=null,n.current=null,null==(e=window.getSelection())||e.removeAllRanges()},[]);return(0,l.useEffect)(()=>{if(e.current)return document.addEventListener("mouseup",i),()=>{document.removeEventListener("mouseup",i)}},[e,i]),{selection:t,clearSelection:r,activeRange:s}}(i),c=(0,l.useRef)(null),[u,m]=(0,l.useState)(null),[x,f]=(0,l.useState)(null),{track:p}=(0,L.st)(),g=void 0!==(0,eE.jw)(),h=n||(0,eS.Fr)();(0,l.useEffect)(()=>{},[]);let b=(0,eE.Tc)(e=>e.promptInputRef,"MiniClaudeContainer"),v=(0,eE.Tc)(e=>e.setAttachments,"MiniClaudeContainer"),y=(0,l.useCallback)(e=>{var t;if(!r)return;let a=window.getSelection(),s=null==b||null==(t=b.current)?void 0:t.getEditor();switch(e){case"explain":if(h)return;a&&a.rangeCount>0&&(c.current=a.getRangeAt(0)),m({selectedText:r.text,action:e});break;case"addToPrompt":if(!g)return;if(s&&(null==b?void 0:b.current)){let e=new Blob([r.text]).size,t={file_name:eT.jP,file_size:e,file_type:"txt",extracted_content:r.text,origin:eA.R9.UserUpload,kind:eA.XA.Excerpt};v(e=>[...e,t]),s.commands.focus()}o();break;default:(0,eI.x)(e)}p({event_key:"claudeai.mini_claude.selection_action",selection_length:r.text.length,action:e})},[b,o,g,r,p,h,v]);return(0,l.useCallback)(()=>{m(null),c.current=null},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{ref:i,className:"contents",children:[a,!u&&(0,s.jsx)(eF,{selection:r,activeRange:d,onOpen:y,showAddToPrompt:g,disableExplain:h})]}),""]})}).displayName="MiniClaudeContainer";var ez=a(0x2504fdeeb),eO=a(0x17509cc64),eU=a(0x249008d3),eD=a(0x214374164),eP=a(0x1fec22234);let eB=e=>{let t=e.thumbnail_width||e.width,a=e.thumbnail_height||e.height;return t&&a&&t>0&&a>0?{width:t,height:a}:null},eG=(0,l.memo)(e=>{let{source:t,pageUrl:a}=e;if(!t)return null;let n=a||"https://".concat(t);return(0,s.jsxs)("button",{type:"button",onClick:e=>{e.stopPropagation(),window.open(n,"_blank","noopener,noreferrer")},className:"absolute bottom-2 left-2 bg-bg-500 hover:bg-bg-200 rounded-full px-2 py-1 flex items-center gap-1.5 text-text-100 max-w-[75%] transition-colors cursor-pointer",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(eP.d,{url:"https://".concat(t),size:16})}),(0,s.jsx)("span",{className:"text-xs truncate",children:t})]})});eG.displayName="AttributionPill";let eW=(0,l.memo)(e=>{let{image:t,onClick:a,className:n,style:i,overflowCount:r,borderRadius:o}=e,[d,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),x=(0,p.A)(),f=t.title||"",g={...i,...o?{borderRadius:o}:{}};return d||!t.thumbnail_url?(0,s.jsx)("div",{className:"bg-bg-300 flex items-center justify-center ".concat(n||""),style:g,children:(0,s.jsx)("span",{className:"text-text-300 text-xs",children:x.formatMessage({defaultMessage:"Image unavailable",id:"0PLW4icmxe"})})}):(0,s.jsxs)("button",{type:"button",onClick:a,className:"relative overflow-hidden cursor-pointer focus:outline-none focus-visible:ring-1 focus-visible:ring-inset focus-visible:ring-accent-secondary-100 ".concat(n||""),style:g,"aria-label":r?x.formatMessage({defaultMessage:"View all {count} images",id:"/Ic0evUYQB"},{count:r}):x.formatMessage({defaultMessage:"View full image: {title}",id:"GmA0VYFLhj"},{title:f}),children:[!u&&(0,s.jsx)("div",{className:"absolute inset-0 bg-bg-300 animate-pulse"}),(0,s.jsx)("img",{src:t.thumbnail_url,alt:f,onError:()=>c(!0),onLoad:()=>m(!0),className:"w-full h-full object-cover transition-transform duration-200 ease-out hover:scale-[1.02]",loading:"lazy",referrerPolicy:"no-referrer"}),(0,s.jsx)(eG,{source:t.source,pageUrl:t.page_url}),r&&(0,s.jsxs)("div",{className:"absolute bottom-2 right-2 bg-always-black/75 rounded-full px-2 py-1 flex items-center gap-1 text-always-white text-xs font-ui",children:[(0,s.jsx)(R.Image,{size:12}),(0,s.jsx)("span",{children:r})]})]})});eW.displayName="GridCell";let eq=(0,l.memo)(e=>{let{images:t,initialIndex:a,onClose:n}=e,[i,r]=(0,l.useState)(a),o=(0,p.A)(),d=t[i],c=i>0?t[i-1]:null,u=i<t.length-1?t[i+1]:null,m=(0,l.useCallback)(()=>{i>0&&r(i-1)},[i]),x=(0,l.useCallback)(()=>{i<t.length-1&&r(i+1)},[i,t.length]);return((0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key?n():"ArrowLeft"===e.key?m():"ArrowRight"===e.key&&x()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n,m,x]),(0,l.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),d)?(0,eR.createPortal)((0,s.jsxs)("div",{className:"fixed inset-0 z-50 bg-always-black flex flex-col overflow-hidden",onClick:n,children:[(0,s.jsx)("div",{className:"relative flex items-center py-4 px-4 z-10",children:(0,s.jsx)(F.$,{variant:"ghost",size:"icon_sm",option:"rounded",onClick:e=>{e.stopPropagation(),n()},className:"!text-always-white/70 hover:!text-always-white hover:!bg-always-white/10","aria-label":o.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}),children:(0,s.jsx)(R.X,{size:16})})}),(0,s.jsxs)("div",{className:"flex-1 relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"flex h-full transition-transform duration-300 ease-out items-center",style:{gap:"32px",transform:"translateX(calc(12.5vw - ".concat(75*i,"vw - ").concat(32*i,"px))")},children:t.map((e,t)=>(0,s.jsx)("div",{className:"h-full flex-shrink-0 flex items-center justify-center",style:{width:"75vw"},children:e.url&&(0,s.jsx)("img",{src:e.url,alt:e.title||"",referrerPolicy:"no-referrer",className:"max-h-[65vh] max-w-full object-contain rounded-2xl transition-opacity duration-300 ".concat(t===i?"opacity-100":"opacity-50 hover:opacity-70 cursor-pointer"),onClick:e=>{t!==i&&(e.stopPropagation(),t<i?m():x())}})},e.id))}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 pointer-events-none",style:{height:"max(128px, 10vh)",background:"linear-gradient(180deg, hsl(var(--always-black)/0%) 0%, hsl(var(--always-black)) 66.41%)"}}),(0,s.jsxs)("div",{className:"absolute bottom-6 left-0 right-0 z-10 flex items-start justify-center px-6 h-14",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"flex-1 flex justify-start items-start",children:(d.source||d.title)&&(0,s.jsxs)("button",{type:"button",className:"flex flex-col items-start text-left hover:opacity-100 opacity-80 transition-opacity cursor-pointer",onClick:e=>{e.stopPropagation();let t=d.page_url||d.url;t&&window.open(t,"_blank","noopener,noreferrer")},children:[d.source&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-always-white/50",children:[(0,s.jsx)(eP.d,{url:"https://".concat(d.source),size:16}),(0,s.jsx)("span",{children:d.source})]}),d.title&&(0,s.jsx)("div",{className:"text-sm text-always-white/90 line-clamp-2 max-w-md mt-0.5",children:d.title})]})}),(0,s.jsxs)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 inline-flex items-center gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:m,disabled:!c,className:(0,f.A)("p-2 rounded-lg transition-colors",c?"text-always-white hover:bg-bg-100 cursor-pointer":"text-always-white/30 cursor-default"),"aria-label":o.formatMessage({defaultMessage:"Previous image",id:"fb1a/oVcaa"}),children:(0,s.jsx)(R.CaretLeft,{size:20})}),(0,s.jsx)("span",{className:"px-2 text-always-white/80 text-sm tabular-nums",children:o.formatMessage({defaultMessage:"{current} of {total}",id:"stJYEYsqnV"},{current:i+1,total:t.length})}),(0,s.jsx)("button",{type:"button",onClick:x,disabled:!u,className:(0,f.A)("p-2 rounded-lg transition-colors",u?"text-always-white hover:bg-bg-100 cursor-pointer":"text-always-white/30 cursor-default"),"aria-label":o.formatMessage({defaultMessage:"Next image",id:"F+ukuPGfqR"}),children:(0,s.jsx)(R.CaretRight,{size:20})})]}),(0,s.jsx)("div",{className:"flex-1"})]})]})]}),document.body):null});eq.displayName="ImageCarousel";let eH=(0,l.memo)(e=>{var t,a,n,i,r,o,d,c;let{images:u,conversationUuid:m,className:x}=e,g=null!=x?x:"my-2",h=(0,p.A)(),b=(0,L.st)(),[v,y]=(0,l.useState)(null),{template:j,visibleCount:w,orderedImages:N,originalIndices:_}=(e=>{let t=e.length;if(1===t)return{template:"single",visibleCount:1,orderedImages:e,originalIndices:[0]};if(2===t)return{template:"two-side",visibleCount:2,orderedImages:e,originalIndices:[0,1]};let a=((e,t,a)=>{let s=0,n=-1/0;return e.forEach((e,l)=>{let i=eB(e);if(!i)return;let r=-Math.abs(i.width/i.height-t)+2*(i.height>=a?1:i.height/a);r>n&&(n=r,s=l)}),s})(e,.5,400);if(1>(e=>{let t=eB(e);return t?t.width/t.height:1})(e[a])||t>3){let t=e.filter((e,t)=>t!==a).slice(0,2);return{template:"three-left",visibleCount:3,orderedImages:[e[a],...t],originalIndices:[a,...e.map((e,t)=>t).filter(e=>e!==a).slice(0,2)]}}return{template:"three-row",visibleCount:3,orderedImages:e.slice(0,3),originalIndices:[0,1,2]}})(u),k=N.slice(0,w),M=u.length>w,C=[...k,...u.filter((e,t)=>!_.slice(0,w).includes(t))],S=(0,l.useCallback)(e=>{b.track({event_key:"image_search.image_clicked",conversation_uuid:m}),y(e)},[b,m]),A=(0,l.useCallback)(()=>y(null),[]);if(0===u.length)return(0,s.jsx)("div",{className:"py-2",children:(0,s.jsx)("p",{className:"text-sm text-text-300",children:h.formatMessage({defaultMessage:"No images found",id:"YeS7phazuq"})})});let E=()=>null!==v&&(0,s.jsx)(eq,{images:C,initialIndex:v,onClose:A});if("single"===j){let e=k[0],t=eB(e);if(t){let a=t.height>400?400/t.height:1,n=t.height*a,l=t.width*a;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:g,children:(0,s.jsx)(eW,{image:e,onClick:()=>S(0),borderRadius:"16px",style:{width:l,height:n},overflowCount:M?u.length:void 0})}),E()]})}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:g,children:(0,s.jsx)(eW,{image:e,onClick:()=>S(0),borderRadius:"16px",style:{height:200,width:300},overflowCount:M?u.length:void 0})}),E()]})}return"two-side"===j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,f.A)("flex",g),style:{gap:8,height:200},children:[(0,s.jsx)(eW,{image:k[0],onClick:()=>S(0),className:"flex-1",borderRadius:"16px"},"img-0-".concat(null==(t=k[0])?void 0:t.id)),(0,s.jsx)(eW,{image:k[1],onClick:()=>S(1),className:"flex-1",borderRadius:"16px",overflowCount:M?u.length:void 0},"img-1-".concat(null==(a=k[1])?void 0:a.id))]}),E()]}):"three-left"===j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,f.A)("grid",g),style:{gap:4,gridTemplateColumns:"1fr 1fr",gridTemplateRows:"".concat(200,"px ").concat(200,"px"),gridTemplateAreas:'"a b" "a c"'},children:[(0,s.jsx)(eW,{image:k[0],onClick:()=>S(0),style:{gridArea:"a"},borderRadius:"16px 4px 4px 16px"},"img-0-".concat(null==(n=k[0])?void 0:n.id)),(0,s.jsx)(eW,{image:k[1],onClick:()=>S(1),style:{gridArea:"b"},borderRadius:"4px 16px 4px 4px"},"img-1-".concat(null==(i=k[1])?void 0:i.id)),(0,s.jsx)(eW,{image:k[2],onClick:()=>S(2),style:{gridArea:"c"},borderRadius:"4px 4px 16px 4px",overflowCount:M?u.length:void 0},"img-2-".concat(null==(r=k[2])?void 0:r.id))]}),E()]}):"three-row"===j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,f.A)("flex",g),style:{gap:8,height:200},children:[(0,s.jsx)(eW,{image:k[0],onClick:()=>S(0),className:"flex-1",borderRadius:"16px"},"img-0-".concat(null==(o=k[0])?void 0:o.id)),(0,s.jsx)(eW,{image:k[1],onClick:()=>S(1),className:"flex-1",borderRadius:"16px"},"img-1-".concat(null==(d=k[1])?void 0:d.id)),(0,s.jsx)(eW,{image:k[2],onClick:()=>S(2),className:"flex-1",borderRadius:"16px",overflowCount:M?u.length:void 0},"img-2-".concat(null==(c=k[2])?void 0:c.id))]}),E()]}):null});eH.displayName="ImageGalleryGrid";var eY=a(0x2129aebe2),eV=a(0x1381f2bb),eJ=a(0x2202d81f6),eK=a(0x1888e36ef),eX=a(0x16c8fc080),e$=a(0x1b643ff5e),eQ=a(0x17774dcd8),eZ=a(0x2524bdea9),e0=a(0x14c0dfde7),e1=a(0x1d302b010),e2=a(0x25062734b),e5=a(0x9f889a90),e3=a(0x3d2215b3),e4=a(0xe824fb1c);function e8(e,t,a,s,n,i){let r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=null!=i?i:"{}",d=(0,e3.M)(),{track:c}=(0,L.st)(),u=(0,e0.p9)(),{mutate:m}=(0,e1.p4)(e),{toggleMcpToolAlwaysApproved:x}=(0,e2.es)(),[f,p]=(0,l.useState)(r),g=(0,e4.pK)(t),h=(null==g?void 0:g.tool)||null,b=(null==g?void 0:g.server)||null,v=u&&(null==b?void 0:b.uuid)&&!(0,e4.HG)(null==b?void 0:b.uuid,u)&&(null==b?void 0:b.type)==="remote",y=(0,e2.yr)()(b,h),j=s?s.includes("always"):!!y.showAlwaysAllowed,w=!!a,N=w&&!!h&&(u&&(null==b?void 0:b.type)==="remote"&&!(0,e4.HG)(b.uuid,u)?!!s&&!!n:y.approvalRequired),_=(0,l.useCallback)(s=>{if(w&&h&&!f){if("always"!==s||n||x(h.alwaysApprovedKey,!0),"deny"===s)if(v)m({tool_use_id:a,is_approved:!1,approval_key:n});else{var l;d(e,t,a,o,{overriddenResult:{content:[{type:"text",text:"The user has chosen to disallow the tool call."}],is_error:!0}}),c({event_key:"mcp.tools.called",result:"disallowed",argument_count:Object.keys(null!=(l=(0,e5.p)(o))?l:{}).length})}else v?m({tool_use_id:a,is_approved:!0,approval_key:n,approval_option:s}):d(e,t,a,o);p(!0)}},[w,f,h,n,x,v,m,d,e,t,a,o,c,p]),k=w&&!N&&!f&&!v&&!!i,M=(0,et.Zx)(e);return k&&(d(e,t,a,o),p(!0)),(0,l.useMemo)(()=>M?{approvalRequired:!1,disabled:!1,showAlwaysAllowed:!1,submitToolApproval:()=>{}}:{approvalRequired:N&&!f,disabled:!i,submitToolApproval:_,showAlwaysAllowed:j},[N,i,f,_,j,M])}let e6=(0,l.memo)(e=>{var t,a,n;let{conversationUuid:i,block:r,message:o,updatedMessage:d,index:c,shareType:u,isStreaming:m,isLastMessage:x,isFirstBlockOfMessage:f,isLastBlockOfMessage:p,renderMode:g,isFirstItemInGroup:h,isLastItemInGroup:b}=e,v=(0,eQ.nb)(),{renderToolUseCell:y}=(0,eZ.Q)(),j=(0,e$.Y)(r),w=r.name,N=r.id,_=r.context,k=null==(t=d.content)?void 0:t[c+1],M=(null==k?void 0:k.type)==="tool_result"?k:void 0,C=e8(i,r.name,r.id,r.approval_options,r.approval_key,r.buffered_input,!!M),S=v?void 0:C,A=!!d.content&&d.content.length<=c+1&&m,E=((e,t,a)=>{var s,n,l,i;let r,o,d,c=(null==t?void 0:t.type)==="tool_use"&&(null==t?void 0:t.name)==="artifacts",u=(null==e?void 0:e.type)==="tool_use"&&(null==e?void 0:e.name)==="artifacts";a.partial_json?a.partial_json.includes('"command":"create"')&&(r=(e=>{let t=e.match(/"id"\s*:\s*"([^"]*)"/);return t?t[1]:void 0})(a.partial_json)):r=null==(n=a.input)?void 0:n.id,u&&(o=null==e||null==(l=e.input)?void 0:l.id),!c||(null==t?void 0:t.partial_json)||(d=null==t||null==(i=t.input)?void 0:i.id);let m=r===o,x=r===d,f="individual_cell_create",p=null==(s=a.input)?void 0:s.command;if(p&&(f=({create:"individual_cell_create",update:"individual_cell_update",rewrite:"individual_cell_rewrite"})[p]),!c&&!u)return f;if(c&&u)if(!m&&!x)return f;else if(m&&!x)return"multi_edit_last";else return"multi_edit_not_last";if(c&&!u)if(!x)return f;else return"multi_edit_not_last";if(!c&&u&&m)return"multi_edit_last";return f})(null==(a=d.content)?void 0:a[c-2],null==(n=d.content)?void 0:n[c+2],r);if(!y)throw Error("renderToolUseCell() is not provided, missing ChatMessageContext?");let I=(0,l.useMemo)(()=>y({toolUseId:N,input:j,isLastMessage:x,message:o,isStreaming:A,toolName:w,toolResult:M,displayData:{integrationName:r.integration_name,integrationIcon:r.integration_icon_url,message:(null==M?void 0:M.message)||r.message,toolMessage:r.message,input:r.display_content,result:null==M?void 0:M.display_content},approvalData:S,mcpAuthRequired:r.mcp_auth_required,artifactCellType:E,isFirstBlockOfMessage:f,isLastBlockOfMessage:p,shareType:u,context:_,renderMode:g,groupItemKey:String(c),isFirstItemInGroup:h,isLastItemInGroup:b}),[S,E,r.display_content,r.integration_icon_url,r.integration_name,r.mcp_auth_required,r.message,_,c,j,f,h,p,b,x,o,g,y,u,A,w,M,N]);return(0,s.jsx)(l.Fragment,{children:I})});e6.displayName="ToolUse";var e9=a(0xf583d59a),e7=a(0x16a96a9a2),te=a(0x18b9bd76),tt=a(0xede65b);function ta(e){let{text:t,conversationUuid:a,onOpen:n,onDownloadAll:i,shareType:r,presentFiles:o}=e,d=(0,Z.PF)(),c=(0,l.useMemo)(()=>[...(0,tt.n)(t),...null!=o?o:[]].filter(e=>(0,e7.m)(e,r)),[t,r,o]);return 0===c.length?null:(0,s.jsxs)("div",{className:"flex flex-col gap-2 py-2",children:[c.map(e=>{let t=e.split("/").pop()||e;return(0,s.jsx)(te._,{conversationUuid:a,file:{name:t,path:e},onOpen:()=>{n(e)},isShared:!!r},e)}),c.length>1&&!d&&(0,s.jsx)("div",{children:(0,s.jsx)(F.$,{variant:"secondary",prepend:(0,s.jsx)(e9.e,{size:"1.1rem"}),onClick:()=>{i(c)},children:(0,s.jsx)(g.A,{defaultMessage:"Download all",id:"V1UrPNM96z"})})})]})}var ts=a(0x1f507121),tn=a(0xec9172c1),tl=a(0x16801a2b9),ti=a(0x1e140f433),tr=a(0x1050bd590);let to=(0,l.memo)(()=>(0,s.jsx)("div",{className:"w-full aspect-[4/3] bg-bg-300 rounded-lg animate-pulse"}));to.displayName="ShimmerImageCard";let td=(0,l.memo)(e=>{let{toolResult:t,isStreaming:a,numImages:n=4,conversationUuid:i}=e,r=(0,p.A)(),o=(0,L.st)(),d=(0,l.useRef)(!1),{images:c,malformedCount:u}=(0,l.useMemo)(()=>(function(e){if(!(null==e?void 0:e.content))return{images:[],malformedCount:0};try{for(let a of e.content)if("image_gallery"===a.type){var t;let e=null!=(t=a.images)?t:[],s=e.filter(e=>e&&e.id&&e.thumbnail_url);return{images:s,malformedCount:e.length-s.length}}}catch(e){}return{images:[],malformedCount:0}})(t),[t]);return((0,l.useEffect)(()=>{u>0&&!d.current&&(d.current=!0,o.track({event_key:"image_search.malformed_images",conversation_uuid:i,malformed_count:u,valid_count:c.length}))},[o,i,u,c.length]),a&&0===c.length)?(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 py-2 pl-2",children:[...Array(n)].map((e,t)=>(0,s.jsx)(to,{},t))}):0===c.length?(0,s.jsx)("div",{className:"py-2 pl-2",children:(0,s.jsx)("p",{className:"text-sm text-text-300",children:r.formatMessage({defaultMessage:"No images found",id:"YeS7phazuq"})})}):(0,s.jsx)("div",{className:"pl-2 w-full",children:(0,s.jsx)(eH,{images:c,conversationUuid:i})})});td.displayName="ImageSearchToolUseCell";var tc=a(0x1f7748bd),tu=a(0xbca8e388),tm=a(0x20805e624),tx=a(0xbe2d73b0),tf=a(0x46988392);let tp=["year","month","day","hour","minute","second","millisecond"],tg=e=>{let{value:t,...a}=e;return function(e,t){let{listStyle:a,...s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=tf.dw.fromDurationLike(t);return e.formatList(tp.filter(e=>0!==n["".concat(e,"s")]).map(t=>e.formatNumber(n["".concat(t,"s")],{...s,style:"unit",unit:t})),{...s,style:a})}((0,p.A)(),t,a)};var th=a(0xc6536c20),tb=a(0xef41e510),tv=a.n(tb);function ty(e,t){if(!e)return;let a=(t?th.c9.fromISO(t):th.c9.now()).diff(th.c9.fromISO(e),["hours","minutes","seconds"]);return 0>a.toMillis()?th.dw.fromMillis(0):a}function tj(e){return(0,s.jsx)("div",{...e,className:"bg-bg-100 text-text-300 border-0.5 border-border-300 flex flex-row gap-1.5 rounded-md p-2 mx-4 mb-4 font-small"})}let tw=()=>(0,s.jsxs)(tj,{"data-testid":"message-warning",children:[(0,s.jsx)(R.Info,{className:"shrink-0",size:16}),(0,s.jsx)(g.A,{defaultMessage:"The rest of the <link>thought process</link> is not available for this response.",id:"G/67Pe5XhQ",values:{link:e=>(0,s.jsx)(tv(),{href:"https://support.anthropic.com/en/articles/10574485-using-extended-thinking-on-claude-3-7-sonnet",className:"underline",target:"_blank",children:e})}})]}),tN=e=>{let{text:t,cutOff:a}=e;return(0,s.jsxs)("div",{className:"text-text-300 text-sm font-normal gap-0.5 relative font-claude-response",children:[(0,s.jsx)(tu.fP,{className:"p-3 pt-0 pr-8",text:t}),!0!==a?null:(0,s.jsx)(tw,{})]})},t_=(0,l.memo)(function(e){let{startTimestamp:t,stopTimestamp:a,isStreaming:n=!1}=e,[i,r]=(0,l.useState)(()=>ty(t,a));return(0,l.useEffect)(()=>{let e;return n&&(e=setInterval(()=>r(ty(t)),1e3)),()=>clearInterval(e)},[n,t]),i?(0,s.jsx)(tg,{value:i,listStyle:"narrow",unitDisplay:"narrow",maximumFractionDigits:0}):null}),tk=(0,l.memo)(e=>{let t,{index:a,text:n,cutOff:i=!1,startTimestamp:r,stopTimestamp:d,isStreaming:c,mostRecentSummary:u,onToggle:m,messageUuid:x,isFirstBlockOfMessage:g,isLastBlockOfMessage:h,renderMode:b=eU.l.Standard,isFirstItemInGroup:v,isLastItemInGroup:y,conversationUuid:j}=e,w=(0,ec.useDynamicConfig)("claudeai_isp_thinking_ux"),N=w.get("enabled",!1),_=(0,p.A)(),k=_.formatMessage({defaultMessage:"Thinking",id:"AHQWDTo4+e"}),M=_.formatMessage({defaultMessage:"Thinking...",id:"QrZMdiKa7h"}),C=_.formatMessage({defaultMessage:"Thought process",id:"zl6fNbo7RW"}),{isExpanded:S,setIsExpanded:A,snappyTransition:E}=(0,tc.a)(!N&&c,String(a)),I=(0,L.st)(),T=(0,l.useRef)(!1),[F,z]=(0,l.useState)(null),O=!!(r&&d&&!T.current),[U,D]=(0,l.useState)(()=>{let e=!1;if(O){let t=ty(r,d);e=!!t&&t.as("milliseconds")>=1e4}return e});(0,l.useEffect)(()=>{let e;return c&&(e=setTimeout(()=>D(!0),1e4)),()=>clearTimeout(e)},[c]);let B=(0,l.useRef)([]);(0,l.useEffect)(()=>{(0,tm.GN)(x)&&B.current.length>0&&(B.current.forEach(e=>{I.track({event_key:"claudeai.thinking_cell.clicked",is_opening:e.isOpening,is_streaming:e.wasStreamingWhenClicked,chat_message_uuid:x,timestamp:e.timestamp})}),B.current=[])},[x,I]),(0,l.useEffect)(()=>{c&&(T.current=!0)},[c]);let G=c||T.current?w.get("fallback_summary_debounce_ms",2e3):0;(0,tx.W)(()=>{!c&&n.length>0&&z(tM(n,w))},[n,c],G);let W=null==u?void 0:u.summary,q=(0,et.Zx)(j);if(q)t=n;else if(N)if(c)t=null!=W?W:M;else{var H;t=null!=(H=null!=W?W:F)?H:M}else t=null!=W?W:c?k:C;return(0,s.jsx)(ti.sH,{isStreaming:c,isExpanded:S,setIsExpanded:()=>{let e=new Date().toISOString();(0,tm.GN)(x)?I.track({event_key:"claudeai.thinking_cell.clicked",is_opening:!S,is_streaming:c,chat_message_uuid:x,timestamp:e}):B.current.push({isOpening:!S,wasStreamingWhenClicked:c,timestamp:e}),A(!S)},isFirstBlockOfMessage:g,isLastBlockOfMessage:h,text:S?C:!q&&(c||T.current)?(0,s.jsx)(P.N,{mode:"wait",children:(0,s.jsx)(o.P.span,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.3,ease:"easeIn"},className:N?"text-text-300":"text-left relative text-sm font-claude-response leading-6 whitespace-nowrap text-text-300 text-ellipsis overflow-hidden basis-0 grow min-w-0",children:t},t)}):(0,s.jsx)("span",{className:N?"text-text-300":"text-left relative text-sm font-claude-response leading-6 whitespace-nowrap text-text-300 text-ellipsis overflow-hidden basis-0 grow min-w-0",children:t}),secondaryText:U?(0,s.jsxs)("span",{className:"flex items-center gap-1 transition-opacity",children:[(0,s.jsx)(R.ExtendedThinking,{className:(0,f.A)("text-text-300 transition-all duration-300 ease-in-out",c?"opacity-0 scale-50":"opacity-50 scale-100"),size:12}),(0,s.jsx)("span",{className:"tabular-nums",children:O?(0,s.jsx)(t_,{startTimestamp:r,stopTimestamp:d}):(0,s.jsx)(t_,{startTimestamp:r,isStreaming:c})})]}):void 0,renderMode:b,isFirstItemInGroup:v,isLastItemInGroup:y,children:(0,s.jsx)(ti.NG,{isExpanded:S,snappyTransition:E,onTransitionEnd:m,isScrollable:!0,children:(0,s.jsx)(tN,{text:n,cutOff:i})})})});tk.displayName="ThinkingCell";let tM=(e,t)=>{let a=t.get("fallback_summary_min_len",50),s=t.get("fallback_summary_max_len",100),n=new RegExp(t.get("fallback_summary_regex",".*(\\n|\\.(\\s|$)|。)")),l=e.substring(0,s),i=n.exec(l);if(i)return i[0];for(let e=l.length-1;e>=a;e--)if(/\s/.test(l[e]))return l.substring(0,e+1);return l},tC=(0,l.memo)(e=>{var t;let a,{block:n,index:l,isThisMessageStreaming:i,blocksCount:o}=e;if(!(0,r.fS)("empty_your_cup")||"text"!==n.type&&"thinking"!==n.type&&"tool_use"!==n.type||!(!i||l<o-1))return null;let d=new Set(null!=(t=n.flags)?t:[]);return(d.has("a2")?a=(0,s.jsx)(K.YX,{id:"curvature_propulsion_drive"}):d.has("a1")&&(a=(0,s.jsx)(K.YX,{id:"bubble_universe_portal"})),a)?(0,s.jsx)("div",{className:"px-1.5 py-0.5 mx-2 my-1 opacity-80 text-xs font-ui bg-danger-900 text-danger-000 rounded border-0.5 border-danger-200 select-none",children:a},"flag-".concat(l)):null});tC.displayName="FlagMessage";let tS=(0,l.memo)(e=>{var t,a;let{taskBlock:n,childBlocks:i,message:r,updatedMessage:o,isStreaming:d,isLastMessage:c,conversationUuid:u,shareType:m,onResize:x,onOpenArtifact:f,onOpenWiggleFile:p,isFirstInGroup:g=!0,isLastInGroup:h=!0,renderMode:b=eU.l.TimelineGroup}=e,v=(0,eK.q)(),{isExpanded:y,setIsExpanded:j,snappyTransition:w}=(0,tc.a)(!1,void 0,!1),N=null!=(a=null==(t=n.input)?void 0:t.description)?a:"Task",_=d&&c,k=(0,l.useCallback)(()=>{j(!y)},[y,j]),M=(0,l.useCallback)(e=>{e.stopPropagation()},[]),C=i.length>0;return(0,s.jsx)(ti.sH,{isExpanded:v&&y,setIsExpanded:k,isExpandingDisabled:!C,isStreaming:_,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,renderMode:b,isFirstItemInGroup:g,isLastItemInGroup:h,text:N,icon:(0,s.jsx)(eV.O,{size:16,children:(0,s.jsx)(eX.Z,{size:12,className:"text-text-300"})}),children:(0,s.jsx)(ti.NG,{isExpanded:v&&y,snappyTransition:w,isScrollable:!1,children:(0,s.jsxs)("div",{className:"flex flex-col",onClick:M,children:[(0,s.jsx)(tr.L,{input:n.input}),(0,s.jsx)(eD.TD,{children:i.length>0&&(0,s.jsx)("div",{className:"flex flex-col",children:i.map((e,t)=>(0,s.jsx)(tA,{block:e,index:t,blocks:i,isStreaming:d,isThisMessageStreaming:_,isLastMessage:c,updatedMessage:o,message:r,onResize:x,conversationUuid:u,shareType:m,onOpenArtifact:f,onOpenWiggleFile:p,renderMode:eU.l.TimelineGroup,isFirstItemInGroup:0===t,isLastItemInGroup:t===i.length-1},"subagent-block-".concat(t)))})})]})})})});tS.displayName="SubAgentToolUseCell";let tA=(0,l.memo)(e=>{let{block:t,index:a,blocks:i,isStreaming:o,isThisMessageStreaming:d,isLastMessage:c,updatedMessage:u,message:m,onResize:x,conversationUuid:f,shareType:p,onOpenArtifact:g,onOpenWiggleFile:h,presentFiles:b,...v}=e,{renderMode:y,isFirstItemInGroup:j,isLastItemInGroup:w}=v,{setMessageFeatures:_}=(0,N.Bk)(),k=(0,r.fS)("claude_ai_image_search"),M=i[a+1],C=i.length,S=(null==M?void 0:M.type)==="tool_result",A=0===a,E=!!C&&a===C-1-!!S,I=(0,l.useCallback)(e=>null==g?void 0:g(e,u.uuid),[g,u.uuid]),T=(0,l.useCallback)(()=>{_(m.uuid,{hasLink:!0})},[_,m.uuid]),L=(0,l.useCallback)(()=>{_(m.uuid,{hasCode:!0})},[_,m.uuid]),{activeOrganization:R}=(0,n.YL)(),{dispatchChatResource:F}=(0,tl.i)(),{setIsDrawerExpanded:z}=(0,tn.x)(),O=(0,r.fS)("chat-ui-core"),U=(0,l.useCallback)((e,t)=>{t.startsWith("computer://")&&(null==R?void 0:R.uuid)&&(e.preventDefault(),F({type:"SELECT_FILE",path:decodeURIComponent(t.replace("computer://","")),toolType:"create_file",messageId:u.uuid}),z(!0))},[null==R?void 0:R.uuid,F,z,u.uuid]),D=(0,ts._)(),P=(0,l.useCallback)(e=>{(null==R?void 0:R.uuid)&&D(p?{filepaths:e,orgUuid:null==R?void 0:R.uuid,snapshotUuid:f,isShared:!0,source:"wiggle_file_card_download_all"}:{filepaths:e,orgUuid:null==R?void 0:R.uuid,conversationUuid:f,isShared:!1,source:"wiggle_file_card_download_all"})},[null==R?void 0:R.uuid,p,f,D]),B=(0,l.useCallback)(()=>{null==x||x()},[x]),G=(0,l.useCallback)(e=>{null==h||h(e,m.uuid)},[h,m.uuid]),W=(0,l.useCallback)(e=>{null==P||P(e)},[P]),q=o||E&&d&&(null==u?void 0:u.stop_reason)==="max_tokens"&&"stop_timestamp"in t&&!!t.stop_timestamp,H=(0,l.useMemo)(()=>{var e,n,l,i;if(k&&"tool_use"===t.type&&"image_search"===t.name){let l=(null==M?void 0:M.type)==="tool_result"?M:void 0,i=null!=(n=null==(e=t.input)?void 0:e.num_images)?n:4;return(0,s.jsx)(td,{toolResult:l,isStreaming:q,numImages:i,conversationUuid:f},a)}switch(t.type){case"thinking":return(0,s.jsx)(tk,{index:a,text:t.thinking,cutOff:t.cut_off,startTimestamp:t.start_timestamp,stopTimestamp:t.stop_timestamp,isStreaming:d&&(!t.stop_timestamp||E&&(null==u?void 0:u.stop_reason)==="max_tokens"),mostRecentSummary:null==(l=t.summaries)?void 0:l.at(-1),messageUuid:u.uuid,onToggle:B,isFirstBlockOfMessage:A,isLastBlockOfMessage:E,renderMode:y,isFirstItemInGroup:j,isLastItemInGroup:w,conversationUuid:f},a);case"tool_use":if("Task"===t.name){let e=null!=(i=t.childBlocks)?i:[];return(0,s.jsx)(tS,{taskBlock:t,childBlocks:e,message:m,updatedMessage:u,isStreaming:q,isLastMessage:c,conversationUuid:f,shareType:p,onResize:B,onOpenArtifact:I,onOpenWiggleFile:G,isFirstInGroup:j,isLastInGroup:w,renderMode:y},a)}return(0,s.jsx)(e6,{conversationUuid:f,block:t,message:m,updatedMessage:u,index:a,shareType:p,isStreaming:q,isLastMessage:c,isFirstBlockOfMessage:A,isLastBlockOfMessage:E,renderMode:y||eU.l.Standard,isFirstItemInGroup:j,isLastItemInGroup:w},a);case"text":if(0===a&&""===t.text)return;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eJ.qO,{text:t.text,blockCitations:t.citations,onLinkDetected:T,onCodeDetected:L,className:d?"progressive-markdown":"standard-markdown",isStreaming:d,onOpenArtifact:I,isLastMessage:c,onLinkClick:U,chatUiCore:O}),(0,s.jsx)(ta,{text:t.text,onOpen:G,conversationUuid:f,onDownloadAll:W,shareType:p,presentFiles:E?b:void 0})]});default:return null}},[t,O,f,q,k,a,A,j,E,w,c,d,m,M,L,W,U,T,I,G,B,b,y,p,u]);return(0,s.jsxs)(s.Fragment,{children:[H,(0,s.jsx)(tC,{block:t,blocksCount:i.length,index:a,isThisMessageStreaming:d})]})});tA.displayName="Block";var tE=a(0xc459f9d1),tI=a(0x9cb4c2a2),tT=a(0x1c29096e8),tL=a(0xda192b6c),tR=a(0x1628a449c),tF=a(0xff72c689);let tz=(0,l.memo)(e=>{let{labelWidth:t,valueWidth:a}=e;return(0,s.jsxs)("div",{className:"flex items-center border-b-0.5 border-border-300",children:[(0,s.jsx)("div",{className:"w-24 shrink-0 px-5 py-3",children:(0,s.jsx)(tT.LB,{width:t,height:14})}),(0,s.jsx)("div",{className:"flex-1 px-2 py-2.5",children:(0,s.jsx)(tT.LB,{width:a,height:14})})]})});tz.displayName="ShimmerField";let tO=(0,l.memo)(()=>(0,s.jsx)("div",{className:"font-ui bg-bg-000 rounded-2xl rounded-t-3xl overflow-hidden border-border-300 border -mx-1 mb-4",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(tz,{labelWidth:24,valueWidth:"50%"}),(0,s.jsx)(tz,{labelWidth:52,valueWidth:"70%"}),(0,s.jsxs)("div",{className:"px-5 py-4 space-y-3",children:[(0,s.jsx)(tT.LB,{width:"100%",height:14}),(0,s.jsx)(tT.LB,{width:"95%",height:14}),(0,s.jsx)(tT.LB,{width:"85%",height:14}),(0,s.jsx)(tT.LB,{width:"60%",height:14})]})]})}));tO.displayName="ShimmerEmailDraft";let tU=(0,l.memo)(e=>{var t,a,i,r,d,u,x,g,h,b,v,y,j,w,N,_,k,M,C,S,A,E,I,T,L,F,z;let{input:O,isStreaming:U,onSubmit:D}=e,B=(0,p.A)(),{sendTransparentMessage:G}=(0,tI.oM)(),{account:W}=(0,n.YL)(),q=(0,l.useMemo)(()=>{var e;let t=String(null!=(e=null==W?void 0:W.email_address)?e:"").toLowerCase();return t.endsWith("@gmail.com")||t.endsWith("@googlemail.com")||t.endsWith("@anthropic.com")},[null==W?void 0:W.email_address]),H=(0,l.useMemo)(()=>{var e;return null!=(e=null==O?void 0:O.variants)?e:[]},[null==O?void 0:O.variants]),Y=H.length>0,[V,J]=(0,l.useState)(Y?0:-1),[K,X]=(0,l.useState)(null!=(i=null==O?void 0:O.to)?i:""),$=(0,l.useCallback)(e=>{X(e),e.trim()&&ed(!1)},[]),[Q,Z]=(0,l.useState)(null!=(r=null==O?void 0:O.cc)?r:""),[ee,et]=(0,l.useState)(null!=(d=null==O?void 0:O.bcc)?d:""),[ea,es]=(0,l.useState)(Y?null!=(x=null!=(u=null==(t=H[0])?void 0:t.subject)?u:null==O?void 0:O.subject)?x:"":null!=(g=null==O?void 0:O.subject)?g:""),[en,el]=(0,l.useState)(Y?null!=(b=null!=(h=null==(a=H[0])?void 0:a.body)?h:null==O?void 0:O.body)?b:"":null!=(v=null==O?void 0:O.body)?v:""),[ei,er]=(0,l.useState)(!1),[eo,ed]=(0,l.useState)(!1),{copyToClipboard:ec}=(0,tE.C)(),eu=JSON.stringify(O),[em,ex]=(0,l.useState)(eu);if(eu!==em){ex(eu);let e=null!=(w=null==O?void 0:O.variants)?w:[],t=e.length>0;J(t?0:-1),X(null!=(N=null==O?void 0:O.to)?N:""),Z(null!=(_=null==O?void 0:O.cc)?_:""),et(null!=(k=null==O?void 0:O.bcc)?k:""),es(t?null!=(C=null!=(M=null==(y=e[0])?void 0:y.subject)?M:null==O?void 0:O.subject)?C:"":null!=(S=null==O?void 0:O.subject)?S:""),el(t?null!=(E=null!=(A=null==(j=e[0])?void 0:j.body)?A:null==O?void 0:O.body)?E:"":null!=(I=null==O?void 0:O.body)?I:""),er(!1)}let ef=V>=0?H[V]:null,ep=null!=(L=null!=(T=null==ef?void 0:ef.subject)?T:null==O?void 0:O.subject)?L:"",eg=null!=(z=null!=(F=null==ef?void 0:ef.body)?F:null==O?void 0:O.body)?z:"",eh=(0,l.useCallback)(e=>{J(e);let t=H[e];if(t){var a,s;es(null!=(s=null!=(a=t.subject)?a:null==O?void 0:O.subject)?s:""),el(t.body)}er(!1)},[H,null==O?void 0:O.subject]),eb=(0,l.useMemo)(()=>{var e,t,a;return K!==(null!=(e=null==O?void 0:O.to)?e:"")||Q!==(null!=(t=null==O?void 0:O.cc)?t:"")||ee!==(null!=(a=null==O?void 0:O.bcc)?a:"")||ea!==ep||en!==eg},[K,Q,ee,ea,en,O,ep,eg]),ev=(0,l.useCallback)(e=>{if(e.stopPropagation(),e.preventDefault(),D&&D({to:K,cc:Q,bcc:ee,subject:ea,body:en}),G){let e=ef?'I selected the "'.concat(ef.label,'" variant'):"",t=eb?" and made some edits":"";G([e?"".concat(e).concat(t,". Here's the email:"):"Here's my revised email:","","To: ".concat(K),Q&&"Cc: ".concat(Q),ee&&"Bcc: ".concat(ee),"Subject: ".concat(ea),"",en].filter(Boolean).join("\n"))}er(!0)},[D,K,Q,ee,ea,en,G,ef,eb]),ey=(0,l.useCallback)(()=>{if(!K.trim())return void ed(!0);if(q){let e=new URLSearchParams;e.set("view","cm"),e.set("fs","1"),K&&e.set("to",K),Q&&e.set("cc",Q),ee&&e.set("bcc",ee),ea&&e.set("su",ea),en&&e.set("body",en);let t="https://mail.google.com/mail/u/0/?".concat(e.toString());window.open(t,"_blank")}else{let e=new URLSearchParams;Q&&e.set("cc",Q),ee&&e.set("bcc",ee),ea&&e.set("subject",ea),en&&e.set("body",en);let t=e.toString(),a="mailto:".concat(encodeURIComponent(K)).concat(t?"?".concat(t):"");window.location.href=a}},[K,Q,ee,ea,en,q]),ej=(0,l.useCallback)(()=>{ec(en)},[en,ec]),ew=(0,l.useCallback)(()=>{var e,t,a;$(null!=(e=null==O?void 0:O.to)?e:""),Z(null!=(t=null==O?void 0:O.cc)?t:""),et(null!=(a=null==O?void 0:O.bcc)?a:""),es(ep),el(eg)},[O,ep,eg,$]);return U?(0,s.jsx)(tO,{}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"font-ui bg-bg-000 rounded-2xl rounded-t-3xl overflow-hidden border-border-300 border -mx-1 mb-4 transition-colors focus-within:border-accent-secondary-200/50 focus-within:shadow-md ",children:[Y&&(0,s.jsx)("div",{className:"flex gap-1 p-1.5 border-b-0.5 border-border-300",children:H.map((e,t)=>{let a=V===t;return(0,s.jsxs)("button",{type:"button",onClick:()=>eh(t),className:(0,f.A)("group/row border-0.5 flex flex-1 items-center gap-2.5 p-2 text-left rounded-full !-outline-offset-4 transition",a?"bg-accent-secondary-000/5 border-accent-secondary-100/20":"hover:bg-bg-200 border-transparent"),children:[(0,s.jsx)("span",{className:(0,f.A)("relative flex size-6 font-semibold shrink-0 items-center justify-center rounded-full text-xs transition",a?"bg-accent-secondary-000 text-bg-000 font-bold":"bg-bg-300 text-text-300 group-hover/row:bg-bg-400"),children:String.fromCharCode(65+t)}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsx)("div",{className:(0,f.A)("text-sm  line-clamp-1",a?"text-accent-secondary-000 font-medium":"text-text-300"),children:e.label})})]},t)})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(tD,{label:B.formatMessage({defaultMessage:"To:",id:"Seu2ONe+xm"}),value:K,onChange:$,placeholder:B.formatMessage({defaultMessage:"recipient@example.com",id:"HUMYZh9FZp"}),error:eo,errorMessage:B.formatMessage({defaultMessage:"Required",id:"Seanpxav9K"})}),(Q||(null==O?void 0:O.cc))&&(0,s.jsx)(tD,{label:B.formatMessage({defaultMessage:"Cc:",id:"uaF1O5GXzh"}),value:Q,onChange:Z,placeholder:B.formatMessage({defaultMessage:"cc@example.com",id:"qAc4YkWabt"})}),(ee||(null==O?void 0:O.bcc))&&(0,s.jsx)(tD,{label:B.formatMessage({defaultMessage:"Bcc:",id:"UZzuoC+ccM"}),value:ee,onChange:et,placeholder:B.formatMessage({defaultMessage:"bcc@example.com",id:"14Noef7PQb"})}),(0,s.jsx)(tD,{label:B.formatMessage({defaultMessage:"Subject:",id:"D5c6XGolTE"}),value:ea,onChange:es,placeholder:B.formatMessage({defaultMessage:"Email subject",id:"YPL7RLd0bp"})}),(0,s.jsx)("div",{className:"overflow-hidden",children:(0,s.jsx)(P.N,{mode:"wait",initial:!1,children:(0,s.jsxs)(o.P.div,{className:"relative",initial:{opacity:0,filter:"blur(4px)"},animate:{opacity:1,x:0,filter:"blur(0px)"},exit:{opacity:0,filter:"blur(4px)"},transition:{duration:.25,ease:[.25,.1,.25,1]},children:[(0,s.jsx)("textarea",{value:en,onChange:e=>el(e.target.value),placeholder:B.formatMessage({defaultMessage:"Write your message...",id:"yoP6t+NY/q"}),className:"px-5 py-4 w-full min-h-[240px] resize-none bg-transparent border-none text-sm text-text-100 placeholder:text-text-500 !outline-none !ring-0",rows:6}),(0,s.jsxs)("div",{className:"absolute bottom-2 right-2 inline-flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center p-0.5 bg-bg-000 rounded-[0.65rem] border-0.5 border-border-300 shadow-sm overflow-hidden",children:[(0,s.jsx)(c.$,{variant:"ghost",size:"icon_sm",onClick:ej,tooltip:B.formatMessage({defaultMessage:"Copy message",id:"8Rj4WgXPcB"}),className:"!rounded-lg",children:(0,s.jsx)(R.Copy,{vectorSizeOverride:18})}),(0,s.jsxs)("div",{className:(0,f.A)("inline-flex items-center transition-all",eb?"opacity-100 translate-x-0":"opacity-0 -translate-x-2 pointer-events-none w-0"),children:[(0,s.jsx)("div",{className:"w-px h-4 bg-border-300 mx-0.5"}),(0,s.jsx)(c.$,{tooltip:B.formatMessage({defaultMessage:"Reset changes",id:"PysW/nhRkj"}),variant:"ghost",size:"icon_sm",onClick:ew,className:"!rounded-lg",children:(0,s.jsx)(m.j,{size:16})}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon_sm",onClick:ev,disabled:ei,tooltip:B.formatMessage({defaultMessage:"Back to chat",id:"9b8jIuaNj+"}),className:"!rounded-lg",children:(0,s.jsx)(tR.K,{size:16})})]})]}),(0,s.jsxs)("div",{className:"group/gmail relative",children:[q&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:'\n                              @property --gradient-angle {\n                                syntax: "<angle>";\n                                initial-value: 0deg;\n                                inherits: false;\n                              }\n                              @keyframes gmail-rotate {\n                                0% { --gradient-angle: 0deg; }\n                                100% { --gradient-angle: 360deg; }\n                              }\n                            '}),(0,s.jsx)("div",{className:"absolute inset-0 rounded-[0.65rem] opacity-0 group-hover/gmail:opacity-100 transition-opacity",style:{background:"conic-gradient(from var(--gradient-angle, 0deg), #EA4335, #FBBC05, #34A853, #4285F4, #EA4335)",animation:"gmail-rotate 3s linear infinite"}})]}),(0,s.jsx)("div",{className:(0,f.A)("relative p-[0.5px] rounded-[0.65rem] shadow-sm border-0.5 border-border-300",q&&"group-hover/gmail:border-transparent"),children:(0,s.jsx)("div",{className:(0,f.A)("bg-bg-000 p-0.5 rounded-[0.6rem]",q&&"!bg-bg-000/90"),children:(0,s.jsx)(c.$,{variant:"ghost",size:"sm",onClick:ey,className:(0,f.A)("gap-2 !rounded-lg",q&&"hover:!bg-bg-000/50 backdrop-blur-lg"),children:q?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tL.kw,{size:16}),B.formatMessage({defaultMessage:"Open in Gmail",id:"cCHB+nypRw"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tF.l,{size:16}),B.formatMessage({defaultMessage:"Open email",id:"+y4Ldn9L8c"})]})})})})]})]})]},V)})})]})]})})});tU.displayName="EmailDraftToolUseCell";let tD=(0,l.memo)(e=>{let{label:t,value:a,onChange:n,placeholder:l,error:i,errorMessage:r}=e;return(0,s.jsxs)("div",{className:(0,f.A)("flex items-center border-b-0.5 border-border-300"),children:[(0,s.jsx)("label",{className:(0,f.A)("w-24 shrink-0 px-5 py-3 text-sm text-text-500 "),children:t}),(0,s.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,s.jsx)("input",{type:"text",value:a,onChange:e=>n(e.target.value),placeholder:l,className:(0,f.A)("flex-1 px-2 py-2.5 text-sm bg-transparent border-none","text-text-100 placeholder:text-text-500","!outline-none !ring-0")}),i&&r&&(0,s.jsx)("span",{className:"mr-3 px-3 py-1 rounded-full text-xs bg-danger-100/10 !text-danger-100",children:r})]})]})});tD.displayName="EmailField";var tP=a(0x18f6e74fb),tB=a(0x1b4b4fb37),tG=a(0x15fe0c6d);function tW(e){if(!(null==e?void 0:e.content))return null;for(let t of e.content)if(t&&"object"==typeof t&&"type"in t&&"text"===t.type&&"text"in t&&"string"==typeof t.text)try{return JSON.parse(t.text)}catch(e){}return null}function tq(e){if(!(null==e?void 0:e.content))return[];for(let a of e.content)if("image_gallery"===a.type){var t;return(null!=(t=a.images)?t:[]).filter(e=>e&&e.id&&e.thumbnail_url)}return[]}let tH=[{toolName:"image_search",extract:tq,aggregate:!0},{toolName:"display_stock_info",extract:tW,previewOnly:!0},{toolName:"display_sports_info",extract:tW,previewOnly:!0},{toolName:"display_weather_info",extract:tW,previewOnly:!0},{toolName:"draft_email",extract:(e,t)=>e?t:null,previewOnly:!0}].filter(e=>!e.previewOnly||""),tY=new Set([...tH.map(e=>e.toolName),"AskUserInput"]),tV=[{toolName:"image_search",className:"pl-2 pt-1",render:(e,t)=>(0,s.jsx)(eH,{images:e.result,conversationUuid:t,className:"mb-2"})},{toolName:"display_stock_info",className:"pl-2 pt-1 pb-2",previewOnly:!0,render:e=>(0,s.jsx)(tB.q,{input:e.result,isStreaming:!e.result})},{toolName:"display_sports_info",className:"pl-2 pt-1 pb-2",previewOnly:!0,render:e=>(0,s.jsx)(tP.R,{input:e.result,isStreaming:!e.result})},{toolName:"display_weather_info",className:"pl-2 pt-1 pb-2",previewOnly:!0,render:e=>(0,s.jsx)(tG.Y,{input:e.result,isStreaming:!e.result})},{toolName:"draft_email",className:"pl-2 pt-1 pb-2",previewOnly:!0,render:e=>(0,s.jsx)(tU,{input:e.result,isStreaming:!e.result})}].filter(e=>!e.previewOnly||""),tJ=e=>"tool_use"===e.type&&"image_search"===e.name,tK=e=>{var t;return"tool_result"===e.type||"token_budget"===e.type||"process_group_marker"===e.type||"thinking"===e.type||"text"===e.type&&!(null==(t=e.text)?void 0:t.trim())},tX=e=>{if("tool_use"!==e.type)return!1;let t=tH.find(t=>t.toolName===e.name);return void 0!==t&&!t.aggregate},t$=(0,l.memo)(e=>{let{blocks:t,isStreaming:a,isThisMessageStreaming:n,isLastMessage:i,updatedMessage:o,message:d,onResize:c,conversationUuid:u,shareType:m,onOpenArtifact:x,onOpenWiggleFile:f}=e,p=(0,ec.useDynamicConfig)("claudeai_isp_thinking_ux"),g=(0,r.fS)("claudeai_collapse_timeline_groups"),h=(0,l.useMemo)(()=>(function(e,t){var a;return!((null==(a=t.metadata)?void 0:a.render_hint)==="subagent"||e.find(e=>"tool_use"===e.type&&"Task"===e.name))&&1?e:e.filter(e=>(!("_isSubagentBlock"in e)||!e._isSubagentBlock)&&("text"===e.type||"thinking"===e.type||"tool_use"===e.type||"tool_result"!==e.type))})(t,d),[t,d]),b=(0,l.useMemo)(()=>h.filter(e=>"tool_use"===e.type&&e.name.includes(":")).map(e=>e.name),[h]),v=(0,eO.TC)(b),y=(0,l.useMemo)(()=>{let e=[],t=new Set;return h.forEach((a,s)=>{if(!t.has(s))if((0,eD.Ih)(a,p,v)){let n={items:[{block:a,index:s,renderable:(0,eD.h4)(a)}],startIndex:s,isLastBlockOfMessage:!1};for(let e=s+1;e<h.length;e++){let a=h[e];if(!(0,eD.Ih)(a,p,v))break;n.items.push({block:a,index:e,renderable:(0,eD.h4)(a)}),t.add(e),e===h.length-1&&(n.isLastBlockOfMessage=!0)}let l=n.items.findLastIndex(e=>"tool_use"===e.block.type&&"artifacts"===e.block.name);if(l>=0){let e=n.items[l];n.items=n.items.slice(0,l),t.delete(e.index),n.items.forEach(e=>{"tool_use"===e.block.type&&"artifacts"===e.block.name&&(e.renderable=!1)})}0===n.items.filter(e=>e.renderable).length?e.push({type:"single",content:a,index:s}):e.push({type:"group",content:n,index:s})}else e.push({type:"single",content:a,index:s})}),e},[h,p,v]),j=(0,eY.a)(d),w=(0,l.useMemo)(()=>(0,eY.G)(d),[j]);return(0,s.jsx)(s.Fragment,{children:y.map(e=>{let t=e.content;if("object"==typeof t&&"type"in t&&"aggregated_image_search"===t.type)return 0===t.images.length?null:(0,s.jsx)("div",{className:"pl-2 w-full",children:(0,s.jsx)(eH,{images:t.images,conversationUuid:u})},"aggregated-image-search-".concat(e.index));if("object"==typeof t&&"type"in t&&"aggregated_widget"===t.type){let a=tV.find(e=>e.toolName===t.toolName);return a?(0,s.jsx)("div",{className:a.className,children:a.render({input:t.input,result:t.result},u)},"aggregated-widget-".concat(t.toolName,"-").concat(e.index)):null}if("group"===e.type){let t=e.content,l=t.items.filter(e=>e.renderable);if(l.length<=1){let t=l[0];return t?(0,s.jsx)(tA,{block:t.block,index:t.index,blocks:h,isLastMessage:i,isStreaming:a,isThisMessageStreaming:n,updatedMessage:o,message:d,onResize:c,conversationUuid:u,shareType:m,onOpenArtifact:x,onOpenWiggleFile:f,presentFiles:w},"block-".concat(e.type,"-").concat(e.index)):null}let r=t.items.every(e=>"thinking"===e.block.type||"tool_use"===e.block.type&&"Task"===e.block.name);return(0,s.jsx)(eD.DT,{isFirstBlockOfMessage:0===t.startIndex,isLastBlockOfMessage:t.isLastBlockOfMessage,isStreaming:a,defaultExpanded:r,alwaysExpanded:r,children:l.map((e,t)=>{let p=g&&l.length>2&&!r;return(0,s.jsx)(tA,{block:e.block,index:e.index,blocks:h,renderMode:eU.l.TimelineGroup,isFirstItemInGroup:0===t&&!p,isLastItemInGroup:t===l.length-1,isLastMessage:i,isStreaming:a,isThisMessageStreaming:n,updatedMessage:o,message:d,onResize:c,conversationUuid:u,shareType:m,onOpenArtifact:x,onOpenWiggleFile:f,presentFiles:w},e.index)})},"block-".concat(e.type,"-").concat(e.index))}return(0,s.jsx)(tA,{block:e.content,index:e.index,blocks:h,onResize:c,conversationUuid:u,shareType:m,onOpenArtifact:x,onOpenWiggleFile:f,isThisMessageStreaming:n,isLastMessage:i,updatedMessage:o,message:d,isStreaming:a,presentFiles:w},"block-".concat(e.type,"-").concat(e.index))})})});t$.displayName="MessageBlocksRenderer";let tQ={COLLAPSE_EXPAND:.2,FADE:.15,FADE_SLOW:.3,FADE_IN:.5,LAYOUT:.2},tZ={EASE_OUT:"easeOut",EASE_IN:"easeIn",SNAPPY_OUT:[.19,1,.22,1]},t0={SHORT:"duration-150"},t1=(0,l.createContext)({}),t2=()=>(0,l.useContext)(t1),t5=e=>{let[t,a]=(0,l.useState)(void 0),n=(0,l.useMemo)(()=>({expandedItemKey:t,setExpandedItemKey:a,hasCollapseHeader:e.hasCollapseHeader,variant:e.variant}),[t,a,e.hasCollapseHeader,e.variant]);return(0,s.jsx)(t1.Provider,{value:n,children:e.children})};var t3=function(e){return e.Standard="Standard",e.TimelineGroup="TimelineGroup",e}({}),t4=a(0x17185943),t8=a(0x112f760bb),t6=a(0x8f813b9c);let t9=(0,l.memo)(e=>{let{icon:t,header:a,isExpanded:n,isFirstItem:l,isLastItem:i,isActive:r,showDotFallback:d=!0,children:c}=e,{hasCollapseHeader:u}=t2();return(0,s.jsxs)(o.P.div,{initial:!1,animate:{opacity:1},transition:{opacity:{duration:tQ.FADE}},className:"flex flex-col shrink-0",children:[(0,s.jsx)("div",{className:"flex flex-row h-[8px]",children:(0,s.jsx)("div",{className:"w-[20px] flex justify-center",children:(0,s.jsx)("div",{className:(0,f.A)("w-[1px] h-full",t0.SHORT,{"bg-border-300":!(!u&&l)})})})}),(0,s.jsxs)("div",{className:(0,f.A)("transition-colors rounded-lg",t0.SHORT,{"bg-bg-000":n}),children:[a&&(0,s.jsxs)("div",{className:"flex flex-row items-center py-1",children:[(0,s.jsx)("div",{className:"w-[20px] flex justify-center shrink-0 text-text-500",children:null!=t?t:d&&(0,s.jsx)("div",{className:"size-[8px] rounded-full bg-border-100 mt-0.5"})}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:a})]}),c&&(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"w-[20px] flex justify-center shrink-0",children:a?(0,s.jsx)("div",{className:(0,f.A)("w-[1px] h-full",t0.SHORT,{"bg-border-300":!i})}):(0,s.jsxs)("div",{className:"flex flex-col items-center pt-1",children:[null!=t?t:d&&(0,s.jsx)("div",{className:"size-[8px] rounded-full bg-border-100 mt-0.5"}),(0,s.jsx)("div",{className:(0,f.A)("w-[1px] flex-1 mt-1",t0.SHORT,{"bg-border-300":!(d&&i)})})]})}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:c})]})]}),(0,s.jsx)("div",{className:"flex flex-row h-[8px]",children:(0,s.jsx)("div",{className:"w-[20px] flex justify-center",children:(0,s.jsx)("div",{className:(0,f.A)("w-[1px] h-full",t0.SHORT,{"bg-border-300":!i})})})})]})},(e,t)=>e.isActive===t.isActive&&!t.isActive&&e.icon===t.icon&&e.header===t.header&&e.children===t.children&&e.isExpanded===t.isExpanded&&e.isFirstItem===t.isFirstItem&&e.isLastItem===t.isLastItem&&e.showDotFallback===t.showDotFallback);t9.displayName="TimelineGroupItem";let t7=e=>{let{isExpanded:t,children:a,className:n}=e;return(0,s.jsx)(o.P.div,{className:(0,f.A)("overflow-clip shrink-0",n),tabIndex:-1,initial:!1,animate:t?"expanded":"collapsed",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{ease:tZ.SNAPPY_OUT,duration:tQ.COLLAPSE_EXPAND},style:{willChange:t?"height":"auto"},children:(0,s.jsx)("div",{className:"h-full",children:a})})},ae=(0,l.memo)(e=>{let{handleClick:t,isDisabled:a,isExpanded:n,isStreaming:l,icon:i,text:r,secondaryText:d,isFirstBlockOfMessage:c,isLastBlockOfMessage:u,className:m,wrapperClassName:x,children:p,renderMode:g=t3.Standard,isFirstItemInGroup:h,isLastItemInGroup:b,secondaryElement:v,secondaryIcon:y,hideCaret:j}=e,{variant:w="default"}=t2(),N=a||!t,_=(0,s.jsxs)("button",{onClick:N?void 0:t,className:(0,f.A)("group/row flex flex-row items-center rounded-lg px-2.5 w-full",v?"gap-2":"justify-between",g!==t3.TimelineGroup&&(v?"py-1":"py-2"),"todoList"===w?"text-text-500":"text-text-300",N?"!cursor-default":"cursor-pointer transition-colors duration-200 hover:text-text-200 hover:text-text-000",m),children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0 flex-1",children:[i&&g!==t3.TimelineGroup&&(0,s.jsx)("div",{className:"flex items-center justify-center text-text-500 shrink-0",children:i}),(0,s.jsx)("div",{className:(0,f.A)("text-sm text-text-500 text-left truncate",!v&&"w-0 flex-grow"),children:l?(0,s.jsx)(t6.N,{children:r}):r}),v&&(0,s.jsx)("div",{className:"flex items-center shrink-0 ml-2",children:v})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-1.5 shrink-0",children:[!!d&&(0,s.jsx)("p",{className:"pl-1 text-text-500 font-small shrink-0 whitespace-nowrap",children:d}),y&&(0,s.jsx)("span",{className:"inline-flex",children:y}),!N&&!j&&!y&&(0,s.jsx)("span",{className:(0,f.A)("inline-flex transition-transform",t0.SHORT,n?"rotate-180":"rotate-0"),children:(0,s.jsx)(R.CaretDownSmall,{className:"text-text-300",size:16})})]})]}),k=(0,s.jsxs)(s.Fragment,{children:[_,p]});return g===t3.TimelineGroup?(0,s.jsx)(t9,{icon:i,header:_,isExpanded:n,isFirstItem:!!h,isLastItem:!!b,isActive:l&&u&&b,showDotFallback:!1,children:p}):(0,s.jsx)(o.P.div,{initial:!1,animate:{opacity:1},transition:{duration:tQ.FADE_IN,ease:tZ.EASE_IN},className:(0,f.A)("ease-out rounded-lg border-[0.5px] flex flex-col font-ui leading-normal my-3 border-border-300",!a&&!n&&"hover:bg-bg-200",c?"mt-2":"mt-3",u?"mb-2":"mb-3",n&&"bg-bg-000 shadow-sm",x),children:k})});ae.displayName="ToolUseRow";let at=(0,l.memo)(e=>{let{isExpandingDisabled:t,setIsExpanded:a,...n}=e,{isExpanded:l}=n;return(0,s.jsx)(ae,{...n,isDisabled:t,handleClick:t?void 0:()=>a(!l)})});at.displayName="CollapsibleToolUseRow";let aa=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;return t.includes("SKILL.md")||"skill"===e?(0,s.jsx)(R.BookText,{size:a,className:"text-text-500"}):(0,s.jsx)(R.File,{size:a,className:"text-text-500"})},as=(0,l.memo)(e=>{let{action:t,path:a,fileText:n,displayText:l,icon:i,iconSize:r=16,files:d,isStreaming:c,isComplete:u=!1,renderMode:m=t3.Standard,isFirstBlockOfMessage:x,isLastBlockOfMessage:f,isFirstItemInGroup:g,isLastItemInGroup:h,renderCode:b,handleClick:v}=e,y=(0,p.A)(),j=a.split("/").pop()||a,w=(e=>{var t;return({js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",c:"c",cpp:"cpp",h:"c",hpp:"cpp",cs:"csharp",go:"go",rs:"rust",php:"php",swift:"swift",kt:"kotlin",scala:"scala",html:"html",css:"css",scss:"scss",less:"less",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",md:"markdown",sql:"sql",sh:"bash",bash:"bash",zsh:"bash",ps1:"powershell",dockerfile:"dockerfile"})[(null==(t=e.split(".").pop())?void 0:t.toLowerCase())||""]||"text"})(a),N=u||!c,_=l||((e,t,a,s)=>{switch(e){case"create":return a?s.formatMessage({defaultMessage:"Creating {fileName}",id:"cuaMuzr//N"},{fileName:t}):s.formatMessage({defaultMessage:"Created {fileName}",id:"5CvLCHBlfQ"},{fileName:t});case"read":return a?s.formatMessage({defaultMessage:"Reading {fileName}",id:"9fXfauBZpW"},{fileName:t}):s.formatMessage({defaultMessage:"Read {fileName}",id:"bApErctxyt"},{fileName:t});case"edit":return a?s.formatMessage({defaultMessage:"Editing {fileName}",id:"O2hMrU1FI9"},{fileName:t}):s.formatMessage({defaultMessage:"Edited {fileName}",id:"V+jPyROpXb"},{fileName:t});case"present":return a?s.formatMessage({defaultMessage:"Presenting file(s)...",id:"Lkp0F6AHBT"}):s.formatMessage({defaultMessage:"Presented file(s)",id:"YD+KHgvA3S"});case"skill":return a?s.formatMessage({defaultMessage:"Loading skill",id:"YBctaBAMh/"}):s.formatMessage({defaultMessage:"Loaded skill",id:"/ly4NRQA83"});default:return t}})(t,j,!N,y),k=i||aa(t,a,r),M=n&&!u;return(0,s.jsxs)(ae,{icon:k,text:(0,s.jsx)("span",{className:"truncate",children:_}),isStreaming:c&&!u,hideCaret:!0,handleClick:v,renderMode:m,isFirstBlockOfMessage:x,isLastBlockOfMessage:f,isFirstItemInGroup:g,isLastItemInGroup:h,children:[("create"===t||"edit"===t)&&n&&(0,s.jsx)(P.N,{mode:"wait",initial:!1,children:u?(0,s.jsx)(o.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:"mx-2.5 mt-1",children:(0,s.jsx)("button",{onClick:v,className:"cursor-pointer transition-colors text-text-500 hover:text-text-200",children:(0,s.jsx)(t4.E,{color:"flat",size:"default",className:"!text-inherit",children:j})})},"file-pill"):(0,s.jsx)(o.P.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"mx-2.5 mt-1 mb-2",children:(0,s.jsx)("div",{className:"border-[0.5px] border-border-300 rounded-xl overflow-hidden bg-bg-000/30 text-xs",children:(0,s.jsx)(t8.Z,{className:"max-h-[150px] overflow-y-auto",noDefaultScroll:!c,children:b?b(n,w):(0,s.jsx)("pre",{className:"p-3 text-text-300 whitespace-pre-wrap overflow-x-auto",children:(0,s.jsx)("code",{children:n})})})})},"file-content")}),"create"!==t&&"edit"!==t&&M&&(0,s.jsx)(o.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{ease:"easeOut",duration:.3},className:"overflow-hidden",children:(0,s.jsx)("div",{className:"border-[0.5px] border-border-300 rounded-xl mx-2.5 mt-1 mb-2 overflow-hidden bg-bg-000/30",children:(0,s.jsx)(t8.Z,{className:"max-h-[150px] overflow-y-auto",noDefaultScroll:!c,children:b?b(n,w):(0,s.jsx)("pre",{className:"p-3 text-sm text-text-300 whitespace-pre-wrap overflow-x-auto",children:(0,s.jsx)("code",{children:n})})})})}),"present"===t&&d&&d.length>0&&(0,s.jsx)(o.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{ease:"easeOut",duration:.3},className:"overflow-hidden",children:(0,s.jsx)("div",{className:"border-[0.5px] border-border-300 rounded-xl mx-2.5 mt-1 mb-2 max-h-[150px] overflow-y-auto bg-bg-000/30 p-2",children:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:d.map((e,t)=>(0,s.jsx)("div",{className:"text-sm text-text-300 truncate",children:e},t))})})})]})});var an=a(0x1b813d90),al=a(0x303b360c);let ai=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;switch(e.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()){case"bash":case"bash_tool":return(0,s.jsx)(R.CommandLine,{size:t,className:"text-text-500"});case"read":return(0,s.jsx)(R.BookText,{size:t,className:"text-text-500"});case"write":case"create_file":case"open_file":case"update_file":return(0,s.jsx)(R.File,{size:t,className:"text-text-500"});case"edit":case"str_replace":case"str_replace_editor":return(0,s.jsx)(R.Edit,{size:t,className:"text-text-500"});case"glob":case"grep":return(0,s.jsx)(R.Search,{size:t,className:"text-text-500"});case"repl":return(0,s.jsx)(R.CodeBlock,{size:t,className:"text-text-500"});case"web_search":case"web_fetch":return(0,s.jsx)(R.Globe,{size:t,className:"text-text-500"});case"todo_write":return(0,s.jsx)(R.Tasks,{size:t,className:"text-text-500"});case"task":return(0,s.jsx)(R.Agent,{size:t,className:"text-text-500"});case"ask_user_question":return(0,s.jsx)(R.Lightbulb,{size:t,className:"text-text-500"});case"recent_chats":case"conversation_search":return(0,s.jsx)(R.Memory,{size:t,className:"text-text-500"});case"project_knowledge_search":return(0,s.jsx)(R.Projects,{size:t,className:"text-text-500"});case"drive_search":return(0,s.jsx)(tL.A9,{type:an.v8.GDRIVE,size:t});default:return null}},ar=(0,l.memo)(e=>{var t;let{toolName:a,toolDisplayName:n,renderMode:l=t3.Standard,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,isFirstItemInGroup:o,isLastItemInGroup:d,isStreaming:c,icon:u,iconSize:m=16,integrationIconUrl:x,integrationName:f,isExpandable:p=!1,expandedContent:g,children:h}=e,b=n||(e=>{let t=e.split("__");if(t.length>=3)return t[2];let a=e.split(":");return a.length>=2?a[a.length-1]:e})(a).split("_").map((e,t)=>0===t?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase()).join(" "),v=ai(a,m),y=(0,s.jsx)(al.B,{letter:f||b,size:m,hideBorder:!0}),j=null!=(t=null!=u?u:v)?t:x?(0,s.jsx)(eP.d,{url:x,size:m,fadeInOnLoad:!0,fallbackSvg:y}):f?y:(0,s.jsx)(R.Wrench,{size:m,className:"text-text-500"});return p&&g?(0,s.jsx)(at,{isExpanded:!1,setIsExpanded:()=>{},isStreaming:c,icon:j,text:b,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,renderMode:l,isFirstItemInGroup:o,isLastItemInGroup:d,children:(0,s.jsx)(t7,{isExpanded:!1,children:g})}):(0,s.jsx)(ae,{icon:j,text:b,isStreaming:c,hideCaret:!0,renderMode:l,isFirstBlockOfMessage:i,isLastBlockOfMessage:r,isFirstItemInGroup:o,isLastItemInGroup:d,children:h})});ar.displayName="GenericToolCell";let ao=(0,l.memo)(e=>{let{toolName:t,message:a,resultMessage:n,resultCount:l=0,renderMode:i=t3.Standard,isFirstBlockOfMessage:r,isLastBlockOfMessage:d,isFirstItemInGroup:c,isLastItemInGroup:u,isStreaming:m,iconSize:x=16,children:f}=e,g=(0,p.A)(),h=l>0||!m,b=n||a||(h?g.formatMessage({defaultMessage:"Searched",id:"0ZuuhwjU4n"}):g.formatMessage({defaultMessage:"Searching",id:"IfE0if3ytt"})),v=h&&l>0?g.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:l}):void 0,y="project_knowledge_search"===t.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()?(0,s.jsx)(R.Projects,{size:x,className:"text-text-500"}):(0,s.jsx)(R.Memory,{size:x,className:"text-text-500"});return(0,s.jsx)(ae,{icon:y,text:b,secondaryText:v,isStreaming:!h,hideCaret:!0,renderMode:i,isFirstBlockOfMessage:r,isLastBlockOfMessage:d,isFirstItemInGroup:c,isLastItemInGroup:u,children:f&&h&&(0,s.jsx)(o.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{ease:"easeOut",duration:.3},className:"overflow-hidden",children:(0,s.jsx)("div",{className:"border-[0.5px] border-border-300 rounded-lg mx-2.5 mt-1 mb-2 max-h-[200px] overflow-y-auto bg-bg-000/50",children:f})})})}),ad=e=>{let{title:t,url:a,faviconUrl:n,className:l,onClick:i}=e,r=(e=>{try{return new URL(e).hostname}catch(t){return e}})(a);return(0,s.jsxs)("div",{className:(0,f.A)("flex flex-row gap-3 items-center px-2 py-1.5 w-full","rounded-md cursor-pointer transition-colors hover:bg-bg-200",l),onClick:()=>{i?i(a):window.open(a,"_blank","noopener,noreferrer")},children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(eP.d,{url:n||a,size:12,fadeInOnLoad:!0})}),(0,s.jsx)("div",{className:"w-0 flex-grow font-small text-text-300 truncate",children:t}),(0,s.jsx)("div",{className:"text-xs text-text-400 shrink-0",children:r})]})};var ac=a(0xc288ff4d);(0,l.memo)(function(e){let{statusText:t,isVisible:a,isExpanded:n=!1,onToggle:i}=e,r=(0,l.useCallback)(()=>{null==i||i()},[i]);if(!a||!t)return null;let d=n?R.Collapse:R.Expand,c=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative w-5 h-5 flex items-center justify-center shrink-0",children:[(0,s.jsx)(ac.a,{state:"writing",className:"!w-5 !text-accent-main-200 group-hover/status:opacity-0 transition-opacity duration-100 mt-1",isInteractive:!1}),i&&(0,s.jsx)(d,{size:16,className:"absolute opacity-0 group-hover/status:opacity-100 transition-opacity duration-100 text-text-500"})]}),(0,s.jsx)(P.N,{mode:"wait",initial:!1,children:(0,s.jsx)(o.P.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:4},transition:{duration:tQ.FADE_SLOW,ease:tZ.EASE_OUT},className:"flex-1",children:(0,s.jsx)(t6.N,{className:"text-left font-base",children:t})},t)})]});return i?(0,s.jsx)("button",{onClick:r,className:"group/status flex items-start gap-2 py-2 text-text-300 text-sm hover:text-text-200 transition-colors cursor-pointer w-full text-left","data-status-display":"true",children:c}):(0,s.jsx)("div",{className:"flex items-start gap-2 py-2 text-text-300 text-sm","data-status-display":"true",children:c})}).displayName="StatusDisplay";let au=(0,l.memo)(function(e){let{isWorking:t,statusText:a,stepCount:n,isTimelineExpanded:i=!1,onToggleTimeline:r,sparkLayoutId:d,className:c,stepsDisplayText:u,children:m}=e,[x,p]=(0,l.useState)(!1),h=(0,l.useCallback)(()=>{p(e=>!e)},[]),b=(0,l.useCallback)(()=>{null==r||r()},[r]),v=i?R.CaretDownUp:R.CaretUpDown,y=r?(0,s.jsxs)("button",{onClick:b,className:"group/status flex items-center gap-2 py-2 text-text-300 text-sm hover:text-text-200 transition-colors cursor-pointer w-full text-left",children:[(0,s.jsxs)("div",{className:"relative w-5 h-5 flex items-center justify-center shrink-0",children:[(0,s.jsx)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"pt-1",children:(0,s.jsx)(ac.a,{state:"writing",className:"!w-5 !text-accent-main-200 group-hover/status:opacity-0 transition-opacity duration-100",isInteractive:!1})}),(0,s.jsx)(v,{size:16,className:"absolute opacity-0 group-hover/status:opacity-100 transition-opacity duration-100 text-text-500"})]}),(0,s.jsx)(P.N,{mode:"wait",initial:!1,children:(0,s.jsx)(o.P.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:4},transition:{duration:tQ.FADE_SLOW,ease:tZ.EASE_OUT},className:"flex-1",children:(0,s.jsx)(t6.N,{className:"text-left font-base",children:a})},a)})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2 py-2 text-text-300 text-sm",children:[(0,s.jsx)("div",{className:"relative w-5 h-5 flex items-center justify-center shrink-0",children:d?(0,s.jsx)(o.P.div,{layoutId:d,layoutDependency:t,transition:{type:"spring",stiffness:400,damping:30},className:"pt-1",children:(0,s.jsx)(ac.a,{state:"writing",className:"!w-5 !text-accent-main-200",isInteractive:!1})}):(0,s.jsx)("div",{className:"pt-1",children:(0,s.jsx)(ac.a,{state:"writing",className:"!w-5 !text-accent-main-200",isInteractive:!1})})}),(0,s.jsx)(t6.N,{className:"text-left font-base",children:a})]}),j=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:h,className:"inline-flex items-center gap-1 text-text-500 font-base text-sm transition-colors hover:text-text-300 py-2",children:[(0,s.jsx)(P.N,{mode:"wait",initial:!1,children:(0,s.jsx)(o.P.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:tQ.FADE,ease:tZ.EASE_OUT},children:u||(0,s.jsx)(g.A,{defaultMessage:"{count, plural, one {# step} other {# steps}}",id:"vAKAnIbJ4M",values:{count:n}})},u||"steps")}),(0,s.jsx)("span",{className:(0,f.A)("inline-flex transition-transform duration-200",!x&&"-rotate-90"),children:(0,s.jsx)(R.CaretDownSmall,{size:12})})]}),(0,s.jsx)(P.N,{children:x&&(0,s.jsx)(o.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:tQ.COLLAPSE_EXPAND,ease:tZ.EASE_OUT},style:{overflow:"hidden"},children:m})})]});return(0,s.jsx)("div",{className:(0,f.A)("min-h-[36px] grid",c),children:(0,s.jsx)(P.N,{mode:"sync",initial:!1,children:t&&a?(0,s.jsx)(o.P.div,{className:"row-start-1 col-start-1",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:tQ.FADE,ease:tZ.SNAPPY_OUT},children:y},"working"):(0,s.jsx)(o.P.div,{className:"row-start-1 col-start-1 pb-1",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:tQ.FADE,ease:tZ.SNAPPY_OUT},children:j},"done")})})});au.displayName="StatusPill";let am=(0,l.memo)(e=>{let{children:t,isFirstBlockOfMessage:a,isLastBlockOfMessage:n,isStreaming:i,className:r,borderless:d=!1,autoCollapse:c=!1,variant:u="default",animateEntrance:m=!1}=e,[x,p]=(0,l.useState)(!1),[h,b]=(0,l.useState)(!1);(0,l.useEffect)(()=>{i&&!x&&p(!0)},[i,x]);let v=l.Children.toArray(t),y=v.length,j=c&&y>=3,w=Math.max(0,y-2);return(0,s.jsx)(o.P.div,{initial:!1,animate:{opacity:1},layout:!i&&!j,transition:{opacity:{duration:tQ.FADE_SLOW,ease:tZ.EASE_OUT},layout:{duration:tQ.LAYOUT,ease:tZ.EASE_OUT}},className:(0,f.A)("flex flex-col font-ui leading-normal",!d&&"rounded-lg border-0.5 border-border-300 my-3",!d&&(a?"mt-2":"mt-3"),!d&&(n?"mb-2":"mb-3"),r),children:(0,s.jsx)(t5,{hasCollapseHeader:j&&w>0,variant:u,children:(0,s.jsxs)(P.N,{initial:m,children:[j&&w>0&&(0,s.jsx)(t9,{icon:(0,s.jsx)(R.CaretDownSmall,{size:16,className:(0,f.A)("transition-transform text-text-300",h?"rotate-0":"rotate-180")}),isFirstItem:!0,isLastItem:!1,isActive:!1,showDotFallback:!1,children:(0,s.jsx)("button",{onClick:()=>b(!h),className:"px-3 py-2 w-full text-left text-sm text-text-300",children:h?(0,s.jsx)(g.A,{defaultMessage:"Hide steps",id:"Iufn28MeR1"}):(0,s.jsx)(g.A,{defaultMessage:"{collapsedCount, plural, one {# step} other {# steps}}",id:"dS6ebV+vpY",values:{collapsedCount:w}})})}),v.map((e,t)=>{let a=(0,l.isValidElement)(e)?e.key:t,n=j&&!h&&t<y-2;return(0,s.jsx)(o.P.div,{className:"overflow-hidden shrink-0",initial:!!m&&{opacity:0,height:0},animate:n?"collapsed":"expanded",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{ease:tZ.SNAPPY_OUT,duration:tQ.COLLAPSE_EXPAND},style:{pointerEvents:n?"none":"auto",willChange:"height, opacity"},children:e},a)})]})})})});am.displayName="TimelineGroup";let ax=(0,l.memo)(function(e){var t;let{description:a,isStreaming:n,isComplete:i=!1,renderMode:r=t3.Standard,isFirstBlockOfMessage:d=!1,isLastBlockOfMessage:c=!1,isFirstItemInGroup:u,isLastItemInGroup:m,subagentBlocks:x,renderSubagentBlock:h}=e,b=(0,p.A)(),[v,y]=(0,l.useState)(!1),j=(0,l.useCallback)(()=>{y(e=>!e)},[]),w=x&&x.length>0&&h,N=null!=(t=null==x?void 0:x.length)?t:0,_=n&&!i,k=a||b.formatMessage({defaultMessage:"Running subagent",id:"XGkVpOO9dA"}),M=N>0?(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm",children:[(0,s.jsx)(g.A,{defaultMessage:"{stepCount, plural, one {# step} other {# steps}}",id:"DNlRq2D8lw",values:{stepCount:N}}),(0,s.jsx)(R.CaretRightSmall,{size:16,className:(0,f.A)("transition-transform duration-200",v&&"rotate-45")})]}):void 0,C=v&&w?x:[];return(0,s.jsx)(ae,{icon:(0,s.jsx)(R.Agent,{size:16,className:"text-text-500"}),text:k,secondaryText:M,isStreaming:_,hideCaret:!0,handleClick:w?j:void 0,renderMode:r,isFirstBlockOfMessage:d,isLastBlockOfMessage:c,isFirstItemInGroup:u,isLastItemInGroup:m,children:(0,s.jsx)(P.N,{children:C.length>0&&(0,s.jsx)(o.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:tQ.COLLAPSE_EXPAND,ease:tZ.EASE_OUT},style:{overflow:"hidden"},children:(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(am,{isStreaming:_,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,borderless:!0,autoCollapse:!1,children:null==x?void 0:x.map((e,t)=>{var a;let n=null!=(a=e.id)?a:"block-".concat(t),l=C.includes(e),i=C.indexOf(e);return(0,s.jsx)(o.P.div,{initial:!1,animate:{opacity:+!!l,height:l?"auto":0},transition:{ease:tZ.SNAPPY_OUT,duration:.2,delay:.15*!l},className:"overflow-hidden",children:null==h?void 0:h(e,t,{isFirstItem:0===i,isLastItem:i===C.length-1,isInExpandedTimeline:v,isTimelineExpanded:v})},n)})})})},"nested-timeline")})})});ax.displayName="TaskToolCell";let af=e=>{let{children:t,isStreaming:a=!1}=e,n=(0,l.useRef)(null),[i,r]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(0);return((0,l.useLayoutEffect)(()=>{if(n.current&&!a){let e=n.current.scrollHeight;m(e),c(e>200)}},[a,t]),a)?(0,s.jsx)("div",{className:"px-2.5 text-text-300 !font-base [&_p]:!font-base [&_p]:!m-0 [&_p]:!p-0",children:t}):(0,s.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.3},className:"px-2.5 text-text-300 !font-base [&_p]:!font-base [&_p]:!m-0 [&_p]:!p-0",children:[(0,s.jsxs)("div",{ref:n,className:"relative overflow-hidden transition-[max-height] duration-300 ease-out",style:{maxHeight:i?"".concat(u,"px"):"".concat(200,"px")},children:[t,d&&!i&&(0,s.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t from-bg-100 to-transparent pointer-events-none"})]}),d&&(0,s.jsx)("button",{onClick:()=>r(e=>!e),className:"text-xs text-text-500/80 hover:text-text-100 transition",children:i?(0,s.jsx)(g.A,{defaultMessage:"Show less",id:"qyJtWyZ0yt"}):(0,s.jsx)(g.A,{defaultMessage:"Show more",id:"aWpBzjCXKS"})})]})},ap=(0,l.memo)(e=>{let{text:t,isStreaming:a,isFirstItemInGroup:n,isLastItemInGroup:l}=e;return t?(0,s.jsx)(t9,{icon:(0,s.jsx)(R.ExtendedThinking,{size:16,className:"text-text-500"}),isFirstItem:!!n,isLastItem:!!l,isActive:a,showDotFallback:!1,children:(0,s.jsx)("div",{className:"pt-0.5",children:(0,s.jsx)(af,{isStreaming:a,children:(0,s.jsx)(eJ.qO,{text:t,isStreaming:a})})})}):null}),ag=(0,l.memo)(function(e){let{blocks:t,isStreaming:a,statusText:n,turnIsOver:i,renderBlock:r,onStatusDisplayVisibilityChange:d,blocksAfterTimeline:c=[],renderBlockAfterTimeline:u,childrenAfterTimeline:m,fadeToolsOnStatusChange:x=!1,statusPillClassName:f,className:h,stepsDisplayText:b}=e,v=(0,p.A)(),[y,j]=(0,l.useState)(!1),w=(0,l.useRef)(""),N=(0,l.useRef)(0),_=!i&&a&&t.length>0,k=c.length>0||null!==m,M=(0,l.useMemo)(()=>{if(!x)return y?t:t.filter(e=>"thinking"!==e.type).slice(-3);let e=n||"";if(e&&e!==w.current&&""!==w.current&&(N.current=t.length),w.current=e,y||0===t.length)return t;let a=N.current;return t.slice(a)},[t,n,y,x]),C=(0,l.useMemo)(()=>new Set(M),[M]),S=(0,l.useMemo)(()=>{let e=new Map;return M.forEach((t,a)=>e.set(t,a)),e},[M]),A=(0,l.useMemo)(()=>{let e=new Map;return t.forEach((t,a)=>e.set(t,a)),e},[t]),E=_&&!!n;(0,l.useLayoutEffect)(()=>(null==d||d(E),()=>null==d?void 0:d(!1)),[E,d]),(0,l.useEffect)(()=>{_||0===N.current||(j(!1),N.current=0,w.current="")},[_]);let I=(0,l.useCallback)(()=>{j(e=>!e)},[]);if(0===t.length&&!k)return null;let T=n||v.formatMessage({defaultMessage:"Working",id:"gAR0atqpRn"}),L=t.length>0;return(0,s.jsx)("div",{className:h,children:(0,s.jsxs)("div",{className:"grid grid-rows-[auto_auto] min-w-0",children:[L&&(0,s.jsx)("div",{className:"row-start-1 col-start-1 min-w-0",children:(0,s.jsx)(au,{isWorking:_&&!!n,statusText:T,stepCount:t.length,isTimelineExpanded:y,onToggleTimeline:I,sparkLayoutId:"claude-spark",className:_?void 0:f,stepsDisplayText:b,children:(0,s.jsxs)(am,{isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,isStreaming:!1,borderless:!0,autoCollapse:!1,children:[t.map((e,t)=>(0,s.jsx)("div",{children:r(e,t,{isFirstItem:0===t,isLastItem:!1,isInExpandedTimeline:!1,isTimelineExpanded:!0})},t)),(0,s.jsx)(t9,{icon:(0,s.jsx)(R.CheckCircle,{size:16,className:"text-text-500"}),isFirstItem:!1,isLastItem:!0,isActive:!1,showDotFallback:!1,children:(0,s.jsx)("div",{className:"pl-2.5 pt-0.5 text-text-300 !font-base",children:(0,s.jsx)(g.A,{defaultMessage:"Done",id:"JXdbo8Vnlw"})})})]})})}),(L||k)&&(0,s.jsxs)("div",{className:"row-start-2 col-start-1 relative grid isolate min-w-0",children:[k&&(0,s.jsx)("div",{className:"row-start-1 col-start-1 relative z-[2] min-w-0",children:null!=m?m:c.map((e,t)=>(0,s.jsx)("div",{children:null==u?void 0:u(e,t)},"after-".concat(t)))}),L&&(0,s.jsx)(P.N,{children:_&&(0,s.jsx)(o.P.div,{className:"row-start-1 col-start-1 relative z-0 min-w-0",style:{overflowAnchor:"none"},initial:{opacity:1},exit:{opacity:0,height:0},transition:{duration:tQ.COLLAPSE_EXPAND,ease:tZ.EASE_OUT},children:(0,s.jsx)(am,{isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,isStreaming:!0,borderless:!0,autoCollapse:!1,animateEntrance:!0,children:x?(0,s.jsx)(P.N,{children:M.map((e,t)=>{var a;let n=null!=(a=A.get(e))?a:t;return(0,s.jsx)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:tQ.FADE,ease:tZ.EASE_OUT},children:r(e,n,{isFirstItem:0===t,isLastItem:t===M.length-1,isInExpandedTimeline:!0,isTimelineExpanded:y})},n)})}):t.map((e,t)=>{var a;let n=C.has(e),l=null!=(a=S.get(e))?a:-1;return(0,s.jsx)(o.P.div,{initial:!1,animate:{opacity:+!!n,height:n?"auto":0},transition:{layout:{duration:0},ease:tZ.SNAPPY_OUT,duration:.2},className:"overflow-hidden",children:r(e,t,{isFirstItem:0===l,isLastItem:l===M.length-1,isInExpandedTimeline:!0,isTimelineExpanded:y})},t)})})},"expanded-tools")})]})]})})}),ah=(0,l.memo)(e=>{let t,a,{input:n,toolResult:l,renderMode:i=t3.Standard,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,isFirstItemInGroup:d,isLastItemInGroup:c,isStreaming:u,iconSize:m=16,onUrlClick:x}=e,f=(0,p.A)(),h=String((null==n?void 0:n.url)||""),b=(e=>{try{return new URL(e).hostname}catch(e){return null}})(h),v=null==l?void 0:l.is_error,y=v?null:(e=>{if(!(null==e?void 0:e.content))return null;try{let t=e.content;if(!Array.isArray(t))return null;let a=t.find(e=>"knowledge"===e.type&&e.title);if(a)return{title:a.title};let s=t.find(e=>"text"===e.type);if(null==s?void 0:s.text)try{let e=JSON.parse(s.text);if(Array.isArray(e)&&e.length>0&&e[0].title)return{title:e[0].title}}catch(e){}return null}catch(e){return null}})(l),j=(null==y?void 0:y.title)||h,w=!!l||!u;return w?v?a=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A,{defaultMessage:"Failed to fetch",id:"1nV3NuMwiG"})," ",(0,s.jsx)("span",{className:"text-text-400",children:j})]}):(a=j,t=b||void 0):a=b?f.formatMessage({defaultMessage:"Fetching from {hostname}",id:"5qKeNV67+8"},{hostname:b}):f.formatMessage({defaultMessage:"Fetching page",id:"uAw7cJ5rnr"}),(0,s.jsx)(ae,{handleClick:h?()=>{h&&(x?x(h):window.open(h,"_blank"))}:void 0,isStreaming:!w,icon:(0,s.jsx)(eP.d,{url:h,size:m,fadeInOnLoad:!0}),text:a,secondaryText:t,secondaryIcon:w&&h?(0,s.jsx)(R.ArrowOutSquare,{size:16,className:"text-text-300"}):void 0,hideCaret:!0,isFirstBlockOfMessage:r,isLastBlockOfMessage:o,renderMode:i,isFirstItemInGroup:d,isLastItemInGroup:c})});ah.displayName="WebFetchToolCell";var ab=a(0x128782146);let av=(0,l.memo)(e=>{let{input:t,toolResult:a,renderMode:n=t3.Standard,isFirstBlockOfMessage:l,isLastBlockOfMessage:i,isFirstItemInGroup:r,isLastItemInGroup:d,isStreaming:c,iconSize:u=16,onResultClick:m}=e,x=(0,p.A)(),f=(0,ab.O)(a),g=f.length,h="";if("string"==typeof t)try{let e=JSON.parse(t);h=(null==e?void 0:e.query)||""}catch(e){h=""}else h=(null==t?void 0:t.query)||"";let b=g>0||!c,v=b?h:x.formatMessage({defaultMessage:"Searching the web",id:"5KajyzHSXj"}),y=b&&g>0?x.formatMessage({defaultMessage:"{count, plural, one {# result} other {# results}}",id:"s88ium+h8p"},{count:g}):void 0;return(0,s.jsx)(ae,{icon:(0,s.jsx)(R.Globe,{size:u,className:"text-text-500"}),text:v,secondaryText:y,isStreaming:!b,hideCaret:!0,renderMode:n,isFirstBlockOfMessage:l,isLastBlockOfMessage:i,isFirstItemInGroup:r,isLastItemInGroup:d,children:f.length>0&&(0,s.jsx)(o.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{ease:"easeOut",duration:.3},className:"overflow-hidden",children:(0,s.jsx)("div",{className:"border-[0.5px] border-border-300 rounded-lg p-1 mx-2.5 mt-1 mb-2 max-h-[150px] overflow-y-auto bg-bg-000/50",children:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:f.map((e,t)=>(0,s.jsx)(ad,{title:e.title,url:e.url,faviconUrl:e.faviconUrl,onClick:m},"".concat(e.url,"-").concat(t)))})})})})});var ay=a(0x4e764078),aj=a(0x204e49c37),aw=a(0x865afcc2),aN=a(0x9f369389),a_=a(0x4fd5f678),ak=a(0x37979d5f),aM=a(0xde8f44d0),aC=a(0x152f2a28d);function aS(e){let{toolName:t,integrationName:a,iconUrl:n,input:l,toolResult:i,approvalData:r,onCollapse:o}=e;return(0,s.jsxs)("div",{className:"border-[0.5px] border-border-300 rounded-lg mx-2.5 mt-1 mb-2 py-2 overflow-hidden bg-bg-000",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2",children:[(0,s.jsx)(eV.O,{size:24,children:(0,s.jsx)(eP.d,{url:n,size:16,fadeInOnLoad:!0,fallbackSvg:(0,s.jsx)(al.B,{letter:a||t,size:16,hideBorder:!0})})}),(0,s.jsx)("div",{className:"text-sm text-text-300",children:a?(0,s.jsx)(g.A,{defaultMessage:"Claude wants to use {toolName} from {integrationName}",id:"wPBSjwhfE4",values:{toolName:t,integrationName:a}}):(0,s.jsx)(g.A,{defaultMessage:"Claude wants to use {toolName}",id:"ZNLjFNb5bD",values:{toolName:t}})})]}),(0,s.jsx)(tr.L,{input:l,toolResult:i}),(0,s.jsx)(aC.E,{disabled:r.disabled,submitToolApproval:r.submitToolApproval,showAlwaysAllowed:r.showAlwaysAllowed,setIsExpanded:o})]})}var aA=a(0x1df1902be);function aE(e){let{toolName:t,integrationName:a,iconUrl:n,input:l,toolResult:i,mcpAuthRequired:r,onAuthSuccess:o}=e;return(0,s.jsxs)("div",{className:"border-[0.5px] border-border-300 rounded-lg mx-2.5 mt-1 mb-2 py-2 overflow-hidden bg-bg-000",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2",children:[(0,s.jsx)(eV.O,{size:24,children:(0,s.jsx)(eP.d,{url:n,size:16,fadeInOnLoad:!0,fallbackSvg:(0,s.jsx)(al.B,{letter:a||t,size:16,hideBorder:!0})})}),(0,s.jsx)("div",{className:"text-sm text-text-300",children:a?(0,s.jsx)(g.A,{defaultMessage:"Claude wants to use {toolName} from {integrationName}",id:"wPBSjwhfE4",values:{toolName:t,integrationName:a}}):(0,s.jsx)(g.A,{defaultMessage:"Claude wants to use {toolName}",id:"ZNLjFNb5bD",values:{toolName:t}})})]}),(0,s.jsx)(tr.L,{input:l,toolResult:i}),(0,s.jsx)(aA.Z,{mcpAuthRequired:r,onAuthSuccess:o})]})}var aI=a(0x14a7c225d),aT=a(0x5ae340a6);let aL=e=>(0,s.jsx)(av,{toolName:e.block.name,toolUseId:e.block.id,input:(0,e$.Y)(e.block),toolResult:e.toolResultBlock,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,isStreaming:e.effectiveIsStreaming},e.index),aR=e=>(0,s.jsx)(ah,{toolName:e.block.name,toolUseId:e.block.id,input:(0,e$.Y)(e.block),toolResult:e.toolResultBlock,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,isStreaming:e.effectiveIsStreaming},e.index),aF=(0,l.memo)(e=>{var t,a;let{block:i,index:o,blocks:d,isStreaming:c,isThisMessageStreaming:u,isLastMessage:m,updatedMessage:x,message:f,onResize:p,conversationUuid:g,shareType:h,onOpenArtifact:b,onOpenWiggleFile:v,presentFiles:y,...j}=e,{isFirstItemInGroup:w,isLastItemInGroup:_,isInExpandedTimeline:k,renderMode:M}=j,{setMessageFeatures:C}=(0,N.Bk)(),S=(0,Z.PF)(),{toolPermissionRequests:A,onToolDecision:E}=(0,eZ.Q)(),I=d[o+1],T=d.length,L=(null==I?void 0:I.type)==="tool_result",R="tool_use"===i.type?i:null,F=e8(g,null!=(t=null==R?void 0:R.name)?t:"",null!=(a=null==R?void 0:R.id)?a:"",null==R?void 0:R.approval_options,null==R?void 0:R.approval_key,null==R?void 0:R.buffered_input,L),z=!!(null==F?void 0:F.approvalRequired),[O,U]=(0,l.useState)(!0),D=R&&"mcp_auth_required"in R?R.mcp_auth_required:void 0,[P,B]=(0,l.useState)(!1),G=(0,l.useCallback)(()=>{B(!0)},[]),W=0===o,q=!!T&&o===T-1-!!L,H=(0,l.useCallback)(e=>null==b?void 0:b(e,x.uuid),[b,x.uuid]),Y=(0,l.useCallback)(()=>{C(f.uuid,{hasLink:!0})},[C,f.uuid]),V=(0,l.useCallback)(()=>{C(f.uuid,{hasCode:!0})},[C,f.uuid]),{activeOrganization:J}=(0,n.YL)(),{dispatchChatResource:K}=(0,tl.i)(),{setIsDrawerExpanded:X}=(0,tn.x)(),$=(0,r.fS)("chat-ui-core"),Q=(0,l.useCallback)((e,t)=>{if(!t.startsWith("computer://")||!(null==J?void 0:J.uuid))return;e.preventDefault();let a=t.replace("computer://","");if(S){var s;null===aN.Q2||void 0===aN.Q2||null==(s=aN.Q2.openLocalFile)||s.call(aN.Q2,g,a);return}K({type:"SELECT_FILE",path:a,toolType:"create_file",messageId:x.uuid}),X(!0)},[null==J?void 0:J.uuid,g,K,S,X,x.uuid]),ee=(0,l.useCallback)((e,t)=>{if(e&&x.uuid){if(S){var a;null===aN.Q2||void 0===aN.Q2||null==(a=aN.Q2.openLocalFile)||a.call(aN.Q2,g,e);return}K({type:"SELECT_FILE",path:e,toolType:t,messageId:x.uuid}),X(!0)}},[g,K,S,X,x.uuid]),et=(0,ts._)(),ea=(0,l.useCallback)(e=>{(null==J?void 0:J.uuid)&&et(h?{filepaths:e,orgUuid:null==J?void 0:J.uuid,snapshotUuid:g,isShared:!0,source:"wiggle_file_card_download_all"}:{filepaths:e,orgUuid:null==J?void 0:J.uuid,conversationUuid:g,isShared:!1,source:"wiggle_file_card_download_all"})},[null==J?void 0:J.uuid,h,g,et]),es=(0,l.useCallback)(e=>{null==v||v(e,f.uuid)},[v,f.uuid]),en=(0,l.useCallback)(e=>{null==ea||ea(e)},[ea]),el=c||q&&u&&(null==x?void 0:x.stop_reason)==="max_tokens"&&"stop_timestamp"in i&&!!i.stop_timestamp,ei=(0,l.useMemo)(()=>{let e={index:o,renderMode:M,isFirstItemInGroup:w,isLastItemInGroup:_,isLastBlockOfMessage:q,isThisMessageStreaming:u,isLastMessage:m,chatUiCore:$,onLinkDetected:Y,onCodeDetected:V,onOpenArtifact:H,onLinkClick:Q};switch(i.type){case"thinking":return((e,t,a,n)=>{let{index:l,renderMode:i,isFirstItemInGroup:r,isLastItemInGroup:o,isLastBlockOfMessage:d,isThisMessageStreaming:c,isLastMessage:u,chatUiCore:m,onLinkDetected:x,onCodeDetected:f,onOpenArtifact:p,onLinkClick:g}=t;if("working"===e.alternative_display_type){let t=(0,s.jsx)(eJ.qO,{text:e.thinking,onLinkDetected:x,onCodeDetected:f,className:c?"progressive-markdown":"standard-markdown",isStreaming:c,onOpenArtifact:p,isLastMessage:u,onLinkClick:g,chatUiCore:m});return i!==t3.TimelineGroup?t:(0,s.jsx)(t9,{isFirstItem:!!r,isLastItem:!!o,isActive:c&&d,showDotFallback:!0,children:(0,s.jsx)(af,{isStreaming:c,children:t})})}let h=c&&(!e.stop_timestamp||d&&(null==n?void 0:n.stop_reason)==="max_tokens");return(0,s.jsx)(ap,{text:e.thinking,isStreaming:h,isFirstItemInGroup:r,isLastItemInGroup:o,isInExpandedTimeline:a},l)})(i,e,k,x);case"tool_use":{let e=(null==I?void 0:I.type)==="tool_result"?I:void 0,t=i.name.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase(),a={index:o,block:i,toolResultBlock:e,normalizedToolName:t,effectiveIsStreaming:el,isFirstBlockOfMessage:W,isLastBlockOfMessage:q,isFirstItemInGroup:w,isLastItemInGroup:_};if("web_search"===t)return aL(a);if("web_fetch"===t)return aR(a);if("recent_chats"===t||"conversation_search"===t||"project_knowledge_search"===t)return(e=>{let{block:t,toolResultBlock:a,normalizedToolName:n,effectiveIsStreaming:l}=e,i="message"in t?t.message:void 0,r=null==a?void 0:a.display_content,o=null==a?void 0:a.message,d=(null==r?void 0:r.type)==="rich_content"&&r.content||[],c="recent_chats"===n||"conversation_search"===n?d.map(e=>{if(!e.title||!e.url)return null;let t=e.url.match(/\/chat\/([a-f0-9-]+)/);return t?{conversationUuid:t[1],title:e.title,url:e.url}:null}).filter(e=>null!==e):[],u="project_knowledge_search"===n?d.filter(e=>!!e.title):[],m=!!a,x=c.length>0||u.length>0?(0,s.jsxs)(s.Fragment,{children:[c.length>0&&(0,s.jsx)("div",{className:"pt-1",children:(0,s.jsx)(ak.g,{results:c,disabled:l})}),u.length>0&&(0,s.jsx)("div",{className:"flex flex-col flex-nowrap p-2",children:u.map((e,t)=>(0,s.jsx)(aw.$,{disabled:l,title:e.title,subtitles:e.subtitles,url:e.url,tag:e.resource_type},t))})]}):null;return(0,s.jsx)(ao,{toolName:t.name,toolUseId:t.id,message:i,resultMessage:o,resultCount:d.length,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,isStreaming:l&&!m,children:x},e.index)})(a);if("ask_user_question"===t)return((e,t,a)=>{let{block:n,toolResultBlock:l,effectiveIsStreaming:i}=e,r=null==t?void 0:t.find(e=>"AskUserQuestion"===e.toolName),o=!!l,d=r&&a?(e,t)=>{let s={questions:t.questions,answers:e};a(r.toolUseId,n.id,s,"once")}:void 0;return(0,s.jsx)(ar,{toolName:n.name,toolUseId:n.id,toolDisplayName:"Asking for clarification",input:(0,e$.Y)(n),toolResult:l,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,isStreaming:!o&&i,children:(0,s.jsx)("div",{className:"mx-2.5 mt-1 mb-2",children:(0,s.jsx)(a_.w,{input:(0,e$.Y)(n),onAnswersSubmit:d})})},e.index)})(a,A,E);if("task"===t)return((e,t)=>{let{block:a,effectiveIsStreaming:n}=e,l=(0,e$.Y)(a),i=a.id,r=t.find(e=>"tool_result"===e.type&&"tool_use_id"in e&&e.tool_use_id===i),o=t.filter(e=>"_parentToolUseId"in e&&e._parentToolUseId===i),d=o.filter(e=>"tool_use"===e.type);return(0,s.jsx)(ax,{description:null==l?void 0:l.description,isStreaming:n,isComplete:!!r,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,subagentBlocks:d,renderSubagentBlock:(e,t,a)=>{var l,i,r;let{isFirstItem:d,isLastItem:c}=a;if("tool_use"!==e.type)return null;let u=o.find(t=>"tool_result"===t.type&&"tool_use_id"in t&&t.tool_use_id===e.id),m=e.name.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase(),x={index:t,block:e,toolResultBlock:u,normalizedToolName:m,effectiveIsStreaming:n,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,isFirstItemInGroup:d,isLastItemInGroup:c};if("web_search"===m)return aL(x);if("web_fetch"===m)return aR(x);let f=(0,e4.pK)(e.name),p=(null==f||null==(l=f.server)?void 0:l.iconSrc)||e.integration_icon_url,g=null==f||null==(i=f.server)?void 0:i.name;return(0,s.jsx)(ar,{toolName:e.name,toolUseId:e.id,toolDisplayName:null==f||null==(r=f.tool)?void 0:r.displayName,input:e.input,toolResult:u,integrationIconUrl:p,integrationName:g,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:!1,isLastBlockOfMessage:!1,isFirstItemInGroup:d,isLastItemInGroup:c,isStreaming:n})}},e.index)})(a,d);if("launch_extended_search_task"===i.name)return((e,t)=>(0,s.jsx)(aT.wD,{toolUseId:e.block.id,conversationUuid:t,toolResult:e.toolResultBlock,isStreaming:e.effectiveIsStreaming,context:e.block.context},e.index))(a,g);if(["create_file","open_file","update_file","view","read","write","edit"].includes(t))return((e,t)=>{let a,{block:n,toolResultBlock:l,normalizedToolName:i,effectiveIsStreaming:r}=e,o=(0,e$.Y)(n),d=(null==o?void 0:o.file_path)||(null==o?void 0:o.path)||"",c=(null==o?void 0:o.content)||(null==o?void 0:o.file_text)||"",u=d.includes("/mnt/skills/"),m=null==o?void 0:o.description;if(u&&["open_file","view"].includes(i)){a="skill";let e=d.split("/"),t=e.indexOf("skills"),s=e[t+1]||"";m=m||(r?"Loading ".concat(s," skill"):"Loaded ".concat(s," skill"))}else a="create_file"===i||"write"===i?"create":["open_file","view","read"].includes(i)?"read":"edit";let x="skill"===a||"read"===a?!!l||!r:!!l;return(0,s.jsx)(as,{action:a,path:d,fileText:c,displayText:m,icon:(0,s.jsx)("div",{className:"text-text-500",children:(0,s.jsx)(aI.o,{path:d,size:16,weight:"light"})}),isStreaming:r,isComplete:x,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,handleClick:()=>t(d,n.name),renderCode:(e,t)=>(0,s.jsx)("div",{className:"[&_pre]:!text-xs [&_code]:!text-xs",children:(0,s.jsx)(aM.z,{language:t,code:e,className:"!bg-bg-000"})})},e.index)})(a,ee);if("present_files"===t)return(e=>{var t;let a=(null==(t=e.toolResultBlock)?void 0:t.message)||(e.effectiveIsStreaming?"Presenting file(s)...":"Presented file(s)"),n=!!e.toolResultBlock||!e.effectiveIsStreaming;return(0,s.jsx)(as,{action:"present",path:"",displayText:a,isStreaming:e.effectiveIsStreaming,isComplete:n,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup},e.index)})(a);return(e=>{var t,a,n,l,i;let{block:r,toolResultBlock:o,normalizedToolName:d,effectiveIsStreaming:c,approvalData:u,isApprovalRequired:m,isApprovalExpanded:x,setIsApprovalExpanded:f,mcpAuthRequired:p,isMcpAuthComplete:g,onMcpAuthSuccess:h}=e,b=(0,e$.Y)(r),v=((e,t)=>"bash"===e||"bash_tool"===e?(null==t?void 0:t.description)||(null==t?void 0:t.command)||"Bash":"str_replace"===e||"str_replace_editor"===e?(null==t?void 0:t.path)?"Editing ".concat(t.path):"Str replace":"todo_write"===e?"Update todo list":void 0)(d,b),y=!!o,j=(0,e4.pK)(r.name),w=(null==j||null==(t=j.server)?void 0:t.iconSrc)||r.integration_icon_url,N=v||(null==j||null==(a=j.tool)?void 0:a.displayName),_=null==j||null==(n=j.server)?void 0:n.name;return(0,s.jsxs)(ar,{toolName:r.name,toolUseId:r.id,toolDisplayName:N,input:r.input,toolResult:o,integrationIconUrl:w,integrationName:_,renderMode:t3.TimelineGroup,isFirstBlockOfMessage:e.isFirstBlockOfMessage,isLastBlockOfMessage:e.isLastBlockOfMessage,isFirstItemInGroup:e.isFirstItemInGroup,isLastItemInGroup:e.isLastItemInGroup,isStreaming:c&&!y,children:[m&&x&&(0,s.jsx)(aS,{toolName:N||r.name,integrationName:null==j||null==(l=j.server)?void 0:l.name,iconUrl:w,input:b,toolResult:o,approvalData:u,onCollapse:()=>f(!1)}),!!p&&!g&&(0,s.jsx)(aE,{toolName:N||r.name,integrationName:null==j||null==(i=j.server)?void 0:i.name,iconUrl:w,input:b,toolResult:o,mcpAuthRequired:p,onAuthSuccess:h})]},e.index)})({...a,approvalData:F,isApprovalRequired:z,isApprovalExpanded:O,setIsApprovalExpanded:U,mcpAuthRequired:D,isMcpAuthComplete:P,onMcpAuthSuccess:G})}case"text":return((e,t)=>{let{index:a,renderMode:n,isFirstItemInGroup:l,isLastItemInGroup:i,isLastBlockOfMessage:r,isThisMessageStreaming:o,isLastMessage:d,chatUiCore:c,onLinkDetected:u,onCodeDetected:m,onOpenArtifact:x,onLinkClick:f,conversationUuid:p,shareType:g,presentFiles:h,onOpenWiggleFile:b,onDownloadAll:v}=t;if(0===a&&""===e.text)return;let y=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eJ.qO,{text:e.text,blockCitations:e.citations,onLinkDetected:u,onCodeDetected:m,className:o?"progressive-markdown":"standard-markdown",isStreaming:o,onOpenArtifact:x,isLastMessage:d,onLinkClick:f,chatUiCore:c}),(0,s.jsx)(ta,{text:e.text,onOpen:b,conversationUuid:p,onDownloadAll:v,shareType:g,presentFiles:r?h:void 0})]});return n!==t3.TimelineGroup?y:(0,s.jsx)(t9,{isFirstItem:!!l,isLastItem:!!i,isActive:o&&r,showDotFallback:!0,children:(0,s.jsx)(af,{isStreaming:o,children:y})})})(i,{...e,conversationUuid:g,shareType:h,presentFiles:y,onOpenWiggleFile:es,onDownloadAll:en});default:return null}},[F,i,d,$,g,el,o,O,z,W,w,k,q,_,m,P,u,D,I,V,en,ee,Q,Y,G,H,es,E,y,M,h,A,x]);return(0,s.jsxs)(s.Fragment,{children:[ei,(0,s.jsx)(tC,{block:i,blocksCount:d.length,index:o,isThisMessageStreaming:u})]})});aF.displayName="TimelineBlock";let az=e=>{let t,a=RegExp(".*(\\n|\\.(\\s|$)|。)"),s=e.substring(0,100),n=a.exec(s);if(n)t=n[0];else{let e=s.length;for(let t=s.length-1;t>=50;t--)if(/\s/.test(s[t])){e=t+1;break}t=s.substring(0,e)}return t.trim().replace(/[.!?;:,\n]+$/,"").trim()},aO=(0,l.memo)(e=>{var t,a;let{blocks:n,isStreaming:i,isThisMessageStreaming:r,isLastMessage:d,updatedMessage:c,message:u,onResize:m,conversationUuid:x,shareType:f,onOpenArtifact:g,onOpenWiggleFile:h,useLastTextAsFinalAnswerFallback:b,useTruncatedThinkingFallback:v=!1}=e,y=(0,p.A)(),{setData:j}=(0,ay.u5)(),w=(0,eO.Ho)(),N=(0,l.useMemo)(()=>n.filter(e=>"tool_use"===e.type).map(e=>e.name),[n]),_=(0,eO.TC)(w?N:[]),k=(0,l.useCallback)(e=>!!w&&"tool_use"===e.type&&_.has(e.name),[w,_]),M=(0,l.useMemo)(()=>{let e=n.find(e=>"tool_use"===e.type&&"AskUserInput"===e.name);return e&&"tool_use"===e.type?e.input:null},[n]);(0,l.useLayoutEffect)(()=>{var e;if(!d)return void j(null);if(null==M||null==(e=M.questions)?void 0:e.length){let e=M.questions.filter(e=>{var t;return e.id&&e.question&&(null==(t=e.options)?void 0:t.length)}).map(e=>({id:e.id,type:e.type||"select",question:e.question,options:(e.options||[]).filter(e=>e.id&&e.label).map(e=>({id:e.id,label:e.label,description:e.description,icon:e.icon})),multiSelect:e.multiSelect})).filter(e=>e.options.length>=2);e.length>0?j({questions:e}):j(null)}else j(null)},[M,d,j]);let{blocksBeforeAnswer:C,blocksAfterAnswer:S,hasProcessGroupMarker:A}=(0,l.useMemo)(()=>{let e=-1,t=!1;for(let a=0;a<n.length;a++){let s=n[a];if("process_group_marker"===s.type){"start"===s.marker_type?t=!0:"end"===s.marker_type&&(e=a);continue}}let a=e=>e.filter(e=>"process_group_marker"!==e.type&&!("_isSubagentBlock"in e&&e._isSubagentBlock));if(-1!==e)return{blocksBeforeAnswer:a(n.slice(0,e)),blocksAfterAnswer:a(n.slice(e+1)),hasProcessGroupMarker:!0};if(t)return{blocksBeforeAnswer:a(n),blocksAfterAnswer:[],hasProcessGroupMarker:!1};let s=a(n);if(b){if(!r||(null==c?void 0:c.stop_reason)==="end_turn"||(null==c?void 0:c.stop_reason)==="stop_sequence"){let e=-1;for(let t=s.length-1;t>=0;t--){var l;let a=s[t];if("text"===a.type&&(null==(l=a.text)?void 0:l.trim())){e=t;break}}if(-1!==e)return{blocksBeforeAnswer:s.slice(0,e),blocksAfterAnswer:s.slice(e),hasProcessGroupMarker:!1}}return{blocksBeforeAnswer:s,blocksAfterAnswer:[],hasProcessGroupMarker:!1}}let i=s.findIndex(e=>{var t;return"text"===e.type&&(null==(t=e.text)?void 0:t.trim())});return -1!==i?{blocksBeforeAnswer:s.slice(0,i),blocksAfterAnswer:s.slice(i),hasProcessGroupMarker:!1}:{blocksBeforeAnswer:s,blocksAfterAnswer:[],hasProcessGroupMarker:!1}},[n,b,r,null==c?void 0:c.stop_reason]),E=(0,eY.a)(u),I=(0,l.useMemo)(()=>(0,eY.G)(u),[E]),T=r?y.formatMessage({defaultMessage:"Working",id:"gAR0atqpRn"}):void 0,L=(0,l.useMemo)(()=>!!(A||(null==c?void 0:c.stop_reason)==="end_turn"||(null==c?void 0:c.stop_reason)==="stop_sequence"||S.some(e=>{var t;return"text"===e.type&&(null==(t=e.text)?void 0:t.trim())})),[null==c?void 0:c.stop_reason,A,S]),R=(0,aj.wg)(),F=(0,l.useRef)(n),z=(0,l.useRef)(i),O=(0,l.useRef)(r),U=(0,l.useRef)(c),D=(0,l.useRef)(u),P=(0,l.useRef)(I);F.current=n,z.current=i,O.current=r,U.current=c,D.current=u,P.current=I;let B=(0,l.useMemo)(()=>{let e=new Map;return n.forEach((t,a)=>e.set(t,a)),e},[n]),G=(0,l.useMemo)(()=>C.filter(e=>{var t;return"tool_result"!==e.type&&"token_budget"!==e.type&&!("text"===e.type&&!(null==(t=e.text)?void 0:t.trim()))&&("tool_use"!==e.type||"artifacts"!==e.name)&&!("tool_use"===e.type&&tY.has(e.name))&&!("_isSubagentBlock"in e&&e._isSubagentBlock)&&!k(e)}),[C,k]),W=C.length>0,q=(0,l.useMemo)(()=>(function(e){let t=new Map;for(let n=0;n<e.length;n++){let l=e[n];if("tool_use"!==l.type)continue;let i=tH.find(e=>e.toolName===l.name);if(!i)continue;let r=e[n+1],o=(null==r?void 0:r.type)==="tool_result"?r:void 0,d=i.extract(o,l.input);if(i.aggregate){var a,s;let e=t.get(i.toolName),n=null!=(a=null==e?void 0:e.result)?a:[],r=Array.isArray(d)?d:d?[d]:[];t.set(i.toolName,{input:null!=(s=null==e?void 0:e.input)?s:l.input,result:[...n,...r]})}else t.has(i.toolName)||t.set(i.toolName,{input:l.input,result:d})}return t})(C),[C]),H=q.size>0,Y=(0,l.useMemo)(()=>S.filter(e=>"thinking"===e.type),[S]),V=(0,l.useMemo)(()=>S.filter(e=>"thinking"!==e.type),[S]),J=(0,l.useMemo)(()=>{let e=[];for(let t=0;t<C.length;t++){let a=C[t];if(k(a)){e.push(a);let s=C[t+1];(null==s?void 0:s.type)==="tool_result"&&e.push(s)}}return e},[C,k]),K=(0,l.useMemo)(()=>{let{aggregatedBlocks:e}=function(e){let t=[],a=new Set,s=0;for(;s<e.length;){let n=e[s];if(tJ(n)){let n=[],l=s,i=s;for(;s<e.length;){let t=e[s];if(tJ(t)){let t=e[s+1],l=(null==t?void 0:t.type)==="tool_result"?t:void 0,r=tq(l);n.push(...r),a.add(s),l?(a.add(s+1),i=s+1,s+=2):(i=s,s+=1)}else if(tK(t))a.add(s),i=s,s+=1;else break}t.push({type:"aggregated_image_search",images:n,startIndex:l,endIndex:i})}else if(tX(n)&&"tool_use"===n.type){let l=s,i=e[s+1],r=(null==i?void 0:i.type)==="tool_result"?i:void 0,o=tW(r);a.add(s),r?(a.add(s+1),s+=2):s+=1,t.push({type:"aggregated_widget",toolName:n.name,input:n.input,result:o,index:l})}else t.push(n),s+=1}return{aggregatedBlocks:t,aggregatedIndices:a}}(V),t=V.find(e=>"tool_use"===e.type&&"AskUserInput"===e.name),a=(null==t?void 0:t.type)==="tool_use"?t.id:null;return e.filter(e=>("tool_use"!==e.type||"AskUserInput"!==e.name)&&("tool_result"!==e.type||!("tool_use_id"in e)||e.tool_use_id!==a))},[V]),X=(0,l.useMemo)(()=>[...G,...Y],[G,Y]),$=(0,l.useMemo)(()=>V.some(e=>{var t;return"text"===e.type&&(null==(t=e.text)?void 0:t.trim())}),[V]),Q=(0,l.useMemo)(()=>{for(let a=X.length-1;a>=0;a--){let s=X[a];if("thinking"===s.type){var e,t;let a=null==(t=s.summaries)||null==(e=t.at(-1))?void 0:e.summary;if(a)return a.trim().replace(/[.!?;:,]+$/,"").trim()}}},[X]),Z=(0,l.useMemo)(()=>{if(v)for(let e=X.length-1;e>=0;e--){let t=X[e];if("thinking"===t.type)return t}},[X,v]),[ee,et]=(0,l.useState)(void 0),ea=(0,l.useRef)(!1);r&&(ea.current=!0),(0,tx.W)(()=>{v&&!r&&!Q&&(null==Z?void 0:Z.thinking)&&et(az(Z.thinking))},[v,r,Q,null==Z?void 0:Z.thinking],r||ea.current?2e3:0);let es=(0,l.useMemo)(()=>{if(v&&r&&!Q&&(null==Z?void 0:Z.thinking))return az(Z.thinking)},[v,r,Q,null==Z?void 0:Z.thinking]),en=null!=(a=null!=(t=null!=Q?Q:es)?t:ee)?a:void 0,el=(0,l.useCallback)((e,t,a)=>{var n;let{isFirstItem:l,isLastItem:i,isInExpandedTimeline:r}=a;if("synthetic_working"===e.type)return null;let o=null!=(n=B.get(e))?n:t,c="tool_use"===e.type&&("launch_extended_search_task"===e.name||"mcp_auth_required"in e),u=c?z.current:!!r&&z.current,p=c?O.current:!!r&&O.current;return(0,s.jsx)(aF,{block:e,index:o,blocks:F.current,renderMode:eU.l.TimelineGroup,isFirstItemInGroup:l,isLastItemInGroup:i,isLastMessage:d,isStreaming:u,isThisMessageStreaming:p,isInExpandedTimeline:r,updatedMessage:U.current,message:D.current,onResize:m,conversationUuid:x,shareType:f,onOpenArtifact:g,onOpenWiggleFile:h,presentFiles:P.current})},[B,d,m,x,f,g,h]),ei=(0,l.useMemo)(()=>{var e,t;if(!r)return!1;let a=-1;for(let e=0;e<V.length;e++){let t=V[e];if("tool_use"===t.type&&"image_search"===t.name){a=e;break}}if(-1===a)return!1;for(let t=0;t<a;t++){let a=V[t];if("text"===a.type&&(null==(e=a.text)?void 0:e.trim()))return!1}let s=a;for(let e=V.length-1;e>=0;e--){let t=V[e];if("tool_use"===t.type&&"image_search"===t.name){s=e;break}}for(let e=s+1;e<V.length;e++){let a=V[e];if("tool_result"!==a.type&&"token_budget"!==a.type&&("text"!==a.type||(null==(t=a.text)?void 0:t.trim())))return!1}return!0},[V,r]),er=(0,l.useMemo)(()=>0!==V.length||H?ei?(0,s.jsx)("div",{className:"pl-2 pt-1",children:(0,s.jsxs)("div",{className:"flex gap-2 h-[160px] rounded-xl overflow-hidden mb-2",children:[(0,s.jsx)("div",{className:"flex-1 bg-bg-300 animate-pulse"}),(0,s.jsx)("div",{className:"flex-1 bg-bg-300 animate-pulse"}),(0,s.jsx)("div",{className:"flex-1 bg-bg-300 animate-pulse"})]})}):(0,s.jsxs)(s.Fragment,{children:[J.length>0&&(0,s.jsx)(t$,{blocks:J,isStreaming:i,isThisMessageStreaming:r,isLastMessage:d,updatedMessage:c,message:u,onResize:m,conversationUuid:x,shareType:f,onOpenArtifact:g,onOpenWiggleFile:h}),tV.map(e=>{let{toolName:t,className:a,render:n}=e,l=q.get(t);return l&&$&&("image_search"!==t||0!==l.result.length)?(0,s.jsx)(o.P.div,{className:a,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,ease:"easeOut"},children:n(l,x)},t):null}),K.length>0&&(0,s.jsx)(t$,{blocks:K,isStreaming:i,isThisMessageStreaming:r,isLastMessage:d,updatedMessage:{...c,content:K},message:u,onResize:m,conversationUuid:x,shareType:f,onOpenArtifact:g,onOpenWiggleFile:h})]}):null,[J,K,V,q,H,$,ei,x,i,r,d,c,u,m,f,g,h]),eo=0===X.length&&W&&r&&!L?[{type:"synthetic_working"}]:X;return(0,s.jsx)(ag,{blocks:eo,isStreaming:r,statusText:en||T,turnIsOver:L,onStatusDisplayVisibilityChange:R,renderBlock:el,childrenAfterTimeline:er,statusPillClassName:"pl-2",stepsDisplayText:en})});aO.displayName="CoalescedMessageBlocksRenderer";let aU=(0,l.memo)(e=>{var t,a,n,i;let{isStreaming:d,isThisMessageStreaming:c,isLastMessage:u,updatedMessage:m,onResize:x,previousMessage:f,message:p,isInteractive:g,isFirstAssistantMessage:h,onRetry:b,isResearchPending:v,isTemporary:y,conversationSettings:j,messageWarningPropsFromParent:w,onSendContinue:N,onOpenArtifact:C,shareType:A,onOpenWiggleFile:T,...L}=e;(0,r.fS)("claudeai_crabby_claws_enabled");let R=(0,r.fS)("chat-ui-core"),F=(0,r.fS)("claude_ai_coalesced_timeline"),z=(0,et.Zx)(L.conversationUuid),{markPerceivedFirstToken:O}=(0,ez.B)(),U=(0,l.useRef)(null);if((0,l.useLayoutEffect)(()=>{if(!u||U.current===m.uuid||!c)return;let e=(m.content||[]).find(e=>"text"===e.type?e.text&&e.text.trim().length>0:"thinking"===e.type?"thinking"in e&&e.thinking&&e.thinking.length>0:"tool_use"===e.type&&"name"in e&&e.name);e&&(U.current=m.uuid,O({firstContentType:e.type}))},[u,c,m.content,m.uuid,O]),(!m.content||!m.content[0])&&!(null==(t=m.metadata)?void 0:t.is_resume_completion_placeholder_message))return null;let D=(0,s.jsxs)(E,{"data-is-streaming":c,...d?M:k,className:R||u?"pb-3":"pb-8",children:[(0,s.jsx)(I,{children:F||z?(0,s.jsx)(aO,{blocks:m.content||[],isStreaming:d,isThisMessageStreaming:c,isLastMessage:u,updatedMessage:m,isResearchPending:v,message:p,onResize:x,conversationUuid:L.conversationUuid,shareType:A,onOpenWiggleFile:T,onOpenArtifact:C,useLastTextAsFinalAnswerFallback:z,useTruncatedThinkingFallback:z}):(0,s.jsx)(t$,{blocks:m.content||[],isStreaming:d,isThisMessageStreaming:c,isLastMessage:u,updatedMessage:m,isResearchPending:v,message:p,onResize:x,conversationUuid:L.conversationUuid,shareType:A,onOpenWiggleFile:T,onOpenArtifact:C})}),null==(a=m.content)?void 0:a.map((e,t)=>{if("bell"===e.type||"voice_note"===e.type)return(0,s.jsx)(eC,{text:e.text,title:e.title},t)}),!z&&(0,s.jsxs)(s.Fragment,{children:[!d&&u&&(0,s.jsx)(ef,{previousMessage:f}),!R&&(0,s.jsx)(ei,{message:p,previousMessage:f,isLastMessage:u,isInteractive:g,isFirstAssistantMessage:h,onRetry:b,isResearchPending:v,isTemporary:y,showArtifacts:null!=(n=null==j?void 0:j.preview_feature_uses_artifacts)&&n,isStreaming:d,...L}),(0,s.jsx)(_,{message:p,isLastMessage:u,messageWarningPropsFromParent:w,conversationSettings:j,onRetry:b,onSendContinue:N}),(0,s.jsx)(eM,{message:p,conversationUuid:L.conversationUuid,isStreaming:c})]})]});return(0,s.jsxs)(o.P.div,{style:{height:"auto"},className:R?"group":void 0,...d?S:k,children:[D,R&&!z&&(0,s.jsx)(ei,{message:p,previousMessage:f,isLastMessage:u,isInteractive:g,isFirstAssistantMessage:h,onRetry:b,isResearchPending:v,isTemporary:y,showArtifacts:null!=(i=null==j?void 0:j.preview_feature_uses_artifacts)&&i,isStreaming:d,positionMode:"flow",...L})]})});aU.displayName="AssistantMessage";var aD=a(0x1a18acadd),aP=a(0x246846ae8),aB=a(0x1f59f8010);let aG=(0,l.memo)(e=>{var t,a,n;let{isStreaming:i,currentEdit:o,setCurrentEdit:d,finishEdit:c,cancelEdit:u,author:m,loggedInAccount:f,message:p,selectAttachment:h,showSharedImageMissing:b=!1,showSharedFileMissing:v=!1}=e,y=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=e=>{if(!e.isComposing&&("Enter"!==e.key||e.shiftKey||(e.preventDefault(),c()),"Escape"===e.key&&(e.preventDefault(),u()),"a"===e.key&&(e.metaKey||e.ctrlKey)&&document.activeElement===y.current)){var t;null==(t=y.current)||t.select()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[c,u,y]);let j=null!=(n=p.files_v2)?n:p.files,w=b||v||p.attachments.length+j.length+((null==p||null==(t=p.sync_sources)?void 0:t.length)||0)>0,N=(0,r.fS)("chat-ui-core"),_=(0,D.C)(p),M=0===o.length||_===o||N&&i;return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c()},className:N?"pb-6":void 0,children:[w&&(0,s.jsxs)("div",{className:"mx-0.5 mb-3 flex flex-wrap gap-0.5",children:[j.map((e,t)=>(0,s.jsx)(eT.NM,{file:e},t)),p.attachments.map((e,t)=>(0,s.jsx)(eT.NM,{file:e,handleClick:()=>null==h?void 0:h(e)},t)),null==p||null==(a=p.sync_sources)?void 0:a.map(e=>(0,s.jsx)(aB.V,{uuid:e.uuid,syncSource:e},e.uuid)),b&&(0,s.jsx)(eT.sv,{}),v&&!b&&(0,s.jsx)(eT.lD,{})]}),(0,s.jsx)(A,{...i?C:k,className:"w-full",children:(0,s.jsxs)("div",{className:"flex flex-row gap-2",children:[!N&&(0,s.jsx)("div",{className:"flex shrink-0 items-center",children:(0,s.jsx)(aD.e,{name:m||(null==f?void 0:f.full_name)||"",size:"sm"})}),(0,s.jsxs)("div",{className:"font-ui mr-3 grid w-full grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6",children:[(0,s.jsx)(aP.fs,{value:o,onChange:e=>d(e.target.value),autoFocus:!0,className:"w-full",ref:y}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsxs)("div",{className:"text-text-300 flex flex-row gap-2 text-xs ".concat(N?"items-start":"items-center"),children:[(0,s.jsx)(x.R,{"aria-hidden":"true",className:"shrink-0 ".concat(N?"mt-0.5":"")}),(0,s.jsx)("div",{children:(0,s.jsx)(g.A,{defaultMessage:"Editing this message will create a new conversation branch. You can switch between branches using the arrow navigation buttons.",id:"zqkUZeVH+L"})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(F.$,{onClick:u,variant:"secondary",children:(0,s.jsx)(g.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(F.$,{type:"submit",disabled:M,children:(0,s.jsx)(g.A,{defaultMessage:"Save",id:"jvo0vs3nF0"})})]})]})]})]})})]})});aG.displayName="EditingMessage";var aW=a(0x7c3335d0),aq=a(0xcd8c00e0);aq.A.blockRegex;let aH=aq.A.defaultRules,aY=aq.A.parserFor;aq.A.defaultBlockParse;let aV=aq.A.outputFor,aJ=e=>{if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(aJ);if(l.isValidElement(e)){if(e.props&&"object"==typeof e.props&&"children"in e.props){let t=e.props.children,a=aJ(t);if(a!==t)return l.cloneElement(e,void 0,a)}return e}if((e=>"object"==typeof e&&null!==e&&"$$typeof"in e&&"type"in e&&"props"in e)(e)){let{type:t,props:a,key:s}=e,n={};return a&&"object"==typeof a&&(Object.assign(n,a),"children"in a&&(n.children=aJ(a.children))),null!=s&&(n.key=s),l.createElement(t,n)}return e};var aK=a(0x11307af4f);let aX={fence:{...aH.fence,parse:(e,t,a)=>({lang:e[2]||void 0,content:e[3]}),react:e=>(0,s.jsx)(aK.I.pre,{flagShowCodeHeader:!1,children:e.content})},blockQuote:{...aH.blockQuote,react:(e,t,a)=>(0,s.jsx)(aK.I.blockQuote,{children:t(e.content,a)})},list:{...aH.list,react:(e,t,a)=>{let n=e.ordered?aK.I.ol:aK.I.ul;return(0,s.jsx)(n,{children:e.items.map((e,n)=>(0,s.jsx)(aK.I.li,{children:t(e,a)},n))},a.key)}},newline:aH.newline,paragraph:{...aH.paragraph,react:(e,t,a)=>(0,s.jsx)(aK.I.p,{children:t(e.content,a)},a.key)},del:aH.del,inlineCode:{...aH.inlineCode,react:e=>{let t=e.content;if(t&&aW.yT.test(t)){var a;if((null==(a=t.match(aW.yT))?void 0:a[0])===t)return(0,s.jsxs)(aK.I.code,{children:[(0,s.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",position:"relative",top:"-0.15em"},children:(0,s.jsx)(aW.qU,{color:t})}),t]})}return(0,s.jsx)(aK.I.code,{children:t})}},text:{...aH.text,react:e=>(0,aW.fz)(e.content)},url:aH.url,link:{...aH.link,match:(e,t)=>null,react:e=>{let t=e.target;return(0,s.jsx)("a",{href:t,target:"_blank",className:"underline",children:t})}}},a$=(0,l.memo)(e=>{let{text:t}=e,a=aY(aX)(t,{inline:!1});return((e,t,a)=>{let s=aV(e,t,a),n=(e,t)=>aJ(s(e,t));return n.displayName="OutputFor_".concat(String(t)),n})(aX,"react")(a)});a$.displayName="AnthropicMarkDown";var aQ=a(0x253a5c787),aZ=a(0x18175ce17),a0=a(0x23e87e502);let a1={type:"remote"},a2=(0,l.memo)(e=>{var t,a,n,i,o,d;let{files:c,updatedMessage:u,message:m,isLastMessage:x,isInteractive:p,editable:h,startEdit:b,onRetry:v,isResearchPending:y,isTemporary:j,author:w,shareType:N,conversationSettings:M,messageWarningPropsFromParent:S,previousMessage:E,isStreaming:I,selectAttachment:T,showSharedImageMissing:L,showSharedFileMissing:R,...F}=e,O=(0,r.fS)("chat-ui-core"),U=L||R||u.attachments.length+c.length+((null==u||null==(t=u.sync_sources)?void 0:t.length)||0)>0,D=null==(a=u.content)?void 0:a.some(e=>"text"===e.type&&""!==e.text),P="voice"===u.input_mode||"speech_input"===u.input_mode,[B,G]=(0,l.useState)(!1),[W,q]=(0,l.useState)(!1),H=(0,l.useRef)(null);(0,l.useEffect)(()=>{H.current&&q(H.current.scrollHeight>300)},[u.content]);let Y=(0,l.useCallback)(()=>{G(e=>!e)},[]),V=(0,l.useMemo)(()=>{var e,t;return null!=(t=null==(e=m.sync_sources)?void 0:e.filter(e=>e.type===an.v8.GDRIVE).map(e=>e.config.uri))?t:[]},[m.sync_sources]),J=(0,aZ.kO)(),K=(0,l.useMemo)(()=>{var e,t;return null!=(t=null==(e=m.sync_sources)?void 0:e.filter(e=>e.type===an.v8.MCP_RESOURCES).map(e=>e.config.resource.uri))?t:[]},[m.sync_sources]),X=(0,e4.Uz)(a1),$=(0,l.useMemo)(()=>null==X?void 0:X.find(e=>e.url&&aZ.TI[e.url]===an.v8.GDRIVE),[X]),[Q,Z]=(0,l.useState)([]);(0,l.useEffect)(()=>{if(!J||!$||0===K.length)return void Z([]);let e=!1;return(async()=>{try{let t=(0,e4.KU)($.uuid),a=await Promise.all(K.map(async e=>{try{var a;let s=await t.readResource({uri:e}),n=null==s||null==(a=s.contents)?void 0:a[0];if(!(null==n?void 0:n.text))return{data:null};let l=n.text;return{data:{uri:e,title:(null==n?void 0:n.name)||"",mime_type:n.mimeType||"text/plain",owner:"",text:l,size:l.length}}}catch(t){return(0,aQ.Cp)(t,{tags:{component:"HumanMessage",action:"fetch_mcp_resource",serverUuid:$.uuid},extra:{uri:e}}),{data:null}}}));e||Z(a)}catch(t){(0,aQ.Cp)(t,{tags:{component:"HumanMessage",action:"fetch_mcp_resources_batch",serverUuid:$.uuid}}),e||Z([])}})(),()=>{e=!0}},[J,$,K]);let ee=(0,eu.qL)(V),et=(0,l.useMemo)(()=>[...ee,...Q],[ee,Q]),ea=(0,l.useMemo)(()=>et.some(e=>{let{data:t}=e;return t&&/\[image\d*\]/.test(t.text)}),[et]),es=(0,l.useMemo)(()=>m.created_at?new Date(m.created_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"",[m.created_at]),en=(0,l.useMemo)(()=>{if(!m.created_at)return"";let e=new Date(m.created_at),t=new Date,a=e.toDateString()===t.toDateString(),s=e.getFullYear()===t.getFullYear();return a?e.toLocaleTimeString(void 0,{timeStyle:"short"}):s?e.toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},[m.created_at]);return(0,s.jsxs)("div",{className:(0,f.A)("mb-1",{"mt-6":O,"mt-1":!O,group:O}),children:[U&&(0,s.jsxs)("div",{className:(0,f.A)("gap-2 mx-0.5 mb-3 flex flex-wrap",{"justify-end":O}),children:[c.map((e,t)=>(0,s.jsx)(eT.NM,{file:e},t)),u.attachments.map((e,t)=>(0,s.jsx)(eT.NM,{file:e,handleClick:()=>null==T?void 0:T(e)},t)),null==u||null==(n=u.sync_sources)?void 0:n.map(e=>(0,s.jsx)(aB.V,{uuid:e.uuid,syncSource:e},e.uuid)),L&&(0,s.jsx)(eT.sv,{}),R&&!L&&(0,s.jsx)(eT.lD,{})]}),(0,s.jsxs)("div",{className:(0,f.A)({"flex flex-col items-end gap-1":O}),children:[(!O||D)&&(0,s.jsxs)(A,{className:(0,f.A)({"!px-4 max-w-[85%]":O,"pr-6":!O&&D,"pr-[2.5px]":!O&&!D}),...I?C:k,children:[(0,s.jsxs)("div",{className:"flex flex-row gap-2 relative",children:[!O&&m.pending&&(0,s.jsx)("div",{className:"absolute size-7 rounded-full bg-bg-500 animate-pulse"}),!O&&(0,s.jsx)(z.m,{delayDuration:1e3,side:"left",sideOffset:16,tooltipContent:es,children:(0,s.jsx)("div",{className:(0,f.A)("shrink-0 transition-all duration-300 self-start",{"blur-md opacity-0 origin-center":m.pending}),children:N?(0,s.jsx)(aD.e,{name:w||null,size:"sm"}):(0,s.jsx)(a0.J,{size:"sm"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{ref:H,"data-testid":"user-message",className:(0,f.A)("font-large !font-user-message grid grid-cols-1 gap-2 py-0.5 relative",{italic:P,"text-text-500 animate-pulse":m.pending}),style:{maxHeight:B||!W?"none":"200px",overflow:"hidden",position:"relative"},children:[null==(i=u.content)?void 0:i.map((e,t)=>"text"!==e.type?null:(0,s.jsx)(a$,{text:e.text},t)),!B&&W&&(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-bg-300 to-transparent pointer-events-none"})]}),W&&(0,s.jsx)("button",{onClick:Y,className:"pb-3 pt-1 text-xs text-text-500/80 hover:text-text-100 transition w-3/4 text-left rounded-lg",children:B?(0,s.jsx)(g.A,{defaultMessage:"Show less",id:"qyJtWyZ0yt"}):(0,s.jsx)(g.A,{defaultMessage:"Show more",id:"aWpBzjCXKS"})})]})]}),(0,s.jsx)(_,{message:m,isLastMessage:x,hasDriveDocWithImages:ea,conversationSettings:M,messageWarningPropsFromParent:S}),!O&&(0,s.jsx)(ei,{message:m,isStreaming:I,previousMessage:E,isLastMessage:x,isInteractive:p,editMessage:b,editable:h,onRetry:v,isResearchPending:y,isTemporary:j,showArtifacts:null!=(o=null==M?void 0:M.preview_feature_uses_artifacts)&&o,...F})]}),O&&(0,s.jsx)(ei,{message:m,isStreaming:I,previousMessage:E,isLastMessage:x,isInteractive:p,editMessage:b,editable:h,onRetry:v,isResearchPending:y,isTemporary:j,showArtifacts:null!=(d=null==M?void 0:M.preview_feature_uses_artifacts)&&d,positionMode:"flow",timestamp:en,fullTimestamp:es,...F})]})]})});function a5(){return(0,s.jsx)("div",{className:"flex justify-center py-2",children:(0,s.jsx)("span",{className:"text-sm text-text-400 italic",children:(0,s.jsx)(g.A,{defaultMessage:"Claude was nudged",id:"/aLBWz8ek0"})})})}a2.displayName="HumanMessage";var a3=a(0xda044f84),a4=a(0xc5b8d95e);let a8=(0,l.memo)(function(e){var t,a;let{lastHumanMessageRef:r,lastAssistantMessageRef:o,isLastMessage:d,isLastHumanMessage:c,selectAttachment:u,author:m,isInteractive:x=!0,onOpenArtifact:f,onOpenWiggleFile:g,onResize:h,editable:b,conversationSettings:v,messageWarningProps:y,showSharedImageMissing:j=!1,showSharedFileMissing:w=!1,isFirstAssistantMessage:N,shareType:_=null,isTemporary:k=!1,actionEmitter:M,onSendContinue:C,isResearchPending:S=!1,isSessionConversation:A=!1,...E}=e,{account:I}=(0,n.YL)(),{messageUuid:T="",message:L,previousMessageUuid:R="",previousMessage:F,isStreaming:z}=E,O=(0,i.JX)(T),D=(0,i.JX)(R),P=L||O,B=F||(R?D:void 0),G=(e=>{let t=(0,l.useRef)(1);return(0,l.useEffect)(()=>{e||(t.current+=1)},[e]),t.current})(d),W=(e=>{let{message:t,onOpenArtifact:a,shareType:s}=e,n=(0,a4.n)(),i=(0,p.A)();return(0,l.useMemo)(()=>{let e=(e=>{var t;let a=e.content,s=null==(t=e.content)?void 0:t[0];return(null==s?void 0:s.type)==="text"&&""===s.text.trim()&&(a=null==a?void 0:a.slice(1)),a})(t),l=(null==e?void 0:e.map(e=>(e=>{let{block:t,citationsEnabled:a,shareType:s,onOpenArtifact:n,intl:l}=e;if("text"!==t.type)return t;let i=t.text;if(a&&t.citations&&t.citations.length>0&&(i=(0,a3.k0)(t.citations,i)),i=n?(0,U.Tm)(i):(0,U.it)(i),s){for(let e of(0,tt.n)(i))if(!(0,e7.m)(e,s)){let t="public"===s?"[".concat(l.formatMessage({defaultMessage:"Files hidden in shared chats",id:"ANRUB+TiTq"}),"]"):"[".concat(l.formatMessage({defaultMessage:"Working file hidden in shared chat",id:"oqkUomHXYH"}),"]"),a=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=RegExp("\\[[^\\]]*\\]\\(".concat(a,"\\)"),"g");i=i.replace(n,t)}}return{...t,text:i}})({block:e,citationsEnabled:n,shareType:s,onOpenArtifact:a,intl:i})))||[];return{...t,content:l}},[n,i,t,a,s])})({message:P,onOpenArtifact:f,shareType:_}),q=(0,l.useCallback)((e,t)=>{null==M||M.emit("retry",{parent_message_uuid:e,paprika_mode:t})},[M]),H=null!=(a=P.files_v2)?a:P.files,Y="human"===W.sender,V="assistant"===W.sender,J=d&&z,K=function(e,t){if(!t||"human"!==e.sender||!e.content||!Array.isArray(e.content)||1!==e.content.length)return!1;let a=e.content[0];return!!a&&"object"==typeof a&&"type"in a&&"text"===a.type&&"text"in a&&"string"==typeof a.text&&/^<claude_restart_nudge>[\s\S]*<\/claude_restart_nudge>$/.test(a.text.trim())}(W,A),{isUserEditing:X,currentEdit:$,setCurrentEdit:Q,startEdit:Z,finishEdit:ee,cancelEdit:et}=(e=>{var t;let{editable:a,updatedMessage:s,actionEmitter:n}=e,[i,r]=(0,l.useState)(!1),[o,d]=(0,l.useState)(""),c="",u=null==(t=s.content)?void 0:t.find(e=>"text"===e.type);u&&"text"in u&&(c=u.text);let m=(0,l.useCallback)(()=>{a&&(d(c),r(!0))},[a,c]),x=(0,l.useCallback)(()=>{0!==o.length&&n&&(n.emit("edit",{message:s,text:o}),r(!1),d(""))},[o,n,s]),f=(0,l.useCallback)(()=>{r(!1),d("")},[]);return{isUserEditing:i,currentEdit:o,setCurrentEdit:d,startEdit:m,finishEdit:x,cancelEdit:f}})({editable:b,actionEmitter:M,updatedMessage:W});return X?(0,s.jsx)(aG,{isStreaming:z,currentEdit:$,setCurrentEdit:Q,finishEdit:ee,cancelEdit:et,author:m,loggedInAccount:I,message:W,selectAttachment:u,showSharedImageMissing:j,showSharedFileMissing:w}):K?(0,s.jsx)(a5,{}):(0,s.jsxs)("div",{ref:c?r:d?o:null,"data-test-render-count":G,children:[Y&&(0,s.jsx)(a2,{files:H,updatedMessage:W,message:P,isLastMessage:d,isLastHumanMessage:c,isInteractive:x,editable:b,startEdit:Z,onRetry:q,isResearchPending:S,isTemporary:k,author:m,shareType:_,conversationSettings:v,messageWarningPropsFromParent:y,previousMessage:B,selectAttachment:u,showSharedImageMissing:j,showSharedFileMissing:w,...E}),V&&(W.content&&W.content[0]||(null==(t=W.metadata)?void 0:t.is_resume_completion_placeholder_message))&&(0,s.jsx)(aU,{isThisMessageStreaming:J,isLastMessage:d,isLastHumanMessage:!1,updatedMessage:W,onResize:h,previousMessage:B,message:P,isInteractive:x,isFirstAssistantMessage:N,onRetry:q,isResearchPending:S,isTemporary:k,conversationSettings:v,messageWarningPropsFromParent:y,onSendContinue:C,onOpenArtifact:f,onOpenWiggleFile:g,shareType:_,...E})]})})},0x20d6272f9:(e,t,a)=>{"use strict";a.d(t,{FT:()=>i,Ud:()=>r});var s=a(0x24fcf6beb),n=a(0x23b9f35d7),l=a.n(n);function i(e){var t;let a=e.split("."),s=a.slice(0,-1).join("."),n=a.length>1?null!=(t=a.at(-1))?t:"":null,i=s.replaceAll(/[_-]/g," ");return{displayName:l()(i),displayExt:n?n.toUpperCase():null}}function r(e){var t;let a=null==(t=e.split(".").pop())?void 0:t.toLowerCase();return a?["skill"].includes(a)?"skill":["csv","tsv"].includes(a)?"table":["xls","xlsx"].includes(a)?"spreadsheet":["pptx"].includes(a)?"preso":["pdf","md","docx"].includes(a)?"doc":["mermaid","mmd"].includes(a)?"diagram":["jsx","tsx"].includes(a)?"code":["svg"].includes(a)||s._o.includes(a)?"image":s.Uv.includes(a)?"code":null:null}},0x20e7b44d0:(e,t,a)=>{"use strict";a.d(t,{H:()=>n});var s=a(0xa5acf583);function n(){return(0,s._r)().ipCountry}},0x21010ec24:(e,t,a)=>{"use strict";a.d(t,{N:()=>g,z:()=>h});var s=a(0x22102fd88),n=a(0xf32c56dd),l=a(0x12c9046cd),i=a(0x14de19ae8),r=a(0x139b5e710),o=a(0x1016c6ed2),d=a(0xfc89b4a4),c=a(0x38e6572),u=a(0x1334f6ecc),m=a(0x4d9fc74e),x=a(0x18175ce17),f=a(0xf02ef1a6),p=a(0xd3117c3a);function g(e){let{conversationUuid:t,source:a}=e,{activeOrganization:g}=(0,i.YL)(),{addError:h}=(0,r.Yf)(),b=(0,n.st)(),[v,y]=(0,d.useState)(!1),[j,w]=(0,d.useState)(f.K.NOT_CONNECTED),N=(0,x.kO)(),{isDriveAuthenticated:_,initDriveAuth:k,isFetched:M}=(0,u.cI)(),C=(0,m.QD)({queryString:"gdrive_export_success=export-direct"}),S=null==g?void 0:g.uuid,A=(0,l.L2)("/api/organizations/".concat(S,"/conversations/").concat(t,"/wiggle/export-to-google-drive"),"POST",{enabled:!!S&&!!t,meta:{noToast:!0}});return{handleOpenInGoogleDrive:(0,d.useCallback)(async e=>{if(!S||!t)return;if(M&&!_)return void h((0,s.jsx)("span",{children:(0,s.jsx)(c.A,{defaultMessage:"<button>Authenticate</button> to export to Google Drive",id:"bQuLbzZRDC",values:{button:e=>(0,s.jsx)("button",{className:"underline",onClick:k,children:e})}})}),{errorContext:{tags:{source:"gdrive_export_auth"}}});let n=e.replace("computer://",""),l=(0,p.k)({filePath:e,isShared:!1,conversationUuid:t,source:a});b.track({event_key:"wiggle.file.gdrive_export.attempted",...l});try{let e=await A.mutateAsync({file_path:n});e.drive_url&&(window.open(e.drive_url,"_blank"),b.track({event_key:"wiggle.file.gdrive_export.success",...l}))}catch(d){let e,t,a,s;if(d instanceof o.LG){var i,r;if(!(e=null!=(r=d.errorCode)?r:void 0)&&(null==(i=d.extra)?void 0:i.details)){let t=d.extra.details;e=t.error_code,a=t.server_id,s=t.server_url}t=d.message}else t="Export failed. Please try again.";let n=(e=>{switch(e){case"google_drive_not_connected":return f.K.NOT_CONNECTED;case"google_drive_insufficient_scopes":return f.K.MISSING_SCOPE;default:return f.K.UNKNOWN}})(e);if(b.track({event_key:"wiggle.file.gdrive_export.failed",error_code:e,error_type:n,error_message:t,...l}),N&&(n===f.K.NOT_CONNECTED||n===f.K.MISSING_SCOPE)&&a)return void C({uuid:a,url:s});if(n===f.K.NOT_CONNECTED||n===f.K.MISSING_SCOPE){w(n),y(!0);return}h(t,{error:d,errorContext:{tags:{source:"google_drive_export"}}})}},[S,t,a,b,A,h,N,C,M,_,k]),showConnectionModal:v,setShowConnectionModal:y,connectionError:j,isExporting:A.isPending}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=/\.docx$/i.test(e),s=/\.xlsx$/i.test(e),n=/\.pptx$/i.test(e);if(t){let t=/\.md$/i.test(e),l=/\.csv$/i.test(e),i=/\.tsv$/i.test(e),r=/\.gif$/i.test(e),o=/\.(jpg|jpeg)$/i.test(e),d=/\.pdf$/i.test(e),c=/\.png$/i.test(e),u=/\.txt$/i.test(e),m=/\.json$/i.test(e);return a||s||n||t||l||i||r||o||d||c||u||m}return a||s||n}},0x2129aebe2:(e,t,a)=>{"use strict";a.d(t,{G:()=>s,a:()=>n});let s=e=>{var t;let a=[];for(let s of null!=(t=e.content)?t:[])if("tool_result"===s.type&&"present_files"===s.name)for(let e of s.content)"local_resource"===e.type&&a.push(e.file_path);return a},n=e=>{var t,a;let s=null!=(a=null==(t=e.content)?void 0:t.length)?a:0;return"present_files:".concat(e.uuid,":").concat(s)}},0x214374164:(e,t,a)=>{"use strict";a.d(t,{TD:()=>h,DT:()=>b,i1:()=>v,Ih:()=>x,h4:()=>f,D8:()=>g});var s=a(0x22102fd88),n=a(0x31075f4f),l=a(0xac309a83),i=a(0x1a1f6dda6),r=a(0x18c2bb2d),o=a(0x160045b25),d=a(0xfc89b4a4),c=a(0x19c88845),u=a(0x38e6572);let m=(0,d.memo)(e=>{let{collapsedCount:t,isExpanded:a,onToggle:n}=e;if(0===t)return null;let l=a?(0,s.jsx)(u.A,{defaultMessage:"Hide steps",id:"Iufn28MeR1"}):(0,s.jsx)(u.A,{defaultMessage:"{collapsedCount, plural, one {# step} other {# steps}}",id:"dS6ebV+vpY",values:{collapsedCount:t}});return(0,s.jsxs)("button",{onClick:n,type:"button",className:(0,i.A)("group/collapse-indicator flex flex-row min-h-[2.125rem] shrink-0 w-full","hover:bg-bg-200 cursor-pointer transition-colors duration-200"),children:[(0,s.jsxs)("div",{className:"flex flex-col items-center pl-3 box-border pointer-events-none",children:[(0,s.jsx)("div",{className:(0,i.A)("transition-all grow w-[1px] bg-border-300",a&&"opacity-0"),style:{minHeight:"calc((2.125rem - 16px) / 2)"}}),(0,s.jsx)("div",{className:"transition-all flex items-center justify-center my-0.5 shrink-0 w-[16px] h-[16px]",children:(0,s.jsx)("span",{className:(0,i.A)("inline-flex transition-transform duration-400 ease-snappy-out",a?"rotate-180":"rotate-0"),children:(0,s.jsx)(c.CaretUpSmall,{className:"text-text-500 group-hover/collapse-indicator:text-text-300",size:16})})}),(0,s.jsx)("div",{className:"transition-all grow w-[1px] bg-border-300",style:{minHeight:"calc((2.125rem - 16px) / 2)"}})]}),(0,s.jsx)("div",{className:"flex items-center px-3 py-2 flex-1 text-sm pointer-events-none",children:(0,s.jsx)("span",{className:"text-text-500 group-hover/collapse-indicator:text-text-300",children:l})})]})});m.displayName="CollapsedToolsIndicator";let x=(e,t,a)=>!(!["thinking","tool_use","tool_result","token_budget"].includes(e.type)||"tool_use"===e.type&&(["prism","end_conversation","launch_extended_search_task","image_search"].includes(e.name)||(null==a?void 0:a.has(e.name))))&&(!!t.get("timeline_artifacts_enabled",!1)||("tool_use"!==e.type||"artifacts"!==e.name)&&("tool_result"!==e.type||"artifacts"!==e.name))&&(!!t.get("timeline_gsuite_enabled",!1)||"tool_use"!==e.type||!e.integration_name),f=e=>"tool_result"!==e.type&&"token_budget"!==e.type&&"process_group_marker"!==e.type,p=d.createContext({}),g=()=>(0,d.useContext)(p),h=e=>{let[t,a]=(0,d.useState)(void 0),n=(0,d.useMemo)(()=>({expandedItemKey:t,setExpandedItemKey:a}),[t,a]);return(0,s.jsx)(p.Provider,{value:n,children:e.children})},b=e=>{let{children:t,isFirstBlockOfMessage:a,isLastBlockOfMessage:c,isStreaming:u,defaultExpanded:x=!1,alwaysExpanded:f=!1}=e,p=(0,l.fS)("claudeai_collapse_timeline_groups"),[g,b]=(0,d.useState)(x),v=(0,d.useCallback)(e=>{e.stopPropagation(),b(e=>!e)},[]),y=d.Children.toArray(t),j=Math.max(0,y.length-2),w=!p||g||f?y:y.slice(-2);return(0,s.jsx)(r.P.div,{initial:{opacity:+!u},animate:{opacity:1},transition:{duration:.5,ease:"easeIn"},className:(0,i.A)("transition-all duration-400 ease-out rounded-lg border-0.5 flex flex-col font-ui leading-normal my-3 border-border-300 min-h-[2.625rem] overflow-hidden",a?"mt-2":"mt-3",c?"mb-2":"mb-3"),children:(0,s.jsxs)(h,{children:[p&&j>0&&!f&&(0,s.jsx)(m,{collapsedCount:j,isExpanded:g,onToggle:v}),(0,s.jsx)(o.N,{initial:!1,mode:"sync",children:w.map((e,t)=>(0,s.jsx)(r.P.div,{className:"overflow-hidden shrink-0",layout:"position",initial:{opacity:0,height:0},animate:"expanded",exit:"collapsed",variants:{expanded:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{layout:{duration:0},ease:n.A.snappyOut,duration:.2},children:e},d.isValidElement(e)&&null!==e.key?e.key:t))})]})})},v=e=>{let{icon:t,isExpanded:a,isFirstItem:n,isLastItem:l,isActive:r,children:o}=e,d={minHeight:"calc((2.125rem - ".concat(t?"16px":"6px",") / 2)")};return(0,s.jsxs)("div",{className:(0,i.A)("flex flex-row min-h-[2.125rem] shrink-0",{"bg-bg-000":a},{"hover:bg-bg-200":!a}),children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pl-3 box-border",children:[(0,s.jsx)("div",{className:(0,i.A)("transition-all w-[1px]",{"bg-border-300":!n}),style:d}),(0,s.jsx)("div",{className:(0,i.A)("transition-all flex items-center justify-center my-1 shrink-0 w-[16px]",{"h-[16px]":!!t}),children:null!=t?t:(0,s.jsx)("div",{className:(0,i.A)("size-[6px] rounded-full",r?"bg-accent-main-200":"bg-border-300")})}),(0,s.jsx)("div",{className:(0,i.A)("transition-all grow w-[1px]",{"bg-border-300":!l}),style:d})]}),(0,s.jsx)("div",{className:"w-full flex flex-col min-w-0",children:o})]})}},0x2202d81f6:(e,t,a)=>{"use strict";a.d(t,{qO:()=>d});var s=a(0x22102fd88),n=a(0x1a1f6dda6),l=a(0xfc89b4a4),i=a(0xbca8e388);class r{isInsideStructure(){return this.inCodeBlock||this.inList||this.inTable||this.inBlockquote}processLine(e){let t=e.trim(),a=this.isInsideStructure();(t.startsWith("```")||t.startsWith("~~~"))&&(this.inCodeBlock?t.startsWith(this.codeBlockDelimiter)&&(this.inCodeBlock=!1,this.codeBlockDelimiter=""):(this.inCodeBlock=!0,this.codeBlockDelimiter=t.substring(0,3))),/^[-*+]|\d+\./.test(t)&&!this.inCodeBlock?this.inList=!0:this.inList&&""===t&&(this.inList=!1),t.includes("|")&&!this.inCodeBlock?this.inTable=!0:this.inTable&&""===t&&(this.inTable=!1);let s=t.startsWith(">");s&&!this.inCodeBlock?this.inBlockquote=!0:this.inBlockquote&&""===t&&!s&&(this.inBlockquote=!1);let n=this.lastLineWasEmpty;this.lastLineWasEmpty=""===t;let l=a&&!this.isInsideStructure();return{insideStructure:this.isInsideStructure(),structureJustClosed:l,previousLineWasEmpty:n}}reset(){this.inCodeBlock=!1,this.codeBlockDelimiter="",this.inList=!1,this.inTable=!1,this.inBlockquote=!1,this.lastLineWasEmpty=!0}constructor(){this.inCodeBlock=!1,this.codeBlockDelimiter="",this.inList=!1,this.inTable=!1,this.inBlockquote=!1,this.lastLineWasEmpty=!0}}let o=(0,l.memo)(e=>{let{text:t,blockCitations:a=[],onLinkDetected:n,onCodeDetected:l,hasLinkRef:r,hasCodeRef:o,className:d,linkTarget:c="_blank",flagShowCodeHeader:u,unsafeAllowNavigationWithoutConfirmation:m,onOpenArtifact:x,isLastMessage:f,messageUuid:p,onLinkClick:g,chatUiCore:h}=e;return(0,s.jsx)(i.fP,{text:t,blockCitations:a,onLinkDetected:n,onCodeDetected:l,hasLinkRef:r,hasCodeRef:o,className:d,linkTarget:c,isStreaming:!1,flagShowCodeHeader:u,unsafeAllowNavigationWithoutConfirmation:m,onOpenArtifact:x,isLastMessage:f,messageUuid:p,onLinkClick:g,chatUiCore:h})},(e,t)=>e.text===t.text);o.displayName="MemoizedMarkdownChunk";let d=(0,l.memo)(e=>{let{text:t,blockCitations:a=[],onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:x,linkTarget:f="_blank",isStreaming:p=!1,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:h,onOpenArtifact:b,isLastMessage:v,messageUuid:y,onLinkClick:j,chatUiCore:w=!1}=e,{completedChunks:N,streamingChunk:_}=((e,t)=>{let a=(0,l.useMemo)(()=>t?null:{completedChunks:e?[e]:[],streamingChunk:""},[e,t]),[s,n]=(0,l.useState)({completedChunks:[],streamingChunk:""}),i=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!t)return;if(!e)return void n({completedChunks:[],streamingChunk:""});i.current||(i.current=new r);let a=e.split("\n"),s=[],l=[],o=-1;i.current.reset();for(let e=0;e<a.length;e++){let t=a[e],{insideStructure:n,structureJustClosed:r,previousLineWasEmpty:d}=i.current.processLine(t);if(l.push(t),r||!n&&""===t.trim()&&l.length>1&&!d){for(;l.length>0&&""===l[l.length-1].trim();)l.pop();l.length>0&&(s.push(l.join("\n")),o=e,l=[])}}n({completedChunks:s,streamingChunk:a.slice(o+1).join("\n")})},[e,t]),null!=a?a:s})(t,p);return 1!==N.length||_?(0,s.jsxs)("div",{className:(0,n.A)("progressive-markdown grid-cols-1 grid [&_>_*]:min-w-0",w?"gap-4":"gap-2.5",x),children:[N.map((e,t)=>(0,s.jsx)(o,{text:t>0?"\n\n"+e:e,blockCitations:a,onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:"",linkTarget:f,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:h,onOpenArtifact:b,isLastMessage:v,messageUuid:y,onLinkClick:j,chatUiCore:w},t)),_&&(0,s.jsx)(i.fP,{text:N.length>0?"\n\n"+_:_,blockCitations:a,onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:"",linkTarget:f,isStreaming:!0,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:h,onOpenArtifact:b,isLastMessage:v,messageUuid:y,onLinkClick:j,chatUiCore:w})]}):(0,s.jsx)(i.fP,{text:t,blockCitations:a,onLinkDetected:d,onCodeDetected:c,hasLinkRef:u,hasCodeRef:m,className:x,linkTarget:f,isStreaming:!1,flagShowCodeHeader:g,unsafeAllowNavigationWithoutConfirmation:h,onOpenArtifact:b,isLastMessage:v,messageUuid:y,onLinkClick:j,chatUiCore:w})});d.displayName="ProgressiveStandardMarkDown"},0x2524bdea9:(e,t,a)=>{"use strict";a.d(t,{$:()=>r,Q:()=>i});var s=a(0x22102fd88),n=a(0xfc89b4a4);let l=n.createContext({renderToolUseCell:void 0,toolPermissionRequests:void 0,onToolDecision:void 0}),i=()=>n.useContext(l),r=e=>{let{renderToolUseCell:t,toolPermissionRequests:a,onToolDecision:i,children:r}=e,o=(0,n.useMemo)(()=>({renderToolUseCell:t,toolPermissionRequests:a,onToolDecision:i}),[t,a,i]);return(0,s.jsx)(l.Provider,{value:o,children:r})}}}]);